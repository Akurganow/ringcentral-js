!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SDK=t():(e.RingCentral=e.RingCentral||{},e.RingCentral.SDK=t())}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="/build/",t(0)}([function(e,t,n){n(1),e.exports=n(2)},function(e,t){(function(t){!function(t){"use strict";function n(e,t,n,r){var o=Object.create((t||i).prototype),s=new h(r||[]);return o._invoke=f(e,n,s),o}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function i(){}function o(){}function s(){}function u(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(e){this.arg=e}function c(e){function t(t,n){var r=e[t](n),s=r.value;return s instanceof a?Promise.resolve(s.arg).then(i,o):Promise.resolve(s).then(function(e){return r.value=e,r})}function n(e,n){function i(){return t(e,n)}return r=r?r.then(i,i):new Promise(function(e){e(i())})}"object"==typeof process&&process.domain&&(t=process.domain.bind(t));var r,i=t.bind(e,"next"),o=t.bind(e,"throw");t.bind(e,"return");this._invoke=n}function f(e,t,n){var i=w;return function(o,s){if(i===x)throw new Error("Generator is already running");if(i===S){if("throw"===o)throw s;return y()}for(;;){var u=n.delegate;if(u){if("return"===o||"throw"===o&&u.iterator[o]===v){n.delegate=null;var a=u.iterator["return"];if(a){var c=r(a,u.iterator,s);if("throw"===c.type){o="throw",s=c.arg;continue}}if("return"===o)continue}var c=r(u.iterator[o],u.iterator,s);if("throw"===c.type){n.delegate=null,o="throw",s=c.arg;continue}o="next",s=v;var f=c.arg;if(!f.done)return i=k,f;n[u.resultName]=f.value,n.next=u.nextLoc,n.delegate=null}if("next"===o)n._sent=s,i===k?n.sent=s:n.sent=v;else if("throw"===o){if(i===w)throw i=S,s;n.dispatchException(s)&&(o="next",s=v)}else"return"===o&&n.abrupt("return",s);i=x;var c=r(e,t,n);if("normal"===c.type){i=n.done?S:k;var f={value:c.arg,done:n.done};if(c.arg!==E)return f;n.delegate&&"next"===o&&(s=v)}else"throw"===c.type&&(i=S,o="throw",s=c.arg)}}}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset(!0)}function d(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function i(){for(;++n<e.length;)if(_.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=v,i.done=!0,i};return r.next=r}}return{next:y}}function y(){return{value:v,done:!0}}var v,_=Object.prototype.hasOwnProperty,b="function"==typeof Symbol&&Symbol.iterator||"@@iterator",m="object"==typeof e,g=t.regeneratorRuntime;if(g)return void(m&&(e.exports=g));g=t.regeneratorRuntime=m?e.exports:{},g.wrap=n;var w="suspendedStart",k="suspendedYield",x="executing",S="completed",E={},O=s.prototype=i.prototype;o.prototype=O.constructor=s,s.constructor=o,o.displayName="GeneratorFunction",g.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===o||"GeneratorFunction"===(t.displayName||t.name):!1},g.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):e.__proto__=s,e.prototype=Object.create(O),e},g.awrap=function(e){return new a(e)},u(c.prototype),g.async=function(e,t,r,i){var o=new c(n(e,t,r,i));return g.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},u(O),O[b]=function(){return this},O.toString=function(){return"[object Generator]"},g.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},g.values=d,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=v,this.done=!1,this.delegate=null,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&_.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=v)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=_.call(i,"catchLoc"),u=_.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&_.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?this.next=i.finallyLoc:this.complete(o),E},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),p(n),E}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;p(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:d(e),resultName:t,nextLoc:n},E}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(3),a=i(u),c=n(12),f=r(c),l=n(4),p=i(l),h=n(13),d=r(h),y=n(14),v=r(y),_=n(15),b=r(_),m=n(17),g=r(m),w=n(16),k=i(w),x=n(18),S=r(x),E=n(20),O=r(E),T=n(19),P=r(T),j=n(21),R=r(j),C=n(22),M=r(C),B=n(23),A=r(B),N=n(25),L=r(N),D=n(26),I=r(D),q=function(){function e(t){o(this,e),t=t||{},this._cache=new f["default"](p.localStorage,t.cachePrefix),this._client=t.client||new b["default"],this._platform=new R["default"](this._client,this._cache,t.server,t.appKey,t.appSecret),this._pubnubFactory=t.pubnubFactory||p.PUBNUB}return s(e,[{key:"platform",value:function(){return this._platform}},{key:"createSubscription",value:function(){return new L["default"](this._pubnubFactory,this._platform)}},{key:"createCachedSubscription",value:function(e){return new I["default"](this._pubnubFactory,this._platform,this._cache,e)}},{key:"cache",value:function(){return this._cache}}]),e}();q.version="2.0.1",q.server={sandbox:"https://platform.devtest.ringcentral.com",production:"https://platform.ringcentral.com"},q.core={Cache:f["default"],Observable:d["default"],Utils:a,Externals:p,Queue:v["default"]},q.http={Client:b["default"],ApiResponse:g["default"],Utils:k},q.platform={Auth:M["default"],Platform:R["default"]},q.subscription={Subscription:L["default"]},q.mocks={Client:S["default"],Registry:P["default"],Mock:O["default"]},q.pubnub={PubnubMockFactory:A["default"]},t["default"]=q},function(e,t,n){"use strict";function r(e){var t=[];return e=e||{},Object.keys(e).forEach(function(n){var r=e[n];s(r)?r.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}),t.join("&")}function i(e){var t={};return e.split("&").forEach(function(e){if(e=decodeURIComponent(e),-1==e.indexOf("="))t[e.trim()]=!0;else{var n=e.split("="),r=n[0].trim(),i=n[1].trim();r in t?(r in t&&!s(t[r])&&(t[r]=[t[r]]),t[r].push(i)):t[r]=i}}),t}function o(e){return"function"==typeof e}function s(e){return Array.isArray?Array.isArray(e):"array"==typeof e}function u(t,n,r){e.exports.stopPolling(r),n=n||1e3;var i=function o(e){return e=e||n,n=e,setTimeout(function(){t(o,e)},e)};return i()}function a(e){e&&clearTimeout(e)}function c(){return"undefined"!=typeof process}function f(){return"undefined"!=typeof window}function l(e){return new p.Promise(function(t,n){setTimeout(function(){t(null)},e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.queryStringify=r,t.parseQueryString=i,t.isFunction=o,t.isArray=s,t.poll=u,t.stopPolling=a,t.isNodeJS=c,t.isBrowser=f,t.delay=l;var p=n(4)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.localStorage=t.PUBNUB=t.Headers=t.Response=t.Request=t.fetch=t.Promise=void 0;var i=n(5),o=r(i),s=n(10),u=r(s),a=n(11),c=r(a),f=new Function("return this")(),l=(t.Promise=o["default"]&&o["default"].Promise||f.Promise,t.fetch=f.fetch||u["default"]);t.Request=f.Request||l.Request,t.Response=f.Response||l.Response,t.Headers=f.Headers||l.Headers,t.PUBNUB=f.PUBNUB||c["default"],t.localStorage="undefined"!=typeof f.localStorage?f.localStorage:{}},function(e,t,n){var r;(function(e,i,o){(function(){"use strict";function s(e){return"function"==typeof e||"object"==typeof e&&null!==e}function u(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function c(e,t){re[X]=e,re[X+1]=t,X+=2,2===X&&(V?V(v):W())}function f(e){V=e}function l(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(t=e),function(){t(v)}}function p(){return function(){G(v)}}function h(){var e=0,t=new ee(v),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function d(){var e=new MessageChannel;return e.port1.onmessage=v,function(){e.port2.postMessage(0)}}function y(){return function(){setTimeout(v,1)}}function v(){for(var e=0;X>e;e+=2){var t=re[e],n=re[e+1];t(n),re[e]=void 0,re[e+1]=void 0}X=0}function _(){try{var e=n(!function(){var e=new Error('Cannot find module "vertx"');throw e.code="MODULE_NOT_FOUND",e}());return G=e.runOnLoop||e.runOnContext,p()}catch(t){return y()}}function b(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function w(e){try{return e.then}catch(t){return ue.error=t,ue}}function k(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function x(e,t,n){Y(function(e){var r=!1,i=k(n,t,function(n){r||(r=!0,t!==n?O(e,n):P(e,n))},function(t){r||(r=!0,j(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,j(e,i))},e)}function S(e,t){t._state===oe?P(e,t._result):t._state===se?j(e,t._result):R(t,void 0,function(t){O(e,t)},function(t){j(e,t)})}function E(e,t){if(t.constructor===e.constructor)S(e,t);else{var n=w(t);n===ue?j(e,ue.error):void 0===n?P(e,t):u(n)?x(e,t,n):P(e,t)}}function O(e,t){e===t?j(e,m()):s(t)?E(e,t):P(e,t)}function T(e){e._onerror&&e._onerror(e._result),C(e)}function P(e,t){e._state===ie&&(e._result=t,e._state=oe,0!==e._subscribers.length&&Y(C,e))}function j(e,t){e._state===ie&&(e._state=se,e._result=t,Y(T,e))}function R(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+oe]=n,i[o+se]=r,0===o&&e._state&&Y(C,e)}function C(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,i,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?A(n,r,i,o):i(o);e._subscribers.length=0}}function M(){this.error=null}function B(e,t){try{return e(t)}catch(n){return ae.error=n,ae}}function A(e,t,n,r){var i,o,s,a,c=u(n);if(c){if(i=B(n,r),i===ae?(a=!0,o=i.error,i=null):s=!0,t===i)return void j(t,g())}else i=r,s=!0;t._state!==ie||(c&&s?O(t,i):a?j(t,o):e===oe?P(t,i):e===se&&j(t,i))}function N(e,t){try{t(function(t){O(e,t)},function(t){j(e,t)})}catch(n){j(e,n)}}function L(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(b),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?P(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&P(n.promise,n._result))):j(n.promise,n._validationError())}function D(e){return new ce(this,e).promise}function I(e){function t(e){O(i,e)}function n(e){j(i,e)}var r=this,i=new r(b);if(!Q(e))return j(i,new TypeError("You must pass an array to race.")),i;for(var o=e.length,s=0;i._state===ie&&o>s;s++)R(r.resolve(e[s]),void 0,t,n);return i}function q(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(b);return O(n,e),n}function U(e){var t=this,n=new t(b);return j(n,e),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function J(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function K(e){this._id=de++,this._state=void 0,this._result=void 0,this._subscribers=[],b!==e&&(u(e)||F(),this instanceof K||J(),N(this,e))}function H(){var e;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(e.Promise=ye)}var z;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G,V,W,Q=z,X=0,Y=({}.toString,c),$="undefined"!=typeof window?window:void 0,Z=$||{},ee=Z.MutationObserver||Z.WebKitMutationObserver,te="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),ne="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,re=new Array(1e3);W=te?l():ee?h():ne?d():void 0===$?_():y();var ie=void 0,oe=1,se=2,ue=new M,ae=new M;L.prototype._validateInput=function(e){return Q(e)},L.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},L.prototype._init=function(){this._result=new Array(this.length)};var ce=L;L.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,r=e._input,i=0;n._state===ie&&t>i;i++)e._eachEntry(r[i],i)},L.prototype._eachEntry=function(e,t){var n=this,r=n._instanceConstructor;a(e)?e.constructor===r&&e._state!==ie?(e._onerror=null,n._settledAt(e._state,t,e._result)):n._willSettleAt(r.resolve(e),t):(n._remaining--,n._result[t]=e)},L.prototype._settledAt=function(e,t,n){var r=this,i=r.promise;i._state===ie&&(r._remaining--,e===se?j(i,n):r._result[t]=n),0===r._remaining&&P(i,r._result)},L.prototype._willSettleAt=function(e,t){var n=this;R(e,void 0,function(e){n._settledAt(oe,t,e)},function(e){n._settledAt(se,t,e)})};var fe=D,le=I,pe=q,he=U,de=0,ye=K;K.all=fe,K.race=le,K.resolve=pe,K.reject=he,K._setScheduler=f,K._asap=Y,K.prototype={constructor:K,then:function(e,t){var n=this,r=n._state;if(r===oe&&!e||r===se&&!t)return this;var i=new this.constructor(b),o=n._result;if(r){var s=arguments[r-1];Y(function(){A(r,i,s,o)})}else R(n,i,e,t);return i},"catch":function(e){return this.then(null,e)}};var ve=H,_e={Promise:ye,polyfill:ve};n(9).amd?(r=function(){return _e}.call(t,n,t,o),!(void 0!==r&&(o.exports=r))):"undefined"!=typeof o&&o.exports?o.exports=_e:"undefined"!=typeof this&&(this.ES6Promise=_e),ve()}).call(this)}).call(t,n(6).setImmediate,function(){return this}(),n(8)(e))},function(e,t,n){(function(e,r){function i(e,t){this._id=e,this._clearFn=t}var o=n(7).nextTick,s=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;t.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=c++,r=arguments.length<2?!1:u.call(arguments,1);return a[n]=!0,o(function(){a[n]&&(r?e.apply(null,r):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof r?r:function(e){delete a[e]}}).call(t,n(6).setImmediate,n(6).clearImmediate)},function(e,t){function n(){c=!1,s.length?a=s.concat(a):f=-1,a.length&&r()}function r(){if(!c){var e=setTimeout(n);c=!0;for(var t=a.length;t;){for(s=a,a=[];++f<t;)s&&s[f].run();f=-1,t=a.length}s=null,c=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function o(){}var s,u=e.exports={},a=[],c=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new i(e,t)),1!==a.length||c||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){!function(){"use strict";function e(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function t(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){this.map={},e instanceof n?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function r(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function i(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function o(e){var t=new FileReader;return t.readAsArrayBuffer(e),i(t)}function s(e){var t=new FileReader;return t.readAsText(e),i(t)}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(h.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(h.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},h.blob?(this.blob=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(o)},this.text=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=r(this);return e?e:Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function a(e){var t=e.toUpperCase();return d.indexOf(t)>-1?t:e}function c(e,t){t=t||{};var r=t.body;if(c.prototype.isPrototypeOf(e)){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new n(e.headers)),this.method=e.method,this.mode=e.mode,r||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=e;if(this.credentials=t.credentials||this.credentials||"omit",(t.headers||!this.headers)&&(this.headers=new n(t.headers)),this.method=a(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function f(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function l(e){var t=new n,r=e.getAllResponseHeaders().trim().split("\n");return r.forEach(function(e){var n=e.trim().split(":"),r=n.shift().trim(),i=n.join(":").trim();t.append(r,i)}),t}function p(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof n?t.headers:new n(t.headers),this.url=t.url||""}if(!self.fetch){n.prototype.append=function(n,r){n=e(n),r=t(r);var i=this.map[n];i||(i=[],this.map[n]=i),i.push(r)},n.prototype["delete"]=function(t){delete this.map[e(t)]},n.prototype.get=function(t){var n=this.map[e(t)];return n?n[0]:null},n.prototype.getAll=function(t){return this.map[e(t)]||[]},n.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},n.prototype.set=function(n,r){this.map[e(n)]=[t(r)]},n.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){e.call(t,r,n,this)},this)},this)};var h={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self},d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.call(c.prototype),u.call(p.prototype),self.Headers=n,self.Request=c,self.Response=p,self.fetch=function(e,t){var n;return n=c.prototype.isPrototypeOf(e)&&!t?e:new c(e,t),new Promise(function(e,t){function r(){return"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0}var i=new XMLHttpRequest;i.onload=function(){var n=1223===i.status?204:i.status;if(100>n||n>599)return void t(new TypeError("Network request failed"));var o={status:n,statusText:i.statusText,headers:l(i),url:r()},s="response"in i?i.response:i.responseText;e(new p(s,o))},i.onerror=function(){t(new TypeError("Network request failed"))},i.open(n.method,n.url,!0),"include"===n.credentials&&(i.withCredentials=!0),"responseType"in i&&h.blob&&(i.responseType="blob"),n.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send("undefined"==typeof n._bodyInit?null:n._bodyInit)})},self.fetch.polyfill=!0}}()},function(module,exports,__webpack_require__){(function(module){window.JSON&&window.JSON.stringify||function(){function toJSON(e){try{return this.valueOf()}catch(t){return null}}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,o,s,u=gap,a=t[e];switch(a&&"object"==typeof a&&(a=toJSON.call(a,e)),"function"==typeof rep&&(a=rep.call(t,e,a)),typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(a)){for(o=a.length,n=0;o>n;n+=1)s[n]=str(n,a)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+u+"]":"["+s.join(",")+"]",gap=u,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)r=rep[n],"string"==typeof r&&(i=str(r,a),i&&s.push(quote(r)+(gap?": ":":")+i));else for(r in a)Object.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&s.push(quote(r)+(gap?": ":":")+i));return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+u+"}":"{"+s.join(",")+"}",gap=u,i}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")})}(),window.PUBNUB||function(){function e(){return"x"+ ++N+ +new Date}function t(){return+new Date}function r(e,t){var n=e.join(H),r=[];return t?(f(t,function(e,t){var n="object"==typeof t?JSON.stringify(t):t;"undefined"!=typeof t&&null!=t&&h(n).length>0&&r.push(e+"="+h(n))}),n+="?"+r.join(z)):n}function i(e,n){var r,i=0,o=function(){i+n>t()?(clearTimeout(r),r=setTimeout(o,n)):(i=t(),e())};return o}function o(e,t){var n=[];return f(e||[],function(e){t(e)&&n.push(e)}),n}function s(e,t){return e.replace(Q,function(e,n){return t[n]||e})}function u(e,t){return setTimeout(e,t)}function a(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});return e&&e(t),t}function c(e){return!!e&&"string"!=typeof e&&(Array.isArray&&Array.isArray(e)||"number"==typeof e.length)}function f(e,t){if(e&&t)if(c(e))for(var n=0,r=e.length;r>n;)t.call(e[n],e[n],n++);else for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)&&t.call(e[n],n,e[n])}function l(e,t){var n=[];return f(e||[],function(e,r){n.push(t(e,r))}),n}function p(e){return encodeURIComponent(e).replace(/[!'()*~]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function h(e){return encodeURIComponent(e)}function d(e,t){var n=[];return f(e,function(e,r){t?e.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function y(e,t){var n=[];return f(e,function(e,r){t?e.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function v(){u(function(){L||(L=1,f(D,function(e){e()}))},K)}function _(_){function b(e){return e||(e={}),f(Me,function(t,n){t in e||(e[t]=n)}),e}function m(e){var t=[];return f(e,function(e,n){t.push(e)}),t}function g(e){return m(e).sort()}function w(e){var t="",n=g(e);for(var r in n){var i=n[r];t+=i+"="+p(e[i]),r!=n.length-1&&(t+="&")}return t}function x(e,t,n){var r=!1;if("undefined"==typeof e)return t;if("number"==typeof e)r=e>G||0==e?!1:!0;else{if("boolean"==typeof e)return e?V:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+G+" or x = 0). Current Value : "+(t||G)),t||G):e}function S(e,t){return He.encrypt(e,t||De)||e}function E(e,t){return He.decrypt(e,t||De)||He.decrypt(e,De)||e}function O(){return clearTimeout(Ee),!Te||Te>=500||1>Te||!d(ke,!0).length&&!y(xe,!0).length?void(Pe=!1):(Pe=!0,void ze.presence_heartbeat({callback:function(e){Ee=u(O,Te*K)},error:function(e){Be&&Be("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),Ee=u(O,Te*K)}}))}function T(){!Pe&&O()}function P(e){if(je){if(!he.length)return}else{if(e&&(he.sending=0),he.sending||!he.length)return;he.sending=1}Ce(he.shift())}function j(e){var t=0;return f(y(xe),function(n){var r=xe[n];r&&(t++,(e||function(){})(r))}),t}function R(e){var t=0;return f(d(ke),function(n){var r=ke[n];r&&(t++,(e||function(){})(r))}),t}function C(e,t,n){if("object"==typeof e){if(e.error){var r={};return e.message&&(r.message=e.message),e.payload&&(r.payload=e.payload),void(n&&n(r))}if(e.payload)return void(e.next_page?t&&t(e.payload,e.next_page):t&&t(e.payload))}t&&t(e)}function M(e,t){if("object"==typeof e&&e.error){var n={};return e.message&&(n.message=e.message),e.payload&&(n.payload=e.payload),void(t&&t(n))}t&&t(e)}function B(e,t,n,r){var t=e.callback||t,i=e.error||Be,o=Ne();r=r||{},r.auth||(r.auth=e.auth_key||oe);var s=[fe,"v1","channel-registration","sub-key",ie];s.push.apply(s,n),o&&(r.callback=o),Ce({callback:o,data:b(r),success:function(e){C(e,t,i)},fail:function(e){M(e,i)},url:s})}function A(){Ae()||U(1,{error:"Offline. Please check your network settings. "}),Q&&clearTimeout(Q),Q=u(A,K)}function N(){te&&ze.time(function(e){z(function(){},e),e||U(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),Y&&clearTimeout(Y),Y=u(N,ee)})}function U(e,t){be&&be(e,t),be=null,clearTimeout(Q),clearTimeout(Y)}function H(e){var n=t()-ye;return n-e/1e4}function z(e,n){function r(n){if(n){var r=n/1e4,o=(t()-i)/2;ye=t()-(r+o),e&&e(ye)}}var i=t();n&&r(n)||ze.time(r)}var Q,Y,$=+_.windowing||q,Z=(+_.timeout||F)*K,ee=(+_.keepalive||J)*K,te=_.timecheck||0,ne=_.noleave||0,re=_.publish_key,ie=_.subscribe_key,oe=_.auth_key||"",se=_.secret_key||"",ue=_.hmac_SHA256,ae=_.ssl?"s":"",ce="http"+ae+"://"+(_.origin||"pubsub.pubnub.com"),fe=X(ce),le=X(ce),pe=function(){},he=[],de=!0,ye=0,ve=0,_e=0,be=0,me=_.restore||0,ge=0,we=!1,ke={},xe={},Se={},Ee=null,Oe=x(_.heartbeat||_.pnexpires||0,_.error),Te=_.heartbeat_interval||Oe/2-1,Pe=!1,je=_.no_wait_for_pending,Re=_["compatible_3.5"]||!1,Ce=_.xdr,Me=_.params||{},Be=_.error||function(){},Ae=_._is_online||function(){return 1},Ne=_.jsonp_cb||function(){return 0},Le=_.db||{get:function(){},set:function(){}},De=_.cipher_key,Ie=_.uuid||!_.unique_uuid&&Le&&Le.get(ie+"uuid")||"",qe=_.instance_id||!1,Ue="",Fe=_.shutdown,Je="undefined"!=typeof _.use_send_beacon?_.use_send_beacon:!0,Ke=Je?_.sendBeacon:null;2===Oe&&(Te=1);var He=_.crypto_obj||{encrypt:function(e,t){return e},decrypt:function(e,t){return e}},ze={LEAVE:function(e,t,n,i,o){var s,u,a={uuid:Ie,auth:n||oe},c=X(ce),i=i||function(){},f=o||function(){},l=Ne();if(e.indexOf(I)>0)return!0;if(Re){if(!ae)return!1;if("0"==l)return!1}return ne?!1:("0"!=l&&(a.callback=l),qe&&(a.instanceid=Ue),s=[c,"v2","presence","sub_key",ie,"channel",h(e),"leave"],u=b(a),Ke&&(url_string=r(s,u),Ke(url_string))?(i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0):(Ce({blocking:t||ae,timeout:2e3,callback:l,data:u,success:function(e){C(e,i,f)},fail:function(e){M(e,f)},url:s}),!0))},LEAVE_GROUP:function(e,t,n,i,o){var s,u,a={uuid:Ie,auth:n||oe},c=X(ce),i=i||function(){},f=o||function(){},l=Ne();if(e.indexOf(I)>0)return!0;if(Re){if(!ae)return!1;if("0"==l)return!1}return ne?!1:("0"!=l&&(a.callback=l),e&&e.length>0&&(a["channel-group"]=e),qe&&(a.instanceid=Ue),s=[c,"v2","presence","sub_key",ie,"channel",h(","),"leave"],u=b(a),Ke&&(url_string=r(s,u),Ke(url_string))?(i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0):(Ce({blocking:t||ae,timeout:5e3,callback:l,data:u,success:function(e){C(e,i,f)},fail:function(e){M(e,f)},url:s}),!0))},set_resumed:function(e){we=e},get_cipher_key:function(){return De},set_cipher_key:function(e){De=e},raw_encrypt:function(e,t){return S(e,t)},raw_decrypt:function(e,t){return E(e,t)},get_heartbeat:function(){return Oe},set_heartbeat:function(e,t){Oe=x(e,Oe,Be),Te=t||Oe/2-1,2==Oe&&(Te=1),pe(),O()},get_heartbeat_interval:function(){return Te},set_heartbeat_interval:function(e){Te=e,O()},get_version:function(){return W},getGcmMessageObject:function(e){return{data:e}},getApnsMessageObject:function(e){
var t={aps:{badge:1,alert:""}};for(k in e)k[t]=e[k];return t},newPnMessage:function(){var e={};gcm&&(e.pn_gcm=gcm),apns&&(e.pn_apns=apns);for(k in n)e[k]=n[k];return e},_add_param:function(e,t){Me[e]=t},channel_group:function(e,t){var n,r,i=e.channel_group,t=t||e.callback,o=e.channels||e.channel,s=e.cloak,u=[],a={},f=e.mode||"add";if(i){var l=i.split(":");l.length>1?(n="*"===l[0]?null:l[0],r=l[1]):r=l[0]}n&&u.push("namespace")&&u.push(h(n)),u.push("channel-group"),r&&"*"!==r&&u.push(r),o?(c(o)&&(o=o.join(",")),a[f]=o,a.cloak=de?"true":"false"):"remove"===f&&u.push("remove"),"undefined"!=typeof s&&(a.cloak=s?"true":"false"),B(e,t,u,a)},channel_group_list_groups:function(e,t){var n;n=e.namespace||e.ns||e.channel_group||null,n&&(e.channel_group=n+":*"),ze.channel_group(e,t)},channel_group_list_channels:function(e,t){return e.channel_group?void ze.channel_group(e,t):Be("Missing Channel Group")},channel_group_remove_channel:function(e,t){return e.channel_group?e.channel||e.channels?(e.mode="remove",void ze.channel_group(e,t)):Be("Missing Channel"):Be("Missing Channel Group")},channel_group_remove_group:function(e,t){return e.channel_group?e.channel?Be("Use channel_group_remove_channel if you want to remove a channel from a group."):(e.mode="remove",void ze.channel_group(e,t)):Be("Missing Channel Group")},channel_group_add_channel:function(e,t){return e.channel_group?e.channel||e.channels?void ze.channel_group(e,t):Be("Missing Channel"):Be("Missing Channel Group")},channel_group_cloak:function(e,t){return"undefined"==typeof e.cloak?void t(de):(de=e.cloak,void ze.channel_group(e,t))},channel_group_list_namespaces:function(e,t){var n=["namespace"];B(e,t,n)},channel_group_remove_namespace:function(e,t){var n=["namespace",e.namespace,"remove"];B(e,t,n)},history:function(e,t){var t=e.callback||t,n=e.count||e.limit||100,r=e.reverse||"false",i=e.error||function(){},o=e.auth_key||oe,s=e.cipher_key,u=e.channel,a=e.channel_group,c=e.start,f=e.end,l=e.include_token,p=e.string_message_token||!1,d={},y=Ne();return u||a?t?ie?(d.stringtoken="true",d.count=n,d.reverse=r,d.auth=o,a&&(d["channel-group"]=a,u||(u=",")),y&&(d.callback=y),c&&(d.start=c),f&&(d.end=f),l&&(d.include_token="true"),p&&(d.string_message_token="true"),void Ce({callback:y,data:b(d),success:function(e){if("object"==typeof e&&e.error)return void i({message:e.message,payload:e.payload});for(var n=e[0],r=[],o=0;o<n.length;o++)if(l){var u=E(n[o].message,s),a=n[o].timetoken;try{r.push({message:JSON.parse(u),timetoken:a})}catch(c){r.push({message:u,timetoken:a})}}else{var u=E(n[o],s);try{r.push(JSON.parse(u))}catch(c){r.push(u)}}t([r,e[1],e[2]])},fail:function(e){M(e,i)},url:[fe,"v2","history","sub-key",ie,"channel",h(u)]})):Be("Missing Subscribe Key"):Be("Missing Callback"):Be("Missing Channel")},replay:function(e,t){var n,t=t||e.callback||function(){},r=e.auth_key||oe,i=e.source,o=e.destination,s=e.stop,u=e.start,a=e.end,c=e.reverse,f=e.limit,l=Ne(),p={};return i?o?re?ie?("0"!=l&&(p.callback=l),s&&(p.stop="all"),c&&(p.reverse="true"),u&&(p.start=u),a&&(p.end=a),f&&(p.count=f),p.auth=r,n=[fe,"v1","replay",re,ie,i,o],void Ce({callback:l,success:function(e){C(e,t,err)},fail:function(){t([0,"Disconnected"])},url:n,data:b(p)})):Be("Missing Subscribe Key"):Be("Missing Publish Key"):Be("Missing Destination Channel"):Be("Missing Source Channel")},auth:function(e){oe=e,pe()},time:function(e){var t=Ne(),n={uuid:Ie,auth:oe};qe&&(n.instanceid=Ue),Ce({callback:t,data:b(n),timeout:5*K,url:[fe,"time",t],success:function(t){e(t[0])},fail:function(){e(0)}})},publish:function(e,t){var n=e.message;if(!n)return Be("Missing Message");var r,i,t=t||e.callback||n.callback||function(){},o=e.channel||n.channel,s=e.auth_key||oe,u=e.cipher_key,a=e.error||n.error||function(){},c=e.post||!1,f="store_in_history"in e?e.store_in_history:!0,l=Ne(),p="push";return e.prepend&&(p="unshift"),o?re?ie?(n.getPubnubMessage&&(n=n.getPubnubMessage()),n=JSON.stringify(S(n,u)),i=[fe,"publish",re,ie,0,h(o),l,h(n)],r={uuid:Ie,auth:s},f||(r.store="0"),qe&&(r.instanceid=Ue),he[p]({callback:l,timeout:5*K,url:i,data:b(r),fail:function(e){M(e,a),P(1)},success:function(e){C(e,t,a),P(1)},mode:c?"POST":"GET"}),void P()):Be("Missing Subscribe Key"):Be("Missing Publish Key"):Be("Missing Channel")},unsubscribe:function(e,t){var n=e.channel,r=e.channel_group,i=e.auth_key||oe,t=t||e.callback||function(){},o=e.error||function(){};if(ge=0,me=1,n){var s=l((n.join?n.join(","):""+n).split(","),function(e){return ke[e]?e:void 0}).join(",");n=l((n.join?n.join(","):""+n).split(","),function(e){return ke[e]?e+","+e+I:void 0}).join(","),f(n.split(","),function(e){e&&(ke[e]=0,e in Se&&delete Se[e])});var u=!0;L&&(u=ze.LEAVE(s,0,i,t,o)),u||t({action:"leave"})}if(r){var a=l((r.join?r.join(","):""+r).split(","),function(e){return xe[e]?e:void 0}).join(",");r=l((r.join?r.join(","):""+r).split(","),function(e){return xe[e]?e+","+e+I:void 0}).join(","),f(r.split(","),function(e){e&&(xe[e]=0,e in Se&&delete Se[e])});var u=!0;L&&(u=ze.LEAVE_GROUP(a,0,i,t,o)),u||t({action:"leave"})}pe()},subscribe:function(e,n){function r(e){e?u(pe,S):(fe=X(ce,1),le=X(ce,1),u(function(){ze.time(r)},K)),R(function(t){return e&&t.disconnected?(t.disconnected=0,t.reconnect(t.name)):void(e||t.disconnected||(t.disconnected=1,t.disconnect(t.name)))}),j(function(t){return e&&t.disconnected?(t.disconnected=0,t.reconnect(t.name)):void(e||t.disconnected||(t.disconnected=1,t.disconnect(t.name)))})}function i(){var e=Ne(),t=d(ke).join(","),n=y(xe).join(",");if(t||n){t||(t=","),U();var o=b({uuid:Ie,auth:oe});n&&(o["channel-group"]=n);var s=JSON.stringify(Se);s.length>2&&(o.state=JSON.stringify(Se)),Oe&&(o.heartbeat=Oe),qe&&(o.instanceid=Ue),T(),be=Ce({timeout:x,callback:e,fail:function(e){e&&e.error&&e.service?(M(e,v),r(1)):ze.time(function(t){!t&&M(e,v),r(t)})},data:b(o),url:[le,"subscribe",ie,h(t),e,ge],success:function(e){if(!e||"object"==typeof e&&"error"in e&&e.error)return v(e.error),u(pe,K);if(_(e[1]),ge=!ge&&me&&Le.get(ie)||e[1],R(function(e){e.connected||(e.connected=1,e.connect(e.name))}),j(function(e){e.connected||(e.connected=1,e.connect(e.name))}),we&&!me)return ge=0,we=!1,Le.set(ie,0),void u(i,S);w&&(ge=1e4,w=0),Le.set(ie,e[1]);var t=function(){var t="",n="";e.length>3?(t=e[3],n=e[2]):t=e.length>2?e[2]:l(d(ke),function(t){return l(Array(e[0].length).join(",").split(","),function(){return t})}).join(",");var r=t.split(","),i=n?n.split(","):[];return function(){var e=r.shift()||_e,t=i.shift(),n={};t?(e&&e.indexOf("-pnpres")>=0&&t.indexOf("-pnpres")<0&&(t+="-pnpres"),n=xe[t]||ke[t]||{callback:function(){}}):n=ke[e];var o=[n.callback||ve,e.split(I)[0]];return t&&o.push(t.split(I)[0]),o}}(),n=H(+e[1]);f(e[0],function(r){var i=t(),o=E(r,ke[i[1]]?ke[i[1]].cipher_key:null);i[0]&&i[0](o,e,i[2]||i[1],n,i[1])}),u(i,S)}})}}var o=e.channel,s=e.channel_group,n=n||e.callback,n=n||e.message,a=e.connect||function(){},c=e.reconnect||function(){},p=e.disconnect||function(){},v=e.error||v||function(){},_=e.idle||function(){},m=e.presence||0,g=e.noheresync||0,w=e.backfill||0,k=e.timetoken||0,x=e.timeout||Z,S=e.windowing||$,O=e.state,P=e.heartbeat||e.pnexpires,C=e.heartbeat_interval,B=e.restore||me;return oe=e.auth_key||oe,me=B,ge=k,o||s?n?ie?((P||0===P||C||0===C)&&ze.set_heartbeat(P,C),o&&f((o.join?o.join(","):""+o).split(","),function(r){var i=ke[r]||{};ke[_e=r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:ve=n,cipher_key:e.cipher_key,connect:a,disconnect:p,reconnect:c},O&&(r in O?Se[r]=O[r]:Se[r]=O),m&&(ze.subscribe({channel:r+I,callback:m,restore:B}),i.subscribed||g||ze.here_now({channel:r,data:b({uuid:Ie,auth:oe}),callback:function(e){f("uuids"in e?e.uuids:[],function(n){m({action:"join",uuid:n,timestamp:Math.floor(t()/1e3),occupancy:e.occupancy||1},e,r)})}}))}),s&&f((s.join?s.join(","):""+s).split(","),function(r){var i=xe[r]||{};xe[r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:ve=n,cipher_key:e.cipher_key,connect:a,disconnect:p,reconnect:c},m&&(ze.subscribe({channel_group:r+I,callback:m,restore:B,auth_key:oe}),i.subscribed||g||ze.here_now({channel_group:r,data:b({uuid:Ie,auth:oe}),callback:function(e){f("uuids"in e?e.uuids:[],function(n){m({action:"join",uuid:n,timestamp:Math.floor(t()/1e3),occupancy:e.occupancy||1},e,r)})}}))}),pe=function(){U(),u(i,S)},L?void pe():D.push(pe)):Be("Missing Subscribe Key"):Be("Missing Callback"):Be("Missing Channel")},here_now:function(e,t){var t=e.callback||t,n=e.debug,r=e.error||function(){},i=e.auth_key||oe,o=e.channel,s=e.channel_group,u=Ne(),a="uuids"in e?e.uuids:!0,c=e.state,f={uuid:Ie,auth:i};if(a||(f.disable_uuids=1),c&&(f.state=1),!t)return Be("Missing Callback");if(!ie)return Be("Missing Subscribe Key");var l=[fe,"v2","presence","sub_key",ie];o&&l.push("channel")&&l.push(h(o)),"0"!=u&&(f.callback=u),s&&(f["channel-group"]=s,!o&&l.push("channel")&&l.push(",")),qe&&(f.instanceid=Ue),Ce({callback:u,data:b(f),success:function(e){C(e,t,r)},fail:function(e){M(e,r)},debug:n,url:l})},where_now:function(e,t){var t=e.callback||t,n=e.error||function(){},r=e.auth_key||oe,i=Ne(),o=e.uuid||Ie,s={auth:r};return t?ie?("0"!=i&&(s.callback=i),qe&&(s.instanceid=Ue),void Ce({callback:i,data:b(s),success:function(e){C(e,t,n)},fail:function(e){M(e,n)},url:[fe,"v2","presence","sub_key",ie,"uuid",h(o)]})):Be("Missing Subscribe Key"):Be("Missing Callback")},state:function(e,t){var n,t=e.callback||t||function(e){},r=e.error||function(){},i=e.auth_key||oe,o=Ne(),s=e.state,u=e.uuid||Ie,a=e.channel,c=e.channel_group,f=b({auth:i});return ie?u?a||c?("0"!=o&&(f.callback=o),"undefined"!=typeof a&&ke[a]&&ke[a].subscribed&&s&&(Se[a]=s),"undefined"!=typeof c&&xe[c]&&xe[c].subscribed&&(s&&(Se[c]=s),f["channel-group"]=c,a||(a=",")),f.state=JSON.stringify(s),qe&&(f.instanceid=Ue),n=s?[fe,"v2","presence","sub-key",ie,"channel",a,"uuid",u,"data"]:[fe,"v2","presence","sub-key",ie,"channel",a,"uuid",h(u)],void Ce({callback:o,data:b(f),success:function(e){C(e,t,r)},fail:function(e){M(e,r)},url:n})):Be("Missing Channel"):Be("Missing UUID"):Be("Missing Subscribe Key")},grant:function(e,t){var t=e.callback||t,n=e.error||function(){},r=e.channel||e.channels,i=e.channel_group,o=Ne(),s=e.ttl,u=e.read?"1":"0",a=e.write?"1":"0",f=e.manage?"1":"0",l=e.auth_key||e.auth_keys;if(!t)return Be("Missing Callback");if(!ie)return Be("Missing Subscribe Key");if(!re)return Be("Missing Publish Key");if(!se)return Be("Missing Secret Key");var p=Math.floor((new Date).getTime()/1e3),h=ie+"\n"+re+"\ngrant\n",d={w:a,r:u,timestamp:p};e.manage&&(d.m=f),c(r)&&(r=r.join(",")),c(l)&&(l=l.join(",")),"undefined"!=typeof r&&null!=r&&r.length>0&&(d.channel=r),"undefined"!=typeof i&&null!=i&&i.length>0&&(d["channel-group"]=i),"0"!=o&&(d.callback=o),(s||0===s)&&(d.ttl=s),l&&(d.auth=l),d=b(d),l||delete d.auth,h+=w(d);var y=ue(h,se);y=y.replace(/\+/g,"-"),y=y.replace(/\//g,"_"),d.signature=y,Ce({callback:o,data:d,success:function(e){C(e,t,n)},fail:function(e){M(e,n)},url:[fe,"v1","auth","grant","sub-key",ie]})},mobile_gw_provision:function(e){var t,n,r=e.callback||function(){},i=e.auth_key||oe,o=e.error||function(){},s=Ne(),u=e.channel,a=e.op,c=e.gw_type,f=e.device_id;return f?c?a?u?re?ie?(n=[fe,"v1/push/sub-key",ie,"devices",f],t={uuid:Ie,auth:i,type:c},"add"==a?t.add=u:"remove"==a&&(t.remove=u),qe&&(data.instanceid=Ue),void Ce({callback:s,data:t,success:function(e){C(e,r,o)},fail:function(e){M(e,o)},url:n})):Be("Missing Subscribe Key"):Be("Missing Publish Key"):Be("Missing gw destination Channel (channel)"):Be("Missing GW Operation (op: add or remove)"):Be("Missing GW Type (gw_type: gcm or apns)"):Be("Missing Device ID (device_id)")},audit:function(e,t){var t=e.callback||t,n=e.error||function(){},r=e.channel,i=e.channel_group,o=e.auth_key,s=Ne();if(!t)return Be("Missing Callback");if(!ie)return Be("Missing Subscribe Key");if(!re)return Be("Missing Publish Key");if(!se)return Be("Missing Secret Key");var u=Math.floor((new Date).getTime()/1e3),a=ie+"\n"+re+"\naudit\n",c={timestamp:u};"0"!=s&&(c.callback=s),"undefined"!=typeof r&&null!=r&&r.length>0&&(c.channel=r),"undefined"!=typeof i&&null!=i&&i.length>0&&(c["channel-group"]=i),o&&(c.auth=o),c=b(c),o||delete c.auth,a+=w(c);var f=ue(a,se);f=f.replace(/\+/g,"-"),f=f.replace(/\//g,"_"),c.signature=f,Ce({callback:s,data:c,success:function(e){C(e,t,n)},fail:function(e){M(e,n)},url:[fe,"v1","auth","audit","sub-key",ie]})},revoke:function(e,t){e.read=!1,e.write=!1,ze.grant(e,t)},set_uuid:function(e){Ie=e,pe()},get_uuid:function(){return Ie},isArray:function(e){return c(e)},get_subscibed_channels:function(){return d(ke,!0)},presence_heartbeat:function(e){var t=e.callback||function(){},n=e.error||function(){},r=Ne(),i={uuid:Ie,auth:oe},o=JSON.stringify(Se);o.length>2&&(i.state=JSON.stringify(Se)),Oe>0&&320>Oe&&(i.heartbeat=Oe),"0"!=r&&(i.callback=r);var s=h(d(ke,!0).join(",")),u=y(xe,!0).join(",");s||(s=","),u&&(i["channel-group"]=u),qe&&(i.instanceid=Ue),Ce({callback:r,data:b(i),timeout:5*K,url:[fe,"v2","presence","sub-key",ie,"channel",s,"heartbeat"],success:function(e){C(e,t,n)},fail:function(e){M(e,n)}})},stop_timers:function(){clearTimeout(Q),clearTimeout(Y),clearTimeout(Ee)},shutdown:function(){ze.stop_timers(),Fe&&Fe()},xdr:Ce,ready:v,db:Le,uuid:a,map:l,each:f,"each-channel":R,grep:o,offline:function(){U(1,{message:"Offline. Please check your network settings."})},supplant:s,now:t,unique:e,updater:i};return Ie||(Ie=ze.uuid()),Ue||(Ue=ze.uuid()),Le.set(ie+"uuid",Ie),Q=u(A,K),Y=u(N,ee),Ee=u(T,(Te-3)*K),z(),ze}function b(){function e(e){return CryptoJS.SHA256(e).toString(CryptoJS.enc.Hex)}function t(e){return e=e||{},e.hasOwnProperty("encryptKey")||(e.encryptKey=f.encryptKey),e.hasOwnProperty("keyEncoding")||(e.keyEncoding=f.keyEncoding),e.hasOwnProperty("keyLength")||(e.keyLength=f.keyLength),e.hasOwnProperty("mode")||(e.mode=f.mode),-1==u.indexOf(e.keyEncoding.toLowerCase())&&(e.keyEncoding=f.keyEncoding),-1==a.indexOf(parseInt(e.keyLength,10))&&(e.keyLength=f.keyLength),-1==c.indexOf(e.mode.toLowerCase())&&(e.mode=f.mode),e}function n(e,t){return"base64"==t.keyEncoding?CryptoJS.enc.Base64.parse(e):"hex"==t.keyEncoding?CryptoJS.enc.Hex.parse(e):e}function r(t,r){return t=n(t,r),r.encryptKey?CryptoJS.enc.Utf8.parse(e(t).slice(0,32)):t}function i(e){return"ecb"==e.mode?CryptoJS.mode.ECB:CryptoJS.mode.CBC}function o(e){return"cbc"==e.mode?CryptoJS.enc.Utf8.parse(s):null}var s="0123456789012345",u=["hex","utf8","base64","binary"],a=[128,256],c=["ecb","cbc"],f={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"};return{encrypt:function(e,n,s){if(!n)return e;s=t(s);var u=o(s),a=i(s),c=r(n,s),f=JSON.stringify(e),l=CryptoJS.AES.encrypt(f,c,{iv:u,mode:a}).ciphertext,p=l.toString(CryptoJS.enc.Base64);return p||e},decrypt:function(e,n,s){if(!n)return e;s=t(s);var u=o(s),a=i(s),c=r(n,s);try{var f=CryptoJS.enc.Base64.parse(e),l=CryptoJS.AES.decrypt({ciphertext:f},c,{iv:u,mode:a}).toString(CryptoJS.enc.Utf8),p=JSON.parse(l);return p}catch(h){return}}}}function m(e,t){var n=CryptoJS.HmacSHA256(e,t);return n.toString(CryptoJS.enc.Base64)}function g(e){return document.getElementById(e)}function w(e){console.error(e)}function x(e,t){var n=[];return f(e.split(/\s+/),function(e){f((t||document).getElementsByTagName(e),function(e){n.push(e)})}),n}function S(e,t,n){f(e.split(","),function(e){var r=function(e){e||(e=window.event),n(e)||(e.cancelBubble=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())};t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent?t.attachEvent("on"+e,r):t["on"+e]=r})}function E(){return x("head")[0]}function O(e,t,n){return n?void e.setAttribute(t,n):e&&e.getAttribute&&e.getAttribute(t)}function T(e,t){for(var n in t)if(t.hasOwnProperty(n))try{e.style[n]=t[n]+("|width|height|top|left|".indexOf(n)>0&&"number"==typeof t[n]?"px":"")}catch(r){}}function P(e){return document.createElement(e)}function j(){return te||A()?0:e()}function R(t){if(te||A())return C(t);var n=P("script"),i=t.callback,o=e(),s=0,a=t.timeout||U,c=u(function(){d(1,{message:"timeout"})},a),f=t.fail||function(){},l=t.data||{},p=t.success||function(){},h=function(){E().appendChild(n)},d=function(e,t){s||(s=1,n.onerror=null,clearTimeout(c),e||!t||p(t),u(function(){e&&f();var t=g(o),n=t&&t.parentNode;n&&n.removeChild(t)},K))};return window[i]=function(e){d(0,e)},t.blocking||(n[$]=$),n.onerror=function(){d(1)},n.src=r(t.url,l),O(n,"id",o),h(),d}function C(e){var t,n,i=function(){if(!s){s=1,clearTimeout(c);try{n=JSON.parse(t.responseText)}catch(e){return d(1)}o=1,p(n)}},o=0,s=0,a=e.timeout||U,c=u(function(){d(1,{message:"timeout"})},a),f=e.fail||function(){},l=e.data||{},p=e.success||function(){},h=!e.blocking,d=function(e,n){o||(o=1,clearTimeout(c),t&&(t.onerror=t.onload=null,t.abort&&t.abort(),t=null),e&&f(n))};try{t=A()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest,t.onerror=t.onabort=function(e){d(1,e||t&&t.responseText||{error:"Network Connection Error"})},t.onload=t.onloadend=i,t.onreadystatechange=function(){if(t&&4==t.readyState)switch(t.status){case 200:break;default:try{n=JSON.parse(t.responseText),d(1,n)}catch(e){return d(1,{status:t.status,payload:null,message:t.responseText})}return}};var y=r(e.url,l);t.open("GET",y,h),h&&(t.timeout=a),t.send()}catch(v){return d(0),te=0,R(e)}return d}function M(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(e){return!0}}function B(e){return"sendBeacon"in navigator?navigator.sendBeacon(e):!1}function A(){if(!ue||!ue.get)return 0;var e={id:A.id++,send:function(){},abort:function(){e.id={}},open:function(t,n){A[e.id]=e,ue.get(e.id,n)}};return e}var N=1,L=!1,D=[],I="-pnpres",q=10,U=1e4,F=310,J=60,K=1e3,H="/",z="&",G=5,V=30,W="3.7.16",Q=/{([\w\-]+)}/g,X=function(){var e=20,t=Math.floor(Math.random()*e);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?a().split("-")[0]:++t<e?t:t=1))||n}}(),Y="https://pubnub.a.ssl.fastly.net/pubnub.swf",$="async",Z=navigator.userAgent,ee="PubNub-JS-Web/3.7.16",te=-1==Z.indexOf("MSIE 6");window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||function(){});var ne=function(){var e={},t=!1;try{t=window.localStorage}catch(n){}var r=function(e){return-1==document.cookie.indexOf(e)?null:((document.cookie||"").match(RegExp(e+"=([^;]+)"))||[])[1]||null},i=function(e,t){document.cookie=e+"="+t+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"},o=function(){try{return i("pnctest","1"),"1"===r("pnctest")}catch(e){return!1}}();return{get:function(n){try{return t?t.getItem(n):o?r(n):e[n]}catch(i){return e[n]}},set:function(n,r){try{if(t)return t.setItem(n,r)&&0;o&&i(n,r),e[n]=r}catch(s){e[n]=r}}}}(),re={list:{},unbind:function(e){re.list[e]=[]},bind:function(e,t){(re.list[e]=re.list[e]||[]).push(t)},fire:function(e,t){f(re.list[e]||[],function(e){e(t)})}},ie=g("pubnub")||0,oe=function(e){te=e.jsonp?0:-1==Z.indexOf("MSIE 6");var t=e.subscribe_key||"",n=((+e.keepalive||J)*K,e.uuid||ne.get(t+"uuid")||"",e.leave_on_unload||0);e.xdr=R,e.db=ne,e.error=e.error||w,e._is_online=M,e.jsonp_cb=j,e.hmac_SHA256=m,e.crypto_obj=b(),e.sendBeacon=B,e.params={pnsdk:ee};var r=function(e){return oe(e)},i=_(e);for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o]);return r.css=T,r.$=g,r.create=P,r.bind=S,r.head=E,r.search=x,r.attr=O,r.events=re,r.init=r,r.secure=r,r.crypto_obj=b(),S("beforeunload",window,function(){return n&&r["each-channel"](function(e){r.LEAVE(e.name,0)}),!0}),e.notest?r:(S("offline",window,r.offline),S("offline",document,r.offline),r)};oe.init=oe,oe.secure=oe,oe.crypto_obj=b(),"complete"===document.readyState?u(v,0):S("load",window,function(){u(v,0)});var se=ie||{};PUBNUB=oe({notest:1,publish_key:O(se,"pub-key"),subscribe_key:O(se,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==O(se,"ssl"),origin:O(se,"origin"),uuid:O(se,"uuid")}),window.jQuery&&(window.jQuery.PUBNUB=oe),"undefined"!=typeof module&&(module.exports=PUBNUB)&&v();var ue=g("pubnubs")||0;ie&&(T(ie,{position:"absolute",top:-K}),("opera"in window||O(ie,"flash"))&&(ie.innerHTML="<object id=pubnubs data="+Y+"><param name=movie value="+Y+"><param name=allowscriptaccess value=always></object>"),PUBNUB.rdx=function(e,t){return t?(A[e].responseText=unescape(t),void A[e].onload()):A[e].onerror()},A.id=K)}(),function(){var e=PUBNUB.ws=function(t,n){if(!(this instanceof e))return new e(t,n);var r=this,t=r.url=t||"",i=(r.protocol=n||"Sec-WebSocket-Protocol",t.split("/")),o={ssl:"wss:"===i[0],origin:i[2],publish_key:i[3],subscribe_key:i[4],channel:i[5]};return r.CONNECTING=0,r.OPEN=1,r.CLOSING=2,r.CLOSED=3,r.CLOSE_NORMAL=1e3,r.CLOSE_GOING_AWAY=1001,r.CLOSE_PROTOCOL_ERROR=1002,r.CLOSE_UNSUPPORTED=1003,r.CLOSE_TOO_LARGE=1004,r.CLOSE_NO_STATUS=1005,r.CLOSE_ABNORMAL=1006,r.onclose=r.onerror=r.onmessage=r.onopen=r.onsend=function(){},r.binaryType="",r.extensions="",r.bufferedAmount=0,r.trasnmitting=!1,r.buffer=[],r.readyState=r.CONNECTING,t?(r.pubnub=PUBNUB.init(o),r.pubnub.setup=o,r.setup=o,void r.pubnub.subscribe({restore:!1,channel:o.channel,disconnect:r.onerror,reconnect:r.onopen,error:function(){r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(e){r.onmessage({data:e})},connect:function(){r.readyState=r.OPEN,r.onopen()}})):(r.readyState=r.CLOSED,r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),r)};e.prototype.send=function(e){var t=this;t.pubnub.publish({channel:t.pubnub.setup.channel,message:e,callback:function(e){t.onsend({data:e})}})},e.prototype.close=function(){var e=this;e.pubnub.unsubscribe({channel:e.pubnub.setup.channel}),e.readyState=e.CLOSED,e.onclose({})}}();var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=function(){},o=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=o.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;e>i;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;e>i;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;t>r;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),u=n.enc={},a=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;e>r;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;t>r;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new s.init(n,t/2)}},c=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;e>r;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;t>r;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new s.init(n,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=i/(4*o),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*o,i=e.min(4*t,i),t){for(var a=0;t>a;a+=o)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=i}return new s.init(a,i)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=l.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(e){for(var t=CryptoJS,n=t.lib,r=n.WordArray,i=n.Hasher,n=t.algo,o=[],s=[],u=function(e){return 4294967296*(e-(0|e))|0},a=2,c=0;64>c;){var f;e:{f=a;for(var l=e.sqrt(f),p=2;l>=p;p++)if(!(f%p)){f=!1;break e}f=!0}f&&(8>c&&(o[c]=u(e.pow(a,.5))),s[c]=u(e.pow(a,1/3)),c++),a++}var h=[],n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],u=n[3],a=n[4],c=n[5],f=n[6],l=n[7],p=0;64>p;p++){if(16>p)h[p]=0|e[t+p];else{var d=h[p-15],y=h[p-2];h[p]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[p-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[p-16]}d=l+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&f)+s[p]+h[p],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&o^i&o),l=f,f=c,c=a,a=u+d|0,u=o,o=i,i=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+f|0,n[7]=n[7]+l|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=e.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(n),t.HmacSHA256=i._createHmacHelper(n)}(Math),function(){var e=CryptoJS,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),s=this._iKey=n.clone(),u=o.words,a=s.words,c=0;r>c;c++)u[c]^=1549556828,a[c]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;n>i;i+=3)for(var o=(t[i>>>2]>>>24-8*(i%4)&255)<<16|(t[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|t[i+2>>>2]>>>24-8*((i+2)%4)&255,s=0;4>s&&n>i+.75*s;s++)e.push(r.charAt(o>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,i=r.charAt(64);i&&(i=e.indexOf(i),-1!=i&&(n=i));for(var i=[],o=0,s=0;n>s;s++)if(s%4){var u=r.indexOf(e.charAt(s-1))<<2*(s%4),a=r.indexOf(e.charAt(s))>>>6-2*(s%4);i[o>>>2]|=(u|a)<<24-8*(o%4),o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,i,o,s){return e=e+(t&n|~t&r)+i+s,(e<<o|e>>>32-o)+t}function n(e,t,n,r,i,o,s){return e=e+(t&r|n&~r)+i+s,(e<<o|e>>>32-o)+t}function r(e,t,n,r,i,o,s){return e=e+(t^n^r)+i+s,(e<<o|e>>>32-o)+t}function i(e,t,n,r,i,o,s){return e=e+(n^(t|~r))+i+s,(e<<o|e>>>32-o)+t}for(var o=CryptoJS,s=o.lib,u=s.WordArray,a=s.Hasher,s=o.algo,c=[],f=0;64>f;f++)c[f]=4294967296*e.abs(e.sin(f+1))|0;s=s.MD5=a.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,o){for(var s=0;16>s;s++){var u=o+s,a=e[u];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var s=this._hash.words,u=e[o+0],a=e[o+1],f=e[o+2],l=e[o+3],p=e[o+4],h=e[o+5],d=e[o+6],y=e[o+7],v=e[o+8],_=e[o+9],b=e[o+10],m=e[o+11],g=e[o+12],w=e[o+13],k=e[o+14],x=e[o+15],S=s[0],E=s[1],O=s[2],T=s[3],S=t(S,E,O,T,u,7,c[0]),T=t(T,S,E,O,a,12,c[1]),O=t(O,T,S,E,f,17,c[2]),E=t(E,O,T,S,l,22,c[3]),S=t(S,E,O,T,p,7,c[4]),T=t(T,S,E,O,h,12,c[5]),O=t(O,T,S,E,d,17,c[6]),E=t(E,O,T,S,y,22,c[7]),S=t(S,E,O,T,v,7,c[8]),T=t(T,S,E,O,_,12,c[9]),O=t(O,T,S,E,b,17,c[10]),E=t(E,O,T,S,m,22,c[11]),S=t(S,E,O,T,g,7,c[12]),T=t(T,S,E,O,w,12,c[13]),O=t(O,T,S,E,k,17,c[14]),E=t(E,O,T,S,x,22,c[15]),S=n(S,E,O,T,a,5,c[16]),T=n(T,S,E,O,d,9,c[17]),O=n(O,T,S,E,m,14,c[18]),E=n(E,O,T,S,u,20,c[19]),S=n(S,E,O,T,h,5,c[20]),T=n(T,S,E,O,b,9,c[21]),O=n(O,T,S,E,x,14,c[22]),E=n(E,O,T,S,p,20,c[23]),S=n(S,E,O,T,_,5,c[24]),T=n(T,S,E,O,k,9,c[25]),O=n(O,T,S,E,l,14,c[26]),E=n(E,O,T,S,v,20,c[27]),S=n(S,E,O,T,w,5,c[28]),T=n(T,S,E,O,f,9,c[29]),O=n(O,T,S,E,y,14,c[30]),E=n(E,O,T,S,g,20,c[31]),S=r(S,E,O,T,h,4,c[32]),T=r(T,S,E,O,v,11,c[33]),O=r(O,T,S,E,m,16,c[34]),E=r(E,O,T,S,k,23,c[35]),S=r(S,E,O,T,a,4,c[36]),T=r(T,S,E,O,p,11,c[37]),O=r(O,T,S,E,y,16,c[38]),E=r(E,O,T,S,b,23,c[39]),S=r(S,E,O,T,w,4,c[40]),T=r(T,S,E,O,u,11,c[41]),O=r(O,T,S,E,l,16,c[42]),E=r(E,O,T,S,d,23,c[43]),S=r(S,E,O,T,_,4,c[44]),T=r(T,S,E,O,g,11,c[45]),O=r(O,T,S,E,x,16,c[46]),E=r(E,O,T,S,f,23,c[47]),S=i(S,E,O,T,u,6,c[48]),T=i(T,S,E,O,y,10,c[49]),O=i(O,T,S,E,k,15,c[50]),E=i(E,O,T,S,h,21,c[51]),S=i(S,E,O,T,g,6,c[52]),T=i(T,S,E,O,l,10,c[53]),O=i(O,T,S,E,b,15,c[54]),E=i(E,O,T,S,a,21,c[55]),S=i(S,E,O,T,v,6,c[56]),T=i(T,S,E,O,x,10,c[57]),O=i(O,T,S,E,d,15,c[58]),E=i(E,O,T,S,w,21,c[59]),S=i(S,E,O,T,p,6,c[60]),T=i(T,S,E,O,m,10,c[61]),O=i(O,T,S,E,f,15,c[62]),E=i(E,O,T,S,_,21,c[63]);s[0]=s[0]+S|0,s[1]=s[1]+E|0,s[2]=s[2]+O|0,s[3]=s[3]+T|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296);for(n[(i+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[(i+64>>>9<<4)+14]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=a._createHelper(s),o.HmacMD5=a._createHmacHelper(s)}(Math),function(){var e=CryptoJS,t=e.lib,n=t.Base,r=t.WordArray,t=e.algo,i=t.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=n.hasher.create(),o=r.create(),s=o.words,u=n.keySize,n=n.iterations;s.length<u;){a&&i.update(a);var a=i.update(e).finalize(t);i.reset();for(var c=1;n>c;c++)a=i.finalize(a),i.reset();o.concat(a)}return o.sigBytes=4*u,o}});e.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)}}(),CryptoJS.lib.Cipher||function(e){var t=CryptoJS,n=t.lib,r=n.Base,i=n.WordArray,o=n.BufferedBlockAlgorithm,s=t.enc.Base64,u=t.algo.EvpKDF,a=n.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?d:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?d:h).decrypt(e,t,n,r)}}}});n.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=t.mode={},f=function(t,n,r){var i=this._iv;i?this._iv=e:i=this._prevBlock;for(var o=0;r>o;o++)t[n+o]^=i[o]},l=(n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t);
},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;f.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),f.call(this,e,t,r),this._prevBlock=i}}),c=c.CBC=l,l=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,o=[],s=0;n>s;s+=4)o.push(r);n=i.create(o,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},n.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:l}),reset:function(){a.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),c=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(s)},parse:function(e){e=s.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=i.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},h=n.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,p.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=i.random(8)),e=u.create({keySize:t+n}).compute(e,r),n=i.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:r})}},d=n.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=h.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=CryptoJS,t=e.lib.BlockCipher,n=e.algo,r=[],i=[],o=[],s=[],u=[],a=[],c=[],f=[],l=[],p=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;for(var y=0,v=0,d=0;256>d;d++){var _=v^v<<1^v<<2^v<<3^v<<4,_=_>>>8^255&_^99;r[y]=_,i[_]=y;var b=h[y],m=h[b],g=h[m],w=257*h[_]^16843008*_;o[y]=w<<24|w>>>8,s[y]=w<<16|w>>>16,u[y]=w<<8|w>>>24,a[y]=w,w=16843009*g^65537*m^257*b^16843008*y,c[_]=w<<24|w>>>8,f[_]=w<<16|w>>>16,l[_]=w<<8|w>>>24,p[_]=w,y?(y=b^h[h[h[g^b]]],v^=h[h[v]]):y=v=1}var k=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],o=0;e>o;o++)if(n>o)i[o]=t[o];else{var s=i[o-1];o%n?n>6&&4==o%n&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=s<<8|s>>>24,s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=k[o/n|0]<<24),i[o]=i[o-n]^s}for(t=this._invKeySchedule=[],n=0;e>n;n++)o=e-n,s=n%4?i[o]:i[o-4],t[n]=4>n||4>=o?s:c[r[s>>>24]]^f[r[s>>>16&255]]^l[r[s>>>8&255]]^p[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,u,a,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,f,l,p,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,o,s,u){for(var a=this._nRounds,c=e[t]^n[0],f=e[t+1]^n[1],l=e[t+2]^n[2],p=e[t+3]^n[3],h=4,d=1;a>d;d++)var y=r[c>>>24]^i[f>>>16&255]^o[l>>>8&255]^s[255&p]^n[h++],v=r[f>>>24]^i[l>>>16&255]^o[p>>>8&255]^s[255&c]^n[h++],_=r[l>>>24]^i[p>>>16&255]^o[c>>>8&255]^s[255&f]^n[h++],p=r[p>>>24]^i[c>>>16&255]^o[f>>>8&255]^s[255&l]^n[h++],c=y,f=v,l=_;y=(u[c>>>24]<<24|u[f>>>16&255]<<16|u[l>>>8&255]<<8|u[255&p])^n[h++],v=(u[f>>>24]<<24|u[l>>>16&255]<<16|u[p>>>8&255]<<8|u[255&c])^n[h++],_=(u[l>>>24]<<24|u[p>>>16&255]<<16|u[c>>>8&255]<<8|u[255&f])^n[h++],p=(u[p>>>24]<<24|u[c>>>16&255]<<16|u[f>>>8&255]<<8|u[255&l])^n[h++],e[t]=y,e[t+1]=v,e[t+2]=_,e[t+3]=p},keySize:8});e.AES=t._createHelper(n)}(),CryptoJS.mode.ECB=function(){var e=CryptoJS.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}()}).call(exports,__webpack_require__(8)(module))},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t,r){n(this,e),this.setPrefix(r),this._storage=t}return r(e,[{key:"setPrefix",value:function(t){return this._prefix=t||e.defaultPrefix,this}},{key:"setItem",value:function(e,t){return this._storage[this._prefixKey(e)]=JSON.stringify(t),this}},{key:"removeItem",value:function(e){return delete this._storage[this._prefixKey(e)],this}},{key:"getItem",value:function(e){var t=this._storage[this._prefixKey(e)];return t?JSON.parse(t):null}},{key:"clean",value:function(){for(var e in this._storage)this._storage.hasOwnProperty(e)&&0===e.indexOf(this._prefix)&&delete this._storage[e];return this}},{key:"_prefixKey",value:function(e){return this._prefix+e}}]),e}();i.defaultPrefix="rc-",t["default"]=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){n(this,e),this.off()}return r(e,[{key:"hasListeners",value:function(e){return e in this._listeners}},{key:"on",value:function(e,t){var n=this;if("string"==typeof e&&(e=[e]),!e)throw new Error("No events to subscribe to");if("function"!=typeof t)throw new Error("Callback must be a function");return e.forEach(function(e){n.hasListeners(e)||(n._listeners[e]=[]),n._listeners[e].push(t)}),this}},{key:"emit",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;n>i;i++)r[i-1]=arguments[i];var o=null;return this.hasListeners(e)?(this._listeners[e].some(function(e){return o=e.apply(t,r),o===!1}),o):null}},{key:"off",value:function(e,t){var n=this;if(e)if(t){if(!this.hasListeners(e))return this;this._listeners[e].forEach(function(r,i){r===t&&delete n._listeners[e][i]})}else delete this._listeners[e];else this._listeners={};return this}}]),e}();t["default"]=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(3),u=function(){function e(t,n){r(this,e),this._cache=t,this._cacheId=n,this._promise=null}return i(e,[{key:"isPaused",value:function(){var t=this._cache.getItem(this._cacheId);return!!t&&Date.now()-parseInt(t)<e._releaseTimeout}},{key:"pause",value:function(){return this._cache.setItem(this._cacheId,Date.now()),this}},{key:"resume",value:function(){return this._cache.removeItem(this._cacheId),this}},{key:"poll",value:function(){var t=this;return this._promise?this._promise:(this._promise=new o.Promise(function(n,r){(0,s.poll)(function(e){return t.isPaused()?e():(t._promise=null,t.resume(),void n(null))},e._pollInterval)}),this._promise)}}]),e}();u._pollInterval=250,u._releaseTimeout=5e3,t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new c.Promise(function(e,n){function r(i,o){try{var s=t[i](o),u=s.value}catch(a){return void n(a)}s.done?e(u):c.Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var c=n(4),f=n(3),l=n(16),p=n(13),h=r(p),d=n(17),y=r(d),v=function(e){function t(){var e,n,r,i;o(this,t);for(var u=arguments.length,a=Array(u),c=0;u>c;c++)a[c]=arguments[c];return n=r=s(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.events={beforeRequest:"beforeRequest",requestSuccess:"requestSuccess",requestError:"requestError"},i=n,s(r,i)}return u(t,e),a(t,[{key:"sendRequest",value:function(){var e=i(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new y["default"](e),t.prev=1,this.emit(this.events.beforeRequest,n),t.next=5,this._loadResponse(e);case 5:if(n._response=t.sent,!n._isMultipart()&&!n._isJson()){t.next=10;break}return t.next=9,n.response().text();case 9:n._text=t.sent;case 10:if(n.ok()){t.next=12;break}throw new Error("Response has unsuccessful status");case 12:return this.emit(this.events.requestSuccess,n),t.abrupt("return",n);case 16:throw t.prev=16,t.t0=t["catch"](1),t.t0.apiResponse||(t.t0=this.makeError(t.t0,n)),this.emit(this.events.requestError,t.t0),t.t0;case 21:case"end":return t.stop()}},t,this,[[1,16]])}));return function(t){return e.apply(this,arguments)}}()},{key:"_loadResponse",value:function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.fetch.call(null,e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"makeError",value:function(e,t){return e.hasOwnProperty("apiResponse")||e.hasOwnProperty("originalMessage")||(e.apiResponse=t,e.originalMessage=e.message,e.message=t&&t.error(!0)||e.originalMessage),e}},{key:"createRequest",value:function(e){if(e=e||{},e.headers=e.headers||{},!e.url)throw new Error("Url is not defined");if(e.method||(e.method="GET"),e.method&&t._allowedMethods.indexOf(e.method)<0)throw new Error("Method has wrong value: "+e.method);if(e.credentials=e.credentials||"include",e.mode=e.mode||"cors",e.query&&(e.url=e.url+(e.url.indexOf("?")>-1?"&":"?")+(0,f.queryStringify)(e.query)),(0,l.findHeaderName)("Accept",e.headers)||(e.headers.Accept=y["default"]._jsonContentType),"string"!=typeof e.body||!e.body){var n=(0,l.findHeaderName)(y["default"]._contentType,e.headers);n||(n=y["default"]._contentType,e.headers[n]=y["default"]._jsonContentType);var r=e.headers[n];r.indexOf(y["default"]._jsonContentType)>-1?e.body=JSON.stringify(e.body):r.indexOf(y["default"]._urlencodedContentType)>-1&&(e.body=(0,f.queryStringify)(e.body))}var i=new c.Request(e.url,e);return i.originalBody=e.body,i}}]),t}(h["default"]);v._allowedMethods=["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"],t["default"]=v},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){t=t||{};var n=new s.Response(e,t);return a.isNodeJS()&&(n._text=e,n._decode=function(){return this._text}),n}function o(e,t){return e=e.toLowerCase(),Object.keys(t).reduce(function(t,n){return t?t:e==n.toLowerCase()?n:t},null)}Object.defineProperty(t,"__esModule",{value:!0}),t.createResponse=i,t.findHeaderName=o;var s=n(4),u=n(3),a=r(u)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),u=n(16),a=r(u),c=function(){function e(t,n,r){i(this,e),this._request=t,this._response=n,this._text=r,this._json=null,this._multipart=[]}return o(e,[{key:"response",value:function(){return this._response}},{key:"request",value:function(){return this._request}},{key:"ok",value:function(){return this._response&&this._response.ok}},{key:"text",value:function(){if(!this._isJson()&&!this._isMultipart())throw new Error("Response is not text");return this._text}},{key:"json",value:function(){if(!this._isJson())throw new Error("Response is not JSON");return this._json||(this._json=this._text?JSON.parse(this._text):null),this._json}},{key:"error",value:function(e){if(this.ok()&&!e)return null;var t=(this._response&&this._response.status?this._response.status+" ":"")+(this._response&&this._response.statusText?this._response.statusText:"");try{this.json().message&&(t=this.json().message),this.json().error_description&&(t=this.json().error_description),this.json().description&&(t=this.json().description)}catch(n){}return t}},{key:"multipart",value:function(){if(!this._isMultipart())throw new Error("Response is not multipart");if(!this._multipart.length){var t=this.text();if(!t)throw new Error("No response body");var n=this._getContentType().match(/boundary=([^;]+)/i)[1];if(!n)throw new Error("Cannot find boundary");var r=t.toString().split(e._boundarySeparator+n);if(""===r[0].trim()&&r.shift(),r[r.length-1].trim()==e._boundarySeparator&&r.pop(),r.length<1)throw new Error("No parts in body");var i=e.create(r.shift(),this._response.status,this._response.statusText).json();this._multipart=r.map(function(t,n){var r=i.response[n].status;return e.create(t,r)})}return this._multipart}},{key:"_isContentType",value:function(e){return this._getContentType().indexOf(e)>-1}},{key:"_getContentType",value:function(){return this._response.headers.get(e._contentType)||""}},{key:"_isMultipart",value:function(){return this._isContentType(e._multipartContentType)}},{key:"_isUrlEncoded",value:function(){return this._isContentType(e._urlencodedContentType)}},{key:"_isJson",value:function(){return this._isContentType(e._jsonContentType)}}],[{key:"create",value:function(t,n,r){t=t||"",n=n||200,r=r||"OK",t=t.replace(/\r/g,"");var i=new s.Headers,o=t.split(e._bodySeparator),u=o.length>1?o.shift():"";return t=o.join(e._bodySeparator),(u||"").split("\n").forEach(function(t){var n=t.trim().split(e._headerSeparator),r=n.shift().trim(),o=n.join(e._headerSeparator).trim();r&&i.append(r,o)}),new e(null,a.createResponse(t,{headers:i,status:n,statusText:r}),t)}}]),e}();c._contentType="Content-Type",c._jsonContentType="application/json",c._multipartContentType="multipart/mixed",c._urlencodedContentType="application/x-www-form-urlencoded",c._headerSeparator=":",c._bodySeparator="\n\n",c._boundarySeparator="--",t["default"]=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var s=t[i](o),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var c=n(19),f=r(c),l=n(15),p=r(l),h=function(e){function t(){o(this,t);var e=s(this,Object.getPrototypeOf(t).call(this));return e._registry=new f["default"],e}return u(t,e),a(t,[{key:"registry",value:function(){return this._registry}},{key:"_loadResponse",value:function(){var e=i(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._registry.find(e),t.next=3,n.getResponse(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(p["default"]);t["default"]=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(20),u=r(s),a=function(){function e(){i(this,e),this._mocks=[]}return o(e,[{key:"add",value:function(e){return this._mocks.push(e),this}},{key:"clear",value:function(){return this._mocks=[],this}},{key:"find",value:function(e){var t=this._mocks.shift();if(!t)throw new Error("No mock in registry for request "+e.method+" "+e.url);if(!t.test(e))throw new Error("Wrong request "+e.method+" "+e.url+" for expected mock "+t.method()+" "+t.path());return t}},{key:"apiCall",value:function(e,t,n,r,i){return this.add(new u["default"](e,t,n,r,i)),this}},{key:"authentication",value:function(){return this.apiCall("POST","/restapi/oauth/token",{access_token:"ACCESS_TOKEN",token_type:"bearer",expires_in:3600,refresh_token:"REFRESH_TOKEN",refresh_token_expires_in:60480,scope:"SMS RCM Foo Boo",expireTime:(new Date).getTime()+36e5}),this}},{key:"logout",value:function(){return this.apiCall("POST","/restapi/oauth/revoke",{}),this}},{key:"presenceLoad",value:function(e){return this.apiCall("GET","/restapi/v1.0/account/~/extension/"+e+"/presence",{uri:"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/"+e+"/presence",extension:{uri:"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/"+e,id:e,extensionNumber:"101"},activeCalls:[],presenceStatus:"Available",telephonyStatus:"Ringing",userStatus:"Available",dndStatus:"TakeAllCalls",extensionId:e}),this}},{key:"subscribeGeneric",value:function(e){e=e||54e3;var t=new Date;return this.apiCall("POST","/restapi/v1.0/subscription",{eventFilters:["/restapi/v1.0/account/~/extension/~/presence"],expirationTime:new Date(t.getTime()+1e3*e).toISOString(),expiresIn:e,deliveryMode:{transportType:"PubNub",encryption:!1,address:"123_foo",subscriberKey:"sub-c-foo",secretKey:"sec-c-bar"},id:"foo-bar-baz",creationTime:t.toISOString(),status:"Active",uri:"https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz"}),this}},{key:"subscribeOnPresence",value:function(e,t){e=e||"1";var n=new Date;return this.apiCall("POST","/restapi/v1.0/subscription",{eventFilters:["/restapi/v1.0/account/~/extension/"+e+"/presence"+(t?"?detailedTelephonyState=true":"")],expirationTime:new Date(n.getTime()+54e6).toISOString(),deliveryMode:{transportType:"PubNub",encryption:!0,address:"123_foo",subscriberKey:"sub-c-foo",secretKey:"sec-c-bar",encryptionAlgorithm:"AES",encryptionKey:"VQwb6EVNcQPBhE/JgFZ2zw=="},creationTime:n.toISOString(),id:"foo-bar-baz",status:"Active",uri:"https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz"}),this}},{key:"tokenRefresh",value:function(e){return e?this.apiCall("POST","/restapi/oauth/token",{message:"Wrong token",error_description:"Wrong token",description:"Wrong token"},400):this.apiCall("POST","/restapi/oauth/token",{access_token:"ACCESS_TOKEN_FROM_REFRESH",token_type:"bearer",expires_in:3600,refresh_token:"REFRESH_TOKEN_FROM_REFRESH",refresh_token_expires_in:60480,scope:"SMS RCM Foo Boo"}),this}}]),e}();t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var s=t[i](o),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(17),a=r(u),c=n(3),f=n(16),l=function(){function e(t,n,r,i,s,u){o(this,e),this._method=t.toUpperCase(),this._path=n,this._json=r||{},this._delay=u||10,this._status=i||200,this._statusText=s||"OK"}return s(e,[{key:"path",value:function(){return this._path}},{key:"method",value:function(){return this._method}},{key:"test",value:function(e){return e.url.indexOf(this._path)>-1&&e.method.toUpperCase()==this._method}},{key:"getResponse",value:function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.delay)(this._delay);case 2:return e.abrupt("return",this.createResponse(this._json));case 3:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createResponse",value:function(e,t){t=t||{},t.status=t.status||this._status,t.statusText=t.statusText||this._statusText;var n=JSON.stringify(e),r=(0,f.createResponse)(n,t);return r.headers.set(a["default"]._contentType,a["default"]._jsonContentType),r}}]),e}();t["default"]=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new y.Promise(function(e,n){function r(i,o){try{var s=t[i](o),u=s.value}catch(a){return void n(a)}s.done?e(u):y.Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var c=n(13),f=r(c),l=n(14),p=r(l),h=n(22),d=r(h),y=n(4),v=n(3),_=function(e){function t(e,n,r,i,u){o(this,t);var a=s(this,Object.getPrototypeOf(t).call(this));return a.events={beforeLogin:"beforeLogin",loginSuccess:"loginSuccess",loginError:"loginError",beforeRefresh:"beforeRefresh",refreshSuccess:"refreshSuccess",refreshError:"refreshError",beforeLogout:"beforeLogout",logoutSuccess:"logoutSuccess",logoutError:"logoutError"},a._server=r,a._appKey=i,a._appSecret=u,a._cache=n,a._client=e,a._queue=new p["default"](a._cache,t._cacheId+"-refresh"),a._auth=new d["default"](a._cache,t._cacheId),a}return u(t,e),a(t,[{key:"auth",value:function(){return this._auth}},{key:"client",value:function(){return this._client}},{key:"createUrl",value:function(e,n){e=e||"",n=n||{};var r="",i=-1!=e.indexOf("http://")||-1!=e.indexOf("https://");return n.addServer&&!i&&(r+=this._server),-1!=e.indexOf(t._urlPrefix)||i||(r+=t._urlPrefix+"/"+t._apiVersion),r+=e,(n.addMethod||n.addToken)&&(r+=e.indexOf("?")>-1?"&":"?"),n.addMethod&&(r+="_method="+n.addMethod),n.addToken&&(r+=(n.addMethod?"&":"")+"access_token="+this._auth.accessToken()),r}},{key:"authUrl",value:function(e){return e=e||{},this.createUrl(t._authorizeEndpoint+"?"+(0,v.queryStringify)({response_type:"code",redirect_uri:e.redirectUri||"",client_id:this._appKey,state:e.state||"",brand_id:e.brandId||"",display:e.display||"",prompt:e.prompt||""}),{addServer:!0})}},{key:"parseAuthRedirectUrl",value:function(e){var t=(0,v.parseQueryString)(e.split("?").reverse()[0]),n=t.error_description||t.error;if(n){var r=new Error(n);throw r.error=t.error,r}return t}},{key:"loggedIn",value:function(){var e=i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._ensureAuthentication();case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",!1);case 9:case"end":return e.stop()}},t,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=i(regeneratorRuntime.mark(function n(e){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e=e||{},e.remember=e.remember||!1,this.emit(this.events.beforeLogin),r={access_token_ttl:t._accessTokenTtl,refresh_token_ttl:e.remember?t._refreshTokenTtlRemember:t._refreshTokenTtl},e.code?e.code&&(r.grant_type="authorization_code",r.code=e.code,r.redirect_uri=e.redirectUri):(r.grant_type="password",r.username=e.username,r.password=e.password,r.extension=e.extension||""),e.endpointId&&(r.endpoint_id=e.endpointId),n.next=9,this._tokenRequest(t._tokenEndpoint,r);case 9:return i=n.sent,o=i.json(),this._auth.setData(o).setRemember(e.remember),this.emit(this.events.loginSuccess,i),n.abrupt("return",i);case 16:throw n.prev=16,n.t0=n["catch"](0),this._cache.clean(),this.emit(this.events.loginError,n.t0),n.t0;case 21:case"end":return n.stop()}},n,this,[[0,16]])}));return function(t){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=i(regeneratorRuntime.mark(function n(){var e,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,this.emit(this.events.beforeRefresh),!this._queue.isPaused()){n.next=9;break}return n.next=5,this._queue.poll();case 5:if(this._isAccessTokenValid()){n.next=7;break}throw new Error("Automatic authentification timeout");case 7:return this.emit(this.events.refreshSuccess,null),n.abrupt("return",null);case 9:return this._queue.pause(),n.next=12,(0,v.delay)(t._refreshDelayMs);case 12:if(this._auth.refreshToken()){n.next=14;break}throw new Error("Refresh token is missing");case 14:if(this._auth.refreshTokenValid()){n.next=16;break}throw new Error("Refresh token has expired");case 16:if(this._queue.isPaused()){n.next=18;break}throw new Error("Queue was resumed before refresh call");case 18:return n.next=20,this._tokenRequest(t._tokenEndpoint,{grant_type:"refresh_token",refresh_token:this._auth.refreshToken(),access_token_ttl:t._accessTokenTtl,refresh_token_ttl:this._auth.remember()?t._refreshTokenTtlRemember:t._refreshTokenTtl});case 20:if(e=n.sent,r=e.json(),r.access_token){n.next=24;break}throw this._client.makeError(new Error("Malformed OAuth response"),e);case 24:return this._auth.setData(r),this._queue.resume(),this.emit(this.events.refreshSuccess,e),n.abrupt("return",e);case 30:throw n.prev=30,n.t0=n["catch"](0),n.t0=this._client.makeError(n.t0),t._clearCacheOnRefreshError&&this._cache.clean(),this.emit(this.events.refreshError,n.t0),n.t0;case 36:case"end":return n.stop()}},n,this,[[0,30]])}));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=i(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.emit(this.events.beforeLogout),this._queue.pause(),n.next=5,this._tokenRequest(t._revokeEndpoint,{token:this._auth.accessToken()});case 5:return e=n.sent,this._queue.resume(),this._cache.clean(),this.emit(this.events.logoutSuccess,e),n.abrupt("return",e);case 12:throw n.prev=12,n.t0=n["catch"](0),this._queue.resume(),this.emit(this.events.logoutError,n.t0),n.t0;case 17:case"end":return n.stop()}},n,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"inflateRequest",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=n||{},!n.skipAuthCheck){t.next=3;break}return t.abrupt("return",e);case 3:return t.next=5,this._ensureAuthentication();case 5:return e.headers.set("Authorization",this._authHeader()),t.abrupt("return",e);case 7:case"end":return t.stop()}},t,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendRequest",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.inflateRequest(e,n);case 3:return e=t.sent,t.next=6,this._client.sendRequest(e);case 6:return t.abrupt("return",t.sent);case 9:if(t.prev=9,t.t0=t["catch"](0),t.t0.apiResponse&&t.t0.apiResponse.response()&&401==t.t0.apiResponse.response().status){t.next=13;break}throw t.t0;case 13:return this._auth.cancelAccessToken(),t.next=16,this.sendRequest(e,n);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}},t,this,[[0,9]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=i(regeneratorRuntime.mark(function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.url=this.createUrl(e.url,{addServer:!0}),t.next=3,this.sendRequest(this._client.createRequest(e),e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n,r){return regeneratorRuntime.wrap(function(t){
for(;;)switch(t.prev=t.next){case 0:return r=r||{},r.method="GET",r.url=e,r.query=n,t.next=6,this.send(r);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n,r,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=i||{},i.method="POST",i.url=e,i.query=r,i.body=n,t.next=7,this.send(i);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n,r,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=i||{},i.method="PUT",i.url=e,i.query=r,i.body=n,t.next=7,this.send(i);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=r||{},r.method="DELETE",r.url=e,r.query=n,t.next=6,this.send(r);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_tokenRequest",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.send({url:e,skipAuthCheck:!0,body:n,method:"POST",headers:{Authorization:"Basic "+this._apiKey(),"Content-Type":"application/x-www-form-urlencoded"}});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_ensureAuthentication",value:function(){var e=i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isAccessTokenValid()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.refresh();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_isAccessTokenValid",value:function(){return this._auth.accessTokenValid()&&!this._queue.isPaused()}},{key:"_apiKey",value:function(){var e=this._appKey+":"+this._appSecret;return"function"==typeof btoa?btoa(e):new Buffer(e).toString("base64")}},{key:"_authHeader",value:function(){var e=this._auth.accessToken();return this._auth.tokenType()+(e?" "+e:"")}}]),t}(f["default"]);_._urlPrefix="/restapi",_._apiVersion="v1.0",_._accessTokenTtl=null,_._refreshTokenTtl=36e3,_._refreshTokenTtlRemember=604800,_._tokenEndpoint="/restapi/oauth/token",_._revokeEndpoint="/restapi/oauth/revoke",_._authorizeEndpoint="/restapi/oauth/authorize",_._refreshDelayMs=100,_._cacheId="platform",_._clearCacheOnRefreshError=!0,t["default"]=_},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t,r){n(this,e),this._cache=t,this._cacheId=r}return r(e,[{key:"accessToken",value:function(){return this.data().access_token}},{key:"refreshToken",value:function(){return this.data().refresh_token}},{key:"tokenType",value:function(){return this.data().token_type}},{key:"data",value:function(){return this._cache.getItem(this._cacheId)||{token_type:"",access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}}},{key:"setData",value:function(e){e=e||{};var t=this.data();return Object.keys(e).forEach(function(n){t[n]=e[n]}),t.expire_time=Date.now()+1e3*t.expires_in,t.refresh_token_expire_time=Date.now()+1e3*t.refresh_token_expires_in,this._cache.setItem(this._cacheId,t),this}},{key:"accessTokenValid",value:function(){var t=this.data();return t.token_type===e.forcedTokenType||t.expire_time-e.refreshHandicapMs>Date.now()}},{key:"refreshTokenValid",value:function(){return this.data().refresh_token_expire_time>Date.now()}},{key:"cancelAccessToken",value:function(){return this.setData({access_token:"",expires_in:0})}},{key:"forceAuthentication",value:function(){return this.setData({token_type:e.forcedTokenType,access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}),this}},{key:"setRemember",value:function(e){return this.setData({remember:e})}},{key:"remember",value:function(){return!!this.data().remember}}]),e}();i.refreshHandicapMs=6e4,i.forcedTokenType="forced",t["default"]=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(24),u=r(s),a=n(4),c=function(){function e(){i(this,e),this.crypto_obj=a.PUBNUB.crypto_obj}return o(e,[{key:"init",value:function(e){return new u["default"](e)}}]),e}();t["default"]=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(13),c=r(a),f=n(4),l=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this));return n.options=e,n.crypto_obj=f.PUBNUB.crypto_obj,n}return s(t,e),u(t,[{key:"ready",value:function(){}},{key:"subscribe",value:function(e){this.on("message-"+e.channel,e.message)}},{key:"unsubscribe",value:function(e){this.off("message-"+e.channel)}},{key:"receiveMessage",value:function(e,t){this.emit("message-"+t,e,"env",t)}}]),t}(c["default"]);t["default"]=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var s=t[i](o),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var c=n(13),f=r(c),l=n(15),p=(r(l),n(3)),h=function(e){function t(e,n){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this));return r.events={notification:"notification",removeSuccess:"removeSuccess",removeError:"removeError",renewSuccess:"renewSuccess",renewError:"renewError",subscribeSuccess:"subscribeSuccess",subscribeError:"subscribeError"},r._pubnubFactory=e,r._platform=n,r._pubnub=null,r._timeout=null,r._subscription={},r}return u(t,e),a(t,[{key:"subscribed",value:function(){return!!(this._subscription.id&&this._subscription.deliveryMode&&this._subscription.deliveryMode.subscriberKey&&this._subscription.deliveryMode.address)}},{key:"alive",value:function(){return this.subscribed()&&Date.now()<this.expirationTime()}},{key:"expirationTime",value:function(){return new Date(this._subscription.expirationTime||0).getTime()-t._renewHandicapMs}},{key:"setSubscription",value:function(e){return e=e||{},this._clearTimeout(),this._subscription=e,this._pubnub||this._subscribeAtPubnub(),this._setTimeout(),this}},{key:"subscription",value:function(){return this._subscription}},{key:"register",value:function(){var e=i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alive()){e.next=6;break}return e.next=3,this.renew();case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,this.subscribe();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}()},{key:"eventFilters",value:function(){return this._subscription.eventFilters||[]}},{key:"addEventFilters",value:function(e){return this.setEventFilters(this.eventFilters().concat(e)),this}},{key:"setEventFilters",value:function(e){return this._subscription.eventFilters=e,this}},{key:"subscribe",value:function(){var e=i(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._clearTimeout(),this.eventFilters().length){t.next=4;break}throw new Error("Events are undefined");case 4:return t.next=6,this._platform.post("/restapi/v1.0/subscription",{eventFilters:this._getFullEventFilters(),deliveryMode:{transportType:"PubNub"}});case 6:return e=t.sent,n=e.json(),this.setSubscription(n).emit(this.events.subscribeSuccess,e),t.abrupt("return",e);case 12:throw t.prev=12,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.reset().emit(this.events.subscribeError,t.t0),t.t0;case 17:case"end":return t.stop()}},t,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"renew",value:function(){var e=i(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._clearTimeout(),this.alive()){t.next=4;break}throw new Error("Subscription is not alive");case 4:if(this.eventFilters().length){t.next=6;break}throw new Error("Events are undefined");case 6:return t.next=8,this._platform.put("/restapi/v1.0/subscription/"+this._subscription.id,{eventFilters:this._getFullEventFilters()});case 8:return e=t.sent,n=e.json(),this.setSubscription(n).emit(this.events.renewSuccess,e),t.abrupt("return",e);case 14:throw t.prev=14,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.reset().emit(this.events.renewError,t.t0),t.t0;case 19:case"end":return t.stop()}},t,this,[[0,14]])}));return function(){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=i(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.subscribed()){t.next=3;break}throw new Error("No subscription");case 3:return t.next=5,this._platform["delete"]("/restapi/v1.0/subscription/"+this._subscription.id);case 5:return e=t.sent,this.reset().emit(this.events.removeSuccess,e),t.abrupt("return",e);case 10:throw t.prev=10,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.emit(this.events.removeError,t.t0),t.t0;case 15:case"end":return t.stop()}},t,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"resubscribe",value:function(){return this.reset().setEventFilters(this.eventFilters()).subscribe()}},{key:"reset",value:function(){return this._clearTimeout(),this.subscribed()&&this._pubnub&&this._pubnub.unsubscribe({channel:this._subscription.deliveryMode.address}),this._subscription={},this}},{key:"_getFullEventFilters",value:function(){var e=this;return this.eventFilters().map(function(t){return e._platform.createUrl(t)})}},{key:"_setTimeout",value:function(){var e=this;if(this._clearTimeout(),!this.alive())throw new Error("Subscription is not alive");return(0,p.poll)(function(t){return e.alive()?t():void e.renew()},t._pollInterval,this._timeout),this}},{key:"_clearTimeout",value:function(){return(0,p.stopPolling)(this._timeout),this}},{key:"_decrypt",value:function(e){if(!this.subscribed())throw new Error("No subscription");if(this._subscription.deliveryMode.encryptionKey){var t=this._pubnubFactory;e=t.crypto_obj.decrypt(e,this._subscription.deliveryMode.encryptionKey,{encryptKey:!1,keyEncoding:"base64",keyLength:128,mode:"ecb"})}return e}},{key:"_notify",value:function(e){return this.emit(this.events.notification,this._decrypt(e)),this}},{key:"_subscribeAtPubnub",value:function(){if(!this.alive())throw new Error("Subscription is not alive");var e=this._pubnubFactory;return this._pubnub=e.init({ssl:!0,subscribe_key:this._subscription.deliveryMode.subscriberKey}),this._pubnub.ready(),this._pubnub.subscribe({channel:this._subscription.deliveryMode.address,message:this._notify.bind(this),connect:function(){}}),this}}]),t}(f["default"]);h._renewHandicapMs=12e4,h._pollInterval=1e4,t["default"]=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var s=t[i](o),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function v(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:v(i,t,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)};Object.defineProperty(t,"__esModule",{value:!0});var l=n(25),p=r(l),h=n(14),d=r(h),y=function(e){function t(e,n,r,i){o(this,t);var u=s(this,Object.getPrototypeOf(t).call(this,e,n));return u._cache=r,u._cacheKey=i,u._renewQueue=new d["default"](u._cache,i+"-renew"),u._resubscribeQueue=new d["default"](u._cache,i+"-resubscribe"),u.events=a({},u.events,{queuedRenewSuccess:"queuedRenewSuccess",queuedRenewError:"queuedRenewError",queuedResubscribeSuccess:"queuedResubscribeSuccess",queuedResubscribeError:"queuedResubscribeError"}),u.on(u.events.renewError,function(){u.resubscribe()}),u.on([u.events.subscribeSuccess,u.events.renewSuccess],function(){u._cache.setItem(u._cacheKey,u.subscription())}),u.on(u.events.removeSuccess,function(){u._cache.removeItem(u._cacheKey)}),u}return u(t,e),c(t,[{key:"_queue",value:function(){var e=i(regeneratorRuntime.mark(function t(e,n,r,i,o){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n.isPaused()){t.next=8;break}return t.next=4,n.poll();case 4:if(this.alive()){t.next=6;break}throw new Error(o);case 6:return this.emit(r,null),t.abrupt("return",null);case 8:return n.pause(),t.next=11,e.call(this);case 11:return s=t.sent,n.resume(),this.emit(r,s),t.abrupt("return",s);case 17:throw t.prev=17,t.t0=t["catch"](0),this.emit(i,t.t0),t.t0;case 21:case"end":return t.stop()}},t,this,[[0,17]])}));return function(t,n,r,i,o){return e.apply(this,arguments)}}()},{key:"renew",value:function(){return this._queue(f(Object.getPrototypeOf(t.prototype),"renew",this),this._renewQueue,this.events.queuedRenewSuccess,this.events.queuedRenewError,"Subscription is not alive after renew timeout")}},{key:"resubscribe",value:function(){return this._queue(f(Object.getPrototypeOf(t.prototype),"resubscribe",this),this._resubscribeQueue,this.events.queuedResubscribeSuccess,this.events.queuedResubscribeError,"Subscription is not alive after resubscribe timeout")}},{key:"restore",value:function(e){var t=this._cache.getItem(this._cacheKey);if(t)try{this.setSubscription(t)}catch(n){}else this.setEventFilters(e);return this}}]),t}(p["default"]);t["default"]=y}])});
//# sourceMappingURL=ringcentral-bundle.min.js.map
