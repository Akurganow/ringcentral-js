!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("es6-promise"),require("node-fetch"),require("pubnub")):"function"==typeof define&&define.amd?define([,,"pubnub"],t):"object"==typeof exports?exports.SDK=t(require("es6-promise"),require("node-fetch"),require("pubnub")):(e.RingCentral=e.RingCentral||{},e.RingCentral.SDK=t(e[void 0],e[void 0],e[void 0]))}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="/build/",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(2),a=o(u),c=r(7),p=n(c),l=r(3),f=o(l),h=r(8),d=n(h),y=r(9),_=n(y),b=r(10),m=n(b),v=r(12),w=n(v),g=r(11),x=o(g),k=r(13),E=n(k),T=r(15),R=n(T),S=r(14),O=n(S),P=r(16),j=n(P),C=r(17),M=n(C),q=r(18),F=n(q),L=r(20),I=n(L),A=r(21),N=n(A);r(22);var K=function(){function e(t){s(this,e),t=t||{},this._cache=new p["default"](f.localStorage,t.cachePrefix),this._client=t.client||new m["default"],this._platform=new j["default"](this._client,this._cache,t.server,t.appKey,t.appSecret),this._pubnubFactory=t.pubnubFactory||f.PUBNUB}return i(e,null,[{key:"version",value:"2.0.0",enumerable:!0},{key:"server",value:{sandbox:"https://platform.devtest.ringcentral.com",production:"https://platform.ringcentral.com"},enumerable:!0}]),e.prototype.platform=function(){return this._platform},e.prototype.createSubscription=function(){return new I["default"](this._pubnubFactory,this._platform)},e.prototype.createCachedSubscription=function(e){return new N["default"](this._pubnubFactory,this._platform,this._cache,e)},e.prototype.cache=function(){return this._cache},i(e,null,[{key:"core",value:{Cache:p["default"],Observable:d["default"],Utils:a,Externals:f,Queue:_["default"]},enumerable:!0},{key:"http",value:{Client:m["default"],ApiResponse:w["default"],Utils:x},enumerable:!0},{key:"platform",value:{Auth:M["default"],Platform:j["default"]},enumerable:!0},{key:"subscription",value:{Subscription:I["default"]},enumerable:!0},{key:"mocks",value:{Client:E["default"],Registry:O["default"],Mock:R["default"]},enumerable:!0},{key:"pubnub",value:{PubnubMockFactory:F["default"]},enumerable:!0}]),e}();t["default"]=K,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){var t=[];return e=e||{},Object.keys(e).forEach(function(r){var n=e[r];i(n)?n.forEach(function(e){t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}),t.join("&")}function o(e){var t={};return e.split("&").forEach(function(e){if(e=decodeURIComponent(e),-1==e.indexOf("="))t[e.trim()]=!0;else{var r=e.split("="),n=r[0].trim(),o=r[1].trim();n in t?(n in t&&!i(t[n])&&(t[n]=[t[n]]),t[n].push(o)):t[n]=o}}),t}function s(e){return"function"==typeof e}function i(e){return Array.isArray?Array.isArray(e):"array"==typeof e}function u(t,r,n){e.exports.stopPolling(n),r=r||1e3;var o=function s(e){return e=e||r,r=e,setTimeout(function(){t(s,e)},e)};return o()}function a(e){e&&clearTimeout(e)}function c(){return"undefined"!=typeof process}function p(){return"undefined"!=typeof window}function l(e){return new f.Promise(function(t,r){setTimeout(function(){t(null)},e)})}t.__esModule=!0,t.queryStringify=n,t.parseQueryString=o,t.isFunction=s,t.isArray=i,t.poll=u,t.stopPolling=a,t.isNodeJS=c,t.isBrowser=p,t.delay=l;var f=r(3)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=r(4),s=n(o),i=r(5),u=n(i),a=r(6),c=n(a),p=new Function("return this")(),l=s["default"]&&s["default"].Promise||p.Promise;t.Promise=l;var f=p.fetch||u["default"];t.fetch=f;var h=p.Request||f.Request;t.Request=h;var d=p.Response||f.Response;t.Response=d;var y=p.Headers||f.Headers;t.Headers=y;var _=p.PUBNUB||c["default"];t.PUBNUB=_;var b="undefined"!=typeof p.localStorage?p.localStorage:{};t.localStorage=b},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t,n){r(this,e),this.setPrefix(n),this._storage=t}return n(e,null,[{key:"defaultPrefix",value:"rc-",enumerable:!0}]),e.prototype.setPrefix=function(t){return this._prefix=t||e.defaultPrefix,this},e.prototype.setItem=function(e,t){return this._storage[this._prefixKey(e)]=JSON.stringify(t),this},e.prototype.removeItem=function(e){return delete this._storage[this._prefixKey(e)],this},e.prototype.getItem=function(e){var t=this._storage[this._prefixKey(e)];return t?JSON.parse(t):null},e.prototype.clean=function(){for(var e in this._storage)this._storage.hasOwnProperty(e)&&0===e.indexOf(this._prefix)&&delete this._storage[e];return this},e.prototype._prefixKey=function(e){return this._prefix+e},e}();t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var n=function(){function e(){r(this,e),this.off()}return e.prototype.hasListeners=function(e){return e in this._listeners},e.prototype.on=function(e,t){var r=this;if("string"==typeof e&&(e=[e]),!e)throw new Error("No events to subscribe to");if("function"!=typeof t)throw new Error("Callback must be a function");return e.forEach(function(e){r.hasListeners(e)||(r._listeners[e]=[]),r._listeners[e].push(t)}),this},e.prototype.emit=function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),o=1;r>o;o++)n[o-1]=arguments[o];var s=null;return this.hasListeners(e)?(this._listeners[e].some(function(e){return s=e.apply(t,n),s===!1}),s):null},e.prototype.off=function(e,t){var r=this;if(e)if(t){if(!this.hasListeners(e))return this;this._listeners[e].forEach(function(n,o){n===t&&delete r._listeners[e][o]})}else delete this._listeners[e];else this._listeners={};return this},e}();t["default"]=n,e.exports=t["default"]},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),i=r(2),u=function(){function e(t,r){n(this,e),this._cache=t,this._cacheId=r,this._promise=null}return o(e,null,[{key:"_pollInterval",value:250,enumerable:!0},{key:"_releaseTimeout",value:5e3,enumerable:!0}]),e.prototype.isPaused=function(){var t=this._cache.getItem(this._cacheId);return!!t&&Date.now()-parseInt(t)<e._releaseTimeout},e.prototype.pause=function(){return this._cache.setItem(this._cacheId,Date.now()),this},e.prototype.resume=function(){return this._cache.removeItem(this._cacheId),this},e.prototype.poll=function(){var t=this;return this._promise?this._promise:(this._promise=new s.Promise(function(r,n){i.poll(function(e){return t.isPaused()?e():(t._promise=null,t.resume(),void r(null))},e._pollInterval)}),this._promise)},e}();t["default"]=u,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(3),a=r(2),c=r(11),p=r(8),l=n(p),f=r(12),h=n(f),d=function(e){function t(){o(this,t),e.apply(this,arguments),this.events={beforeRequest:"beforeRequest",requestSuccess:"requestSuccess",requestError:"requestError"}}return s(t,e),t.prototype.sendRequest=function(e){var t;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t=new h["default"](e),r.prev=1,this.emit(this.events.beforeRequest,t),r.next=5,regeneratorRuntime.awrap(this._loadResponse(e));case 5:if(t._response=r.sent,!t._isMultipart()&&!t._isJson()){r.next=10;break}return r.next=9,regeneratorRuntime.awrap(t.response().text());case 9:t._text=r.sent;case 10:if(t.ok()){r.next=12;break}throw new Error("Response has unsuccessful status");case 12:return this.emit(this.events.requestSuccess,t),r.abrupt("return",t);case 16:throw r.prev=16,r.t0=r["catch"](1),r.t0.apiResponse||(r.t0=this.makeError(r.t0,t)),this.emit(this.events.requestError,r.t0),r.t0;case 21:case"end":return r.stop()}},null,this,[[1,16]])},t.prototype._loadResponse=function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(u.fetch.call(null,e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},null,this)},t.prototype.makeError=function(e,t){return e.hasOwnProperty("apiResponse")||e.hasOwnProperty("originalMessage")||(e.apiResponse=t,e.originalMessage=e.message,e.message=t&&t.error(!0)||e.originalMessage),e},t.prototype.createRequest=function(e){if(e=e||{},e.headers=e.headers||{},!e.url)throw new Error("Url is not defined");if(e.method||(e.method="GET"),e.method&&t._allowedMethods.indexOf(e.method)<0)throw new Error("Method has wrong value: "+e.method);if(e.credentials=e.credentials||"include",e.mode=e.mode||"cors",e.query&&(e.url=e.url+(e.url.indexOf("?")>-1?"&":"?")+a.queryStringify(e.query)),c.findHeaderName("Accept",e.headers)||(e.headers.Accept=h["default"]._jsonContentType),"string"!=typeof e.body||!e.body){var r=c.findHeaderName(h["default"]._contentType,e.headers);r||(r=h["default"]._contentType,e.headers[r]=h["default"]._jsonContentType);var n=e.headers[r];n.indexOf(h["default"]._jsonContentType)>-1?e.body=JSON.stringify(e.body):n.indexOf(h["default"]._urlencodedContentType)>-1&&(e.body=a.queryStringify(e.body))}var o=new u.Request(e.url,e);return o.originalBody=e.body,o},i(t,null,[{key:"_allowedMethods",value:["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"],enumerable:!0}]),t}(l["default"]);t["default"]=d,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e,t){t=t||{};var r=new i.Response(e,t);return a.isNodeJS()&&(r._text=e,r._decode=function(){return this._text}),r}function s(e,t){return e=e.toLowerCase(),Object.keys(t).reduce(function(t,r){return t?t:e==r.toLowerCase()?r:t},null)}t.__esModule=!0,t.createResponse=o,t.findHeaderName=s;var i=r(3),u=r(2),a=n(u)},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3),u=r(11),a=n(u),c=function(){function e(t,r,n){o(this,e),this._request=t,this._response=r,this._text=n,this._json=null,this._multipart=[]}return s(e,null,[{key:"_contentType",value:"Content-Type",enumerable:!0},{key:"_jsonContentType",value:"application/json",enumerable:!0},{key:"_multipartContentType",value:"multipart/mixed",enumerable:!0},{key:"_urlencodedContentType",value:"application/x-www-form-urlencoded",enumerable:!0},{key:"_headerSeparator",value:":",enumerable:!0},{key:"_bodySeparator",value:"\n\n",enumerable:!0},{key:"_boundarySeparator",value:"--",enumerable:!0}]),e.prototype.response=function(){return this._response},e.prototype.request=function(){return this._request},e.prototype.ok=function(){return this._response&&this._response.ok},e.prototype.text=function(){if(!this._isJson()&&!this._isMultipart())throw new Error("Response is not text");return this._text},e.prototype.json=function(){if(!this._isJson())throw new Error("Response is not JSON");return this._json||(this._json=this._text?JSON.parse(this._text):null),this._json},e.prototype.error=function(e){if(this.ok()&&!e)return null;var t=(this._response&&this._response.status?this._response.status+" ":"")+(this._response&&this._response.statusText?this._response.statusText:"");try{this.json().message&&(t=this.json().message),this.json().error_description&&(t=this.json().error_description),this.json().description&&(t=this.json().description)}catch(r){}return t},e.prototype.multipart=function(){if(!this._isMultipart())throw new Error("Response is not multipart");if(!this._multipart.length){var t=this.text();if(!t)throw new Error("No response body");var r=this._getContentType().match(/boundary=([^;]+)/i)[1];if(!r)throw new Error("Cannot find boundary");var n=t.toString().split(e._boundarySeparator+r);if(""===n[0].trim()&&n.shift(),n[n.length-1].trim()==e._boundarySeparator&&n.pop(),n.length<1)throw new Error("No parts in body");var o=e.create(n.shift(),this._response.status,this._response.statusText).json();this._multipart=n.map(function(t,r){var n=o.response[r].status;return e.create(t,n)})}return this._multipart},e.prototype._isContentType=function(e){return this._getContentType().indexOf(e)>-1},e.prototype._getContentType=function(){return this._response.headers.get(e._contentType)||""},e.prototype._isMultipart=function(){return this._isContentType(e._multipartContentType)},e.prototype._isUrlEncoded=function(){return this._isContentType(e._urlencodedContentType)},e.prototype._isJson=function(){return this._isContentType(e._jsonContentType)},e.create=function(t,r,n){t=t||"",r=r||200,n=n||"OK",t=t.replace(/\r/g,"");var o=new i.Headers,s=t.split(e._bodySeparator),u=s.length>1?s.shift():"";return t=s.join(e._bodySeparator),(u||"").split("\n").forEach(function(t){var r=t.trim().split(e._headerSeparator),n=r.shift().trim(),s=r.join(e._headerSeparator).trim();n&&o.append(n,s)}),new e(null,a.createResponse(t,{headers:o,status:r,statusText:n}),t)},e}();t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(14),u=n(i),a=r(10),c=n(a),p=function(e){function t(){o(this,t),e.call(this),this._registry=new u["default"]}return s(t,e),t.prototype.registry=function(){return this._registry},t.prototype._loadResponse=function(e){var t;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t=this._registry.find(e),r.next=3,regeneratorRuntime.awrap(t.getResponse(e));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},null,this)},t}(c["default"]);t["default"]=p,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var s=r(15),i=n(s),u=function(){function e(){o(this,e),this._mocks=[]}return e.prototype.add=function(e){return this._mocks.push(e),this},e.prototype.clear=function(){return this._mocks=[],this},e.prototype.find=function(e){var t=this._mocks.shift();if(!t)throw new Error("No mock in registry for request "+e.method+" "+e.url);if(!t.test(e))throw new Error("Wrong request "+e.method+" "+e.url+" for expected mock "+t.method()+" "+t.path());return t},e.prototype.apiCall=function(e,t,r,n,o){return this.add(new i["default"](e,t,r,n,o)),this},e.prototype.authentication=function(){return this.apiCall("POST","/restapi/oauth/token",{access_token:"ACCESS_TOKEN",token_type:"bearer",expires_in:3600,refresh_token:"REFRESH_TOKEN",refresh_token_expires_in:60480,scope:"SMS RCM Foo Boo",expireTime:(new Date).getTime()+36e5}),this},e.prototype.logout=function(){return this.apiCall("POST","/restapi/oauth/revoke",{}),this},e.prototype.presenceLoad=function(e){return this.apiCall("GET","/restapi/v1.0/account/~/extension/"+e+"/presence",{uri:"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/"+e+"/presence",extension:{uri:"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/"+e,id:e,extensionNumber:"101"},activeCalls:[],presenceStatus:"Available",telephonyStatus:"Ringing",userStatus:"Available",dndStatus:"TakeAllCalls",extensionId:e}),this},e.prototype.subscribeGeneric=function(e){e=e||54e3;var t=new Date;return this.apiCall("POST","/restapi/v1.0/subscription",{eventFilters:["/restapi/v1.0/account/~/extension/~/presence"],expirationTime:new Date(t.getTime()+1e3*e).toISOString(),expiresIn:e,deliveryMode:{transportType:"PubNub",encryption:!1,address:"123_foo",subscriberKey:"sub-c-foo",secretKey:"sec-c-bar"},id:"foo-bar-baz",creationTime:t.toISOString(),status:"Active",uri:"https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz"}),this},e.prototype.subscribeOnPresence=function(e,t){e=e||"1";var r=new Date;return this.apiCall("POST","/restapi/v1.0/subscription",{eventFilters:["/restapi/v1.0/account/~/extension/"+e+"/presence"+(t?"?detailedTelephonyState=true":"")],expirationTime:new Date(r.getTime()+54e6).toISOString(),deliveryMode:{transportType:"PubNub",encryption:!0,address:"123_foo",subscriberKey:"sub-c-foo",secretKey:"sec-c-bar",encryptionAlgorithm:"AES",encryptionKey:"VQwb6EVNcQPBhE/JgFZ2zw=="},creationTime:r.toISOString(),id:"foo-bar-baz",status:"Active",uri:"https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz"}),this},e.prototype.tokenRefresh=function(e){return e?this.apiCall("POST","/restapi/oauth/token",{message:"Wrong token",error_description:"Wrong token",description:"Wrong token"},400):this.apiCall("POST","/restapi/oauth/token",{access_token:"ACCESS_TOKEN_FROM_REFRESH",token_type:"bearer",expires_in:3600,refresh_token:"REFRESH_TOKEN_FROM_REFRESH",refresh_token_expires_in:60480,scope:"SMS RCM Foo Boo"}),this},e}();t["default"]=u,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var s=r(12),i=n(s),u=r(2),a=r(11),c=function(){function e(t,r,n,s,i,u){o(this,e),this._method=t.toUpperCase(),this._path=r,this._json=n||{},this._delay=u||10,this._status=s||200,this._statusText=i||"OK"}return e.prototype.path=function(){return this._path},e.prototype.method=function(){return this._method},e.prototype.test=function(e){return e.url.indexOf(this._path)>-1&&e.method.toUpperCase()==this._method},e.prototype.getResponse=function(e){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(u.delay(this._delay));case 2:return e.abrupt("return",this.createResponse(this._json));case 3:case"end":return e.stop()}},null,this)},e.prototype.createResponse=function(e,t){t=t||{},t.status=t.status||this._status,t.statusText=t.statusText||this._statusText;var r=JSON.stringify(e),n=a.createResponse(r,t);return n.headers.set(i["default"]._contentType,i["default"]._jsonContentType),n},e}();t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(8),a=n(u),c=r(9),p=n(c),l=r(17),f=n(l),h=(r(3),r(2)),d=function(e){function t(r,n,s,i,u){o(this,t),e.call(this),this.events={beforeLogin:"beforeLogin",loginSuccess:"loginSuccess",loginError:"loginError",beforeRefresh:"beforeRefresh",refreshSuccess:"refreshSuccess",refreshError:"refreshError",beforeLogout:"beforeLogout",logoutSuccess:"logoutSuccess",logoutError:"logoutError"},this._server=s,this._appKey=i,this._appSecret=u,this._cache=n,this._client=r,this._queue=new p["default"](this._cache,t._cacheId+"-refresh"),this._auth=new f["default"](this._cache,t._cacheId)}return s(t,e),i(t,null,[{key:"_urlPrefix",value:"/restapi",enumerable:!0},{key:"_apiVersion",value:"v1.0",enumerable:!0},{key:"_accessTokenTtl",value:null,enumerable:!0},{key:"_refreshTokenTtl",value:36e3,enumerable:!0},{key:"_refreshTokenTtlRemember",value:604800,enumerable:!0},{key:"_tokenEndpoint",value:"/restapi/oauth/token",enumerable:!0},{key:"_revokeEndpoint",value:"/restapi/oauth/revoke",enumerable:!0},{key:"_authorizeEndpoint",value:"/restapi/oauth/authorize",enumerable:!0},{key:"_refreshDelayMs",value:100,enumerable:!0},{key:"_cacheId",value:"platform",enumerable:!0},{key:"_clearCacheOnRefreshError",value:!0,enumerable:!0}]),t.prototype.auth=function(){return this._auth},t.prototype.client=function(){return this._client},t.prototype.createUrl=function(e,r){e=e||"",r=r||{};var n="",o=-1!=e.indexOf("http://")||-1!=e.indexOf("https://");return r.addServer&&!o&&(n+=this._server),-1!=e.indexOf(t._urlPrefix)||o||(n+=t._urlPrefix+"/"+t._apiVersion),n+=e,(r.addMethod||r.addToken)&&(n+=e.indexOf("?")>-1?"&":"?"),r.addMethod&&(n+="_method="+r.addMethod),r.addToken&&(n+=(r.addMethod?"&":"")+"access_token="+this._auth.accessToken()),n},t.prototype.authUrl=function(e){return e=e||{},this.createUrl(t._authorizeEndpoint+"?"+h.queryStringify({response_type:"code",redirect_uri:e.redirectUri||"",client_id:this._appKey,state:e.state||"",brand_id:e.brandId||"",display:e.display||"",prompt:e.prompt||""}),{addServer:!0})},t.prototype.parseAuthRedirectUrl=function(e){var t=h.parseQueryString(e.split("?").reverse()[0]),r=t.error_description||t.error;if(r){var n=new Error(r);throw n.error=t.error,n}return t},t.prototype.loggedIn=function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(this._ensureAuthentication());case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",!1);case 9:case"end":return e.stop()}},null,this,[[0,6]])},t.prototype.login=function(e){var r,n,o;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,e=e||{},e.remember=e.remember||!1,this.emit(this.events.beforeLogin),r={access_token_ttl:t._accessTokenTtl,refresh_token_ttl:e.remember?t._refreshTokenTtlRemember:t._refreshTokenTtl},e.code?e.code&&(r.grant_type="authorization_code",r.code=e.code,r.redirect_uri=e.redirectUri):(r.grant_type="password",r.username=e.username,r.password=e.password,r.extension=e.extension||""),e.endpointId&&(r.endpoint_id=e.endpointId),s.next=9,regeneratorRuntime.awrap(this._tokenRequest(t._tokenEndpoint,r));case 9:return n=s.sent,o=n.json(),this._auth.setData(o).setRemember(e.remember),this.emit(this.events.loginSuccess,n),s.abrupt("return",n);case 16:throw s.prev=16,s.t0=s["catch"](0),this._cache.clean(),this.emit(this.events.loginError,s.t0),s.t0;case 21:case"end":return s.stop()}},null,this,[[0,16]])},t.prototype.refresh=function(){var e,r;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,this.emit(this.events.beforeRefresh),!this._queue.isPaused()){n.next=9;break}return n.next=5,regeneratorRuntime.awrap(this._queue.poll());case 5:if(this._isAccessTokenValid()){n.next=7;break}throw new Error("Automatic authentification timeout");case 7:return this.emit(this.events.refreshSuccess,null),n.abrupt("return",null);case 9:return this._queue.pause(),n.next=12,regeneratorRuntime.awrap(h.delay(t._refreshDelayMs));case 12:if(this._auth.refreshToken()){n.next=14;break}throw new Error("Refresh token is missing");case 14:if(this._auth.refreshTokenValid()){n.next=16;break}throw new Error("Refresh token has expired");case 16:if(this._queue.isPaused()){n.next=18;break}throw new Error("Queue was resumed before refresh call");case 18:return n.next=20,regeneratorRuntime.awrap(this._tokenRequest(t._tokenEndpoint,{grant_type:"refresh_token",refresh_token:this._auth.refreshToken(),access_token_ttl:t._accessTokenTtl,refresh_token_ttl:this._auth.remember()?t._refreshTokenTtlRemember:t._refreshTokenTtl}));case 20:if(e=n.sent,r=e.json(),r.access_token){n.next=24;break}throw this._client.makeError(new Error("Malformed OAuth response"),e);case 24:return this._auth.setData(r),this._queue.resume(),this.emit(this.events.refreshSuccess,e),n.abrupt("return",e);case 30:throw n.prev=30,n.t0=n["catch"](0),n.t0=this._client.makeError(n.t0),t._clearCacheOnRefreshError&&this._cache.clean(),this.emit(this.events.refreshError,n.t0),n.t0;case 36:case"end":return n.stop()}},null,this,[[0,30]])},t.prototype.logout=function(){var e;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,this.emit(this.events.beforeLogout),this._queue.pause(),r.next=5,regeneratorRuntime.awrap(this._tokenRequest(t._revokeEndpoint,{token:this._auth.accessToken()}));case 5:return e=r.sent,this._queue.resume(),this._cache.clean(),this.emit(this.events.logoutSuccess,e),r.abrupt("return",e);case 12:throw r.prev=12,r.t0=r["catch"](0),this._queue.resume(),this.emit(this.events.logoutError,r.t0),r.t0;case 17:case"end":return r.stop()}},null,this,[[0,12]])},t.prototype.inflateRequest=function(e,t){return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=t||{},!t.skipAuthCheck){r.next=3;break}return r.abrupt("return",e);case 3:return r.next=5,regeneratorRuntime.awrap(this._ensureAuthentication());case 5:return e.headers.set("Authorization",this._authHeader()),r.abrupt("return",e);case 7:case"end":return r.stop()}},null,this)},t.prototype.sendRequest=function(e,t){return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(this.inflateRequest(e,t));case 3:return e=r.sent,r.next=6,regeneratorRuntime.awrap(this._client.sendRequest(e));case 6:return r.abrupt("return",r.sent);case 9:if(r.prev=9,r.t0=r["catch"](0),r.t0.apiResponse&&r.t0.apiResponse.response()&&401==r.t0.apiResponse.response().status){r.next=13;break}throw r.t0;case 13:return this._auth.cancelAccessToken(),r.next=16,regeneratorRuntime.awrap(this.sendRequest(e,t));case 16:return r.abrupt("return",r.sent);case 17:case"end":return r.stop()}},null,this,[[0,9]])},t.prototype.send=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return e.url=this.createUrl(e.url,{addServer:!0}),t.next=3,regeneratorRuntime.awrap(this.sendRequest(this._client.createRequest(e),e));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},null,this)},t.prototype.get=function(e,t,r){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return r=r||{},r.method="GET",r.url=e,r.query=t,n.next=6,regeneratorRuntime.awrap(this.send(r));case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},null,this)},t.prototype.post=function(e,t,r,n){return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return n=n||{},n.method="POST",n.url=e,n.query=r,n.body=t,o.next=7,regeneratorRuntime.awrap(this.send(n));case 7:return o.abrupt("return",o.sent);case 8:case"end":return o.stop()}},null,this)},t.prototype.put=function(e,t,r,n){return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return n=n||{},n.method="PUT",n.url=e,n.query=r,n.body=t,o.next=7,regeneratorRuntime.awrap(this.send(n));case 7:return o.abrupt("return",o.sent);case 8:case"end":return o.stop()}},null,this)},t.prototype["delete"]=function(e,t,r){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return r=r||{},r.method="DELETE",r.url=e,r.query=t,n.next=6,regeneratorRuntime.awrap(this.send(r));case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},null,this)},t.prototype._tokenRequest=function(e,t){return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.send({url:e,skipAuthCheck:!0,body:t,method:"POST",headers:{Authorization:"Basic "+this._apiKey(),"Content-Type":"application/x-www-form-urlencoded"}}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},null,this)},t.prototype._ensureAuthentication=function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isAccessTokenValid()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,regeneratorRuntime.awrap(this.refresh());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},null,this)},t.prototype._isAccessTokenValid=function(){return this._auth.accessTokenValid()&&!this._queue.isPaused()},t.prototype._apiKey=function(){var e=this._appKey+":"+this._appSecret;return"function"==typeof btoa?btoa(e):new Buffer(e).toString("base64")},t.prototype._authHeader=function(){var e=this._auth.accessToken();return this._auth.tokenType()+(e?" "+e:"")},t}(a["default"]);t["default"]=d,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t,n){r(this,e),this._cache=t,this._cacheId=n}return n(e,null,[{key:"refreshHandicapMs",value:6e4,enumerable:!0},{key:"forcedTokenType",value:"forced",enumerable:!0}]),e.prototype.accessToken=function(){return this.data().access_token},e.prototype.refreshToken=function(){return this.data().refresh_token},e.prototype.tokenType=function(){return this.data().token_type},e.prototype.data=function(){return this._cache.getItem(this._cacheId)||{token_type:"",access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}},e.prototype.setData=function(e){e=e||{};
var t=this.data();return Object.keys(e).forEach(function(r){t[r]=e[r]}),t.expire_time=Date.now()+1e3*t.expires_in,t.refresh_token_expire_time=Date.now()+1e3*t.refresh_token_expires_in,this._cache.setItem(this._cacheId,t),this},e.prototype.accessTokenValid=function(){var t=this.data();return t.token_type===e.forcedTokenType||t.expire_time-e.refreshHandicapMs>Date.now()},e.prototype.refreshTokenValid=function(){return this.data().refresh_token_expire_time>Date.now()},e.prototype.cancelAccessToken=function(){return this.setData({access_token:"",expires_in:0})},e.prototype.forceAuthentication=function(){return this.setData({token_type:e.forcedTokenType,access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}),this},e.prototype.setRemember=function(e){return this.setData({remember:e})},e.prototype.remember=function(){return!!this.data().remember},e}();t["default"]=o,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var s=r(19),i=n(s),u=r(3),a=function(){function e(){o(this,e),this.crypto_obj=u.PUBNUB.crypto_obj}return e.prototype.init=function(e){return new i["default"](e)},e}();t["default"]=a,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(8),u=n(i),a=r(3),c=function(e){function t(r){o(this,t),e.call(this),this.options=r,this.crypto_obj=a.PUBNUB.crypto_obj}return s(t,e),t.prototype.ready=function(){},t.prototype.subscribe=function(e){this.on("message-"+e.channel,e.message)},t.prototype.unsubscribe=function(e){this.off("message-"+e.channel)},t.prototype.receiveMessage=function(e,t){this.emit("message-"+t,e,"env",t)},t}(u["default"]);t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(8),a=n(u),c=r(10),p=(n(c),r(2)),l=function(e){function t(r,n){o(this,t),e.call(this),this.events={notification:"notification",removeSuccess:"removeSuccess",removeError:"removeError",renewSuccess:"renewSuccess",renewError:"renewError",subscribeSuccess:"subscribeSuccess",subscribeError:"subscribeError"},this._pubnubFactory=r,this._platform=n,this._pubnub=null,this._timeout=null,this._subscription={}}return s(t,e),i(t,null,[{key:"_renewHandicapMs",value:12e4,enumerable:!0},{key:"_pollInterval",value:1e4,enumerable:!0}]),t.prototype.subscribed=function(){return!!(this._subscription.id&&this._subscription.deliveryMode&&this._subscription.deliveryMode.subscriberKey&&this._subscription.deliveryMode.address)},t.prototype.alive=function(){return this.subscribed()&&Date.now()<this.expirationTime()},t.prototype.expirationTime=function(){return new Date(this._subscription.expirationTime||0).getTime()-t._renewHandicapMs},t.prototype.setSubscription=function(e){return e=e||{},this._clearTimeout(),this._subscription=e,this._pubnub||this._subscribeAtPubnub(),this._setTimeout(),this},t.prototype.subscription=function(){return this._subscription},t.prototype.register=function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alive()){e.next=6;break}return e.next=3,regeneratorRuntime.awrap(this.renew());case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,regeneratorRuntime.awrap(this.subscribe());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},null,this)},t.prototype.eventFilters=function(){return this._subscription.eventFilters||[]},t.prototype.addEventFilters=function(e){return this.setEventFilters(this.eventFilters().concat(e)),this},t.prototype.setEventFilters=function(e){return this._subscription.eventFilters=e,this},t.prototype.subscribe=function(){var e,t;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,this._clearTimeout(),this.eventFilters().length){r.next=4;break}throw new Error("Events are undefined");case 4:return r.next=6,regeneratorRuntime.awrap(this._platform.post("/restapi/v1.0/subscription",{eventFilters:this._getFullEventFilters(),deliveryMode:{transportType:"PubNub"}}));case 6:return e=r.sent,t=e.json(),this.setSubscription(t).emit(this.events.subscribeSuccess,e),r.abrupt("return",e);case 12:throw r.prev=12,r.t0=r["catch"](0),r.t0=this._platform.client().makeError(r.t0),this.reset().emit(this.events.subscribeError,r.t0),r.t0;case 17:case"end":return r.stop()}},null,this,[[0,12]])},t.prototype.renew=function(){var e,t;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,this._clearTimeout(),this.alive()){r.next=4;break}throw new Error("Subscription is not alive");case 4:if(this.eventFilters().length){r.next=6;break}throw new Error("Events are undefined");case 6:return r.next=8,regeneratorRuntime.awrap(this._platform.put("/restapi/v1.0/subscription/"+this._subscription.id,{eventFilters:this._getFullEventFilters()}));case 8:return e=r.sent,t=e.json(),this.setSubscription(t).emit(this.events.renewSuccess,e),r.abrupt("return",e);case 14:throw r.prev=14,r.t0=r["catch"](0),r.t0=this._platform.client().makeError(r.t0),this.reset().emit(this.events.renewError,r.t0),r.t0;case 19:case"end":return r.stop()}},null,this,[[0,14]])},t.prototype.remove=function(){var e;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.subscribed()){t.next=3;break}throw new Error("No subscription");case 3:return t.next=5,regeneratorRuntime.awrap(this._platform["delete"]("/restapi/v1.0/subscription/"+this._subscription.id));case 5:return e=t.sent,this.reset().emit(this.events.removeSuccess,e),t.abrupt("return",e);case 10:throw t.prev=10,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.emit(this.events.removeError,t.t0),t.t0;case 15:case"end":return t.stop()}},null,this,[[0,10]])},t.prototype.resubscribe=function(){return this.reset().setEventFilters(this.eventFilters()).subscribe()},t.prototype.reset=function(){return this._clearTimeout(),this.subscribed()&&this._pubnub&&this._pubnub.unsubscribe({channel:this._subscription.deliveryMode.address}),this._subscription={},this},t.prototype._getFullEventFilters=function(){var e=this;return this.eventFilters().map(function(t){return e._platform.createUrl(t)})},t.prototype._setTimeout=function(){var e=this;if(this._clearTimeout(),!this.alive())throw new Error("Subscription is not alive");return p.poll(function(t){return e.alive()?t():void e.renew()},t._pollInterval,this._timeout),this},t.prototype._clearTimeout=function(){return p.stopPolling(this._timeout),this},t.prototype._decrypt=function(e){if(!this.subscribed())throw new Error("No subscription");if(this._subscription.deliveryMode.encryptionKey){var t=this._pubnubFactory;e=t.crypto_obj.decrypt(e,this._subscription.deliveryMode.encryptionKey,{encryptKey:!1,keyEncoding:"base64",keyLength:128,mode:"ecb"})}return e},t.prototype._notify=function(e){return this.emit(this.events.notification,this._decrypt(e)),this},t.prototype._subscribeAtPubnub=function(){if(!this.alive())throw new Error("Subscription is not alive");var e=this._pubnubFactory;return this._pubnub=e.init({ssl:!0,subscribe_key:this._subscription.deliveryMode.subscriberKey}),this._pubnub.ready(),this._pubnub.subscribe({channel:this._subscription.deliveryMode.address,message:this._notify.bind(this),connect:function(){}}),this},t}(a["default"]);t["default"]=l,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=r(20),a=n(u),c=r(9),p=n(c),l=function(e){function t(r,n,s,u){var a=this;o(this,t),e.call(this,r,n),this._cache=s,this._cacheKey=u,this._renewQueue=new p["default"](this._cache,u+"-renew"),this._resubscribeQueue=new p["default"](this._cache,u+"-resubscribe"),this.events=i({},this.events,{queuedRenewSuccess:"queuedRenewSuccess",queuedRenewError:"queuedRenewError",queuedResubscribeSuccess:"queuedResubscribeSuccess",queuedResubscribeError:"queuedResubscribeError"}),this.on(this.events.renewError,function(){a.resubscribe()}),this.on([this.events.subscribeSuccess,this.events.renewSuccess],function(){a._cache.setItem(a._cacheKey,a.subscription())}),this.on(this.events.removeSuccess,function(){a._cache.removeItem(a._cacheKey)})}return s(t,e),t.prototype._queue=function(e,t,r,n,o){var s;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!t.isPaused()){i.next=8;break}return i.next=4,regeneratorRuntime.awrap(t.poll());case 4:if(this.alive()){i.next=6;break}throw new Error(o);case 6:return this.emit(r,null),i.abrupt("return",null);case 8:return t.pause(),i.next=11,regeneratorRuntime.awrap(e.call(this));case 11:return s=i.sent,t.resume(),this.emit(r,s),i.abrupt("return",s);case 17:throw i.prev=17,i.t0=i["catch"](0),this.emit(n,i.t0),i.t0;case 21:case"end":return i.stop()}},null,this,[[0,17]])},t.prototype.renew=function(){return this._queue(e.prototype.renew,this._renewQueue,this.events.queuedRenewSuccess,this.events.queuedRenewError,"Subscription is not alive after renew timeout")},t.prototype.resubscribe=function(){return this._queue(e.prototype.resubscribe,this._resubscribeQueue,this.events.queuedResubscribeSuccess,this.events.queuedResubscribeError,"Subscription is not alive after resubscribe timeout")},t.prototype.restore=function(e){var t=this._cache.getItem(this._cacheKey);if(t)try{this.setSubscription(t)}catch(r){}else this.setEventFilters(e);return this},t}(a["default"]);t["default"]=l,e.exports=t["default"]},function(e,t){(function(t){!function(t){"use strict";function r(e,t,r,n){var s=Object.create((t||o).prototype),i=new h(n||[]);return s._invoke=p(e,r,i),s}function n(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}function o(){}function s(){}function i(){}function u(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(e){this.arg=e}function c(e){function t(t,r){var n=e[t](r),i=n.value;return i instanceof a?Promise.resolve(i.arg).then(o,s):Promise.resolve(i).then(function(e){return n.value=e,n})}function r(e,r){function o(){return t(e,r)}return n=n?n.then(o,o):new Promise(function(e){e(o())})}"object"==typeof process&&process.domain&&(t=process.domain.bind(t));var n,o=t.bind(e,"next"),s=t.bind(e,"throw");t.bind(e,"return");this._invoke=r}function p(e,t,r){var o=g;return function(s,i){if(o===k)throw new Error("Generator is already running");if(o===E){if("throw"===s)throw i;return y()}for(;;){var u=r.delegate;if(u){if("return"===s||"throw"===s&&u.iterator[s]===_){r.delegate=null;var a=u.iterator["return"];if(a){var c=n(a,u.iterator,i);if("throw"===c.type){s="throw",i=c.arg;continue}}if("return"===s)continue}var c=n(u.iterator[s],u.iterator,i);if("throw"===c.type){r.delegate=null,s="throw",i=c.arg;continue}s="next",i=_;var p=c.arg;if(!p.done)return o=x,p;r[u.resultName]=p.value,r.next=u.nextLoc,r.delegate=null}if("next"===s)o===x?r.sent=i:r.sent=_;else if("throw"===s){if(o===g)throw o=E,i;r.dispatchException(i)&&(s="next",i=_)}else"return"===s&&r.abrupt("return",i);o=k;var c=n(e,t,r);if("normal"===c.type){o=r.done?E:x;var p={value:c.arg,done:r.done};if(c.arg!==T)return p;r.delegate&&"next"===s&&(i=_)}else"throw"===c.type&&(o=E,s="throw",i=c.arg)}}}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function f(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset(!0)}function d(e){if(e){var t=e[m];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function o(){for(;++r<e.length;)if(b.call(e,r))return o.value=e[r],o.done=!1,o;return o.value=_,o.done=!0,o};return n.next=n}}return{next:y}}function y(){return{value:_,done:!0}}var _,b=Object.prototype.hasOwnProperty,m="function"==typeof Symbol&&Symbol.iterator||"@@iterator",v="object"==typeof e,w=t.regeneratorRuntime;if(w)return void(v&&(e.exports=w));w=t.regeneratorRuntime=v?e.exports:{},w.wrap=r;var g="suspendedStart",x="suspendedYield",k="executing",E="completed",T={},R=i.prototype=o.prototype;s.prototype=R.constructor=i,i.constructor=s,s.displayName="GeneratorFunction",w.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===s||"GeneratorFunction"===(t.displayName||t.name):!1},w.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):e.__proto__=i,e.prototype=Object.create(R),e},w.awrap=function(e){return new a(e)},u(c.prototype),w.async=function(e,t,n,o){var s=new c(r(e,t,n,o));return w.isGeneratorFunction(t)?s:s.next().then(function(e){return e.done?e.value:s.next()})},u(R),R[m]=function(){return this},R.toString=function(){return"[object Generator]"},w.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},w.values=d,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=_,this.done=!1,this.delegate=null,this.tryEntries.forEach(f),!e)for(var t in this)"t"===t.charAt(0)&&b.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=_)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return s.type="throw",s.arg=e,r.next=t,!!n}if(this.done)throw e;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=b.call(o,"catchLoc"),u=b.call(o,"finallyLoc");if(i&&u){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&b.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?this.next=o.finallyLoc:this.complete(s),T},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),f(r),T}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;f(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:d(e),resultName:t,nextLoc:r},T}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,function(){return this}())}])});
//# sourceMappingURL=ringcentral.min.js.map
