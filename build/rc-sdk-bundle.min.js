!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(function(){try{return require("xhr2")}catch(t){}}(),require("dom-storage")):"function"==typeof define&&define.amd?define(["empty:","empty:"],e):"object"==typeof exports?exports.RCSDK=e(function(){try{return require("xhr2")}catch(t){}}(),require("dom-storage")):t.RCSDK=e(t.XMLHttpRequest,t.localStorage)}(this,function(__WEBPACK_EXTERNAL_MODULE_1__,__WEBPACK_EXTERNAL_MODULE_2__){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r=n(8),i=n(4),o=n(3);n(5),n(6);var s=n(7),a="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(r){}try{return n(1)}catch(r){}throw new Error("This browser does not support XMLHttpRequest.")};e=t.exports=o.factory({CryptoJS:s,localStorage:"undefined"!=typeof localStorage?localStorage:n(2),Promise:"undefined"!=typeof Promise?Promise:r.Promise,PUBNUB:i,XHR:a})},function(t){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_1__){var e=new Error('Cannot find module "undefined"');throw e.code="MODULE_NOT_FOUND",e}t.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(t){t.exports=__WEBPACK_EXTERNAL_MODULE_2__},function(t,e,n){function r(t){if(!(t&&"CryptoJS"in t&&"localStorage"in t&&"Promise"in t&&"PUBNUB"in t&&"XHR"in t))throw new Error("Injections object is not complete");return R.setInjections(t)}var i=n(9),o=n(10),s=n(11),a=n(12),u=n(13),c=n(14),f=n(15),p=n(16),l=n(17),h=n(18),d=n(19),y=n(20),g=n(21),v=n(22),m=n(23),b=n(24),_=n(25),S=n(26),w=n(27),x=n(28),E=n(29),C=n(30),k=n(31),P=n(32),A=n(33),O=n(34),T=n(35),M=n(36),F=n(37),I=n(38),D=n(39),N=n(40),H=n(41),B=n(42),R=function(){function t(e){e=e||{},this._context=a.$get(t.injections),this.getCache().setPrefix(e.cachePrefix||""),this.getPlatform().setServer(e.server||"").setCredentials(e.appKey||"",e.appSecret||"")}return t.setInjections=function(t){return this.injections=t,this},t.prototype.getContext=function(){return this._context},t.prototype.getAjaxObserver=function(){return o.$get(this.getContext())},t.prototype.getXhrResponse=function(){return i.$get(this.getContext())},t.prototype.getPlatform=function(){return h.$get(this.getContext())},t.prototype.getCache=function(){return s.$get(this.getContext())},t.prototype.getSubscription=function(){return d.$get(this.getContext())},t.prototype.getPageVisibility=function(){return l.$get(this.getContext())},t.prototype.getHelper=function(){return u.$get(this.getContext())},t.prototype.getObservable=function(){return p.$get(this.getContext())},t.prototype.getValidator=function(){return g.$get(this.getContext())},t.prototype.getLog=function(){return f.$get(this.getContext())},t.prototype.getUtils=function(){return y.$get(this.getContext())},t.prototype.getList=function(){return c.$get(this.getContext())},t.prototype.getCountryHelper=function(){return x.$get(this.getContext())},t.prototype.getDeviceModelHelper=function(){return C.$get(this.getContext())},t.prototype.getLanguageHelper=function(){return A.$get(this.getContext())},t.prototype.getLocationHelper=function(){return O.$get(this.getContext())},t.prototype.getShippingMethodHelper=function(){return N.$get(this.getContext())},t.prototype.getStateHelper=function(){return H.$get(this.getContext())},t.prototype.getTimezoneHelper=function(){return B.$get(this.getContext())},t.prototype.getAccountHelper=function(){return v.$get(this.getContext())},t.prototype.getBlockedNumberHelper=function(){return m.$get(this.getContext())},t.prototype.getCallHelper=function(){return b.$get(this.getContext())},t.prototype.getConferencingHelper=function(){return w.$get(this.getContext())},t.prototype.getContactHelper=function(){return _.$get(this.getContext())},t.prototype.getContactGroupHelper=function(){return S.$get(this.getContext())},t.prototype.getDeviceHelper=function(){return E.$get(this.getContext())},t.prototype.getExtensionHelper=function(){return k.$get(this.getContext())},t.prototype.getForwardingNumberHelper=function(){return P.$get(this.getContext())},t.prototype.getMessageHelper=function(){return T.$get(this.getContext())},t.prototype.getPhoneNumberHelper=function(){return M.$get(this.getContext())},t.prototype.getPresenceHelper=function(){return F.$get(this.getContext())},t.prototype.getRingoutHelper=function(){return I.$get(this.getContext())},t.prototype.getServiceHelper=function(){return D.$get(this.getContext())},t.version="1.2.1",t}();e.RCSDK=R,e.factory=r},function(module,exports,__webpack_require__){(function(module){function unique(){return"x"+ ++NOW+ +new Date}function rnow(){return+new Date}function build_url(t,e){var n=t.join(URLBIT),r=[];return e?(each(e,function(t,e){var n="object"==typeof e?JSON.stringify(e):e;"undefined"!=typeof e&&null!=e&&encode(n).length>0&&r.push(t+"="+encode(n))}),n+="?"+r.join(PARAMSBIT)):n}function updater(t,e){var n,r=0,i=function(){r+e>rnow()?(clearTimeout(n),n=setTimeout(i,e)):(r=rnow(),t())};return i}function grep(t,e){var n=[];return each(t||[],function(t){e(t)&&n.push(t)}),n}function supplant(t,e){return t.replace(REPL,function(t,n){return e[n]||t})}function timeout(t,e){return setTimeout(t,e)}function generate_uuid(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)});return t&&t(e),e}function isArray(t){return!!t&&"string"!=typeof t&&(Array.isArray&&Array.isArray(t)||"number"==typeof t.length)}function each(t,e){if(t&&e)if(isArray(t))for(var n=0,r=t.length;r>n;)e.call(t[n],t[n],n++);else for(var n in t)t.hasOwnProperty&&t.hasOwnProperty(n)&&e.call(t[n],n,t[n])}function map(t,e){var n=[];return each(t||[],function(t,r){n.push(e(t,r))}),n}function encode(t){return encodeURIComponent(t)}function generate_channel_list(t,e){var n=[];return each(t,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function generate_channel_group_list(t,e){var n=[];return each(t,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function ready(){timeout(function(){READY||(READY=1,each(READY_BUFFER,function(t){t()}))},SECOND)}function PNmessage(t){return msg=t||{apns:{}},msg.getPubnubMessage=function(){var t={};if(Object.keys(msg.apns).length){t.pn_apns={aps:{alert:msg.apns.alert,badge:msg.apns.badge}};for(var e in msg.apns)t.pn_apns[e]=msg.apns[e];var n=["badge","alert"];for(var e in n)delete t.pn_apns[n[e]]}msg.gcm&&(t.pn_gcm={data:msg.gcm});for(var e in msg)t[e]=msg[e];var r=["apns","gcm","publish","channel","callback","error"];for(var e in r)delete t[r[e]];return t},msg.publish=function(){var t=msg.getPubnubMessage();msg.pubnub&&msg.channel&&msg.pubnub.publish({message:t,channel:msg.channel,callback:msg.callback,error:msg.error})},msg}function PN_API(t){function e(t){return t||(t={}),each(oe,function(e,n){e in t||(t[e]=n)}),t}function r(t){var e=[];return each(t,function(t){e.push(t)}),e}function i(t){return r(t).sort()}function o(t){var e="",n=i(t);for(var r in n){var o=n[r];e+=o+"="+encode(t[o]),r!=n.length-1&&(e+="&")}return e}function s(t,e,n){var r=!1;if("undefined"==typeof t)return e;if("number"==typeof t)r=t>PRESENCE_HB_THRESHOLD||0==t?!1:!0;else{if("boolean"==typeof t)return t?PRESENCE_HB_DEFAULT:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+PRESENCE_HB_THRESHOLD+" or x = 0). Current Value : "+(e||PRESENCE_HB_THRESHOLD)),e||PRESENCE_HB_THRESHOLD):t}function a(t,e){return de.encrypt(t,e||fe)||t}function u(t,e){return de.decrypt(t,e||fe)||de.decrypt(t,fe)||t}function c(){return clearTimeout(Q),!te||te>=500||1>te||!generate_channel_list(G,!0).length&&!generate_channel_group_list(W,!0).length?void(ee=!1):(ee=!0,void ye.presence_heartbeat({callback:function(){Q=timeout(c,te*SECOND)},error:function(t){se&&se("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(t)),Q=timeout(c,te*SECOND)}}))}function f(){!ee&&c()}function p(t){if(ne){if(!U.length)return}else{if(t&&(U.sending=0),U.sending||!U.length)return;U.sending=1}ie(U.shift())}function l(t){var e=0;return each(generate_channel_group_list(W),function(n){var r=W[n];r&&(e++,(t||function(){})(r))}),e}function h(t){var e=0;return each(generate_channel_list(G),function(n){var r=G[n];r&&(e++,(t||function(){})(r))}),e}function d(t,e,n){if("object"==typeof t){if(t.error){var r={};return t.message&&(r.message=t.message),t.payload&&(r.payload=t.payload),void(n&&n(r))}if(t.payload)return void(t.next_page?e&&e(t.payload,t.next_page):e&&e(t.payload))}e&&e(t)}function y(t,e){if("object"==typeof t&&t.error){var n={};return t.message&&(n.message=t.message),t.payload&&(n.payload=t.payload),void(e&&e(n))}e&&e(t)}function g(t,n,r,i){var n=t.callback||n,o=t.error||se,s=ue();i=i||{},i.auth||(i.auth=t.auth_key||F);var a=[B,"v1","channel-registration","sub-key",M];a.push.apply(a,r),s&&(i.callback=s),ie({callback:s,data:e(i),success:function(t){d(t,n,o)},fail:function(t){y(t,o)},url:a})}function v(){ae()||b(1,{error:"Offline. Please check your network settings. "}),w&&clearTimeout(w),w=timeout(v,SECOND)}function m(){A&&ye.time(function(t){S(function(){},t),t||b(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),x&&clearTimeout(x),x=timeout(m,P)})}function b(t,e){K&&K(t,e),K=null,clearTimeout(w),clearTimeout(x)}function _(t){var e=rnow()-L;return e-t/1e4}function S(t,e){function n(e){if(e){var n=e/1e4,i=(rnow()-r)/2;L=rnow()-(n+i),t&&t(L)}}var r=rnow();e&&n(e)||ye.time(n)}var w,x,E=+t.windowing||DEF_WINDOWING,C=(+t.timeout||DEF_SUB_TIMEOUT)*SECOND,P=(+t.keepalive||DEF_KEEPALIVE)*SECOND,A=t.timecheck||0,O=t.noleave||0,T=t.publish_key||"demo",M=t.subscribe_key||"demo",F=t.auth_key||"",I=t.secret_key||"",D=t.hmac_SHA256,N=t.ssl?"s":"",H="http"+N+"://"+(t.origin||"pubsub.pubnub.com"),B=nextorigin(H),R=nextorigin(H),j=function(){},U=[],$=!0,L=0,q=0,z=0,K=0,V=t.restore||0,X=0,J=!1,G={},W={},Y={},Q=null,Z=s(t.heartbeat||t.pnexpires||0,t.error),te=t.heartbeat_interval||Z/2-1,ee=!1,ne=t.no_wait_for_pending,re=t["compatible_3.5"]||!1,ie=t.xdr,oe=t.params||{},se=t.error||function(){},ae=t._is_online||function(){return 1},ue=t.jsonp_cb||function(){return 0},ce=t.db||{get:function(){},set:function(){}},fe=t.cipher_key,pe=t.uuid||!t.unique_uuid&&ce&&ce.get(M+"uuid")||"",le=t.instance_id||!1,he="";2===Z&&(te=1);var de=t.crypto_obj||{encrypt:function(t){return t},decrypt:function(t){return t}},ye={LEAVE:function(t,n,r,i,o){var s={uuid:pe,auth:r||F},a=nextorigin(H),i=i||function(){},u=o||function(){},c=ue();if(t.indexOf(PRESENCE_SUFFIX)>0)return!0;if(re){if(!N)return!1;if("0"==c)return!1}return O?!1:("0"!=c&&(s.callback=c),le&&(s.instanceid=he),ie({blocking:n||N,timeout:2e3,callback:c,data:e(s),success:function(t){d(t,i,u)},fail:function(t){y(t,u)},url:[a,"v2","presence","sub_key",M,"channel",encode(t),"leave"]}),!0)},LEAVE_GROUP:function(t,n,r,i,o){var s={uuid:pe,auth:r||F},a=nextorigin(H),i=i||function(){},u=o||function(){},c=ue();if(t.indexOf(PRESENCE_SUFFIX)>0)return!0;if(re){if(!N)return!1;if("0"==c)return!1}return O?!1:("0"!=c&&(s.callback=c),t&&t.length>0&&(s["channel-group"]=t),le&&(s.instanceid=he),ie({blocking:n||N,timeout:5e3,callback:c,data:e(s),success:function(t){d(t,i,u)},fail:function(t){y(t,u)},url:[a,"v2","presence","sub_key",M,"channel",encode(","),"leave"]}),!0)},set_resumed:function(t){J=t},get_cipher_key:function(){return fe},set_cipher_key:function(t){fe=t},raw_encrypt:function(t,e){return a(t,e)},raw_decrypt:function(t,e){return u(t,e)},get_heartbeat:function(){return Z},set_heartbeat:function(t,e){Z=s(t,Z,se),te=e||Z/2-1,2==Z&&(te=1),j(),c()},get_heartbeat_interval:function(){return te},set_heartbeat_interval:function(t){te=t,c()},get_version:function(){return SDK_VER},getGcmMessageObject:function(t){return{data:t}},getApnsMessageObject:function(t){var e={aps:{badge:1,alert:""}};for(k in t)k[e]=t[k];return e},newPnMessage:function(){var t={};gcm&&(t.pn_gcm=gcm),apns&&(t.pn_apns=apns);for(k in n)t[k]=n[k];return t},_add_param:function(t,e){oe[t]=e},channel_group:function(t,e){var n,r,i=t.channel_group,e=e||t.callback,o=t.channels||t.channel,s=t.cloak,a=[],u={},c=t.mode||"add";if(i){var f=i.split(":");f.length>1?(n="*"===f[0]?null:f[0],r=f[1]):r=f[0]}n&&a.push("namespace")&&a.push(encode(n)),a.push("channel-group"),r&&"*"!==r&&a.push(r),o?(isArray(o)&&(o=o.join(",")),u[c]=o,u.cloak=$?"true":"false"):"remove"===c&&a.push("remove"),"undefined"!=typeof s&&(u.cloak=s?"true":"false"),g(t,e,a,u)},channel_group_list_groups:function(t,e){var n;n=t.namespace||t.ns||t.channel_group||null,n&&(t.channel_group=n+":*"),ye.channel_group(t,e)},channel_group_list_channels:function(t,e){return t.channel_group?void ye.channel_group(t,e):se("Missing Channel Group")},channel_group_remove_channel:function(t,e){return t.channel_group?t.channel||t.channels?(t.mode="remove",void ye.channel_group(t,e)):se("Missing Channel"):se("Missing Channel Group")},channel_group_remove_group:function(t,e){return t.channel_group?t.channel?se("Use channel_group_remove_channel if you want to remove a channel from a group."):(t.mode="remove",void ye.channel_group(t,e)):se("Missing Channel Group")},channel_group_add_channel:function(t,e){return t.channel_group?t.channel||t.channels?void ye.channel_group(t,e):se("Missing Channel"):se("Missing Channel Group")},channel_group_cloak:function(t,e){return"undefined"==typeof t.cloak?void e($):($=t.cloak,void ye.channel_group(t,e))},channel_group_list_namespaces:function(t,e){var n=["namespace"];g(t,e,n)},channel_group_remove_namespace:function(t,e){var n=["namespace",t.namespace,"remove"];g(t,e,n)},history:function(t,n){var n=t.callback||n,r=t.count||t.limit||100,i=t.reverse||"false",o=t.error||function(){},s=t.auth_key||F,a=t.cipher_key,c=t.channel,f=t.channel_group,p=t.start,l=t.end,h=t.include_token,d={},g=ue();return c||f?n?M?(d.stringtoken="true",d.count=r,d.reverse=i,d.auth=s,f&&(d["channel-group"]=f,c||(c=",")),g&&(d.callback=g),p&&(d.start=p),l&&(d.end=l),h&&(d.include_token="true"),void ie({callback:g,data:e(d),success:function(t){if("object"==typeof t&&t.error)return void o({message:t.message,payload:t.payload});for(var e=t[0],r=[],i=0;i<e.length;i++){var s=u(e[i],a);try{r.push(JSON.parse(s))}catch(c){r.push(s)}}n([r,t[1],t[2]])},fail:function(t){y(t,o)},url:[B,"v2","history","sub-key",M,"channel",encode(c)]})):se("Missing Subscribe Key"):se("Missing Callback"):se("Missing Channel")},replay:function(t,n){var r,n=n||t.callback||function(){},i=t.auth_key||F,o=t.source,s=t.destination,a=t.stop,u=t.start,c=t.end,f=t.reverse,p=t.limit,l=ue(),h={};return o?s?T?M?("0"!=l&&(h.callback=l),a&&(h.stop="all"),f&&(h.reverse="true"),u&&(h.start=u),c&&(h.end=c),p&&(h.count=p),h.auth=i,r=[B,"v1","replay",T,M,o,s],void ie({callback:l,success:function(t){d(t,n,err)},fail:function(){n([0,"Disconnected"])},url:r,data:e(h)})):se("Missing Subscribe Key"):se("Missing Publish Key"):se("Missing Destination Channel"):se("Missing Source Channel")},auth:function(t){F=t,j()},time:function(t){var n=ue(),r={uuid:pe,auth:F};le&&(r.instanceid=he),ie({callback:n,data:e(r),timeout:5*SECOND,url:[B,"time",n],success:function(e){t(e[0])},fail:function(){t(0)}})},publish:function(t,n){var r=t.message;if(!r)return se("Missing Message");var i,n=n||t.callback||r.callback||function(){},o=t.channel||r.channel,s=t.auth_key||F,u=t.cipher_key,c=t.error||r.error||function(){},f=t.post||!1,l="store_in_history"in t?t.store_in_history:!0,h=ue(),g="push";return t.prepend&&(g="unshift"),o?T?M?(r.getPubnubMessage&&(r=r.getPubnubMessage()),r=JSON.stringify(a(r,u)),i=[B,"publish",T,M,0,encode(o),h,encode(r)],oe={uuid:pe,auth:s},l||(oe.store="0"),le&&(oe.instanceid=he),U[g]({callback:h,timeout:5*SECOND,url:i,data:e(oe),fail:function(t){y(t,c),p(1)},success:function(t){d(t,n,c),p(1)},mode:f?"POST":"GET"}),void p()):se("Missing Subscribe Key"):se("Missing Publish Key"):se("Missing Channel")},unsubscribe:function(t,e){var n=t.channel,r=t.channel_group,i=t.auth_key||F,e=e||t.callback||function(){},o=t.error||function(){};X=0,n&&(n=map((n.join?n.join(","):""+n).split(","),function(t){return G[t]?t+","+t+PRESENCE_SUFFIX:void 0}).join(","),each(n.split(","),function(t){var n=!0;t&&(G[t]=0,t in Y&&delete Y[t],READY&&(n=ye.LEAVE(t,0,i,e,o)),n||e({action:"leave"}))})),r&&(r=map((r.join?r.join(","):""+r).split(","),function(t){return W[t]?t+","+t+PRESENCE_SUFFIX:void 0}).join(","),each(r.split(","),function(t){var n=!0;t&&(W[t]=0,t in Y&&delete Y[t],READY&&(n=ye.LEAVE_GROUP(t,0,i,e,o)),n||e({action:"leave"}))})),j()},subscribe:function(t,n){function r(t){t?timeout(j,SECOND):(B=nextorigin(H,1),R=nextorigin(H,1),timeout(function(){ye.time(r)},SECOND)),h(function(e){return t&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(t||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))}),l(function(e){return t&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(t||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))})}function i(){var t=ue(),n=generate_channel_list(G).join(","),o=generate_channel_group_list(W).join(",");if(n||o){n||(n=","),b();var s=e({uuid:pe,auth:a});o&&(s["channel-group"]=o);var c=JSON.stringify(Y);c.length>2&&(s.state=JSON.stringify(Y)),Z&&(s.heartbeat=Z),le&&(s.instanceid=he),f(),K=ie({timeout:k,callback:t,fail:function(t){t&&t.error&&t.service?(y(t,g),r(1)):ye.time(function(e){!e&&y(t,g),r(e)})},data:e(s),url:[R,"subscribe",M,encode(n),t,X],success:function(t){if(!t||"object"==typeof t&&"error"in t&&t.error)return g(t.error),timeout(j,SECOND);if(v(t[1]),X=!X&&V&&ce.get(M)||t[1],h(function(t){t.connected||(t.connected=1,t.connect(t.name))}),l(function(t){t.connected||(t.connected=1,t.connect(t.name))}),J&&!V)return X=0,J=!1,ce.set(M,0),void timeout(i,P);w&&(X=1e4,w=0),ce.set(M,t[1]);var e=function(){var e="",n="";t.length>3?(e=t[3],n=t[2]):e=t.length>2?t[2]:map(generate_channel_list(G),function(e){return map(Array(t[0].length).join(",").split(","),function(){return e})}).join(",");var r=e.split(","),i=n?n.split(","):[];return function(){var t=r.shift()||z,e=i.shift(),n={};e?(t&&t.indexOf("-pnpres")>=0&&e.indexOf("-pnpres")<0&&(e+="-pnpres"),n=W[e]||G[e]||{callback:function(){}}):n=G[t];var o=[n.callback||q,t.split(PRESENCE_SUFFIX)[0]];return e&&o.push(e.split(PRESENCE_SUFFIX)[0]),o}}(),n=_(+t[1]);each(t[0],function(r){var i=e(),o=u(r,G[i[1]]?G[i[1]].cipher_key:null);i[0]&&i[0](o,t,i[2]||i[1],n,i[1])}),timeout(i,P)}})}}var o=t.channel,s=t.channel_group,n=n||t.callback,n=n||t.message,a=t.auth_key||F,c=t.connect||function(){},p=t.reconnect||function(){},d=t.disconnect||function(){},g=t.error||g||function(){},v=t.idle||function(){},m=t.presence||0,S=t.noheresync||0,w=t.backfill||0,x=t.timetoken||0,k=t.timeout||C,P=t.windowing||E,A=t.state,O=t.heartbeat||t.pnexpires,T=t.heartbeat_interval,I=t.restore||V;return V=I,X=x,o||s?n?M?((O||0===O||T||0===T)&&ye.set_heartbeat(O,T),o&&each((o.join?o.join(","):""+o).split(","),function(r){var i=G[r]||{};G[z=r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:q=n,cipher_key:t.cipher_key,connect:c,disconnect:d,reconnect:p},A&&(Y[r]=r in A?A[r]:A),m&&(ye.subscribe({channel:r+PRESENCE_SUFFIX,callback:m,restore:I}),i.subscribed||S||ye.here_now({channel:r,data:e({uuid:pe,auth:a}),callback:function(t){each("uuids"in t?t.uuids:[],function(e){m({action:"join",uuid:e,timestamp:Math.floor(rnow()/1e3),occupancy:t.occupancy||1},t,r)})}}))}),s&&each((s.join?s.join(","):""+s).split(","),function(r){var i=W[r]||{};W[r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:q=n,cipher_key:t.cipher_key,connect:c,disconnect:d,reconnect:p},m&&(ye.subscribe({channel_group:r+PRESENCE_SUFFIX,callback:m,restore:I,auth_key:a}),i.subscribed||S||ye.here_now({channel_group:r,data:e({uuid:pe,auth:a}),callback:function(t){each("uuids"in t?t.uuids:[],function(e){m({action:"join",uuid:e,timestamp:Math.floor(rnow()/1e3),occupancy:t.occupancy||1},t,r)})}}))}),j=function(){b(),timeout(i,P)},READY?void j():READY_BUFFER.push(j)):se("Missing Subscribe Key"):se("Missing Callback"):se("Missing Channel")},here_now:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.auth_key||F,o=t.channel,s=t.channel_group,a=ue(),u="uuids"in t?t.uuids:!0,c=t.state,f={uuid:pe,auth:i};if(u||(f.disable_uuids=1),c&&(f.state=1),!n)return se("Missing Callback");if(!M)return se("Missing Subscribe Key");var p=[B,"v2","presence","sub_key",M];o&&p.push("channel")&&p.push(encode(o)),"0"!=a&&(f.callback=a),s&&(f["channel-group"]=s,!o&&p.push("channel")&&p.push(",")),le&&(f.instanceid=he),ie({callback:a,data:e(f),success:function(t){d(t,n,r)},fail:function(t){y(t,r)},url:p})},where_now:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.auth_key||F,o=ue(),s=t.uuid||pe,a={auth:i};return n?M?("0"!=o&&(a.callback=o),le&&(a.instanceid=he),void ie({callback:o,data:e(a),success:function(t){d(t,n,r)},fail:function(t){y(t,r)},url:[B,"v2","presence","sub_key",M,"uuid",encode(s)]})):se("Missing Subscribe Key"):se("Missing Callback")},state:function(t,n){var r,n=t.callback||n||function(){},i=t.error||function(){},o=t.auth_key||F,s=ue(),a=t.state,u=t.uuid||pe,c=t.channel,f=t.channel_group,p=e({auth:o});return M?u?c||f?("0"!=s&&(p.callback=s),"undefined"!=typeof c&&G[c]&&G[c].subscribed&&a&&(Y[c]=a),"undefined"!=typeof f&&W[f]&&W[f].subscribed&&(a&&(Y[f]=a),p["channel-group"]=f,c||(c=",")),p.state=JSON.stringify(a),le&&(p.instanceid=he),r=a?[B,"v2","presence","sub-key",M,"channel",c,"uuid",u,"data"]:[B,"v2","presence","sub-key",M,"channel",c,"uuid",encode(u)],void ie({callback:s,data:e(p),success:function(t){d(t,n,i)},fail:function(t){y(t,i)},url:r})):se("Missing Channel"):se("Missing UUID"):se("Missing Subscribe Key")},grant:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.channel,s=t.channel_group,a=ue(),u=t.ttl,c=t.read?"1":"0",f=t.write?"1":"0",p=t.manage?"1":"0",l=t.auth_key;if(!n)return se("Missing Callback");if(!M)return se("Missing Subscribe Key");if(!T)return se("Missing Publish Key");if(!I)return se("Missing Secret Key");var h=Math.floor((new Date).getTime()/1e3),g=M+"\n"+T+"\ngrant\n",v={w:f,r:c,timestamp:h};t.manage&&(v.m=p),"undefined"!=typeof i&&null!=i&&i.length>0&&(v.channel=i),"undefined"!=typeof s&&null!=s&&s.length>0&&(v["channel-group"]=s),"0"!=a&&(v.callback=a),(u||0===u)&&(v.ttl=u),l&&(v.auth=l),v=e(v),l||delete v.auth,g+=o(v);var m=D(g,I);m=m.replace(/\+/g,"-"),m=m.replace(/\//g,"_"),v.signature=m,ie({callback:a,data:v,success:function(t){d(t,n,r)},fail:function(t){y(t,r)},url:[B,"v1","auth","grant","sub-key",M]})},mobile_gw_provision:function(t){var e,n=t.callback||function(){},r=t.auth_key||F,i=t.error||function(){},o=ue(),s=t.channel,a=t.op,u=t.gw_type,c=t.device_id;return c?u?a?s?T?M?(e=[B,"v1/push/sub-key",M,"devices",c],oe={uuid:pe,auth:r,type:u},"add"==a?oe.add=s:"remove"==a&&(oe.remove=s),le&&(data.instanceid=he),void ie({callback:o,data:oe,success:function(t){d(t,n,i)},fail:function(t){y(t,i)},url:e})):se("Missing Subscribe Key"):se("Missing Publish Key"):se("Missing gw destination Channel (channel)"):se("Missing GW Operation (op: add or remove)"):se("Missing GW Type (gw_type: gcm or apns)"):se("Missing Device ID (device_id)")},audit:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.channel,s=t.channel_group,a=t.auth_key,u=ue();if(!n)return se("Missing Callback");if(!M)return se("Missing Subscribe Key");if(!T)return se("Missing Publish Key");if(!I)return se("Missing Secret Key");var c=Math.floor((new Date).getTime()/1e3),f=M+"\n"+T+"\naudit\n",p={timestamp:c};"0"!=u&&(p.callback=u),"undefined"!=typeof i&&null!=i&&i.length>0&&(p.channel=i),"undefined"!=typeof s&&null!=s&&s.length>0&&(p["channel-group"]=s),a&&(p.auth=a),p=e(p),a||delete p.auth,f+=o(p);var l=D(f,I);l=l.replace(/\+/g,"-"),l=l.replace(/\//g,"_"),p.signature=l,ie({callback:u,data:p,success:function(t){d(t,n,r)},fail:function(t){y(t,r)},url:[B,"v1","auth","audit","sub-key",M]})},revoke:function(t,e){t.read=!1,t.write=!1,ye.grant(t,e)},set_uuid:function(t){pe=t,j()},get_uuid:function(){return pe},isArray:function(t){return isArray(t)},get_subscibed_channels:function(){return generate_channel_list(G,!0)},presence_heartbeat:function(t){var n=t.callback||function(){},r=t.error||function(){},i=ue(),o={uuid:pe,auth:F},s=JSON.stringify(Y);s.length>2&&(o.state=JSON.stringify(Y)),Z>0&&320>Z&&(o.heartbeat=Z),"0"!=i&&(o.callback=i);var a=encode(generate_channel_list(G,!0).join(",")),u=generate_channel_group_list(W,!0).join(",");a||(a=","),u&&(o["channel-group"]=u),le&&(o.instanceid=he),ie({callback:i,data:e(o),timeout:5*SECOND,url:[B,"v2","presence","sub-key",M,"channel",a,"heartbeat"],success:function(t){d(t,n,r)},fail:function(t){y(t,r)}})},stop_timers:function(){clearTimeout(w),clearTimeout(x)},xdr:ie,ready:ready,db:ce,uuid:generate_uuid,map:map,each:each,"each-channel":h,grep:grep,offline:function(){b(1,{message:"Offline. Please check your network settings."})},supplant:supplant,now:rnow,unique:unique,updater:updater};return pe||(pe=ye.uuid()),he||(he=ye.uuid()),ce.set(M+"uuid",pe),w=timeout(v,SECOND),x=timeout(m,P),Q=timeout(f,(te-3)*SECOND),S(),ye}function crypto_obj(){function t(t){function e(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n}function n(t,e){return t>>>e|t<<32-e}function r(t,e){return t>>>e}function i(t,e,n){return t&e^~t&n}function o(t,e,n){return t&e^t&n^e&n}function s(t){return n(t,2)^n(t,13)^n(t,22)}function a(t){return n(t,6)^n(t,11)^n(t,25)}function u(t){return n(t,7)^n(t,18)^r(t,3)}function c(t){return n(t,17)^n(t,19)^r(t,10)}function f(t,n){var r,f,p,l,h,d,y,g,v,m,b,_,S=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);t[n>>5]|=128<<24-n%32,t[(n+64>>9<<4)+15]=n;for(var v=0;v<t.length;v+=16){r=w[0],f=w[1],p=w[2],l=w[3],h=w[4],d=w[5],y=w[6],g=w[7];for(var m=0;64>m;m++)x[m]=16>m?t[m+v]:e(e(e(c(x[m-2]),x[m-7]),u(x[m-15])),x[m-16]),b=e(e(e(e(g,a(h)),i(h,d,y)),S[m]),x[m]),_=e(s(r),o(r,f,p)),g=y,y=d,d=h,h=e(l,b),l=p,p=f,f=r,r=e(b,_);w[0]=e(r,w[0]),w[1]=e(f,w[1]),w[2]=e(p,w[2]),w[3]=e(l,w[3]),w[4]=e(h,w[4]),w[5]=e(d,w[5]),w[6]=e(y,w[6]),w[7]=e(g,w[7])}return w}function p(t){for(var e=Array(),n=(1<<d)-1,r=0;r<t.length*d;r+=d)e[r>>5]|=(t.charCodeAt(r/d)&n)<<24-r%32;return e}function l(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);128>r?e+=String.fromCharCode(r):r>127&&2048>r?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}function h(t){for(var e=y?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*t.length;r++)n+=e.charAt(t[r>>2]>>8*(3-r%4)+4&15)+e.charAt(t[r>>2]>>8*(3-r%4)&15);return n}var d=8,y=0;return t=l(t),h(f(p(t),t.length*d))}var e=CRYPTO;e.size(256);var n=e.s2a("0123456789012345");return{encrypt:function(r,i){if(!i)return r;var o=e.s2a(t(i).slice(0,32)),s=e.s2a(JSON.stringify(r)),a=e.rawEncrypt(s,o,n),u=e.Base64.encode(a);return u||r},decrypt:function(r,i){if(!i)return r;var o=e.s2a(t(i).slice(0,32));try{var s=e.Base64.decode(r),a=e.rawDecrypt(s,o,n,!1),u=JSON.parse(a);return u}catch(c){return void 0}}}}window.JSON&&window.JSON.stringify||function(){function toJSON(){try{return this.valueOf()}catch(t){return null}}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,i,o,s,a=gap,u=e[t];switch(u&&"object"==typeof u&&(u=toJSON.call(u,t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(u)){for(o=u.length,n=0;o>n;n+=1)s[n]=str(n,u)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)r=rep[n],"string"==typeof r&&(i=str(r,u),i&&s.push(quote(r)+(gap?": ":":")+i));else for(r in u)Object.hasOwnProperty.call(u,r)&&(i=str(r,u),i&&s.push(quote(r)+(gap?": ":":")+i));return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,i}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")})}();var NOW=1,READY=!1,READY_BUFFER=[],PRESENCE_SUFFIX="-pnpres",DEF_WINDOWING=10,DEF_TIMEOUT=1e4,DEF_SUB_TIMEOUT=310,DEF_KEEPALIVE=60,SECOND=1e3,URLBIT="/",PARAMSBIT="&",PRESENCE_HB_THRESHOLD=5,PRESENCE_HB_DEFAULT=30,SDK_VER="3.7.10",REPL=/{([\w\-]+)}/g,nextorigin=function(){var t=20,e=Math.floor(Math.random()*t);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?generate_uuid().split("-")[0]:++e<t?e:e=1))||n}}(),CRYPTO=function(){var t=14,e=8,n=!1,r=function(t){try{return unescape(encodeURIComponent(t))}catch(e){throw"Error on UTF-8 encode"}},o=function(t){try{return decodeURIComponent(escape(t))}catch(e){throw"Bad Key"}},s=function(t){var e,n,r=[];for(t.length<16&&(e=16-t.length,r=[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]),n=0;n<t.length;n++)r[n]=t[n];return r},a=function(t,e){var n,r,i="";if(e){if(n=t[15],n>16)throw"Decryption error: Maybe bad key";if(16==n)return"";for(r=0;16-n>r;r++)i+=String.fromCharCode(t[r])}else for(r=0;16>r;r++)i+=String.fromCharCode(t[r]);return i},u=function(t){var e,n="";for(e=0;e<t.length;e++)n+=(t[e]<16?"0":"")+t[e].toString(16);return n},c=function(t){var e=[];return t.replace(/(..)/g,function(t){e.push(parseInt(t,16))}),e},f=function(t,e){var n,i=[];for(e||(t=r(t)),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i},p=function(n){switch(n){case 128:t=10,e=4;break;case 192:t=12,e=6;break;case 256:t=14,e=8;break;default:throw"Invalid Key Size Specified:"+n}},l=function(t){var e,n=[];for(e=0;t>e;e++)n=n.concat(Math.floor(256*Math.random()));return n},h=function(n,r){var i,o=t>=12?3:2,s=[],a=[],u=[],c=[],f=n.concat(r);for(u[0]=GibberishAES.Hash.MD5(f),c=u[0],i=1;o>i;i++)u[i]=GibberishAES.Hash.MD5(u[i-1].concat(f)),c=c.concat(u[i]);return s=c.slice(0,4*e),a=c.slice(4*e,4*e+16),{key:s,iv:a}},d=function(t,e,n){e=x(e);var r,i=Math.ceil(t.length/16),o=[],a=[];for(r=0;i>r;r++)o[r]=s(t.slice(16*r,16*r+16));for(t.length%16===0&&(o.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),i++),r=0;r<o.length;r++)o[r]=0===r?w(o[r],n):w(o[r],a[r-1]),a[r]=g(o[r],e);
return a},y=function(t,e,n,r){e=x(e);var i,s=t.length/16,u=[],c=[],f="";for(i=0;s>i;i++)u.push(t.slice(16*i,16*(i+1)));for(i=u.length-1;i>=0;i--)c[i]=v(u[i],e),c[i]=0===i?w(c[i],n):w(c[i],u[i-1]);for(i=0;s-1>i;i++)f+=a(c[i]);return f+=a(c[i],!0),r?f:o(f)},g=function(e,r){n=!1;var i,o=S(e,r,0);for(i=1;t+1>i;i++)o=m(o),o=b(o),t>i&&(o=_(o)),o=S(o,r,i);return o},v=function(e,r){n=!0;var i,o=S(e,r,t);for(i=t-1;i>-1;i--)o=b(o),o=m(o),o=S(o,r,i),i>0&&(o=_(o));return o},m=function(t){var e,r=n?M:T,i=[];for(e=0;16>e;e++)i[e]=r[t[e]];return i},b=function(t){var e,r=[],i=n?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11];for(e=0;16>e;e++)r[e]=t[i[e]];return r},_=function(t){var e,r=[];if(n)for(e=0;4>e;e++)r[4*e]=R[t[4*e]]^H[t[1+4*e]]^B[t[2+4*e]]^N[t[3+4*e]],r[1+4*e]=N[t[4*e]]^R[t[1+4*e]]^H[t[2+4*e]]^B[t[3+4*e]],r[2+4*e]=B[t[4*e]]^N[t[1+4*e]]^R[t[2+4*e]]^H[t[3+4*e]],r[3+4*e]=H[t[4*e]]^B[t[1+4*e]]^N[t[2+4*e]]^R[t[3+4*e]];else for(e=0;4>e;e++)r[4*e]=I[t[4*e]]^D[t[1+4*e]]^t[2+4*e]^t[3+4*e],r[1+4*e]=t[4*e]^I[t[1+4*e]]^D[t[2+4*e]]^t[3+4*e],r[2+4*e]=t[4*e]^t[1+4*e]^I[t[2+4*e]]^D[t[3+4*e]],r[3+4*e]=D[t[4*e]]^t[1+4*e]^t[2+4*e]^I[t[3+4*e]];return r},S=function(t,e,n){var r,i=[];for(r=0;16>r;r++)i[r]=t[r]^e[n][r];return i},w=function(t,e){var n,r=[];for(n=0;16>n;n++)r[n]=t[n]^e[n];return r},x=function(n){var r,i,o,s,a=[],u=[],c=[];for(r=0;e>r;r++)i=[n[4*r],n[4*r+1],n[4*r+2],n[4*r+3]],a[r]=i;for(r=e;4*(t+1)>r;r++){for(a[r]=[],o=0;4>o;o++)u[o]=a[r-1][o];for(r%e===0?(u=E(C(u)),u[0]^=F[r/e-1]):e>6&&r%e==4&&(u=E(u)),o=0;4>o;o++)a[r][o]=a[r-e][o]^u[o]}for(r=0;t+1>r;r++)for(c[r]=[],s=0;4>s;s++)c[r].push(a[4*r+s][0],a[4*r+s][1],a[4*r+s][2],a[4*r+s][3]);return c},E=function(t){for(var e=0;4>e;e++)t[e]=T[t[e]];return t},C=function(t){var e,n=t[0];for(e=0;4>e;e++)t[e]=t[e+1];return t[3]=n,t},k=function(t,e){var n=[];for(i=0;i<t.length;i+=e)n[i/e]=parseInt(t.substr(i,e),16);return n},P=function(t){var e=[];for(i=0;i<t.length;i++)e[t[i]]=i;return e},A=function(t,e){var n,r;for(r=0,n=0;8>n;n++)r=1==(1&e)?r^t:r,t=t>127?283^t<<1:t<<1,e>>>=1;return r},O=function(t){for(var e=[],n=0;256>n;n++)e[n]=A(t,n);return e},T=k("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",2),M=P(T),F=k("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),I=O(2),D=O(3),N=O(9),H=O(11),B=O(13),R=O(14),j=function(t,e,n){var r,i=l(8),o=h(f(e,n),i),s=o.key,a=o.iv,u=[[83,97,108,116,101,100,95,95].concat(i)];return t=f(t,n),r=d(t,s,a),r=u.concat(r),L.encode(r)},U=function(t,e,n){var r=L.decode(t),i=r.slice(8,16),o=h(f(e,n),i),s=o.key,a=o.iv;return r=r.slice(16,r.length),t=y(r,s,a,n)},$=function(t){function e(t,e){return t<<e|t>>>32-e}function n(t,e){var n,r,i,o,s;return i=2147483648&t,o=2147483648&e,n=1073741824&t,r=1073741824&e,s=(1073741823&t)+(1073741823&e),n&r?2147483648^s^i^o:n|r?1073741824&s?3221225472^s^i^o:1073741824^s^i^o:s^i^o}function r(t,e,n){return t&e|~t&n}function i(t,e,n){return t&n|e&~n}function o(t,e,n){return t^e^n}function s(t,e,n){return e^(t|~n)}function a(t,i,o,s,a,u,c){return t=n(t,n(n(r(i,o,s),a),c)),n(e(t,u),i)}function u(t,r,o,s,a,u,c){return t=n(t,n(n(i(r,o,s),a),c)),n(e(t,u),r)}function c(t,r,i,s,a,u,c){return t=n(t,n(n(o(r,i,s),a),c)),n(e(t,u),r)}function f(t,r,i,o,a,u,c){return t=n(t,n(n(s(r,i,o),a),c)),n(e(t,u),r)}function p(t){for(var e,n=t.length,r=n+8,i=(r-r%64)/64,o=16*(i+1),s=[],a=0,u=0;n>u;)e=(u-u%4)/4,a=u%4*8,s[e]=s[e]|t[u]<<a,u++;return e=(u-u%4)/4,a=u%4*8,s[e]=s[e]|128<<a,s[o-2]=n<<3,s[o-1]=n>>>29,s}function l(t){var e,n,r=[];for(n=0;3>=n;n++)e=t>>>8*n&255,r=r.concat(e);return r}var h,d,y,g,v,m,b,_,S,w=[],x=k("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",8);for(w=p(t),m=x[0],b=x[1],_=x[2],S=x[3],h=0;h<w.length;h+=16)d=m,y=b,g=_,v=S,m=a(m,b,_,S,w[h+0],7,x[4]),S=a(S,m,b,_,w[h+1],12,x[5]),_=a(_,S,m,b,w[h+2],17,x[6]),b=a(b,_,S,m,w[h+3],22,x[7]),m=a(m,b,_,S,w[h+4],7,x[8]),S=a(S,m,b,_,w[h+5],12,x[9]),_=a(_,S,m,b,w[h+6],17,x[10]),b=a(b,_,S,m,w[h+7],22,x[11]),m=a(m,b,_,S,w[h+8],7,x[12]),S=a(S,m,b,_,w[h+9],12,x[13]),_=a(_,S,m,b,w[h+10],17,x[14]),b=a(b,_,S,m,w[h+11],22,x[15]),m=a(m,b,_,S,w[h+12],7,x[16]),S=a(S,m,b,_,w[h+13],12,x[17]),_=a(_,S,m,b,w[h+14],17,x[18]),b=a(b,_,S,m,w[h+15],22,x[19]),m=u(m,b,_,S,w[h+1],5,x[20]),S=u(S,m,b,_,w[h+6],9,x[21]),_=u(_,S,m,b,w[h+11],14,x[22]),b=u(b,_,S,m,w[h+0],20,x[23]),m=u(m,b,_,S,w[h+5],5,x[24]),S=u(S,m,b,_,w[h+10],9,x[25]),_=u(_,S,m,b,w[h+15],14,x[26]),b=u(b,_,S,m,w[h+4],20,x[27]),m=u(m,b,_,S,w[h+9],5,x[28]),S=u(S,m,b,_,w[h+14],9,x[29]),_=u(_,S,m,b,w[h+3],14,x[30]),b=u(b,_,S,m,w[h+8],20,x[31]),m=u(m,b,_,S,w[h+13],5,x[32]),S=u(S,m,b,_,w[h+2],9,x[33]),_=u(_,S,m,b,w[h+7],14,x[34]),b=u(b,_,S,m,w[h+12],20,x[35]),m=c(m,b,_,S,w[h+5],4,x[36]),S=c(S,m,b,_,w[h+8],11,x[37]),_=c(_,S,m,b,w[h+11],16,x[38]),b=c(b,_,S,m,w[h+14],23,x[39]),m=c(m,b,_,S,w[h+1],4,x[40]),S=c(S,m,b,_,w[h+4],11,x[41]),_=c(_,S,m,b,w[h+7],16,x[42]),b=c(b,_,S,m,w[h+10],23,x[43]),m=c(m,b,_,S,w[h+13],4,x[44]),S=c(S,m,b,_,w[h+0],11,x[45]),_=c(_,S,m,b,w[h+3],16,x[46]),b=c(b,_,S,m,w[h+6],23,x[47]),m=c(m,b,_,S,w[h+9],4,x[48]),S=c(S,m,b,_,w[h+12],11,x[49]),_=c(_,S,m,b,w[h+15],16,x[50]),b=c(b,_,S,m,w[h+2],23,x[51]),m=f(m,b,_,S,w[h+0],6,x[52]),S=f(S,m,b,_,w[h+7],10,x[53]),_=f(_,S,m,b,w[h+14],15,x[54]),b=f(b,_,S,m,w[h+5],21,x[55]),m=f(m,b,_,S,w[h+12],6,x[56]),S=f(S,m,b,_,w[h+3],10,x[57]),_=f(_,S,m,b,w[h+10],15,x[58]),b=f(b,_,S,m,w[h+1],21,x[59]),m=f(m,b,_,S,w[h+8],6,x[60]),S=f(S,m,b,_,w[h+15],10,x[61]),_=f(_,S,m,b,w[h+6],15,x[62]),b=f(b,_,S,m,w[h+13],21,x[63]),m=f(m,b,_,S,w[h+4],6,x[64]),S=f(S,m,b,_,w[h+11],10,x[65]),_=f(_,S,m,b,w[h+2],15,x[66]),b=f(b,_,S,m,w[h+9],21,x[67]),m=n(m,d),b=n(b,y),_=n(_,g),S=n(S,v);return l(m).concat(l(b),l(_),l(S))},L=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=t.split(""),n=function(t){{var n,r,i=[],o="";Math.floor(16*t.length/3)}for(n=0;n<16*t.length;n++)i.push(t[Math.floor(n/16)][n%16]);for(n=0;n<i.length;n+=3)o+=e[i[n]>>2],o+=e[(3&i[n])<<4|i[n+1]>>4],o+=void 0!==i[n+1]?e[(15&i[n+1])<<2|i[n+2]>>6]:"=",o+=void 0!==i[n+2]?e[63&i[n+2]]:"=";for(r=o.slice(0,64),n=1;n<Math.ceil(o.length/64);n++)r+=o.slice(64*n,64*n+64)+(Math.ceil(o.length/64)==n+1?"":"\n");return r},r=function(e){e=e.replace(/\n/g,"");var n,r=[],i=[],o=[];for(n=0;n<e.length;n+=4)i[0]=t.indexOf(e.charAt(n)),i[1]=t.indexOf(e.charAt(n+1)),i[2]=t.indexOf(e.charAt(n+2)),i[3]=t.indexOf(e.charAt(n+3)),o[0]=i[0]<<2|i[1]>>4,o[1]=(15&i[1])<<4|i[2]>>2,o[2]=(3&i[2])<<6|i[3],r.push(o[0],o[1],o[2]);return r=r.slice(0,r.length-r.length%16)};return"function"==typeof Array.indexOf&&(t=e),{encode:n,decode:r}}();return{size:p,h2a:c,expandKey:x,encryptBlock:g,decryptBlock:v,Decrypt:n,s2a:f,rawEncrypt:d,rawDecrypt:y,dec:U,openSSLKey:h,a2h:u,enc:j,Hash:{MD5:$},Base64:L}}();window.PUBNUB||function(){function t(t,e){var n=CryptoJS.HmacSHA256(t,e);return n.toString(CryptoJS.enc.Base64)}function e(t){return document.getElementById(t)}function n(t){console.error(t)}function r(t,e){var n=[];return each(t.split(/\s+/),function(t){each((e||document).getElementsByTagName(t),function(t){n.push(t)})}),n}function i(t,e,n){each(t.split(","),function(t){var r=function(t){t||(t=window.event),n(t)||(t.cancelBubble=!0,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())};e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r})}function o(){return r("head")[0]}function s(t,e,n){return n?void t.setAttribute(e,n):t&&t.getAttribute&&t.getAttribute(e)}function a(t,e){for(var n in e)if(e.hasOwnProperty(n))try{t.style[n]=e[n]+("|width|height|top|left|".indexOf(n)>0&&"number"==typeof e[n]?"px":"")}catch(r){}}function u(t){return document.createElement(t)}function c(){return m||h()?0:unique()}function f(t){if(m||h())return p(t);var n=u("script"),r=t.callback,i=unique(),a=0,c=t.timeout||DEF_TIMEOUT,f=timeout(function(){b(1,{message:"timeout"})},c),l=t.fail||function(){},d=t.data||{},g=t.success||function(){},v=function(){o().appendChild(n)},b=function(t,r){a||(a=1,n.onerror=null,clearTimeout(f),t||!r||g(r),timeout(function(){t&&l();var n=e(i),r=n&&n.parentNode;r&&r.removeChild(n)},SECOND))};return window[r]=function(t){b(0,t)},t.blocking||(n[y]=y),n.onerror=function(){b(1)},n.src=build_url(t.url,d),s(n,"id",i),v(),b}function p(t){var e,n,r=function(){if(!o){o=1,clearTimeout(a);try{n=JSON.parse(e.responseText)}catch(t){return d(1)}i=1,p(n)}},i=0,o=0,s=t.timeout||DEF_TIMEOUT,a=timeout(function(){d(1,{message:"timeout"})},s),u=t.fail||function(){},c=t.data||{},p=t.success||function(){},l=!t.blocking,d=function(t,n){i||(i=1,clearTimeout(a),e&&(e.onerror=e.onload=null,e.abort&&e.abort(),e=null),t&&u(n))};try{e=h()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest,e.onerror=e.onabort=function(){d(1,e.responseText||{error:"Network Connection Error"})},e.onload=e.onloadend=r,e.onreadystatechange=function(){if(e&&4==e.readyState)switch(e.status){case 200:break;default:try{n=JSON.parse(e.responseText),d(1,n)}catch(t){return d(1,{status:e.status,payload:null,message:e.responseText})}return}};var y=build_url(t.url,c);e.open("GET",y,l),l&&(e.timeout=s),e.send()}catch(g){return d(0),m=0,f(t)}return d}function l(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(t){return!0}}function h(){if(!E||!E.get)return 0;var t={id:h.id++,send:function(){},abort:function(){t.id={}},open:function(e,n){h[t.id]=t,E.get(t.id,n)}};return t}var d="https://pubnub.a.ssl.fastly.net/pubnub.swf",y="async",g=navigator.userAgent,v="PubNub-JS-Web/3.7.10",m=-1==g.indexOf("MSIE 6");window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||function(){});var b=function(){var t={},e=!1;try{e=window.localStorage}catch(n){}var r=function(t){return-1==document.cookie.indexOf(t)?null:((document.cookie||"").match(RegExp(t+"=([^;]+)"))||[])[1]||null},i=function(t,e){document.cookie=t+"="+e+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"},o=function(){try{return i("pnctest","1"),"1"===r("pnctest")}catch(t){return!1}}();return{get:function(n){try{return e?e.getItem(n):o?r(n):t[n]}catch(i){return t[n]}},set:function(n,r){try{if(e)return e.setItem(n,r)&&0;o&&i(n,r),t[n]=r}catch(s){t[n]=r}}}}(),_={list:{},unbind:function(t){_.list[t]=[]},bind:function(t,e){(_.list[t]=_.list[t]||[]).push(e)},fire:function(t,e){each(_.list[t]||[],function(t){t(e)})}},S=e("pubnub")||0,w=function(p){m=p.jsonp?0:-1==g.indexOf("MSIE 6");var h=p.subscribe_key||"",d=((+p.keepalive||DEF_KEEPALIVE)*SECOND,p.uuid||b.get(h+"uuid")||"",p.leave_on_unload||0);p.xdr=f,p.db=b,p.error=p.error||n,p._is_online=l,p.jsonp_cb=c,p.hmac_SHA256=t,p.crypto_obj=crypto_obj(),p.params={pnsdk:v};var y=function(t){return w(t)},S=PN_API(p);for(var x in S)S.hasOwnProperty(x)&&(y[x]=S[x]);return y.css=a,y.$=e,y.create=u,y.bind=i,y.head=o,y.search=r,y.attr=s,y.events=_,y.init=y,y.secure=y,i("beforeunload",window,function(){return d&&y["each-channel"](function(t){y.LEAVE(t.name,0)}),!0}),p.notest?y:(i("offline",window,y.offline),i("offline",document,y.offline),y)};w.init=w,w.secure=w,"complete"===document.readyState?timeout(ready,0):i("load",window,function(){timeout(ready,0)});var x=S||{};PUBNUB=w({notest:1,publish_key:s(x,"pub-key"),subscribe_key:s(x,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==s(x,"ssl"),origin:s(x,"origin"),uuid:s(x,"uuid")}),window.jQuery&&(window.jQuery.PUBNUB=w),"undefined"!=typeof module&&(module.exports=PUBNUB)&&ready();var E=e("pubnubs")||0;S&&(a(S,{position:"absolute",top:-SECOND}),("opera"in window||s(S,"flash"))&&(S.innerHTML="<object id=pubnubs data="+d+"><param name=movie value="+d+"><param name=allowscriptaccess value=always></object>"),PUBNUB.rdx=function(t,e){return e?(h[t].responseText=unescape(e),void h[t].onload()):h[t].onerror()},h.id=SECOND)}(),function(){var t=PUBNUB.ws=function(e,n){if(!(this instanceof t))return new t(e,n);var r=this,e=r.url=e||"",i=(r.protocol=n||"Sec-WebSocket-Protocol",e.split("/")),o={ssl:"wss:"===i[0],origin:i[2],publish_key:i[3],subscribe_key:i[4],channel:i[5]};return r.CONNECTING=0,r.OPEN=1,r.CLOSING=2,r.CLOSED=3,r.CLOSE_NORMAL=1e3,r.CLOSE_GOING_AWAY=1001,r.CLOSE_PROTOCOL_ERROR=1002,r.CLOSE_UNSUPPORTED=1003,r.CLOSE_TOO_LARGE=1004,r.CLOSE_NO_STATUS=1005,r.CLOSE_ABNORMAL=1006,r.onclose=r.onerror=r.onmessage=r.onopen=r.onsend=function(){},r.binaryType="",r.extensions="",r.bufferedAmount=0,r.trasnmitting=!1,r.buffer=[],r.readyState=r.CONNECTING,e?(r.pubnub=PUBNUB.init(o),r.pubnub.setup=o,r.setup=o,void r.pubnub.subscribe({restore:!1,channel:o.channel,disconnect:r.onerror,reconnect:r.onopen,error:function(){r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(t){r.onmessage({data:t})},connect:function(){r.readyState=r.OPEN,r.onopen()}})):(r.readyState=r.CLOSED,r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),r)};t.prototype.send=function(t){var e=this;e.pubnub.publish({channel:e.pubnub.setup.channel,message:t,callback:function(t){e.onsend({data:t})}})},t.prototype.close=function(){var t=this;t.pubnub.unsubscribe({channel:t.pubnub.setup.channel}),t.readyState=t.CLOSED,t.onclose({})}}();var CryptoJS=CryptoJS||function(t,e){var n={},r=n.lib={},i=function(){},o=r.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=o.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes;if(t=t.sigBytes,this.clamp(),r%4)for(var i=0;t>i;i++)e[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;t>i;i+=4)e[r+i>>>2]=n[i>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-8*(n%4),e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],r=0;e>r;r+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),a=n.enc={},u=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],r=0;t>r;r++){var i=e[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],r=0;e>r;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-4*(r%8);return new s.init(n,e/2)}},c=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],r=0;t>r;r++)n.push(String.fromCharCode(e[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],r=0;e>r;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-8*(r%4);return new s.init(n,e)}},f=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},p=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,a=i/(4*o),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0);if(e=a*o,i=t.min(4*e,i),e){for(var u=0;e>u;u+=o)this._doProcessBlock(r,u);u=r.splice(0,e),n.sigBytes-=i}return new s.init(u,i)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});r.Hasher=p.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new l.HMAC.init(t,n).finalize(e)}}});var l=n.algo={};return n}(Math);!function(t){for(var e=CryptoJS,n=e.lib,r=n.WordArray,i=n.Hasher,n=e.algo,o=[],s=[],a=function(t){return 4294967296*(t-(0|t))|0},u=2,c=0;64>c;){var f;t:{f=u;for(var p=t.sqrt(f),l=2;p>=l;l++)if(!(f%l)){f=!1;break t}f=!0}f&&(8>c&&(o[c]=a(t.pow(u,.5))),s[c]=a(t.pow(u,1/3)),c++),u++}var h=[],n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],c=n[5],f=n[6],p=n[7],l=0;64>l;l++){if(16>l)h[l]=0|t[e+l];else{var d=h[l-15],y=h[l-2];h[l]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[l-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[l-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&f)+s[l]+h[l],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&o^i&o),p=f,f=c,c=u,u=a+d|0,a=o,o=i,i=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+f|0,n[7]=n[7]+p|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=t.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(n),e.HmacSHA256=i._createHmacHelper(n)}(Math),function(){var t=CryptoJS,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var r=t.blockSize,i=4*r;n.sigBytes>i&&(n=t.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),s=this._iKey=n.clone(),a=o.words,u=s.words,c=0;r>c;c++)a[c]^=1549556828,u[c]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp(),t=[];for(var i=0;n>i;i+=3)for(var o=(e[i>>>2]>>>24-8*(i%4)&255)<<16|(e[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|e[i+2>>>2]>>>24-8*((i+2)%4)&255,s=0;4>s&&n>i+.75*s;s++)t.push(r.charAt(o>>>6*(3-s)&63));if(e=r.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,r=this._map,i=r.charAt(64);i&&(i=t.indexOf(i),-1!=i&&(n=i));for(var i=[],o=0,s=0;n>s;s++)if(s%4){var a=r.indexOf(t.charAt(s-1))<<2*(s%4),u=r.indexOf(t.charAt(s))>>>6-2*(s%4);i[o>>>2]|=(a|u)<<24-8*(o%4),o++}return e.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}()}).call(exports,__webpack_require__(50)(module))},function(t,e,n){!function(r,i){t.exports=e=i(n(7),n(43),n(44),n(45),n(46))}(this,function(t){return function(){var e=t,n=e.lib,r=n.BlockCipher,i=e.algo,o=[],s=[],a=[],u=[],c=[],f=[],p=[],l=[],h=[],d=[];!function(){for(var t=[],e=0;256>e;e++)t[e]=128>e?e<<1:283^e<<1;for(var n=0,r=0,e=0;256>e;e++){var i=r^r<<1^r<<2^r<<3^r<<4;i=99^(i>>>8^255&i),o[n]=i,s[i]=n;var y=t[n],g=t[y],v=t[g],m=257*t[i]^16843008*i;a[n]=m<<24|m>>>8,u[n]=m<<16|m>>>16,c[n]=m<<8|m>>>24,f[n]=m;var m=16843009*v^65537*g^257*y^16843008*n;p[i]=m<<24|m>>>8,l[i]=m<<16|m>>>16,h[i]=m<<8|m>>>24,d[i]=m,n?(n=y^t[t[t[v^y]]],r^=t[t[r]]):n=r=1}}();var y=[0,1,2,4,8,16,32,64,128,27,54],g=i.AES=r.extend({_doReset:function(){for(var t=this._key,e=t.words,n=t.sigBytes/4,r=this._nRounds=n+6,i=4*(r+1),s=this._keySchedule=[],a=0;i>a;a++)if(n>a)s[a]=e[a];else{var u=s[a-1];a%n?n>6&&4==a%n&&(u=o[u>>>24]<<24|o[255&u>>>16]<<16|o[255&u>>>8]<<8|o[255&u]):(u=u<<8|u>>>24,u=o[u>>>24]<<24|o[255&u>>>16]<<16|o[255&u>>>8]<<8|o[255&u],u^=y[0|a/n]<<24),s[a]=s[a-n]^u}for(var c=this._invKeySchedule=[],f=0;i>f;f++){var a=i-f;if(f%4)var u=s[a];else var u=s[a-4];c[f]=4>f||4>=a?u:p[o[u>>>24]]^l[o[255&u>>>16]]^h[o[255&u>>>8]]^d[o[255&u]]}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,a,u,c,f,o)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,p,l,h,d,s);var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,r,i,o,s,a){for(var u=this._nRounds,c=t[e]^n[0],f=t[e+1]^n[1],p=t[e+2]^n[2],l=t[e+3]^n[3],h=4,d=1;u>d;d++){var y=r[c>>>24]^i[255&f>>>16]^o[255&p>>>8]^s[255&l]^n[h++],g=r[f>>>24]^i[255&p>>>16]^o[255&l>>>8]^s[255&c]^n[h++],v=r[p>>>24]^i[255&l>>>16]^o[255&c>>>8]^s[255&f]^n[h++],m=r[l>>>24]^i[255&c>>>16]^o[255&f>>>8]^s[255&p]^n[h++];c=y,f=g,p=v,l=m}var y=(a[c>>>24]<<24|a[255&f>>>16]<<16|a[255&p>>>8]<<8|a[255&l])^n[h++],g=(a[f>>>24]<<24|a[255&p>>>16]<<16|a[255&l>>>8]<<8|a[255&c])^n[h++],v=(a[p>>>24]<<24|a[255&l>>>16]<<16|a[255&c>>>8]<<8|a[255&f])^n[h++],m=(a[l>>>24]<<24|a[255&c>>>16]<<16|a[255&f>>>8]<<8|a[255&p])^n[h++];t[e]=y,t[e+1]=g,t[e+2]=v,t[e+3]=m},keySize:8});e.AES=r._createHelper(g)}(),t.AES})},function(t,e,n){!function(r,i){t.exports=e=i(n(7),n(46))}(this,function(t){return t.mode.ECB=function(){var e=t.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),e.Decryptor=e.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),e}(),t.mode.ECB})},function(t,e){!function(n,r){t.exports=e=r()}(this,function(){var t=t||function(t,e){var n={},r=n.lib={},i=r.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=i.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;i>o;o++){var s=255&n[o>>>2]>>>24-8*(o%4);e[r+o>>>2]|=s<<24-8*((r+o)%4)}else if(n.length>65535)for(var o=0;i>o;o+=4)e[r+o>>>2]=n[o>>>2];else e.push.apply(e,n);return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-8*(n%4),e.length=t.ceil(n/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],r=0;e>r;r+=4)n.push(0|4294967296*t.random());return new o.init(n,e)}}),s=n.enc={},a=s.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;n>i;i++){var o=255&e[i>>>2]>>>24-8*(i%4);r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;e>r;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-4*(r%8);return new o.init(n,e/2)}},u=s.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;n>i;i++){var o=255&e[i>>>2]>>>24-8*(i%4);r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;e>r;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-8*(r%4);return new o.init(n,e)}},c=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=c.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,a=4*s,u=i/a;u=e?t.ceil(u):t.max((0|u)-this._minBufferSize,0);var c=u*s,f=t.min(4*c,i);if(c){for(var p=0;c>p;p+=s)this._doProcessBlock(r,p);var l=r.splice(0,c);n.sigBytes-=f}return new o.init(l,f)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});r.Hasher=f.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){t&&this._append(t);var e=this._doFinalize();return e},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new p.HMAC.init(t,n).finalize(e)}}});var p=n.algo={};return n}(Math);return t})},function(t,e,n){var r;(function(t,i,o){(function(){"use strict";function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function u(t){return"object"==typeof t&&null!==t}function c(){}function f(){return function(){t.nextTick(d)}}function p(){var t=0,e=new q(d),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function l(){var t=new MessageChannel;return t.port1.onmessage=d,function(){t.port2.postMessage(0)}}function h(){return function(){setTimeout(d,1)}}function d(){for(var t=0;U>t;t+=2){var e=K[t],n=K[t+1];e(n),K[t]=void 0,K[t+1]=void 0}U=0}function y(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function m(t){try{return t.then}catch(e){return G.error=e,G}}function b(t,e,n,r){try{t.call(e,n,r)}catch(i){return i}}function _(t,e,n){$(function(t){var r=!1,i=b(n,e,function(n){r||(r=!0,e!==n?x(t,n):C(t,n))},function(e){r||(r=!0,k(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&i&&(r=!0,k(t,i))},t)}function S(t,e){e._state===X?C(t,e._result):t._state===J?k(t,e._result):P(e,void 0,function(e){x(t,e)},function(e){k(t,e)})}function w(t,e){if(e.constructor===t.constructor)S(t,e);else{var n=m(e);n===G?k(t,G.error):void 0===n?C(t,e):a(n)?_(t,e,n):C(t,e)}}function x(t,e){t===e?k(t,g()):s(e)?w(t,e):C(t,e)}function E(t){t._onerror&&t._onerror(t._result),A(t)}function C(t,e){t._state===V&&(t._result=e,t._state=X,0===t._subscribers.length||$(A,t))}function k(t,e){t._state===V&&(t._state=J,t._result=e,$(E,t))}function P(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+X]=n,i[o+J]=r,0===o&&t._state&&$(A,t)}function A(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,i,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?M(n,r,i,o):i(o);t._subscribers.length=0}}function O(){this.error=null}function T(t,e){try{return t(e)}catch(n){return W.error=n,W}}function M(t,e,n,r){var i,o,s,u,c=a(n);if(c){if(i=T(n,r),i===W?(u=!0,o=i.error,i=null):s=!0,e===i)return void k(e,v())}else i=r,s=!0;e._state!==V||(c&&s?x(e,i):u?k(e,o):t===X?C(e,i):t===J&&k(e,i))}function F(t,e){try{e(function(e){x(t,e)},function(e){k(t,e)})}catch(n){k(t,n)}}function I(t,e,n,r){this._instanceConstructor=t,this.promise=new t(y,r),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&C(this.promise,this._result))):k(this.promise,this._validationError())}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(t){this._id=ne++,this._state=void 0,this._result=void 0,this._subscribers=[],y!==t&&(a(t)||D(),this instanceof H||N(),F(this,t))}var B;B=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var R,j=B,U=(Date.now||function(){return(new Date).getTime()},Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return c.prototype=t,new c},0),$=function(t,e){K[U]=t,K[U+1]=e,U+=2,2===U&&R()},L="undefined"!=typeof window?window:{},q=L.MutationObserver||L.WebKitMutationObserver,z="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,K=new Array(1e3);R="undefined"!=typeof t&&"[object process]"==={}.toString.call(t)?f():q?p():z?l():h();var V=void 0,X=1,J=2,G=new O,W=new O;I.prototype._validateInput=function(t){return j(t)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var Y=I;I.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===V&&t>r;r++)this._eachEntry(n[r],r)},I.prototype._eachEntry=function(t,e){var n=this._instanceConstructor;u(t)?t.constructor===n&&t._state!==V?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(n.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(X,e,t))},I.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===V&&(this._remaining--,this._abortOnReject&&t===J?k(r,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&C(r,this._result)},I.prototype._makeResult=function(t,e,n){return n},I.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,function(t){n._settledAt(X,e,t)},function(t){n._settledAt(J,e,t)})};var Q=function(t,e){return new Y(this,t,!0,e).promise},Z=function(t,e){function n(t){x(o,t)}function r(t){k(o,t)}var i=this,o=new i(y,e);if(!j(t))return k(o,new TypeError("You must pass an array to race.")),o;for(var s=t.length,a=0;o._state===V&&s>a;a++)P(i.resolve(t[a]),void 0,n,r);return o},te=function(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(y,e);return x(r,t),r},ee=function(t,e){var n=this,r=new n(y,e);return k(r,t),r},ne=0,re=H;H.all=Q,H.race=Z,H.resolve=te,H.reject=ee,H.prototype={constructor:H,then:function(t,e){var n=this,r=n._state;if(r===X&&!t||r===J&&!e)return this;var i=new this.constructor(y),o=n._result;if(r){var s=arguments[r-1];$(function(){M(r,i,s,o)})}else P(n,i,t,e);return i},"catch":function(t){return this.then(null,t)}};var ie=function(){var t;t="undefined"!=typeof i?i:"undefined"!=typeof window&&window.document?window:self;var e="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),a(e)}();e||(t.Promise=re)},oe={Promise:re,polyfill:ie};n(51).amd?(r=function(){return oe}.call(e,n,e,o),!(void 0!==r&&(o.exports=r))):"undefined"!=typeof o&&o.exports?o.exports=oe:"undefined"!=typeof this&&(this.ES6Promise=oe)}).call(this)}).call(e,n(52),function(){return this}(),n(50)(t))},function(t,e){function n(t){return t.createSingleton("XhrResponse",function(){return new r(t)})}var r=function(){function t(){this.responses=[]}return t.prototype.add=function(t){this.responses.push(t)
},t.prototype.clear=function(){this.responses=[]},t.prototype.find=function(t){var e;return this.responses.forEach(function(n){t.url.indexOf(n.path)>-1&&(!n.test||n.test(t))&&(e=n)}),e},t}();e.XhrResponse=r,e.$get=n},function(t,e,n){function r(t){return t.createSingleton("AjaxObserver",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(16),s=function(t){function e(){t.apply(this,arguments),this.events={beforeRequest:"beforeRequest",requestSuccess:"requestSuccess",requestError:"requestError"}}return i(e,t),e}(o.Observable);e.AjaxObserver=s,e.$get=r},function(t,e){function n(t){return t.createSingleton("Cache",function(){return new r(t)})}var r=function(){function t(t){this.setPrefix(),this.context=t,this.storage=t.getLocalStorage()}return t.prototype.setPrefix=function(t){return this.prefix=t||"rc-",this},t.prototype.prefixKey=function(t){return this.prefix+t},t.prototype.setItem=function(t,e){return this.storage.setItem(this.prefixKey(t),JSON.stringify(e)),this},t.prototype.removeItem=function(t){return this.storage.removeItem(this.prefixKey(t)),this},t.prototype.getItem=function(t){var e=this.storage.getItem(this.prefixKey(t));return e?JSON.parse(e):null},t.prototype.clean=function(){for(var t in this.storage)this.storage.hasOwnProperty(t)&&0===t.indexOf(this.prefix)&&(this.storage.removeItem(t),delete this.storage[t]);return this},t}();e.Cache=r,e.$get=n},function(t,e,n){function r(t){return new s(t)}var i=n(47),o=n(48),s=function(){function t(t){this.singletons={},this.injections=t,this.stubPubnub=!1,this.stubAjax=!1}return t.prototype.createSingleton=function(t,e){return this.singletons[t]||(this.singletons[t]=e()),this.singletons[t]},t.prototype.usePubnubStub=function(t){return this.stubPubnub=!!t,this},t.prototype.useAjaxStub=function(t){return this.stubAjax=!!t,this},t.prototype.getCryptoJS=function(){return this.injections.CryptoJS},t.prototype.getPubnub=function(){return this.stubPubnub?i.$get(this):this.injections.PUBNUB},t.prototype.getLocalStorage=function(){var t=this;return this.createSingleton("localStorage",function(){return"function"!=typeof t.injections.localStorage?t.injections.localStorage:new t.injections.localStorage})},t.prototype.getPromise=function(){return this.injections.Promise},t.prototype.getXHR=function(){return this.stubAjax?o.$get(this):new this.injections.XHR},t}();e.Context=s,e.$get=r},function(t,e,n){function r(t){return new o(t)}var i=n(20),o=function(){function t(t){this.defaultProperty="id",this.context=t,this.utils=i.$get(t)}return t.prototype.getContext=function(){return this.context},t.prototype.createUrl=function(){return""},t.prototype.getId=function(t){return t&&t[this.defaultProperty]},t.prototype.isNew=function(t){return!this.getId(t)||!this.getUri(t)},t.prototype.resetAsNew=function(t){return t&&(delete t.id,delete t.uri),t},t.prototype.getUri=function(t){return t&&t.uri},t.prototype.parseMultipartResponse=function(t){return t.isMultipart()?t.data.filter(function(t){return!t.error}).map(function(t){return t.data}):[t.data]},t.prototype.loadRequest=function(t,e){return this.utils.extend(e||{},{url:e&&e.url||t&&this.getUri(t)||this.createUrl(),method:e&&e.method||"GET"})},t.prototype.saveRequest=function(t,e){if(!(t||e&&(e.post||e.body)))throw new Error("No Object");return this.utils.extend(e||{},{method:e&&e.method||(this.isNew(t)?"POST":"PUT"),url:e&&e.url||this.getUri(t)||this.createUrl(),body:e&&(e.body||e.post)||t})},t.prototype.deleteRequest=function(t,e){if(e=e||{},!(this.getUri(t)||e&&e.url))throw new Error("Object has to be not new or URL must be provided");return this.utils.extend(e||{},{method:e&&e.method||"DELETE",url:e&&e.url||this.getUri(t)})},t.prototype.syncRequest=function(t){return t=t||{},t.url=t.url||this.createUrl({sync:!0}),t.query=t.query||t.get||{},t.query.syncToken?t.query={syncType:"ISync",syncToken:t.get.syncToken}:t.query.syncType="FSync",t},t.prototype.nextPageExists=function(t){return t&&t.navigation&&"nextPage"in t.navigation},t.prototype.index=function(t,e,n){return e=e||this.getId.bind(this),t=t||[],t.reduce(function(t,r){var i=e(r);return!i||t[i]&&!n?t:(n?(t[i]||(t[i]=[]),t[i].push(r)):t[i]=r,t)},{})},t.prototype.merge=function(t,e,n,r){var i=this;n=n||this.getId.bind(this),t=t||[],e=e||[];var o=this.index(e,n),s=[],a=t.map(function(t){var e=n(t),a=o[e];return a&&s.push(e),a?r?i.utils.extend(t,a):a:t});return e.forEach(function(t){-1==s.indexOf(n(t))&&a.push(t)}),a},t}();e.Helper=o,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("List",function(){return new o(t)})}var i=n(20),o=function(){function t(t){this.context=t,this.utils=i.$get(t),this.numberComparator=this.numberComparator.bind(this),this.stringComparator=this.stringComparator.bind(this)}return t.prototype.propertyExtractor=function(t){return function(e){return t?e&&e[t]||null:e}},t.prototype.stringComparator=function(t,e){return this.utils.parseString(t).localeCompare(this.utils.parseString(e))},t.prototype.numberComparator=function(t,e){return this.utils.parseNumber(t)-this.utils.parseNumber(e)},t.prototype.comparator=function(t){return t=this.utils.extend({extractFn:this.propertyExtractor(t&&t.sortBy||null).bind(this),compareFn:this.stringComparator.bind(this)},t),function(e,n){return t.compareFn(t.extractFn(e,t),t.extractFn(n,t),t)}},t.prototype.equalsFilter=function(t,e){return e.condition===t},t.prototype.containsFilter=function(t,e){return t&&t.toString().indexOf(e.condition)>-1},t.prototype.regexpFilter=function(t,e){if(!(e.condition instanceof RegExp))throw new Error("Condition must be an instance of RegExp");return e.condition.test(t)},t.prototype.filter=function(t){var e=this,n=this;return t=(t||[]).map(function(t){return e.utils.extend({condition:"",extractFn:n.propertyExtractor(t&&t.filterBy||null).bind(e),filterFn:n.equalsFilter.bind(e)},t)}),function(e){return t.reduce(function(t,n){return t&&n.condition?n.filterFn(n.extractFn(e,n),n):t},!0)}},t}();e.List=o,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Log",function(){return new o(t,console)})}var i=n(20),o=function(){function t(t,e){e||(e={log:function(){},warn:function(){},info:function(){},error:function(){}}),this.context=t,this.console=e,this.utils=i.$get(t),this.logDebug=!1,this.logInfo=!1,this.logWarnings=!1,this.logErrors=!1,this.addTimestamps=!1}return t.prototype.disableAll=function(){this.logDebug=!1,this.logInfo=!1,this.logWarnings=!1,this.logErrors=!1},t.prototype.enableAll=function(){this.logDebug=!0,this.logInfo=!0,this.logWarnings=!0,this.logErrors=!0},t.prototype.parseArguments=function(t){return t=this.utils.argumentsToArray(t),this.addTimestamps&&t.unshift((new Date).toLocaleString(),"-"),t},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logDebug&&this.console.log.apply(this.console,this.parseArguments(arguments))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logInfo&&this.console.info.apply(this.console,this.parseArguments(arguments))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logWarnings&&this.console.warn.apply(this.console,this.parseArguments(arguments))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logErrors&&this.console.error.apply(this.console,this.parseArguments(arguments))},t}();e.Log=o,e.$get=r},function(t,e,n){function r(t){return new s(t)}var i=n(20),o=n(15),s=function(){function t(e){if(!(this instanceof t))throw new Error("Observable(): New operator was omitted");Object.defineProperty(this,"listeners",{value:{},enumerable:!1,writable:!0}),Object.defineProperty(this,"oneTimeEvents",{value:{},enumerable:!1,writable:!0}),Object.defineProperty(this,"oneTimeArguments",{value:{},enumerable:!1,writable:!0}),this.context=e,this.utils=i.$get(e),this.log=o.$get(e)}return t.prototype.hasListeners=function(t){return t in this.listeners},t.prototype.registerOneTimeEvent=function(t){this.oneTimeEvents[t]=!1,this.oneTimeArguments[t]=[]},t.prototype.on=function(t,e){var n=this;if("string"==typeof t&&(t=[t]),!t)throw new Error("No events to subscribe to");if("function"!=typeof e)throw new Error("Callback must be a function");var r=this;return t.forEach(function(t){r.hasListeners(t)||(r.listeners[t]=[]),r.listeners[t].push(e),r.isOneTimeEventFired(t)&&(n.log.debug("Observable.on(%s): One-time event has been fired already, executing callback",t),e.apply(r,r.getOneTimeEventArgumens(t)))}),this},t.prototype.emit=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(this.isOneTimeEventFired(t))return this.log.debug("Observable.emit(%s): One-time event has been fired already",t),null;var i=null;return this.isOneTimeEvent(t)&&(this.setOneTimeEventFired(t),this.setOneTimeEventArgumens(t,n)),this.hasListeners(t)?(this.listeners[t].some(function(t){return i=t.apply(e,n),i===!1}),i):null},t.prototype.off=function(t,e){var n=this;if(e){if(!this.hasListeners(t))return this;this.listeners[t].forEach(function(r,i){r===e&&delete n.listeners[t][i]})}else delete this.listeners[t];return this},t.prototype.isOneTimeEvent=function(t){return t in this.oneTimeEvents},t.prototype.isOneTimeEventFired=function(t){return this.isOneTimeEvent(t)?this.oneTimeEvents[t]:!1},t.prototype.setOneTimeEventFired=function(t){this.oneTimeEvents[t]=!0},t.prototype.setOneTimeEventArgumens=function(t,e){this.oneTimeArguments[t]=e},t.prototype.getOneTimeEventArgumens=function(t){return this.oneTimeArguments[t]},t.prototype.offAll=function(){return this.listeners={},this.oneTimeEvents={},this.oneTimeArguments={},this},t.prototype.destroy=function(){return this.offAll(),this.log.debug("Observable.destroy(): Listeners were destroyed"),this},t.prototype.emitAndCallback=function(t,e,n){return e=this.utils.argumentsToArray(e),t&&this.emit.apply(this,[t].concat(e)),n&&n.apply(this,e),this},t}();e.Observable=s,e.$get=r},function(t,e,n){function r(t){return new s(t)}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(16),s=function(t){function e(e){var n=this;t.call(this,e),this.events={change:"change"};var r="hidden",i=function(t){t=t||window.event;var e="visible",i="hidden",o={focus:e,focusin:e,pageshow:e,blur:i,focusout:i,pagehide:i};n.visible=t.type in o?o[t.type]==e:!document[r],n.emit(n.events.change,n.visible)};this.visible=!0,"undefined"!=typeof document&&"undefined"!=typeof window&&(r in document?document.addEventListener("visibilitychange",i):(r="mozHidden")in document?document.addEventListener("mozvisibilitychange",i):(r="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",i):(r="msHidden")in document?document.addEventListener("msvisibilitychange",i):"onfocusin"in document?document.onfocusin=document.onfocusout=i:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=i)}return i(e,t),e.prototype.isVisible=function(){return this.visible},e}(o.Observable);e.PageVisibility=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Platform",function(){return new u(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(16),s=n(11),a=n(49),u=function(t){function e(e){t.call(this,e),this.events={accessViolation:"accessViolation",logoutSuccess:"logoutSuccess",logoutError:"logoutError",authorizeSuccess:"authorizeSuccess",authorizeError:"authorizeError",refreshSuccess:"refreshSuccess",refreshError:"refreshError"},this.server="",this.apiKey="",this.account="~",this.urlPrefix="/restapi",this.apiVersion="v1.0",this.accountPrefix="/account/",this.accessTokenTtl=null,this.refreshTokenTtl=36e3,this.refreshTokenTtlRemember=604800,this.refreshHandicapMs=6e4,this.refreshDelayMs=100,this.clearCacheOnRefreshError=!0,this.refreshPromise=null,this.cacheId="platform",this.pollInterval=250,this.releaseTimeout=5e3}return i(e,t),e.prototype.getStorage=function(){return s.$get(this.context)},e.prototype.getRequest=function(){return a.$get(this.context)},e.prototype.clearStorage=function(){return this.getStorage().clean(),this},e.prototype.setCredentials=function(t,e){var n=(t||"")+":"+(e||"");return":"==n?this:(this.apiKey="function"==typeof btoa?btoa(n):new Buffer(n).toString("base64"),this)},e.prototype.setServer=function(t){return this.server=t||"",this},e.prototype.remember=function(t){var e=this.cacheId+"-remember";return void 0!==t?(this.getStorage().setItem(e,t),this):this.getStorage().getItem(e)||!1},e.prototype.authorize=function(t){var e=this;return t=t||{},t.remember=t.remember||!1,this.authCall({url:"/restapi/oauth/token",post:{grant_type:"password",username:t.username,extension:t.extension||"",password:t.password,access_token_ttl:this.accessTokenTtl,refresh_token_ttl:t.remember?this.refreshTokenTtlRemember:this.refreshTokenTtl}}).then(function(n){return e.setCache(n.data).remember(t.remember).emitAndCallback(e.events.authorizeSuccess,[]),n})["catch"](function(t){throw e.clearStorage().emitAndCallback(e.events.authorizeError,[t]),t})},e.prototype.isPaused=function(){var t=this.getStorage(),e=this.cacheId+"-refresh";return!!t.getItem(e)&&Date.now()-parseInt(t.getItem(e))<this.releaseTimeout},e.prototype.pause=function(){return this.getStorage().setItem(this.cacheId+"-refresh",Date.now()),this},e.prototype.resume=function(){return this.getStorage().removeItem(this.cacheId+"-refresh"),this},e.prototype.refresh=function(){var t=this,e=new(this.context.getPromise())(function(e,n){return t.isPaused()?e(t.refreshPolling(null)):(t.pause(),void setTimeout(function(){var r=t.getAuthData();return t.log.debug("Platform.refresh(): Performing token refresh (access token",r.access_token,", refresh token",r.refresh_token,")"),r&&r.refresh_token?Date.now()>r.refreshExpireTime?n(new Error("Refresh token has expired")):t.isPaused()?void e(t.authCall({url:"/restapi/oauth/token",post:{grant_type:"refresh_token",refresh_token:r.refresh_token,access_token_ttl:t.accessTokenTtl,refresh_token_ttl:t.remember()?t.refreshTokenTtlRemember:t.refreshTokenTtl}})):n(new Error("Queue was resumed before refresh call")):n(new Error("Refresh token is missing"))},t.refreshDelayMs))});return e.then(function(e){if(!e||!e.data)return e;if(t.log.info("Platform.refresh(): Token was refreshed"),!e.data.refresh_token||!e.data.access_token){var n=new Error("Malformed OAuth response");throw n.ajax=e,n}return t.setCache(e.data).resume(),e}).then(function(e){return t.emit(t.events.refreshSuccess,e),e})["catch"](function(e){throw t.clearCacheOnRefreshError&&t.clearStorage(),t.emitAndCallback(t.events.accessViolation,[e]).emitAndCallback(t.events.refreshError,[e]),e})},e.prototype.logout=function(){var t=this;return this.pause(),this.authCall({url:"/restapi/oauth/revoke",post:{token:this.getToken()}}).then(function(e){return t.resume().clearStorage().emit(t.events.logoutSuccess,e),e})["catch"](function(e){throw t.resume().emitAndCallback(t.events.accessViolation,[e]).emitAndCallback(t.events.logoutError,[e]),e})},e.prototype.refreshPolling=function(t){var e=this;return this.refreshPromise?this.refreshPromise:(this.refreshPromise=new(this.context.getPromise())(function(n,r){e.log.warn("Platform.refresh(): Refresh is already in progress polling started"),e.utils.poll(function(i){return e.isPaused()?i():(e.refreshPromise=null,e.resume(),void(e.isTokenValid()?n(t):r(new Error("Automatic authentification timeout"))))},e.pollInterval)}),this.refreshPromise)},e.prototype.getToken=function(){return this.getAuthData().access_token},e.prototype.getTokenType=function(){return this.getAuthData().token_type},e.prototype.getAuthData=function(){return this.getStorage().getItem(this.cacheId)||{token_type:"",access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}},e.prototype.isTokenValid=function(){var t=this.getAuthData();return t.token_type==e.forcedTokenType||new Date(t.expireTime).getTime()-this.refreshHandicapMs>Date.now()&&!this.isPaused()},e.prototype.isAuthorized=function(){return this.isTokenValid()?this.context.getPromise().resolve(!0):this.refresh()},e.prototype.cancelAccessToken=function(){return this.setCache(this.utils.extend(this.getAuthData(),{access_token:"",expires_in:0}))},e.prototype.setCache=function(t){var e=this.getAuthData();return this.log.info("Platform.setCache(): Tokens were updated, new:",t,", old:",e),t.expireTime=Date.now()+1e3*t.expires_in,t.refreshExpireTime=Date.now()+1e3*t.refresh_token_expires_in,this.getStorage().setItem(this.cacheId,t),this},e.prototype.forceAuthentication=function(){return this.setCache({token_type:e.forcedTokenType,access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}),this},e.prototype.apiCall=function(t){var e=this;return t=t||{},t.url=this.apiUrl(t.url,{addServer:!0}),this.isAuthorized().then(function(){var n=e.getToken();return e.getRequest().setOptions(t).setHeader("Authorization",e.getTokenType()+(n?" "+n:"")).send()})["catch"](function(n){if(!n.response||!n.response.isUnauthorized())throw n;return e.cancelAccessToken(),e.refresh().then(function(){return e.apiCall(t)})})},e.prototype.get=function(t,e){return e=e||{},e.url=t,e.method="GET",this.apiCall(e)},e.prototype.post=function(t,e){return e=e||{},e.url=t,e.method="POST",this.apiCall(e)},e.prototype.put=function(t,e){return e=e||{},e.url=t,e.method="PUT",this.apiCall(e)},e.prototype["delete"]=function(t,e){return e=e||{},e.url=t,e.method="DELETE",this.apiCall(e)},e.prototype.authCall=function(t){return t=t||{},t.method=t.method||"POST",t.url=this.apiUrl(t.url,{addServer:!0}),this.getRequest().setOptions(t).setHeader("Content-Type","application/x-www-form-urlencoded").setHeader("Accept","application/json").setHeader("Authorization","Basic "+this.apiKey).send()},e.prototype.apiUrl=function(t,e){t=t||"",e=e||{};var n="";return e.addServer&&-1==t.indexOf("http://")&&-1==t.indexOf("https://")&&(n+=this.server),-1==t.indexOf(this.urlPrefix)&&(n+=this.urlPrefix+"/"+this.apiVersion),t.indexOf(this.accountPrefix)>-1&&n.replace(this.accountPrefix+"~",this.accountPrefix+this.account),n+=t,(e.addMethod||e.addToken)&&(n+=t.indexOf("?")>-1?"&":"?"),e.addMethod&&(n+="_method="+e.addMethod),e.addToken&&(n+=(e.addMethod?"&":"")+"access_token="+this.getToken()),n},e.prototype.destroy=function(){return t.prototype.destroy.call(this),this},e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n),this},e.prototype.off=function(e,n){return t.prototype.on.call(this,e,n),this},e.prototype.emitAndCallback=function(e,n,r){return t.prototype.emitAndCallback.call(this,e,n,r),this},e.forcedTokenType="forced",e}(o.Observable);e.Platform=u,e.$get=r},function(t,e,n){function r(t){return new s(t)}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(16),s=function(t){function e(e){t.call(this,e),this.events={notification:"notification",removeSuccess:"removeSuccess",removeError:"removeError",renewSuccess:"renewSuccess",renewError:"renewError",subscribeSuccess:"subscribeSuccess",subscribeError:"subscribeError"},this.pubnub=null,this.eventFilters=[],this.timeout=null,this.subscription={eventFilters:[],expirationTime:"",expiresIn:0,deliveryMode:{transportType:"PubNub",encryption:!1,address:"",subscriberKey:"",secretKey:""},id:"",creationTime:"",status:"",uri:""}}return i(e,t),e.prototype.getPubnub=function(){return this.context.getPubnub()},e.prototype.getCrypto=function(){return this.context.getCryptoJS()},e.prototype.getPlatform=function(){return n(18).$get(this.context)},e.prototype.register=function(t){return this.isSubscribed()?this.renew(t):this.subscribe(t)},e.prototype.addEvents=function(t){return this.eventFilters=this.eventFilters.concat(t),this},e.prototype.setEvents=function(t){return this.eventFilters=t,this},e.prototype.getFullEventFilters=function(){var t=this;return this.eventFilters.map(function(e){return t.getPlatform().apiUrl(e)})},e.prototype.subscribe=function(t){var e=this;return t=t||{},t.events&&(this.eventFilters=t.events),this.clearTimeout(),new(this.context.getPromise())(function(t){if(!e.eventFilters||!e.eventFilters.length)throw new Error("Events are undefined");t(e.getPlatform().apiCall({method:"POST",url:"/restapi/v1.0/subscription",post:{eventFilters:e.getFullEventFilters(),deliveryMode:{transportType:"PubNub"}}}))}).then(function(t){return e.updateSubscription(t.data).subscribeAtPubnub().emit(e.events.subscribeSuccess,t.data),t})["catch"](function(t){throw e.unsubscribe().emit(e.events.subscribeError,t),t})},e.prototype.renew=function(t){var e=this;return t=t||{},t.events&&(this.eventFilters=t.events),this.clearTimeout(),new(this.context.getPromise())(function(t){if(!e.subscription||!e.subscription.id)throw new Error("Subscription ID is required");if(!e.eventFilters||!e.eventFilters.length)throw new Error("Events are undefined");t()}).then(function(){return e.getPlatform().apiCall({method:"PUT",url:"/restapi/v1.0/subscription/"+e.subscription.id,post:{eventFilters:e.getFullEventFilters()}})}).then(function(t){return e.updateSubscription(t.data).emit(e.events.renewSuccess,t.data),t})["catch"](function(t){throw e.unsubscribe().emit(e.events.renewError,t),t})},e.prototype.remove=function(t){var e=this;return t=this.utils.extend({async:!0},t),new(this.context.getPromise())(function(n){if(!e.subscription||!e.subscription.id)throw new Error("Subscription ID is required");n(e.getPlatform().apiCall({async:!!t.async,method:"DELETE",url:"/restapi/v1.0/subscription/"+e.subscription.id}))}).then(function(t){return e.unsubscribe().emit(e.events.removeSuccess,t),t})["catch"](function(t){throw e.emit(e.events.removeError,t),t})},e.prototype.destroy=function(){return this.unsubscribe(),this.log.info("RC.core.Subscription: Destroyed"),t.prototype.destroy.call(this)},e.prototype.isSubscribed=function(){return this.subscription&&this.subscription.deliveryMode&&this.subscription.deliveryMode.subscriberKey&&this.subscription.deliveryMode.address},e.prototype.setTimeout=function(){var t=this,n=1e3*this.subscription.expiresIn-e.renewHandicapMs;this.timeout=setTimeout(function(){t.renew({})},n)},e.prototype.clearTimeout=function(){clearTimeout(this.timeout)},e.prototype.updateSubscription=function(t){return this.clearTimeout(),this.subscription=t,this.setTimeout(),this},e.prototype.unsubscribe=function(){return this.clearTimeout(),this.pubnub&&this.isSubscribed()&&this.pubnub.unsubscribe({channel:this.subscription.deliveryMode.address}),this.subscription=null,this},e.prototype.notify=function(t){if(this.isSubscribed()&&this.subscription.deliveryMode.encryptionKey){var e=this.getCrypto(),n=e.enc.Base64.parse(this.subscription.deliveryMode.encryptionKey),r=e.enc.Base64.parse(t),i=e.AES.decrypt({ciphertext:r},n,{mode:e.mode.ECB,padding:e.pad.Pkcs7}).toString(e.enc.Utf8);t=JSON.parse(i)}return this.emit(this.events.notification,t),this},e.prototype.subscribeAtPubnub=function(){var t=this;if(!this.isSubscribed())return this;var e=this.getPubnub();return this.pubnub=e.init({ssl:!0,subscribe_key:this.subscription.deliveryMode.subscriberKey}),this.pubnub.ready(),this.pubnub.subscribe({channel:this.subscription.deliveryMode.address,message:function(e){t.log.info("RC.core.Subscription: Incoming message",e),t.notify(e)},connect:function(){t.log.info("RC.core.Subscription: PUBNUB connected")}}),this},e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n),this},e.prototype.off=function(e,n){return t.prototype.on.call(this,e,n),this},e.prototype.emitAndCallback=function(e,n,r){return t.prototype.emitAndCallback.call(this,e,n,r),this},e.renewHandicapMs=6e4,e}(o.Observable);e.Subscription=s,e.$get=r},function(t,e){function n(t){return t.createSingleton("Utils",function(){return new a})}var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=/\d/,s={};"Boolean Number String Function Array Date RegExp Object".split(" ").forEach(function(t){s["[object "+t+"]"]=t.toLowerCase()});var a=function(){function t(){}return t.prototype.extend=function(){for(var t=[],e=2;e<arguments.length;e++)t[e-2]=arguments[e];var n,r,i,o,s,a,u=arguments[0]||{},c=1,f=arguments.length,p=!1;for("boolean"==typeof u&&(p=u,u=arguments[c]||{},c++),"object"==typeof u||this.isFunction(u)||(u={});f>c;c++)if(null!==(n=arguments[c]))for(r in n)i=u[r],o=n[r],u!==o&&(p&&o&&(this.isPlainObject(o)||(s=this.isArray(o)))?(s?(s=!1,a=i&&this.isArray(i)?i:[]):a=i&&this.isPlainObject(i)?i:{},u[r]=this.extend(p,a,o)):void 0!==o&&(u[r]=o));return u},t.prototype.forEach=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=e(t[n],n);if(r===!1)break}},t.prototype.queryStringify=function(t){var e=this,n=[];return this.forEach(t,function(t,r){e.isArray(t)?t.forEach(function(t){n.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):n.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}),n.join("&")},t.prototype.parseQueryString=function(t){var e={},n=this;return t.split("&").forEach(function(t){if(t=decodeURIComponent(t),-1==t.indexOf("="))e[t.trim()]=!0;else{var r=t.split("="),i=r[0].trim(),o=r[1].trim();i in e?(i in e&&!n.isArray(e[i])&&(e[i]=[e[i]]),e[i].push(o)):e[i]=o}}),e},t.prototype.isEmail=function(t,e){return e?/^(?:[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?[ ,;]*)+$/i.test(t):/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i.test(t)},t.prototype.isPhoneNumber=function(t){return/\+?1[0-9]{3}[0-9a-z]{7}/im.test(t.toString().split(/[^0-9a-z\+]/im).join(""))},t.prototype.argumentsToArray=function(t){return Array.prototype.slice.call(t||[],0)},t.prototype.isDate=function(t){return"date"===this.type(t)},t.prototype.isFunction=function(t){return"function"===this.type(t)},t.prototype.isArray=function(t){return Array.isArray?Array.isArray(t):"array"===this.type(t)},t.prototype.isWindow=function(t){return t&&"object"==typeof t&&"setInterval"in t},t.prototype.isNaN=function(t){return null===t||!o.test(t)||isNaN(t)},t.prototype.type=function(t){return null===t?String(t):s[i.call(t)]||"object"},t.prototype.isPlainObject=function(t){if(!t||"object"!==this.type(t)||t.nodeType||this.isWindow(t))return!1;if(t.constructor&&!r.call(t,"constructor")&&!r.call(t.constructor.prototype,"isPrototypeOf"))return!1;var e;for(e in t);return void 0===e||r.call(t,e)},t.prototype.getProperty=function(t,e){return e.split(/[.[\]]/).reduce(function(t,e){return t?e?t[e]:t:void 0},t)},t.prototype.poll=function(t,e,n){this.stopPolling(n),e=e||1e3;var r=function(n){return n=n||e,e=n,setTimeout(function(){t(r,n)},n)};return r()},t.prototype.stopPolling=function(t){t&&clearTimeout(t)},t.prototype.parseString=function(t){return t?t.toString():""},t.prototype.parseNumber=function(t){return t?(t=parseFloat(t),isNaN(t)?0:t):0},t}();e.Utils=a,e.$get=n},function(t,e,n){function r(t){return t.createSingleton("Validator",function(){return new o(t)})}var i=n(20),o=function(){function t(t){this.context=t,this.utils=i.$get(t)}return t.prototype.validate=function(t){var e={errors:{},isValid:!0};return e.errors=t.reduce(function(t,n){var r=n.validator();return r.length>0&&(e.isValid=!1,t[n.field]=t[n.field]||[],t[n.field]=t[n.field].concat(r)),t},{}),e},t.prototype.email=function(t,e){var n=this;return function(){return t?n.utils.isEmail(t,e)?[]:[new Error("Value has to be a valid email")]:[]}},t.prototype.phone=function(t){var e=this;return function(){return t?e.utils.isPhoneNumber(t)?[]:[new Error("Value has to be a valid US phone number")]:[]}},t.prototype.required=function(t){return function(){return t?[]:[new Error("Field is required")]}},t.prototype.length=function(t,e,n){return function(){var r=[];return t?(t=t.toString(),n&&t.length<n&&r.push(new Error("Minimum length of "+n+" characters is required")),e&&t.length>e&&r.push(new Error("Maximum length of "+e+" characters is required")),r):r}},t}();e.Validator=o,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Account",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/account/~"},e}(o.Helper);e.Account=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("BlockedNumber",function(){return new a(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(21),a=function(t){function e(e){t.call(this,e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId?t.extensionId:"~")+"/blocked-number"+(e?"/"+e:"")},e.prototype.validate=function(t){return this.validator.validate([{field:"phoneNumber",validator:this.validator.phone(t.phoneNumber)},{field:"phoneNumber",validator:this.validator.required(t.phoneNumber)},{field:"name",validator:this.validator.required(t.name)}])},e}(o.Helper);e.BlockedNumber=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Call",function(){return new c(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=n(37),u=n(25),c=function(t){function e(e){t.call(this,e),this.list=s.$get(e),this.contact=u.$get(e),this.presence=a.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"personal"in t||"extensionId"in t||(t.personal=!0),"/account/~/"+(t.personal||t.extensionId?"extension/"+(t.extensionId||"~")+"/":"")+(t.active?"active-calls":"call-log")+(e?"/"+e:"")},e.prototype.getSessionId=function(t){return t&&t.sessionId},e.prototype.isInProgress=function(t){return t&&"In Progress"==t.result},e.prototype.isAlive=function(t){return t&&"Alive"==t.availability},e.prototype.isInbound=function(t){return t&&"Inbound"==t.direction},e.prototype.isOutbound=function(t){return!this.isInbound(t)},e.prototype.isMissed=function(t){return t&&"Missed"==t.result},e.prototype.isFindMe=function(t){return t&&"FindMe"==t.action},e.prototype.getCallerInfo=function(t){return this.isInbound(t)?t.from:t.to},e.prototype.getAllCallerInfos=function(t){return[this.getCallerInfo(t)].concat(this.isInbound(t)?t.to:t.from)},e.prototype.formatDuration=function(t){function e(t){return 10>t?"0"+t:t}var n=parseInt(t.duration),r=Math.floor(n/3600),i=Math.floor(n%3600/60),o=Math.floor(n%60);return(r?r+":":"")+e(i)+":"+e(o)},e.prototype.filter=function(t){return t=this.utils.extend({alive:!0,direction:"",type:""},t),this.list.filter([{filterBy:"direction",condition:t.direction},{filterBy:"type",condition:t.type}])},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"startTime"},t))},e.prototype.attachContacts=function(t,e,n){var r=this,i=e.reduce(function(t,e){return t.concat(r.getAllCallerInfos(e))},[]);this.contact.attachToCallerInfos(i,t,n)},e.prototype.checkMergeability=function(t,e,n){function r(t){return new Date(t).getTime()}return(!n.strict||t.action&&-1!=t.action.toLowerCase().indexOf("ringout"))&&"Outbound"==t.direction&&"Inbound"==e.direction&&(!e.startTime&&!t.startTime||Math.abs(r(e.startTime)-r(t.startTime))<(n.maxStartTimeDiscrepancy||5e3))&&e.from.phoneNumber==t.to.phoneNumber&&(e.to.phoneNumber==t.from.phoneNumber||e.to.name==t.from.name)},e.prototype.combineCalls=function(t,e,n){n=n||{};var r=[];return t.hasSubsequent=!0,n.merge?(t.duration=t.duration>e.duration?t.duration:e.duration,t.from=e.to,t.to=e.from,r.push(t)):(e.subsequent=!0,e.startTime=t.startTime,r.push(t),r.push(e)),r
},e.prototype.processCalls=function(t,e){var n=[],r=[],i=this;return t.forEach(function(o){var s=!1;o.subsequent=!1,o.hasSubsequent=!1,t.some(function(t){return o===t?!1:(i.checkMergeability(o,t,e)&&(n=n.concat(i.combineCalls(o,t,e)),r.push(o),r.push(t),s=!0),s)})}),t.forEach(function(t){-1==r.indexOf(t)&&n.push(t)}),n},e.prototype.parsePresenceCalls=function(t){var e=this;return t.map(function(t){return{id:t.id,uri:"",sessionId:t.sessionId,from:{phoneNumber:t.from},to:{phoneNumber:t.to},direction:t.direction,startTime:"",duration:0,type:"",action:"",result:e.presence.isCallInProgress(t)?"In Progress":t.telephonyStatus,telephonyStatus:t.telephonyStatus}})},e.prototype.getSignature=function(t){function e(t){return(t||"").toString().replace(/[^0-9]/gi,"")}return t.direction+"|"+(t.from&&e(t.from.phoneNumber))+"|"+(t.to&&e(t.to.phoneNumber))},e.prototype.mergePresenceCalls=function(t,e){var n=new Date,r=this.parsePresenceCalls(e&&e.activeCalls||[]).map(function(t){return delete t.startTime,t});return t=this.merge(t||[],r,this.getSessionId,!0),t.forEach(function(t){t.startTime||(t.startTime=n.toISOString())}),t},e.prototype.mergeAll=function(t,e,n){var r=this.merge(t||[],e||[],this.getSessionId,!0);return this.merge(r,n||[],this.getSessionId,!0)},e}(o.Helper);e.Call=c,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Contact",function(){return new u(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(21),a=n(14),u=function(t){function e(e){t.call(this,e),this.phoneFields=["homePhone","homePhone2","businessPhone","businessPhone2","mobilePhone","companyPhone","assistantPhone","carPhone","otherPhone","callbackPhone"],this.faxFields=["businessFax","otherFax"],this.addressFields=["homeAddress","businessAddress","otherAddress"],this.addressSubFields=["street","city","state","zip"],this.nameFields=["firstName","middleName","lastName","nickName"],this.otherFields=["company","jobTitle","webPage","notes"],this.emailFields=["email","email2","email3"],this.list=a.$get(e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){t=t||{};var n="/account/~/extension/"+(t.extensionId?t.extensionId:"~")+"/address-book";return t.sync?n+"-sync":n+(t.groupId?"/group/"+t.groupId+"/contact":"/contact")+(e?"/"+e:"")},e.prototype.getFieldValues=function(t,e,n){return e.reduce(function(e,r){return t&&t[r]&&(n?e[r]=t[r]:e.push(t[r])),e},n?{}:[])},e.prototype.getFullName=function(t){return this.getFieldValues(t,this.nameFields).join(" ")},e.prototype.getEmails=function(t,e){return this.getFieldValues(t,this.emailFields,e)},e.prototype.getPhones=function(t,e){return this.getFieldValues(t,this.phoneFields,e)},e.prototype.getFaxes=function(t,e){return this.getFieldValues(t,this.faxFields,e)},e.prototype.getAddresses=function(t,e){return this.getFieldValues(t,this.addressFields,e)},e.prototype.isAlive=function(t){return"Alive"==t.availability},e.prototype.match=function(t,e,n){var r=this;n=this.utils.extend({fields:[].concat(this.nameFields,this.emailFields,this.phoneFields,this.faxFields,this.otherFields),inAddresses:!0,transformFn:function(t){return t?t.toString().toLocaleLowerCase():""},strict:!1},n),e=n.transformFn(e,n);var i=null;if(!e)return i;var o=function(t){if(!i){var r=n.transformFn(t,n);if(r){var o=n.strict?r==e:r.indexOf(e)>-1;o&&(i=t)}}};return n.fields.forEach(function(e){o(t[e])}),n.inAddresses&&!i&&this.addressFields.forEach(function(e){t[e]&&!i&&r.addressSubFields.forEach(function(n){o(t[e][n])})}),i},e.prototype.matchAsPhone=function(t,e,n){return this.match(t,e,this.utils.extend({fields:[].concat(this.phoneFields,this.faxFields),inAddresses:!1,transformFn:function(t){return t?t.toString().replace(/[^\d\w]/gi,""):""},strict:!1},n))},e.prototype.attachToCallerInfos=function(t,e,n){var r=this,i=this.index(t,function(t){return t.phoneNumber},!0);this.utils.forEach(i,function(t,i){var o=null,s=null;e.some(function(t){return s=r.matchAsPhone(t,i,n),s&&(o=t),s}),o&&t.forEach(function(t){t.contact=o,t.contactPhone=s})})},e.prototype.comparator=function(t){var e=this;return this.list.comparator(this.utils.extend({extractFn:function(t){return e.getFullName(t)}},t))},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({alive:!0,startsWith:"",phonesOnly:!1,faxesOnly:!1},t),this.list.filter([{condition:t.alive,filterFn:this.isAlive},{condition:t.startsWith,filterFn:function(t,n){return e.match(t,n.condition)}},{condition:t.phonesOnly,filterFn:function(t){return e.getPhones(t).length>0}},{condition:t.faxesOnly,filterFn:function(t){return e.getFaxes(t).length>0}}])},e.prototype.validate=function(t){return this.validator.validate([{field:"firstName",validator:this.validator.required(t.firstName)},{field:"lastName",validator:this.validator.required(t.lastName)},{field:"email",validator:this.validator.email(t.email)},{field:"email2",validator:this.validator.email(t.email2)},{field:"email3",validator:this.validator.email(t.email3)}])},e}(o.Helper);e.Contact=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("ContactGroup",function(){return new a(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(21),a=function(t){function e(e){t.call(this,e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return"/account/~/extension/~/address-book/group"+(e?"/"+e:"")},e.prototype.validate=function(t){return this.validator.validate([{field:"groupName",validator:this.validator.required(t&&t.groupName)}])},e}(o.Helper);e.ContactGroup=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Conferencing",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/account/~/extension/~/conferencing"},e}(o.Helper);e.Conferencing=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Country",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/country"},e}(o.Helper);e.Country=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Device",function(){return new c(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(21),a=n(31),u=n(30),c=function(t){function e(e){t.call(this,e),this.validator=s.$get(e),this.extension=a.$get(e),this.deviceModel=u.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},t.order?"/account/~/order":"/account/~"+(t.extensionId?"/extension/"+t.extensionId:"")+"/device"+(e?"/"+e:"")},e.prototype.validate=function(t){return this.validator.validate([{field:"emergencyServiceAddress-street",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.street)},{field:"emergencyServiceAddress-city",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.city)},{field:"emergencyServiceAddress-state",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.state)},{field:"emergencyServiceAddress-country",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.country)},{field:"emergencyServiceAddress-zip",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.zip)},{field:"emergencyServiceAddress-customerName",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.customerName)},{field:"extension",validator:this.validator.required(this.extension.getId(t&&t.extension))},{field:"model",validator:this.validator.required(this.deviceModel.getId(t&&t.model))}])},e}(o.Helper);e.Device=c,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("DeviceModel",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments),this.devices=[{id:"-1",name:"Softphone"},{id:"0",name:"Existing device"},{id:"19",name:"Cisco SPA-525G2 Desk Phone",deviceClass:"Desk Phone"},{id:"23",name:"Polycom IP 321 Basic IP phone",deviceClass:"Desk Phone"},{id:"30",name:"Polycom IP 550 HD Manager IP phone",deviceClass:"Desk Phone"},{id:"37",name:"Polycom IP 6000 Conference Phone",deviceClass:"Conference Phone"},{id:"40",name:"Polycom IP 335 HD IP phone",deviceClass:"Desk Phone"},{id:"51",name:"Cisco SPA-303 Desk Phone",deviceClass:"Desk Phone"},{id:"16",name:"Cisco SPA-508G Desk Phone with 1 Expansion Module",deviceClass:"Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"1"}]},{id:"16",name:"Cisco SPA-508G Desk Phone with 2 Expansion Modules",deviceClass:"Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"2"}]},{id:"16",name:"Cisco SPA-508G Desk Phone",deviceClass:"Desk Phone"},{id:"19",name:"Cisco SPA-525G2 Desk Phone with 1 Expansion Module",deviceClass:"Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"1"}]},{id:"19",name:"Cisco SPA-525G2 Desk Phone with 2 Expansion Modules	Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"2"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone with 1 Expansion Module",deviceClass:"Desk Phone",addons:[{id:"1",name:"Plolycom Expansion",count:"1"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone with 2 Expansion Modules",deviceClass:"Desk Phone",addons:[{id:"1",name:"Plolycom Expansion",count:"2"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone with 3 Expansion Modules",deviceClass:"Desk Phone",addons:[{id:"1",name:"Plolycom Expansion",count:"3"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone",deviceClass:"Desk Phone"},{id:"52",name:"Cisco SPA-122 ATA",deviceClass:"Analog Adapter"},{id:"53",name:"Polycom VVX-500 Color Touchscreen",deviceClass:"Desk Phone"},{id:"54",name:"Polycom VVX-310 Gigabit Ethernet Phone",deviceClass:"Desk Phone"},{id:"55",name:"Polycom VVX-410 Color Gigabit Ethernet Phone",deviceClass:"Desk Phone"}]}return i(e,t),e.prototype.getId=function(t){return t?t.id+(t.addons&&t.addons[0]?"-"+t.addons[0].id+"-"+t.addons[0].count:""):null},e.prototype.cleanForSaving=function(t){return t?(delete t.name,delete t.deviceClass,t.addons&&t.addons.length>0?t.addons.forEach(function(e,n){delete t.addons[n].name}):delete t.addons,t):null},e}(o.Helper);e.DeviceModel=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Extension",function(){return new a(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=function(t){function e(e){t.call(this,e),this.type={department:"Department",user:"User",announcement:"Announcement",voicemail:"Voicemail"},this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~"+(t.departmentId?"/department/"+t.departmentId+"/members":"/extension")+(e?"/"+e:"")},e.prototype.isUser=function(t){return t&&t.type==this.type.user},e.prototype.isDepartment=function(t){return t&&t.type==this.type.department},e.prototype.isAnnouncement=function(t){return t&&t.type==this.type.announcement},e.prototype.isVoicemail=function(t){return t&&t.type==this.type.voicemail},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"extensionNumber",compareFn:this.list.numberComparator},t))},e.prototype.filter=function(t){return t=this.utils.extend({search:"",type:""},t),this.list.filter([{filterBy:"type",condition:t.type},{condition:t.search.toLocaleLowerCase(),filterFn:this.list.containsFilter,extractFn:function(t){return(t.name&&t.name.toLocaleLowerCase()+" ")+(t.extensionNumber&&t.extensionNumber.toString().toLocaleLowerCase())}}])},e}(o.Helper);e.Extension=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("ForwardingNumber",function(){return new a(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=function(t){function e(e){t.call(this,e),this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId||"~")+"/forwarding-number"+(e?"/"+e:"")},e.prototype.getId=function(t){return t&&(t.id||t.phoneNumber)},e.prototype.hasFeature=function(t,e){return!!t&&!!t.features&&-1!=t.features.indexOf(e)},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"label"},t))},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({features:[]},t),this.list.filter([{condition:t.features.length,filterFn:function(n){return t.features.some(function(t){return e.hasFeature(n,t)})}}])},e}(o.Helper);e.ForwardingNumber=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Language",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments),this.languages=[{id:"1033",name:"English (US)"},{id:"3084",name:"French (Canada)"}]}return i(e,t),e}(o.Helper);e.Language=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Location",function(){return new u(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=n(41),u=function(t){function e(e){t.call(this,e),this.list=s.$get(e),this.state=a.$get(e)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/location"},e.prototype.filter=function(t){var e=[];return t=this.utils.extend({stateId:"",onlyUniqueNPA:!1},t),this.list.filter([{condition:t.stateId,filterFn:function(t,e){return this.state.getId(t.state)==e.condition}.bind(this)},{condition:t.onlyUniqueNPA,filterFn:function(t){return-1==e.indexOf(t.npa)?(e.push(t.npa),!0):!1}}])},e.prototype.comparator=function(t){return t=this.utils.extend({sortBy:"npa"},t),"nxx"==t.sortBy&&(t.extractFn=function(t){return 1e6*parseInt(t.npa)+parseInt(t.nxx)},t.compareFn=this.list.numberComparator),this.list.comparator(t)},e}(o.Helper);e.Location=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Message",function(){return new p(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=n(21),u=n(19),c=n(18),f=n(25),p=function(t){function e(e){t.call(this,e),this.contact=f.$get(e),this.list=s.$get(e),this.platform=c.$get(e),this.validator=a.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){t=t||{};var n="/account/~/extension/"+(t.extensionId||"~");return t.fax?n+"/fax":t.sms?n+"/sms":t.pager?n+"/company-pager":t.sync?n+"/message-sync":n+"/message-store"+(e?"/"+e:"")},e.prototype.isInbound=function(t){return t&&"Inbound"==t.direction},e.prototype.isOutbound=function(t){return!this.isInbound(t)},e.prototype.isSMS=function(t){return t&&"SMS"==t.type},e.prototype.isPager=function(t){return t&&"Pager"==t.type},e.prototype.isVoiceMail=function(t){return t&&"VoiceMail"==t.type},e.prototype.isFax=function(t){return t&&"Fax"==t.type},e.prototype.isAlive=function(t){return t&&"Alive"==t.availability},e.prototype.isRead=function(t){return"Read"==t.readStatus},e.prototype.setIsRead=function(t,e){return t.readStatus=e?"Read":"Unread",t},e.prototype.getAttachmentUrl=function(t,e){return t.attachments[e]?this.platform.apiUrl(t.attachments[e].uri,{addMethod:"GET",addServer:!0,addToken:!0}):""},e.prototype.getAttachmentContentType=function(t,e){return t.attachments[e]?t.attachments[e].contentType:""},e.prototype.getSubscription=function(t){return u.$get(this.context).setEvents([this.createUrl(t)])},e.prototype.getCallerInfos=function(t){return this.isInbound(t)?[t.from]:t.to},e.prototype.getAllCallerInfos=function(t){return this.getCallerInfos(t).concat(this.isInbound(t)?t.to:[t.from])},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"creationTime"},t))},e.prototype.filter=function(t){return t=this.utils.extend({search:"",alive:!0,direction:"",conversationId:"",readStatus:""},t),this.list.filter([{condition:t.alive,filterFn:this.isAlive},{filterBy:"type",condition:t.type},{filterBy:"direction",condition:t.direction},{filterBy:"conversationId",condition:t.conversationId},{filterBy:"readStatus",condition:t.readStatus},{filterBy:"subject",condition:t.search,filterFn:this.list.containsFilter}])},e.prototype.attachContacts=function(t,e,n){var r=this,i=e.reduce(function(t,e){return t.concat(r.getAllCallerInfos(e))},[]);this.contact.attachToCallerInfos(i,t,n)},e.prototype.shorten=function(t){return{from:t.from,to:t.to,text:t.subject}},e.prototype.validateSMS=function(t){return this.validator.validate([{field:"to",validator:this.validator.required(this.utils.getProperty(t,"to[0].phoneNumber"))},{field:"from",validator:this.validator.required(this.utils.getProperty(t,"from.phoneNumber"))},{field:"subject",validator:this.validator.required(this.utils.getProperty(t,"subject"))},{field:"subject",validator:this.validator.length(this.utils.getProperty(t,"subject"),160)}])},e.prototype.validatePager=function(t){return this.validator.validate([{field:"to",validator:this.validator.required(this.utils.getProperty(t,"to.extensionNumber"))},{field:"from",validator:this.validator.required(this.utils.getProperty(t,"from.extensionNumber"))},{field:"subject",validator:this.validator.required(this.utils.getProperty(t,"subject"))},{field:"subject",validator:this.validator.length(this.utils.getProperty(t,"subject"),160)}])},e}(o.Helper);e.Message=p,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("PhoneNumber",function(){return new u(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=n(31),u=function(t){function e(e){t.call(this,e),this.extension=a.$get(e),this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},t.lookup?"/number-pool/lookup":"/account/~"+(t.extensionId?"/extension/"+t.extensionId:"")+"/phone-number"+(e?"/"+e:"")},e.prototype.isSMS=function(t){return this.hasFeature(t,"SmsSender")},e.prototype.hasFeature=function(t,e){return!!t.features&&-1!=t.features.indexOf(e)},e.prototype.reserve=function(t,e){t.reservedTill=new Date(e).toISOString()},e.prototype.unreserve=function(t){t.reservedTill=null},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({extractFn:function(t){return t.usageType+"-"+t.paymentType+"-"+t.type}},t))},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({usageType:"",paymentType:"",type:"",features:[]},t),this.list.filter([{filterBy:"usageType",condition:t.usageType},{filterBy:"paymentType",condition:t.paymentType},{filterBy:"type",condition:t.type},{condition:t.features.length,filterFn:function(n){return t.features.some(function(t){return e.hasFeature(n,t)})}}])},e}(o.Helper);e.PhoneNumber=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Presence",function(){return new u(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(19),a=n(31),u=function(t){function e(e){t.call(this,e),this.extension=a.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(e||"~")+"/presence"+(t.detailed?"?detailedTelephonyState=true":"")},e.prototype.getId=function(t){return t&&(this.extension.getId(t.extension)||t.extensionId)},e.prototype.isAvailable=function(t){return t&&"Available"==t.presenceStatus},e.prototype.getSubscription=function(t,e){return s.$get(this.context).setEvents([this.createUrl(t,e)])},e.prototype.updateSubscription=function(t,e,n){var r=e.map(this.getId,this).map(function(t){return this.createUrl(n,t)},this);return t.addEvents(r),t},e.prototype.attachToExtensions=function(t,e,n){var r=this,i=this.index(e);return t.forEach(function(t){var e=i[r.extension.getId(t)];e&&("presence"in t&&n?r.utils.extend(t.presence,e):t.presence=e)},this),this},e.prototype.isCallInProgress=function(t){return t&&"NoCall"!=t.telephonyStatus},e}(o.Helper);e.Presence=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Ringout",function(){return new a(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(21),a=function(t){function e(e){t.call(this,e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId||"~")+"/ringout"+(e?"/"+e:"")},e.prototype.resetAsNew=function(e){return e=t.prototype.resetAsNew.call(this,e),e&&delete e.status,e},e.prototype.isInProgress=function(t){return t&&!this.isNew(t)&&t.status&&"InProgress"==t.status.callStatus},e.prototype.isSuccess=function(t){return t&&!this.isNew(t)&&t.status&&"Success"==t.status.callStatus},e.prototype.isError=function(t){return!this.isNew(t)&&!this.isInProgress(t)&&!this.isSuccess(t)},e.prototype.validate=function(t){return this.validator.validate([{field:"to",validator:this.validator.required(t&&t.to&&t.to.phoneNumber)},{field:"from",validator:this.validator.required(t&&t.from&&t.from.phoneNumber)}])},e}(o.Helper);e.Ringout=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Service",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments),this.isSmsEnabled=this.isServiceFeatureEnabledMethod("SMS"),this.isSmsReceivingEnabled=this.isServiceFeatureEnabledMethod("SMSReceiving"),this.isPresenceEnabled=this.isServiceFeatureEnabledMethod("Presence"),this.isRingOutEnabled=this.isServiceFeatureEnabledMethod("RingOut"),this.isInternationalCallingEnabled=this.isServiceFeatureEnabledMethod("InternationalCalling"),this.isDndEnabled=this.isServiceFeatureEnabledMethod("DND"),this.isFaxEnabled=this.isServiceFeatureEnabledMethod("Fax"),this.isFaxReceivingEnabled=this.isServiceFeatureEnabledMethod("FaxReceiving"),this.isVoicemailEnabled=this.isServiceFeatureEnabledMethod("Voicemail"),this.isPagerEnabled=this.isServiceFeatureEnabledMethod("Pager"),this.isPagerReceivingEnabled=this.isServiceFeatureEnabledMethod("PagerReceiving"),this.isVoipCallingEnabled=this.isServiceFeatureEnabledMethod("VoipCalling"),this.isVideoConferencingEnabled=this.isServiceFeatureEnabledMethod("VideoConferencing"),this.isSalesForceEnabled=this.isServiceFeatureEnabledMethod("SalesForce"),this.isIntercomEnabled=this.isServiceFeatureEnabledMethod("Intercom"),this.isPagingEnabled=this.isServiceFeatureEnabledMethod("Paging"),this.isConferencingEnabled=this.isServiceFeatureEnabledMethod("Conferencing"),this.isFreeSoftPhoneLinesEnabled=this.isServiceFeatureEnabledMethod("FreeSoftPhoneLines"),this.isHipaaComplianceEnabled=this.isServiceFeatureEnabledMethod("HipaaCompliance"),this.isCallParkEnabled=this.isServiceFeatureEnabledMethod("CallPark"),this.isOnDemandCallRecordingEnabled=this.isServiceFeatureEnabledMethod("OnDemandCallRecording")}return i(e,t),e.prototype.createUrl=function(){return"/account/~/service-info"},e.prototype.isEnabled=function(t,e){return e.reduce(function(e,n){return n.featureName==t&&(e=n.enabled),e},!1)},e.prototype.isServiceFeatureEnabledMethod=function(t){return function(e){return this.isEnabled(t,e)}},e}(o.Helper);e.Service=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("ShippingMethod",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments),this.shippingMethods=[{id:"1",name:"Ground Shipping (5-7 business days)"},{id:"2",name:"2-days Shipping"},{id:"3",name:"Overnight Shipping"}]}return i(e,t),e}(o.Helper);e.ShippingMethod=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("State",function(){return new u(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=n(14),a=n(28),u=function(t){function e(e){t.call(this,e),this.countryHelper=a.$get(e),this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/state"},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({countryId:""},t),this.list.filter([{condition:t.countryId,filterFn:function(t,n){return e.countryHelper.getId(t.country)==n.condition}}])},e}(o.Helper);e.State=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Timezone",function(){return new s(t)})}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(13),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/timezone"},e}(o.Helper);e.Timezone=s,e.$get=r},function(t,e,n){!function(r,i){t.exports=e=i(n(7))}(this,function(t){return function(){var e=t,n=e.lib,r=n.WordArray,i=e.enc;i.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp();for(var i=[],o=0;n>o;o+=3)for(var s=255&e[o>>>2]>>>24-8*(o%4),a=255&e[o+1>>>2]>>>24-8*((o+1)%4),u=255&e[o+2>>>2]>>>24-8*((o+2)%4),c=s<<16|a<<8|u,f=0;4>f&&n>o+.75*f;f++)i.push(r.charAt(63&c>>>6*(3-f)));var p=r.charAt(64);if(p)for(;i.length%4;)i.push(p);return i.join("")},parse:function(t){var e=t.length,n=this._map,i=n.charAt(64);if(i){var o=t.indexOf(i);-1!=o&&(e=o)}for(var s=[],a=0,u=0;e>u;u++)if(u%4){var c=n.indexOf(t.charAt(u-1))<<2*(u%4),f=n.indexOf(t.charAt(u))>>>6-2*(u%4);s[a>>>2]|=(c|f)<<24-8*(a%4),a++}return r.create(s,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64})},function(t,e,n){!function(r,i){t.exports=e=i(n(7))}(this,function(t){return function(e){function n(t,e,n,r,i,o,s){var a=t+(e&n|~e&r)+i+s;return(a<<o|a>>>32-o)+e}function r(t,e,n,r,i,o,s){var a=t+(e&r|n&~r)+i+s;return(a<<o|a>>>32-o)+e}function i(t,e,n,r,i,o,s){var a=t+(e^n^r)+i+s;return(a<<o|a>>>32-o)+e}function o(t,e,n,r,i,o,s){var a=t+(n^(e|~r))+i+s;return(a<<o|a>>>32-o)+e}var s=t,a=s.lib,u=a.WordArray,c=a.Hasher,f=s.algo,p=[];!function(){for(var t=0;64>t;t++)p[t]=0|4294967296*e.abs(e.sin(t+1))}();var l=f.MD5=c.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var s=0;16>s;s++){var a=e+s,u=t[a];t[a]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var c=this._hash.words,f=t[e+0],l=t[e+1],h=t[e+2],d=t[e+3],y=t[e+4],g=t[e+5],v=t[e+6],m=t[e+7],b=t[e+8],_=t[e+9],S=t[e+10],w=t[e+11],x=t[e+12],E=t[e+13],C=t[e+14],k=t[e+15],P=c[0],A=c[1],O=c[2],T=c[3];P=n(P,A,O,T,f,7,p[0]),T=n(T,P,A,O,l,12,p[1]),O=n(O,T,P,A,h,17,p[2]),A=n(A,O,T,P,d,22,p[3]),P=n(P,A,O,T,y,7,p[4]),T=n(T,P,A,O,g,12,p[5]),O=n(O,T,P,A,v,17,p[6]),A=n(A,O,T,P,m,22,p[7]),P=n(P,A,O,T,b,7,p[8]),T=n(T,P,A,O,_,12,p[9]),O=n(O,T,P,A,S,17,p[10]),A=n(A,O,T,P,w,22,p[11]),P=n(P,A,O,T,x,7,p[12]),T=n(T,P,A,O,E,12,p[13]),O=n(O,T,P,A,C,17,p[14]),A=n(A,O,T,P,k,22,p[15]),P=r(P,A,O,T,l,5,p[16]),T=r(T,P,A,O,v,9,p[17]),O=r(O,T,P,A,w,14,p[18]),A=r(A,O,T,P,f,20,p[19]),P=r(P,A,O,T,g,5,p[20]),T=r(T,P,A,O,S,9,p[21]),O=r(O,T,P,A,k,14,p[22]),A=r(A,O,T,P,y,20,p[23]),P=r(P,A,O,T,_,5,p[24]),T=r(T,P,A,O,C,9,p[25]),O=r(O,T,P,A,d,14,p[26]),A=r(A,O,T,P,b,20,p[27]),P=r(P,A,O,T,E,5,p[28]),T=r(T,P,A,O,h,9,p[29]),O=r(O,T,P,A,m,14,p[30]),A=r(A,O,T,P,x,20,p[31]),P=i(P,A,O,T,g,4,p[32]),T=i(T,P,A,O,b,11,p[33]),O=i(O,T,P,A,w,16,p[34]),A=i(A,O,T,P,C,23,p[35]),P=i(P,A,O,T,l,4,p[36]),T=i(T,P,A,O,y,11,p[37]),O=i(O,T,P,A,m,16,p[38]),A=i(A,O,T,P,S,23,p[39]),P=i(P,A,O,T,E,4,p[40]),T=i(T,P,A,O,f,11,p[41]),O=i(O,T,P,A,d,16,p[42]),A=i(A,O,T,P,v,23,p[43]),P=i(P,A,O,T,_,4,p[44]),T=i(T,P,A,O,x,11,p[45]),O=i(O,T,P,A,k,16,p[46]),A=i(A,O,T,P,h,23,p[47]),P=o(P,A,O,T,f,6,p[48]),T=o(T,P,A,O,m,10,p[49]),O=o(O,T,P,A,C,15,p[50]),A=o(A,O,T,P,g,21,p[51]),P=o(P,A,O,T,x,6,p[52]),T=o(T,P,A,O,d,10,p[53]),O=o(O,T,P,A,S,15,p[54]),A=o(A,O,T,P,l,21,p[55]),P=o(P,A,O,T,b,6,p[56]),T=o(T,P,A,O,k,10,p[57]),O=o(O,T,P,A,v,15,p[58]),A=o(A,O,T,P,E,21,p[59]),P=o(P,A,O,T,y,6,p[60]),T=o(T,P,A,O,w,10,p[61]),O=o(O,T,P,A,h,15,p[62]),A=o(A,O,T,P,_,21,p[63]),c[0]=0|c[0]+P,c[1]=0|c[1]+A,c[2]=0|c[2]+O,c[3]=0|c[3]+T},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296),s=r;n[(i+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[(i+64>>>9<<4)+14]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,u=a.words,c=0;4>c;c++){var f=u[c];u[c]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}return a},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t}});s.MD5=c._createHelper(l),s.HmacMD5=c._createHmacHelper(l)}(Math),t.MD5})},function(t,e,n){!function(r,i){t.exports=e=i(n(7),n(53),n(54))}(this,function(t){return function(){var e=t,n=e.lib,r=n.Base,i=n.WordArray,o=e.algo,s=o.MD5,a=o.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,r=n.hasher.create(),o=i.create(),s=o.words,a=n.keySize,u=n.iterations;a>s.length;){c&&r.update(c);var c=r.update(t).finalize(e);r.reset();for(var f=1;u>f;f++)c=r.finalize(c),r.reset();o.concat(c)}return o.sigBytes=4*a,o}});e.EvpKDF=function(t,e,n){return a.create(n).compute(t,e)}}(),t.EvpKDF})},function(t,e,n){!function(r,i){t.exports=e=i(n(7))}(this,function(t){t.lib.Cipher||function(e){var n=t,r=n.lib,i=r.Base,o=r.WordArray,s=r.BufferedBlockAlgorithm,a=n.enc;a.Utf8;var u=a.Base64,c=n.algo,f=c.EvpKDF,p=r.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){t&&this._append(t);var e=this._doFinalize();return e},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?x:_}return function(e){return{encrypt:function(n,r,i){return t(r).encrypt(e,n,r,i)},decrypt:function(n,r,i){return t(r).decrypt(e,n,r,i)}}}}()});r.StreamCipher=p.extend({_doFinalize:function(){var t=this._process(!0);return t},blockSize:1});var l=n.mode={},h=r.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),d=l.CBC=function(){function t(t,n,r){var i=this._iv;if(i){var o=i;this._iv=e}else var o=this._prevBlock;for(var s=0;r>s;s++)t[n+s]^=o[s]}var n=h.extend();
return n.Encryptor=n.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize;t.call(this,e,n,i),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+i)}}),n.Decryptor=n.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=e.slice(n,n+i);r.decryptBlock(e,n),t.call(this,e,n,i),this._prevBlock=o}}),n}(),y=n.pad={},g=y.Pkcs7={pad:function(t,e){for(var n=4*e,r=n-t.sigBytes%n,i=r<<24|r<<16|r<<8|r,s=[],a=0;r>a;a+=4)s.push(i);var u=o.create(s,r);t.concat(u)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}};r.BlockCipher=p.extend({cfg:p.cfg.extend({mode:d,padding:g}),reset:function(){p.reset.call(this);var t=this.cfg,e=t.iv,n=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{var r=n.createDecryptor;this._minBufferSize=1}this._mode=r.call(n,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else{var e=this._process(!0);t.unpad(e)}return e},blockSize:4});var v=r.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),m=n.format={},b=m.OpenSSL={stringify:function(t){var e=t.ciphertext,n=t.salt;if(n)var r=o.create([1398893684,1701076831]).concat(n).concat(e);else var r=e;return r.toString(u)},parse:function(t){var e=u.parse(t),n=e.words;if(1398893684==n[0]&&1701076831==n[1]){var r=o.create(n.slice(2,4));n.splice(0,4),e.sigBytes-=16}return v.create({ciphertext:e,salt:r})}},_=r.SerializableCipher=i.extend({cfg:i.extend({format:b}),encrypt:function(t,e,n,r){r=this.cfg.extend(r);var i=t.createEncryptor(n,r),o=i.finalize(e),s=i.cfg;return v.create({ciphertext:o,key:n,iv:s.iv,algorithm:t,mode:s.mode,padding:s.padding,blockSize:t.blockSize,formatter:r.format})},decrypt:function(t,e,n,r){r=this.cfg.extend(r),e=this._parse(e,r.format);var i=t.createDecryptor(n,r).finalize(e.ciphertext);return i},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),S=n.kdf={},w=S.OpenSSL={execute:function(t,e,n,r){r||(r=o.random(8));var i=f.create({keySize:e+n}).compute(t,r),s=o.create(i.words.slice(e),4*n);return i.sigBytes=4*e,v.create({key:i,iv:s,salt:r})}},x=r.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:w}),encrypt:function(t,e,n,r){r=this.cfg.extend(r);var i=r.kdf.execute(n,t.keySize,t.ivSize);r.iv=i.iv;var o=_.encrypt.call(this,t,e,i.key,r);return o.mixIn(i),o},decrypt:function(t,e,n,r){r=this.cfg.extend(r),e=this._parse(e,r.format);var i=r.kdf.execute(n,t.keySize,t.ivSize,e.salt);r.iv=i.iv;var o=_.decrypt.call(this,t,e,i.key,r);return o}})}()})},function(t,e){function n(t){return new i(t)}var r=function(){function t(){}return t.prototype.ready=function(){},t.prototype.unsubscribe=function(){},t.prototype.subscribe=function(t){this.onMessage=t.message},t.prototype.receiveMessage=function(t){this.onMessage(t,"env","channel")},t}();e.PubnubMock=r;var i=function(){function t(t){this.context=t}return t.prototype.init=function(){return new r},t}();e.PubnubFactory=i,e.$get=n},function(t,e,n){function r(t){return new a(t)}var i=n(20),o=n(15),s=n(9),a=function(){function t(t){this.context=t,this.responses=s.$get(t),this.log=o.$get(t),this.utils=i.$get(t),this.async=!0,this.method="",this.url="",this.requestHeaders={},this.withCredentials=!1,this.data=null,this.readyState=0,this.responseHeaders={},this.status=0}return t.prototype.getResponseHeader=function(t){return this.responseHeaders[t.toLowerCase()]},t.prototype.setRequestHeader=function(t,e){this.requestHeaders[t.toLowerCase()]=e},t.prototype.getAllResponseHeaders=function(){var t=[];return this.utils.forEach(this.responseHeaders,function(e,n){t.push(n+":"+e)}),t.join("\n")},t.prototype.open=function(t,e,n){this.method=t,this.url=e,this.async=n},t.prototype.send=function(t){var e=this,n=this.getRequestHeader("Content-Type");this.data=t,this.data&&"string"==typeof this.data&&("application/json"==n&&(this.data=JSON.parse(this.data)),"application/x-www-form-urlencoded"==n&&(this.data=this.utils.parseQueryString(this.data))),this.log.debug("API REQUEST",this.method,this.url);var r=this.responses.find(this);if(!r)return void setTimeout(function(){e.onerror&&e.onerror(new Error("Unknown request: "+e.url))},1);this.setStatus(200),this.setResponseHeader("Content-Type","application/json");var i=r.response(this),o=this.context.getPromise(),s=function(t){"application/json"==e.getResponseHeader("Content-Type")&&(t=JSON.stringify(t)),e.responseText=t,setTimeout(function(){e.onload&&e.onload()},1)};i instanceof o?i.then(s.bind(this))["catch"](this.onerror.bind(this)):s(i)},t.prototype.abort=function(){this.log.debug("XhrMock.destroy(): Aborted")},t.prototype.getRequestHeader=function(t){return this.requestHeaders[t.toLowerCase()]},t.prototype.setResponseHeader=function(t,e){this.responseHeaders[t.toLowerCase()]=e},t.prototype.setStatus=function(t){return this.status=t,this},t}();e.XhrMock=a,e.$get=r},function(t,e,n){function r(t){return new u(t)}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(55),s=n(10),a=n(56),u=function(t){function e(e){t.call(this,e),this.async=!0,this.method="",this.url="",this.query=null,this.body={},this.context=e,this.xhr=null,this.observer=s.$get(e)}return i(e,t),e.prototype.isLoaded=function(){return!!this.xhr},e.prototype.setHeader=function(e,n){return t.prototype.setHeader.call(this,e,n),this},e.prototype.setHeaders=function(e){return t.prototype.setHeaders.call(this,e),this},e.prototype.setOptions=function(t){return t=t||{},"body"in t||!t.post||(t.body=t.post),"query"in t||!t.get||(t.query=t.get),"method"in t&&(this.method=t.method),"url"in t&&(this.url=t.url),"query"in t&&(this.query=t.query),"body"in t&&(this.body=t.body),"headers"in t&&this.setHeaders(t.headers),"async"in t&&(this.async=!!t.async),this},e.prototype.checkOptions=function(){if(!this.url)throw new Error("Url is not defined");if(this.hasHeader("Accept")||this.setHeader("Accept",o.Headers.jsonContentType),this.hasHeader("Content-Type")||this.setHeader("Content-Type",o.Headers.jsonContentType),this.method=this.method?this.method.toUpperCase():"GET",["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"].indexOf(this.method)<0)throw new Error("Method has wrong value");return this},e.prototype.getEncodedBody=function(){return"GET"===this.method?null:"string"==typeof this.body?this.body:this.isJson()?JSON.stringify(this.body):this.isUrlEncoded()?this.utils.queryStringify(this.body):this.body},e.prototype.send=function(){var t=this;this.observer.emit(this.observer.events.beforeRequest,this);var e=new(this.context.getPromise())(function(e,n){t.checkOptions();var r=t.getXHR(),i=t.url+(t.query?(t.url.indexOf("?")>-1?"&":"?")+t.utils.queryStringify(t.query):"");r.open(t.method,i,t.async),r.withCredentials=!0,r.onload=function(){var i=a.$get(t.context,r.status,r.statusText,r.responseText,r.getAllResponseHeaders());if(i.error){var o=i.error;o.ajax=i,o.response=i,o.request=t,n(o)}else e(i)},r.onerror=function(e){var r=new Error("The request cannot be sent"+(e?" ("+e.toString()+")":""));r.request=t,r.response=null,r.ajax=null,n(r)},t.utils.forEach(t.headers,function(t,e){t&&r.setRequestHeader(e,t)}),r.send(t.getEncodedBody()),t.xhr=r});return e.then(function(e){return t.observer.emit(t.observer.events.requestSuccess,e,t),e})["catch"](function(e){throw t.observer.emit(t.observer.events.requestError,e),e})},e.prototype.getXHR=function(){return this.context.getXHR()},e.prototype.destroy=function(){this.xhr&&this.xhr.abort()},e}(o.Headers);e.Request=u,e.$get=r},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t){function e(){if(!o){o=!0;for(var t,e=i.length;e;){t=i,i=[];for(var n=-1;++n<e;)t[n]();e=i.length}o=!1}}function n(){}var r=t.exports={},i=[],o=!1;r.nextTick=function(t){i.push(t),o||setTimeout(e,0)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){!function(r,i){t.exports=e=i(n(7))}(this,function(t){return function(){var e=t,n=e.lib,r=n.WordArray,i=n.Hasher,o=e.algo,s=[],a=o.SHA1=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],c=0;80>c;c++){if(16>c)s[c]=0|t[e+c];else{var f=s[c-3]^s[c-8]^s[c-14]^s[c-16];s[c]=f<<1|f>>>31}var p=(r<<5|r>>>27)+u+s[c];p+=20>c?(i&o|~i&a)+1518500249:40>c?(i^o^a)+1859775393:60>c?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,u=a,a=o,o=i<<30|i>>>2,i=r,r=p}n[0]=0|n[0]+r,n[1]=0|n[1]+i,n[2]=0|n[2]+o,n[3]=0|n[3]+a,n[4]=0|n[4]+u},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),e[(r+64>>>9<<4)+15]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA1=i._createHelper(a),e.HmacSHA1=i._createHmacHelper(a)}(),t.SHA1})},function(t,e,n){!function(r,i){t.exports=e=i(n(7))}(this,function(t){!function(){var e=t,n=e.lib,r=n.Base,i=e.enc,o=i.Utf8,s=e.algo;s.HMAC=r.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=o.parse(e));var n=t.blockSize,r=4*n;e.sigBytes>r&&(e=t.finalize(e)),e.clamp();for(var i=this._oKey=e.clone(),s=this._iKey=e.clone(),a=i.words,u=s.words,c=0;n>c;c++)a[c]^=1549556828,u[c]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);e.reset();var r=e.finalize(this._oKey.clone().concat(n));return r}})}()})},function(t,e,n){var r=n(20),i=function(){function t(t){this.headers={},this.context=t,this.utils=r.$get(t)}return t.prototype.setHeader=function(t,e){return this.headers[t.toLowerCase()]=e,this},t.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},t.prototype.hasHeader=function(t){return t.toLowerCase()in this.headers},t.prototype.setHeaders=function(t){var e=this;return this.utils.forEach(t,function(t,n){e.setHeader(n,t)}),this},t.prototype.isContentType=function(t){return this.getContentType().indexOf(t)>-1},t.prototype.getContentType=function(){return this.getHeader(t.contentType)||""},t.prototype.isMultipart=function(){return this.isContentType(t.multipartContentType)},t.prototype.isUrlEncoded=function(){return this.isContentType(t.urlencodedContentType)},t.prototype.isJson=function(){return this.isContentType(t.jsonContentType)},t.contentType="Content-Type",t.jsonContentType="application/json",t.multipartContentType="multipart/mixed",t.urlencodedContentType="application/x-www-form-urlencoded",t}();e.Headers=i},function(t,e,n){function r(t,e,n,r,i){return new a(t,e,n,r,i)}var i=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},o=n(55),s=n(15),a=function(t){function e(n,r,i,a,u){var c=this;if(t.call(this,n),this.log=s.$get(n),"string"==typeof a&&(a=a.replace(/\r/g,""),!u)){var f=a.split(e.bodySeparator);u=f.length>1?f.shift():{},a=f.join(e.bodySeparator)}this.data=null,this.json=null,this.responses=[],this.error=null,1223==r&&(r=204),this.status=r,this.statusText=i,this.body=a;try{if("string"==typeof u?(u||"").split("\n").forEach(function(t){if(t){var n=t.split(e.headerSeparator),r=n.shift().trim();c.setHeader(r,n.join(e.headerSeparator).trim())}}):this.setHeaders(u),this.hasHeader(o.Headers.contentType)||this.setHeader(o.Headers.contentType,o.Headers.jsonContentType),this.isJson()&&this.body&&"string"==typeof this.body)this.json=JSON.parse(this.body),this.data=this.json,this.checkStatus()||(this.error=new Error(this.getError()));else if(this.isMultipart()){var p=this.getContentType().match(/boundary=([^;]+)/i)[1],l=this.body.split(e.boundarySeparator+p);""===l[0].trim()&&l.shift(),l[l.length-1].trim()==e.boundarySeparator&&l.pop();var h=new e(this.context,this.status,"",l.shift());this.responses=l.map(function(t,n){var r=h.data.response[n].status;return new e(c.context,r,"",t)}),this.data=this.responses}else this.data=this.body}catch(d){this.log.error("Response.parseResponse(): Unable to parse data"),this.log.error(d.stack||d),this.log.error(this.body),this.error=d}}return i(e,t),e.prototype.isUnauthorized=function(){return 401==this.status},e.prototype.checkStatus=function(){return this.status>=200&&this.status<300},e.prototype.getError=function(){return this.data.message||this.data.error_description||this.data.description||"Unknown error"},e.boundarySeparator="--",e.headerSeparator=":",e.bodySeparator="\n\n",e}(o.Headers);e.Response=a,e.$get=r}])});
//# sourceMappingURL=rc-sdk-bundle.min.js.map