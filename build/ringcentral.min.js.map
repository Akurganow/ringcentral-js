{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","ringcentral.js","webpack:/webpack/bootstrap c0838cc3f17cb1b5a03c","webpack:///src/SDK.js","webpack:///src/core/Utils.js","webpack:///src/core/Externals.js","webpack:/external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}","webpack:/external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}","webpack:/external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}","webpack:///src/core/Cache.js","webpack:///src/core/Observable.js","webpack:///src/http/Client.js","webpack:///src/http/Utils.js","webpack:///src/http/ApiResponse.js","webpack:///src/mocks/ClientMock.js","webpack:///src/mocks/Registry.js","webpack:///src/mocks/Mock.js","webpack:///src/platform/Platform.js","webpack:///src/platform/Queue.js","webpack:///src/platform/Auth.js","webpack:///src/pubnub/PubnubFactory.js","webpack:///src/pubnub/PubnubMock.js","webpack:///src/subscription/Subscription.js","webpack:///~/regenerator/runtime.js"],"names":["root","factory","exports","module","require","define","amd","undefined","this","__WEBPACK_EXTERNAL_MODULE_4__","__WEBPACK_EXTERNAL_MODULE_5__","__WEBPACK_EXTERNAL_MODULE_6__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_interopRequireWildcard","newObj","key","Object","prototype","hasOwnProperty","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","_coreUtils","Utils","_coreCache","_coreCache2","_coreExternals","Externals","_coreObservable","_coreObservable2","_httpClient","_httpClient2","_httpApiResponse","_httpApiResponse2","_httpUtils","HttpUtils","_mocksClientMock","_mocksClientMock2","_mocksMock","_mocksMock2","_mocksRegistry","_mocksRegistry2","_platformPlatform","_platformPlatform2","_platformAuth","_platformAuth2","_platformQueue","_platformQueue2","_pubnubPubnubFactory","_pubnubPubnubFactory2","_subscriptionSubscription","_subscriptionSubscription2","SDK","options","_cache","localStorage","cachePrefix","_client","client","_platform","server","appKey","appSecret","_pubnubFactory","pubnubFactory","PUBNUB","value","sandbox","production","platform","createSubscription","cache","Cache","Observable","Client","ApiResponse","Auth","Platform","Queue","Subscription","Registry","Mock","PubnubMockFactory","queryStringify","parameters","array","keys","forEach","k","v","isArray","vv","push","encodeURIComponent","join","parseQueryString","queryString","argsParsed","split","arg","decodeURIComponent","indexOf","trim","pair","isFunction","Array","poll","fn","interval","timeout","stopPolling","next","delay","setTimeout","clearTimeout","isNodeJS","process","isBrowser","window","_ExternalsJs","Promise","resolve","reject","_es6Promise","_es6Promise2","_nodeFetch","_nodeFetch2","_pubnub","_pubnub2","fetch","Request","Response","Headers","storage","prefix","setPrefix","_storage","_prefix","defaultPrefix","setItem","data","_prefixKey","JSON","stringify","removeItem","getItem","item","parse","clean","off","hasListeners","event","_listeners","on","events","callback","_this","Error","emit","_this2","_len","arguments","args","_key","result","some","apply","_this3","cb","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_Utils","_ApiResponse","_ApiResponse2","_Observable","beforeRequest","requestSuccess","requestError","sendRequest","request","apiResponse","regeneratorRuntime","async","context$2$0","prev","awrap","_loadResponse","_response","sent","_isMultipart","_isJson","response","text","_text","ok","abrupt","t0","makeError","stop","e","originalMessage","message","error","createRequest","init","headers","url","method","_allowedMethods","credentials","mode","query","findHeaderName","_jsonContentType","body","contentTypeHeaderName","_contentType","contentType","_urlencodedContentType","req","originalBody","createResponse","stringBody","utils","_decode","name","toLowerCase","reduce","res","responseText","_request","_json","_multipart","json","skipOKCheck","status","statusText","error_description","description","multipart","boundary","_getContentType","match","parts","toString","_boundarySeparator","shift","pop","statusInfo","map","part","_isContentType","get","_multipartContentType","_isUrlEncoded","replace","headersAndBody","_bodySeparator","headersText","header","_headerSeparator","append","_Registry","_Registry2","_HttpClient","_registry","registry","mock","find","getResponse","_Mock","_Mock2","_mocks","add","clear","test","path","apiCall","authentication","access_token","token_type","expires_in","refresh_token","refresh_token_expires_in","scope","expireTime","Date","getTime","logout","presenceLoad","uri","extension","extensionNumber","activeCalls","presenceStatus","telephonyStatus","userStatus","dndStatus","extensionId","subscribeGeneric","expiresIn","date","eventFilters","expirationTime","toISOString","deliveryMode","transportType","encryption","address","subscriberKey","secretKey","creationTime","subscribeOnPresence","detailed","encryptionAlgorithm","encryptionKey","tokenRefresh","failure","_method","toUpperCase","_path","_delay","_status","_statusText","str","set","_Queue","_Queue2","_Auth","_Auth2","beforeLogin","loginSuccess","loginError","beforeRefresh","refreshSuccess","refreshError","beforeLogout","logoutSuccess","logoutError","_server","_appKey","_appSecret","_queue","_cacheId","_auth","auth","createUrl","builtUrl","hasHttp","addServer","_urlPrefix","_apiVersion","addMethod","addToken","accessToken","authUrl","_authorizeEndpoint","response_type","redirect_uri","redirectUri","client_id","state","brand_id","brandId","display","prompt","parseAuthRedirectUrl","qs","reverse","loggedIn","_ensureAuthentication","login","remember","access_token_ttl","_accessTokenTtl","refresh_token_ttl","_refreshTokenTtlRemember","_refreshTokenTtl","code","grant_type","username","password","endpointId","endpoint_id","_tokenRequest","_tokenEndpoint","setData","setRemember","refresh","isPaused","_isAccessTokenValid","pause","_refreshDelayMs","refreshToken","refreshTokenValid","resume","_clearCacheOnRefreshError","_revokeEndpoint","token","inflateRequest","skipAuthCheck","_authHeader","cancelAccessToken","send","post","put","Authorization","_apiKey","Content-Type","accessTokenValid","apiKey","btoa","Buffer","tokenType","cacheId","_promise","time","now","parseInt","_releaseTimeout","_pollInterval","newData","expire_time","refresh_token_expire_time","authData","forcedTokenType","refreshHandicapMs","forceAuthentication","_PubnubMockJs","_PubnubMockJs2","crypto_obj","PubnubMock","ready","subscribe","channel","unsubscribe","receiveMessage","msg","notification","removeSuccess","removeError","renewSuccess","renewError","subscribeSuccess","subscribeError","_timeout","_subscription","alive","_renewHandicapMs","setSubscription","subscription","_clearTimeout","_subscribeAtPubnub","_setTimeout","register","renew","addEventFilters","setEventFilters","concat","_getFullEventFilters","reset","remove","restoreFromCache","cacheKey","cachedSubscriptionData","_decrypt","decrypt","encryptKey","keyEncoding","keyLength","_notify","ssl","subscribe_key","bind","connect","global","wrap","innerFn","outerFn","self","tryLocsList","generator","Generator","context","Context","_invoke","makeInvokeMethod","tryCatch","type","err","GeneratorFunction","GeneratorFunctionPrototype","defineIteratorMethods","AwaitArgument","AsyncIterator","invoke","then","invokeNext","invokeThrow","unwrapped","enqueue","callInvokeWithMethodAndArg","previousPromise","domain","GenStateSuspendedStart","GenStateExecuting","GenStateCompleted","doneResult","delegate","iterator","returnMethod","record","info","done","GenStateSuspendedYield","resultName","nextLoc","dispatchException","ContinueSentinel","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","values","iterable","iteratorMethod","iteratorSymbol","isNaN","hasOwn","Symbol","inModule","runtime","Gp","displayName","isGeneratorFunction","genFun","ctor","mark","iter","object","skipTempReset","charAt","slice","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield"],"mappings":"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","file":"ringcentral.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/build/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Utils = _interopRequireWildcard(_coreUtils);\n\nvar _coreCache = __webpack_require__(7);\n\nvar _coreCache2 = _interopRequireDefault(_coreCache);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar Externals = _interopRequireWildcard(_coreExternals);\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _httpClient = __webpack_require__(9);\n\nvar _httpClient2 = _interopRequireDefault(_httpClient);\n\nvar _httpApiResponse = __webpack_require__(11);\n\nvar _httpApiResponse2 = _interopRequireDefault(_httpApiResponse);\n\nvar _httpUtils = __webpack_require__(10);\n\nvar HttpUtils = _interopRequireWildcard(_httpUtils);\n\nvar _mocksClientMock = __webpack_require__(12);\n\nvar _mocksClientMock2 = _interopRequireDefault(_mocksClientMock);\n\nvar _mocksMock = __webpack_require__(14);\n\nvar _mocksMock2 = _interopRequireDefault(_mocksMock);\n\nvar _mocksRegistry = __webpack_require__(13);\n\nvar _mocksRegistry2 = _interopRequireDefault(_mocksRegistry);\n\nvar _platformPlatform = __webpack_require__(15);\n\nvar _platformPlatform2 = _interopRequireDefault(_platformPlatform);\n\nvar _platformAuth = __webpack_require__(17);\n\nvar _platformAuth2 = _interopRequireDefault(_platformAuth);\n\nvar _platformQueue = __webpack_require__(16);\n\nvar _platformQueue2 = _interopRequireDefault(_platformQueue);\n\nvar _pubnubPubnubFactory = __webpack_require__(18);\n\nvar _pubnubPubnubFactory2 = _interopRequireDefault(_pubnubPubnubFactory);\n\nvar _subscriptionSubscription = __webpack_require__(20);\n\nvar _subscriptionSubscription2 = _interopRequireDefault(_subscriptionSubscription);\n\n__webpack_require__(21);\n\nvar SDK = (function () {\n    _createClass(SDK, null, [{\n        key: 'version',\n        value: '2.0.0',\n        enumerable: true\n    }, {\n        key: 'server',\n        value: {\n            sandbox: 'https://platform.devtest.ringcentral.com',\n            production: 'https://platform.ringcentral.com'\n        },\n\n        /**\n         * @constructor\n         * @param {object} [options]\n         * @param {string} [options.server]\n         * @param {string} [options.cachePrefix]\n         * @param {string} [options.appSecret]\n         * @param {string} [options.appKey]\n         * @param {string} [options.appName]\n         * @param {string} [options.appVersion]\n         * @param {string} [options.pubnubFactory]\n         * @param {string} [options.client]\n         */\n        enumerable: true\n    }]);\n\n    function SDK(options) {\n        _classCallCheck(this, SDK);\n\n        options = options || {};\n\n        this._cache = new _coreCache2['default'](Externals.localStorage, options.cachePrefix);\n\n        this._client = options.client || new _httpClient2['default']();\n\n        this._platform = new _platformPlatform2['default'](this._client, this._cache, options.server, options.appKey, options.appSecret);\n\n        this._pubnubFactory = options.pubnubFactory || Externals.PUBNUB;\n    }\n\n    /**\n     * @return {Platform}\n     */\n\n    SDK.prototype.platform = function platform() {\n        return this._platform;\n    };\n\n    /**\n     * @return {Subscription}\n     */\n\n    SDK.prototype.createSubscription = function createSubscription() {\n        return new _subscriptionSubscription2['default'](this._pubnubFactory, this._platform, this._cache);\n    };\n\n    /**\n     * @return {Cache}\n     */\n\n    SDK.prototype.cache = function cache() {\n        return this._cache;\n    };\n\n    _createClass(SDK, null, [{\n        key: 'core',\n        value: {\n            Cache: _coreCache2['default'],\n            Observable: _coreObservable2['default'],\n            Utils: Utils,\n            Externals: Externals\n        },\n        enumerable: true\n    }, {\n        key: 'http',\n        value: {\n            Client: _httpClient2['default'],\n            ApiResponse: _httpApiResponse2['default'],\n            Utils: HttpUtils\n        },\n        enumerable: true\n    }, {\n        key: 'platform',\n        value: {\n            Auth: _platformAuth2['default'],\n            Platform: _platformPlatform2['default'],\n            Queue: _platformQueue2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'subscription',\n        value: {\n            Subscription: _subscriptionSubscription2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'mocks',\n        value: {\n            Client: _mocksClientMock2['default'],\n            Registry: _mocksRegistry2['default'],\n            Mock: _mocksMock2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'pubnub',\n        value: {\n            PubnubMockFactory: _pubnubPubnubFactory2['default']\n        },\n        enumerable: true\n    }]);\n\n    return SDK;\n})();\n\nexports['default'] = SDK;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\nexports.queryStringify = queryStringify;\nexports.parseQueryString = parseQueryString;\nexports.isFunction = isFunction;\nexports.isArray = isArray;\nexports.poll = poll;\nexports.stopPolling = stopPolling;\nexports.isNodeJS = isNodeJS;\nexports.isBrowser = isBrowser;\nexports.delay = delay;\n\nvar _ExternalsJs = __webpack_require__(3);\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {object} parameters\n * @returns {string}\n */\n\nfunction queryStringify(parameters) {\n\n    var array = [];\n\n    parameters = parameters || {};\n\n    Object.keys(parameters).forEach(function (k) {\n\n        var v = parameters[k];\n\n        if (isArray(v)) {\n            v.forEach(function (vv) {\n                array.push(encodeURIComponent(k) + '=' + encodeURIComponent(vv));\n            });\n        } else {\n            array.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n        }\n    });\n\n    return array.join('&');\n}\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {string} queryString\n * @returns {object}\n */\n\nfunction parseQueryString(queryString) {\n\n    var argsParsed = {};\n\n    queryString.split('&').forEach(function (arg) {\n\n        arg = decodeURIComponent(arg);\n\n        if (arg.indexOf('=') == -1) {\n\n            argsParsed[arg.trim()] = true;\n        } else {\n\n            var pair = arg.split('='),\n                key = pair[0].trim(),\n                value = pair[1].trim();\n\n            if (key in argsParsed) {\n                if (key in argsParsed && !isArray(argsParsed[key])) argsParsed[key] = [argsParsed[key]];\n                argsParsed[key].push(value);\n            } else {\n                argsParsed[key] = value;\n            }\n        }\n    });\n\n    return argsParsed;\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\n\nfunction isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\n\nfunction isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\n/**\n * @param fn\n * @param interval\n * @param timeout\n */\n\nfunction poll(fn, interval, timeout) {\n    //NodeJS.Timer|number\n\n    module.exports.stopPolling(timeout);\n\n    interval = interval || 1000;\n\n    var next = function next(delay) {\n\n        delay = delay || interval;\n\n        interval = delay;\n\n        return setTimeout(function () {\n\n            fn(next, delay);\n        }, delay);\n    };\n\n    return next();\n}\n\nfunction stopPolling(timeout) {\n    if (timeout) clearTimeout(timeout);\n}\n\nfunction isNodeJS() {\n    return typeof process !== 'undefined';\n}\n\nfunction isBrowser() {\n    return typeof window !== 'undefined';\n}\n\nfunction delay(timeout) {\n    return new _ExternalsJs.Promise(function (resolve, reject) {\n        setTimeout(function () {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _es6Promise = __webpack_require__(4);\n\nvar _es6Promise2 = _interopRequireDefault(_es6Promise);\n\nvar _nodeFetch = __webpack_require__(5);\n\nvar _nodeFetch2 = _interopRequireDefault(_nodeFetch);\n\nvar _pubnub = __webpack_require__(6);\n\nvar _pubnub2 = _interopRequireDefault(_pubnub);\n\nvar Promise = _es6Promise2['default'] && _es6Promise2['default'].Promise || window.Promise;\n\nexports.Promise = Promise;\nvar fetch = _nodeFetch2['default'] || window.fetch;\nexports.fetch = fetch;\nvar Request = fetch.Request || window.Request;\nexports.Request = Request;\nvar Response = fetch.Response || window.Response;\nexports.Response = Response;\nvar Headers = fetch.Headers || window.Headers;\n\nexports.Headers = Headers;\nvar PUBNUB = _pubnub2['default'] || window.PUBNUB;\n\nexports.PUBNUB = PUBNUB;\nvar localStorage = typeof window !== 'undefined' && typeof window.localStorage !== 'undefined' ? window.localStorage : {};\nexports.localStorage = localStorage;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar Cache = (function () {\n    _createClass(Cache, null, [{\n        key: 'defaultPrefix',\n        value: 'rc-',\n        enumerable: true\n    }]);\n\n    function Cache(storage, prefix) {\n        _classCallCheck(this, Cache);\n\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    Cache.prototype.setPrefix = function setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    };\n\n    Cache.prototype.setItem = function setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    };\n\n    Cache.prototype.removeItem = function removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    };\n\n    Cache.prototype.getItem = function getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    };\n\n    Cache.prototype.clean = function clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n        }\n\n        return this;\n    };\n\n    Cache.prototype._prefixKey = function _prefixKey(key) {\n        return this._prefix + key;\n    };\n\n    return Cache;\n})();\n\nexports['default'] = Cache;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar Observable = (function () {\n    function Observable() {\n        _classCallCheck(this, Observable);\n\n        this.off();\n    }\n\n    Observable.prototype.hasListeners = function hasListeners(event) {\n        return event in this._listeners;\n    };\n\n    Observable.prototype.on = function on(events, callback) {\n        var _this = this;\n\n        if (typeof events == 'string') events = [events];\n        if (!events) throw new Error('No events to subscribe to');\n        if (typeof callback !== 'function') throw new Error('Callback must be a function');\n\n        events.forEach(function (event) {\n\n            if (!_this.hasListeners(event)) _this._listeners[event] = [];\n\n            _this._listeners[event].push(callback);\n        });\n\n        return this;\n    };\n\n    Observable.prototype.emit = function emit(event) {\n        var _this2 = this;\n\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n        }\n\n        var result = null;\n\n        if (!this.hasListeners(event)) return null;\n\n        this._listeners[event].some(function (callback) {\n\n            result = callback.apply(_this2, args);\n            return result === false;\n        });\n\n        return result;\n    };\n\n    Observable.prototype.off = function off(event, callback) {\n        var _this3 = this;\n\n        if (!event) {\n\n            this._listeners = {};\n        } else {\n\n            if (!callback) {\n\n                delete this._listeners[event];\n            } else {\n\n                if (!this.hasListeners(event)) return this;\n\n                this._listeners[event].forEach(function (cb, i) {\n\n                    if (cb === callback) delete _this3._listeners[event][i];\n                });\n            }\n        }\n\n        return this;\n    };\n\n    return Observable;\n})();\n\nexports['default'] = Observable;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar _Utils = __webpack_require__(10);\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _ApiResponse = __webpack_require__(11);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nvar Client = (function (_Observable) {\n    _inherits(Client, _Observable);\n\n    function Client() {\n        _classCallCheck(this, Client);\n\n        _Observable.apply(this, arguments);\n\n        this.events = {\n            beforeRequest: 'beforeRequest',\n            requestSuccess: 'requestSuccess',\n            requestError: 'requestError'\n        };\n    }\n\n    /**\n     * @name IApiError\n     * @property {string} stack\n     * @property {string} originalMessage\n     * @property {ApiResponse} apiResponse\n     */\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n\n    Client.prototype.sendRequest = function sendRequest(request) {\n        var apiResponse;\n        return regeneratorRuntime.async(function sendRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    apiResponse = new _ApiResponse2['default'](request);\n                    context$2$0.prev = 1;\n\n                    //TODO Stop request if listeners return false\n                    this.emit(this.events.beforeRequest, apiResponse);\n\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._loadResponse(request));\n\n                case 5:\n                    apiResponse._response = context$2$0.sent;\n\n                    if (!(apiResponse._isMultipart() || apiResponse._isJson())) {\n                        context$2$0.next = 10;\n                        break;\n                    }\n\n                    context$2$0.next = 9;\n                    return regeneratorRuntime.awrap(apiResponse.response().text());\n\n                case 9:\n                    apiResponse._text = context$2$0.sent;\n\n                case 10:\n                    if (apiResponse.ok()) {\n                        context$2$0.next = 12;\n                        break;\n                    }\n\n                    throw new Error('Response has unsuccessful status');\n\n                case 12:\n\n                    this.emit(this.events.requestSuccess, apiResponse);\n\n                    return context$2$0.abrupt('return', apiResponse);\n\n                case 16:\n                    context$2$0.prev = 16;\n                    context$2$0.t0 = context$2$0['catch'](1);\n\n                    if (!context$2$0.t0.apiResponse) context$2$0.t0 = this.makeError(context$2$0.t0, apiResponse);\n\n                    this.emit(this.events.requestError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 21:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[1, 16]]);\n    };\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n\n    Client.prototype._loadResponse = function _loadResponse(request) {\n        return regeneratorRuntime.async(function _loadResponse$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.next = 2;\n                    return regeneratorRuntime.awrap(_coreExternals.fetch.call(null, request));\n\n                case 2:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 3:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n\n    Client.prototype.makeError = function makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = apiResponse && apiResponse.error(true) || e.originalMessage;\n        }\n\n        return e;\n    };\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n\n    Client.prototype.createRequest = function createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) throw new Error('Method has wrong value: ' + init.method);\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + _coreUtils.queryStringify(init.query);\n        }\n\n        if (!_Utils.findHeaderName('Accept', init.headers)) {\n            init.headers['Accept'] = _ApiResponse2['default']._jsonContentType;\n        }\n\n        // Serialize body\n        //TODO Check that body is a plain object\n        if (typeof init.body !== 'string' || !init.body) {\n\n            var contentTypeHeaderName = _Utils.findHeaderName(_ApiResponse2['default']._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = _ApiResponse2['default']._contentType;\n                init.headers[contentTypeHeaderName] = _ApiResponse2['default']._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(_ApiResponse2['default']._jsonContentType) > -1) {\n                init.body = JSON.stringify(init.body);\n            } else if (contentType.indexOf(_ApiResponse2['default']._urlencodedContentType) > -1) {\n                init.body = _coreUtils.queryStringify(init.body);\n            }\n        }\n\n        // Create a request with encoded body\n        var req = new _coreExternals.Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n    };\n\n    _createClass(Client, null, [{\n        key: '_allowedMethods',\n        value: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'],\n        enumerable: true\n    }]);\n\n    return Client;\n})(_coreObservable2['default']);\n\nexports['default'] = Client;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\nexports.createResponse = createResponse;\nexports.findHeaderName = findHeaderName;\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar utils = _interopRequireWildcard(_coreUtils);\n\n/**\n * Creates a response\n * @param stringBody\n * @param init\n * @return {Response}\n */\n\nfunction createResponse(stringBody, init) {\n\n    init = init || {};\n\n    var response = new _coreExternals.Response(stringBody, init);\n\n    //TODO Wait for https://github.com/bitinn/node-fetch/issues/38\n    if (utils.isNodeJS()) {\n\n        response._text = stringBody;\n        response._decode = function () {\n            return this._text;\n        };\n    }\n\n    return response;\n}\n\nfunction findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function (res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _Utils = __webpack_require__(10);\n\nvar utils = _interopRequireWildcard(_Utils);\n\nvar ApiResponse = (function () {\n    _createClass(ApiResponse, null, [{\n        key: '_contentType',\n        value: 'Content-Type',\n        enumerable: true\n    }, {\n        key: '_jsonContentType',\n        value: 'application/json',\n        enumerable: true\n    }, {\n        key: '_multipartContentType',\n        value: 'multipart/mixed',\n        enumerable: true\n    }, {\n        key: '_urlencodedContentType',\n        value: 'application/x-www-form-urlencoded',\n        enumerable: true\n    }, {\n        key: '_headerSeparator',\n        value: ':',\n        enumerable: true\n    }, {\n        key: '_bodySeparator',\n        value: '\\n\\n',\n        enumerable: true\n    }, {\n        key: '_boundarySeparator',\n        value: '--',\n\n        /**\n         * @param {Request} request\n         * @param {Response} response\n         * @param {string} responseText\n         */\n        enumerable: true\n    }]);\n\n    function ApiResponse(request, response, responseText) {\n        _classCallCheck(this, ApiResponse);\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n    }\n\n    /**\n     * @return {Response}\n     */\n\n    ApiResponse.prototype.response = function response() {\n        return this._response;\n    };\n\n    /**\n     * @return {Request}\n     */\n\n    ApiResponse.prototype.request = function request() {\n        return this._request;\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n    ApiResponse.prototype.ok = function ok() {\n        return this._response && this._response.ok;\n    };\n\n    /**\n     * @return {string}\n     */\n\n    ApiResponse.prototype.text = function text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    };\n\n    /**\n     * @return {object}\n     */\n\n    ApiResponse.prototype.json = function json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    };\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n\n    ApiResponse.prototype.error = function error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') + (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n        } catch (e) {}\n\n        return message;\n    };\n\n    /**\n     * @return {ApiResponse[]}\n     */\n\n    ApiResponse.prototype.multipart = function multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map(function (part, i) {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n            });\n        }\n\n        return this._multipart;\n    };\n\n    ApiResponse.prototype._isContentType = function _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    };\n\n    ApiResponse.prototype._getContentType = function _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    };\n\n    ApiResponse.prototype._isMultipart = function _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    };\n\n    ApiResponse.prototype._isUrlEncoded = function _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    };\n\n    ApiResponse.prototype._isJson = function _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    };\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n\n    ApiResponse.create = function create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new _coreExternals.Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = headersAndBody.length > 1 ? headersAndBody.shift() : '';\n\n        text = headersAndBody.join(ApiResponse._bodySeparator);\n\n        (headersText || '').split('\\n').forEach(function (header) {\n\n            var split = header.trim().split(ApiResponse._headerSeparator),\n                key = split.shift().trim(),\n                value = split.join(ApiResponse._headerSeparator).trim();\n\n            if (key) headers.append(key, value);\n        });\n\n        return new ApiResponse(null, utils.createResponse(text, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n    };\n\n    return ApiResponse;\n})();\n\nexports['default'] = ApiResponse;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _Registry = __webpack_require__(13);\n\nvar _Registry2 = _interopRequireDefault(_Registry);\n\nvar _httpClient = __webpack_require__(9);\n\nvar _httpClient2 = _interopRequireDefault(_httpClient);\n\nvar Client = (function (_HttpClient) {\n    _inherits(Client, _HttpClient);\n\n    function Client() {\n        _classCallCheck(this, Client);\n\n        _HttpClient.call(this);\n        this._registry = new _Registry2['default']();\n    }\n\n    Client.prototype.registry = function registry() {\n        return this._registry;\n    };\n\n    Client.prototype._loadResponse = function _loadResponse(request) {\n        var mock;\n        return regeneratorRuntime.async(function _loadResponse$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    mock = this._registry.find(request);\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(mock.getResponse(request));\n\n                case 3:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 4:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    return Client;\n})(_httpClient2['default']);\n\nexports['default'] = Client;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _Mock = __webpack_require__(14);\n\nvar _Mock2 = _interopRequireDefault(_Mock);\n\nvar Registry = (function () {\n    function Registry() {\n        _classCallCheck(this, Registry);\n\n        this._mocks = [];\n    }\n\n    Registry.prototype.add = function add(mock) {\n        this._mocks.push(mock);\n        return this;\n    };\n\n    Registry.prototype.clear = function clear() {\n        this._mocks = [];\n        return this;\n    };\n\n    Registry.prototype.find = function find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url + ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n    };\n\n    Registry.prototype.apiCall = function apiCall(method, path, response, status, statusText) {\n\n        this.add(new _Mock2['default'](method, path, response, status, statusText));\n\n        return this;\n    };\n\n    Registry.prototype.authentication = function authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n    };\n\n    Registry.prototype.logout = function logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n    };\n\n    Registry.prototype.presenceLoad = function presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n    };\n\n    Registry.prototype.subscribeGeneric = function subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/~/presence'],\n            'expirationTime': new Date(date.getTime() + expiresIn * 1000).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n    };\n\n    Registry.prototype.subscribeOnPresence = function subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + 15 * 60 * 60 * 1000).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n    };\n\n    Registry.prototype.tokenRefresh = function tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n        }\n\n        return this;\n    };\n\n    return Registry;\n})();\n\nexports['default'] = Registry;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _httpApiResponse = __webpack_require__(11);\n\nvar _httpApiResponse2 = _interopRequireDefault(_httpApiResponse);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar _httpUtils = __webpack_require__(10);\n\nvar Mock = (function () {\n    function Mock(method, path, json, status, statusText, delay) {\n        _classCallCheck(this, Mock);\n\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    Mock.prototype.path = function path() {\n        return this._path;\n    };\n\n    Mock.prototype.method = function method() {\n        return this._method;\n    };\n\n    Mock.prototype.test = function test(request) {\n\n        return request.url.indexOf(this._path) > -1 && request.method.toUpperCase() == this._method;\n    };\n\n    Mock.prototype.getResponse = function getResponse(request) {\n        return regeneratorRuntime.async(function getResponse$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.next = 2;\n                    return regeneratorRuntime.awrap(_coreUtils.delay(this._delay));\n\n                case 2:\n                    return context$2$0.abrupt('return', this.createResponse(this._json));\n\n                case 3:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Mock.prototype.createResponse = function createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = _httpUtils.createResponse(str, init);\n\n        res.headers.set(_httpApiResponse2['default']._contentType, _httpApiResponse2['default']._jsonContentType);\n\n        return res;\n    };\n\n    return Mock;\n})();\n\nexports['default'] = Mock;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _Queue = __webpack_require__(16);\n\nvar _Queue2 = _interopRequireDefault(_Queue);\n\nvar _Auth = __webpack_require__(17);\n\nvar _Auth2 = _interopRequireDefault(_Auth);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Platform = (function (_Observable) {\n    _inherits(Platform, _Observable);\n\n    _createClass(Platform, null, [{\n        key: '_urlPrefix',\n        value: '/restapi',\n        enumerable: true\n    }, {\n        key: '_apiVersion',\n        value: 'v1.0',\n        enumerable: true\n    }, {\n        key: '_accessTokenTtl',\n        value: null,\n        // Platform server by default sets it to 60 * 60 = 1 hour\n        enumerable: true\n    }, {\n        key: '_refreshTokenTtl',\n        value: 10 * 60 * 60,\n        // 10 hours\n        enumerable: true\n    }, {\n        key: '_refreshTokenTtlRemember',\n        value: 7 * 24 * 60 * 60,\n        // 1 week\n        enumerable: true\n    }, {\n        key: '_tokenEndpoint',\n        value: '/restapi/oauth/token',\n        enumerable: true\n    }, {\n        key: '_revokeEndpoint',\n        value: '/restapi/oauth/revoke',\n        enumerable: true\n    }, {\n        key: '_authorizeEndpoint',\n        value: '/restapi/oauth/authorize',\n        enumerable: true\n    }, {\n        key: '_refreshDelayMs',\n        value: 100,\n        enumerable: true\n    }, {\n        key: '_cacheId',\n        value: 'platform',\n        enumerable: true\n    }, {\n        key: '_clearCacheOnRefreshError',\n        value: true,\n        enumerable: true\n    }]);\n\n    function Platform(client, cache, server, appKey, appSecret) {\n        _classCallCheck(this, Platform);\n\n        _Observable.call(this);\n\n        this.events = {\n            beforeLogin: 'beforeLogin',\n            loginSuccess: 'loginSuccess',\n            loginError: 'loginError',\n            beforeRefresh: 'beforeRefresh',\n            refreshSuccess: 'refreshSuccess',\n            refreshError: 'refreshError',\n            beforeLogout: 'beforeLogout',\n            logoutSuccess: 'logoutSuccess',\n            logoutError: 'logoutError'\n        };\n        this._server = server;\n        this._appKey = appKey;\n        this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        this._cache = cache;\n\n        /** @type {Client} */\n        this._client = client;\n\n        this._queue = new _Queue2['default'](this._cache, Platform._cacheId + '-refresh');\n\n        this._auth = new _Auth2['default'](this._cache, Platform._cacheId);\n    }\n\n    /**\n     * @return {Auth}\n     */\n\n    Platform.prototype.auth = function auth() {\n        return this._auth;\n    };\n\n    /**\n     * @return {Client}\n     */\n\n    Platform.prototype.client = function client() {\n        return this._client;\n    };\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n\n    Platform.prototype.createUrl = function createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += path.indexOf('?') > -1 ? '&' : '?';\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n    };\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @return {string}\n     */\n\n    Platform.prototype.authUrl = function authUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + _coreUtils.queryStringify({\n            'response_type': 'code',\n            'redirect_uri': options.redirectUri || '',\n            'client_id': this._appKey,\n            'state': options.state || '',\n            'brand_id': options.brandId || '',\n            'display': options.display || '',\n            'prompt': options.prompt || ''\n        }), { addServer: true });\n    };\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n\n    Platform.prototype.parseAuthRedirectUrl = function parseAuthRedirectUrl(url) {\n\n        var qs = _coreUtils.parseQueryString(url.split('?').reverse()[0]),\n            error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n    };\n\n    /**\n     * @return {Promise<boolean>}\n     */\n\n    Platform.prototype.loggedIn = function loggedIn() {\n        return regeneratorRuntime.async(function loggedIn$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this._ensureAuthentication());\n\n                case 3:\n                    return context$2$0.abrupt('return', true);\n\n                case 6:\n                    context$2$0.prev = 6;\n                    context$2$0.t0 = context$2$0['catch'](0);\n                    return context$2$0.abrupt('return', false);\n\n                case 9:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 6]]);\n    };\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.login = function login(options) {\n        var body, apiResponse, json;\n        return regeneratorRuntime.async(function login$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    options = options || {};\n\n                    options.remember = options.remember || false;\n\n                    this.emit(this.events.beforeLogin);\n\n                    body = {\n                        \"access_token_ttl\": Platform._accessTokenTtl,\n                        \"refresh_token_ttl\": options.remember ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                    };\n\n                    if (!options.code) {\n\n                        body.grant_type = 'password';\n                        body.username = options.username;\n                        body.password = options.password;\n                        body.extension = options.extension || '';\n                    } else if (options.code) {\n\n                        body.grant_type = 'authorization_code';\n                        body.code = options.code;\n                        body.redirect_uri = options.redirectUri;\n                        //body.client_id = this.getCredentials().key; // not needed\n                    }\n\n                    if (options.endpointId) body.endpoint_id = options.endpointId;\n\n                    context$2$0.next = 9;\n                    return regeneratorRuntime.awrap(this._tokenRequest(Platform._tokenEndpoint, body));\n\n                case 9:\n                    apiResponse = context$2$0.sent;\n                    json = apiResponse.json();\n\n                    this._auth.setData(json).setRemember(options.remember);\n\n                    this.emit(this.events.loginSuccess, apiResponse);\n\n                    return context$2$0.abrupt('return', apiResponse);\n\n                case 16:\n                    context$2$0.prev = 16;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    this._cache.clean();\n\n                    this.emit(this.events.loginError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 21:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 16]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.refresh = function refresh() {\n        var res, json;\n        return regeneratorRuntime.async(function refresh$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    this.emit(this.events.beforeRefresh);\n\n                    if (!this._queue.isPaused()) {\n                        context$2$0.next = 9;\n                        break;\n                    }\n\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._queue.poll());\n\n                case 5:\n                    if (this._isAccessTokenValid()) {\n                        context$2$0.next = 7;\n                        break;\n                    }\n\n                    throw new Error('Automatic authentification timeout');\n\n                case 7:\n\n                    this.emit(this.events.refreshSuccess, null);\n\n                    return context$2$0.abrupt('return', null);\n\n                case 9:\n\n                    this._queue.pause();\n\n                    // Make sure all existing AJAX calls had a chance to reach the server\n                    context$2$0.next = 12;\n                    return regeneratorRuntime.awrap(_coreUtils.delay(Platform._refreshDelayMs));\n\n                case 12:\n                    if (this._auth.refreshToken()) {\n                        context$2$0.next = 14;\n                        break;\n                    }\n\n                    throw new Error('Refresh token is missing');\n\n                case 14:\n                    if (this._auth.refreshTokenValid()) {\n                        context$2$0.next = 16;\n                        break;\n                    }\n\n                    throw new Error('Refresh token has expired');\n\n                case 16:\n                    if (this._queue.isPaused()) {\n                        context$2$0.next = 18;\n                        break;\n                    }\n\n                    throw new Error('Queue was resumed before refresh call');\n\n                case 18:\n                    context$2$0.next = 20;\n                    return regeneratorRuntime.awrap(this._tokenRequest(Platform._tokenEndpoint, {\n                        \"grant_type\": \"refresh_token\",\n                        \"refresh_token\": this._auth.refreshToken(),\n                        \"access_token_ttl\": Platform._accessTokenTtl,\n                        \"refresh_token_ttl\": this._auth.remember() ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                    }));\n\n                case 20:\n                    res = context$2$0.sent;\n                    json = res.json();\n\n                    if (json.access_token) {\n                        context$2$0.next = 24;\n                        break;\n                    }\n\n                    throw this._client.makeError(new Error('Malformed OAuth response'), res);\n\n                case 24:\n\n                    this._auth.setData(json);\n                    this._queue.resume();\n\n                    this.emit(this.events.refreshSuccess, res);\n\n                    return context$2$0.abrupt('return', res);\n\n                case 30:\n                    context$2$0.prev = 30;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._client.makeError(context$2$0.t0);\n\n                    if (Platform._clearCacheOnRefreshError) {\n                        this._cache.clean();\n                    }\n\n                    this.emit(this.events.refreshError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 36:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 30]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.logout = function logout() {\n        var res;\n        return regeneratorRuntime.async(function logout$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    this.emit(this.events.beforeLogout);\n\n                    this._queue.pause();\n\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._tokenRequest(Platform._revokeEndpoint, {\n                        token: this._auth.accessToken()\n                    }));\n\n                case 5:\n                    res = context$2$0.sent;\n\n                    this._queue.resume();\n                    this._cache.clean();\n\n                    this.emit(this.events.logoutSuccess, res);\n\n                    return context$2$0.abrupt('return', res);\n\n                case 12:\n                    context$2$0.prev = 12;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    this._queue.resume();\n\n                    this.emit(this.events.logoutError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 17:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 12]]);\n    };\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n\n    Platform.prototype.inflateRequest = function inflateRequest(request, options) {\n        return regeneratorRuntime.async(function inflateRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n\n                    options = options || {};\n\n                    if (!options.skipAuthCheck) {\n                        context$2$0.next = 3;\n                        break;\n                    }\n\n                    return context$2$0.abrupt('return', request);\n\n                case 3:\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._ensureAuthentication());\n\n                case 5:\n\n                    request.headers.set('Authorization', this._authHeader());\n                    //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n                    //TODO Add User-Agent here\n\n                    return context$2$0.abrupt('return', request);\n\n                case 7:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.sendRequest = function sendRequest(request, options) {\n        return regeneratorRuntime.async(function sendRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this.inflateRequest(request, options));\n\n                case 3:\n                    request = context$2$0.sent;\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this._client.sendRequest(request));\n\n                case 6:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 9:\n                    context$2$0.prev = 9;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    if (!(!context$2$0.t0.apiResponse || !context$2$0.t0.apiResponse.response() || context$2$0.t0.apiResponse.response().status != 401)) {\n                        context$2$0.next = 13;\n                        break;\n                    }\n\n                    throw context$2$0.t0;\n\n                case 13:\n\n                    this._auth.cancelAccessToken();\n\n                    context$2$0.next = 16;\n                    return regeneratorRuntime.awrap(this.sendRequest(request, options));\n\n                case 16:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 17:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 9]]);\n    };\n\n    /**\n     * General purpose function to send anything to server\n     * @param {object} [options.body]\n     * @param {string} [options.url]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.send = function send() {\n        var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n        return regeneratorRuntime.async(function send$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n\n                    //FIXME https://github.com/bitinn/node-fetch/issues/43\n                    options.url = this.createUrl(options.url, { addServer: true });\n\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this.sendRequest(this._client.createRequest(options), options));\n\n                case 3:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 4:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {object} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.get = function get(url, query, options) {\n        return regeneratorRuntime.async(function get$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'GET';\n                    options.url = url;\n                    options.query = query;\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 6:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 7:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.post = function post(url, body, query, options) {\n        return regeneratorRuntime.async(function post$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'POST';\n                    options.url = url;\n                    options.query = query;\n                    options.body = body;\n                    context$2$0.next = 7;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 7:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 8:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.put = function put(url, body, query, options) {\n        return regeneratorRuntime.async(function put$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'PUT';\n                    options.url = url;\n                    options.query = query;\n                    options.body = body;\n                    context$2$0.next = 7;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 7:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 8:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {string} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype['delete'] = function _delete(url, query, options) {\n        return regeneratorRuntime.async(function _delete$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'DELETE';\n                    options.url = url;\n                    options.query = query;\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 6:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 7:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Platform.prototype._tokenRequest = function _tokenRequest(path, body) {\n        return regeneratorRuntime.async(function _tokenRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.next = 2;\n                    return regeneratorRuntime.awrap(this.send({\n                        url: path,\n                        skipAuthCheck: true,\n                        body: body,\n                        method: 'POST',\n                        headers: {\n                            'Authorization': 'Basic ' + this._apiKey(),\n                            'Content-Type': 'application/x-www-form-urlencoded'\n                        }\n                    }));\n\n                case 2:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 3:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Platform.prototype._ensureAuthentication = function _ensureAuthentication() {\n        return regeneratorRuntime.async(function _ensureAuthentication$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    if (!this._isAccessTokenValid()) {\n                        context$2$0.next = 2;\n                        break;\n                    }\n\n                    return context$2$0.abrupt('return', null);\n\n                case 2:\n                    context$2$0.next = 4;\n                    return regeneratorRuntime.awrap(this.refresh());\n\n                case 4:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 5:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Platform.prototype._isAccessTokenValid = function _isAccessTokenValid() {\n\n        return this._auth.accessTokenValid() && !this._queue.isPaused();\n    };\n\n    Platform.prototype._apiKey = function _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return typeof btoa == 'function' ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    };\n\n    Platform.prototype._authHeader = function _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    };\n\n    return Platform;\n})(_coreObservable2['default']);\n\nexports['default'] = Platform;\nmodule.exports = exports['default'];\n\n// Perform sanity checks\n\n/** @type {ApiResponse} */\n\n// Guard is for errors that come from polling\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Queue = (function () {\n    _createClass(Queue, null, [{\n        key: '_pollInterval',\n        value: 250,\n        enumerable: true\n    }, {\n        key: '_releaseTimeout',\n        value: 5000,\n        enumerable: true\n    }]);\n\n    function Queue(cache, cacheId) {\n        _classCallCheck(this, Queue);\n\n        this._cache = cache;\n        this._cacheId = cacheId;\n        this._promise = null;\n    }\n\n    Queue.prototype.isPaused = function isPaused() {\n\n        var storage = this._cache,\n            cacheId = this._cacheId,\n            time = storage.getItem(cacheId);\n\n        return !!time && Date.now() - parseInt(time) < Queue._releaseTimeout;\n    };\n\n    Queue.prototype.pause = function pause() {\n        this._cache.setItem(this._cacheId, Date.now());\n        return this;\n    };\n\n    Queue.prototype.resume = function resume() {\n        this._cache.removeItem(this._cacheId);\n        return this;\n    };\n\n    Queue.prototype.poll = function poll() {\n        var _this = this;\n\n        if (this._promise) return this._promise;\n\n        this._promise = new _coreExternals.Promise(function (resolve, reject) {\n\n            _coreUtils.poll(function (next) {\n\n                if (_this.isPaused()) return next();\n\n                _this._promise = null;\n\n                _this.resume(); // this is actually not needed but why not\n\n                resolve(null);\n            }, Queue._pollInterval);\n        });\n\n        return this._promise;\n    };\n\n    return Queue;\n})();\n\nexports['default'] = Queue;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 17 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar Auth = (function () {\n    _createClass(Auth, null, [{\n        key: 'refreshHandicapMs',\n        value: 60 * 1000,\n        // 1 minute\n        enumerable: true\n    }, {\n        key: 'forcedTokenType',\n        value: 'forced',\n        enumerable: true\n    }]);\n\n    function Auth(cache, cacheId) {\n        _classCallCheck(this, Auth);\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n    }\n\n    //export interface IAuthData {\n    //    remember?:boolean;\n    //    token_type?:string;\n    //    access_token?:string;\n    //    expires_in?:number; // actually it's string\n    //    expire_time?:number;\n    //    refresh_token?:string;\n    //    refresh_token_expires_in?:number; // actually it's string\n    //    refresh_token_expire_time?:number;\n    //    scope?:string;\n    //}\n\n    Auth.prototype.accessToken = function accessToken() {\n        return this.data().access_token;\n    };\n\n    Auth.prototype.refreshToken = function refreshToken() {\n        return this.data().refresh_token;\n    };\n\n    Auth.prototype.tokenType = function tokenType() {\n        return this.data().token_type;\n    };\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n\n    Auth.prototype.data = function data() {\n\n        return this._cache.getItem(this._cacheId) || {\n            token_type: '',\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        };\n    };\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n\n    Auth.prototype.setData = function setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach(function (key) {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + data.expires_in * 1000;\n        data.refresh_token_expire_time = Date.now() + data.refresh_token_expires_in * 1000;\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n    };\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n\n    Auth.prototype.accessTokenValid = function accessTokenValid() {\n\n        var authData = this.data();\n        return authData.token_type === Auth.forcedTokenType || authData.expire_time - Auth.refreshHandicapMs > Date.now();\n    };\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n\n    Auth.prototype.refreshTokenValid = function refreshTokenValid() {\n\n        return this.data().refresh_token_expire_time > Date.now();\n    };\n\n    /**\n     * @return {Auth}\n     */\n\n    Auth.prototype.cancelAccessToken = function cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n    };\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n\n    Auth.prototype.forceAuthentication = function forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n    };\n\n    /**\n     * @param remember\n     * @return {Auth}\n     */\n\n    Auth.prototype.setRemember = function setRemember(remember) {\n\n        return this.setData({ remember: remember });\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n    Auth.prototype.remember = function remember() {\n\n        return !!this.data().remember;\n    };\n\n    return Auth;\n})();\n\nexports['default'] = Auth;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _PubnubMockJs = __webpack_require__(19);\n\nvar _PubnubMockJs2 = _interopRequireDefault(_PubnubMockJs);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar PubnubMockFactory = (function () {\n    function PubnubMockFactory() {\n        _classCallCheck(this, PubnubMockFactory);\n\n        this.crypto_obj = _coreExternals.PUBNUB.crypto_obj;\n    }\n\n    PubnubMockFactory.prototype.init = function init(options) {\n        return new _PubnubMockJs2['default'](options);\n    };\n\n    return PubnubMockFactory;\n})();\n\nexports['default'] = PubnubMockFactory;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar PubnubMock = (function (_Observable) {\n    _inherits(PubnubMock, _Observable);\n\n    function PubnubMock(options) {\n        _classCallCheck(this, PubnubMock);\n\n        _Observable.call(this);\n        this.options = options;\n        this.crypto_obj = _coreExternals.PUBNUB.crypto_obj;\n    }\n\n    PubnubMock.prototype.ready = function ready() {};\n\n    PubnubMock.prototype.subscribe = function subscribe(options) {\n        this.on('message-' + options.channel, options.message);\n    };\n\n    PubnubMock.prototype.unsubscribe = function unsubscribe(options) {\n        this.off('message-' + options.channel);\n    };\n\n    PubnubMock.prototype.receiveMessage = function receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    };\n\n    return PubnubMock;\n})(_coreObservable2['default']);\n\nexports['default'] = PubnubMock;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _httpClient = __webpack_require__(9);\n\nvar _httpClient2 = _interopRequireDefault(_httpClient);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Subscription = (function (_Observable) {\n    _inherits(Subscription, _Observable);\n\n    _createClass(Subscription, null, [{\n        key: '_renewHandicapMs',\n        value: 2 * 60 * 1000,\n        enumerable: true\n    }, {\n        key: '_pollInterval',\n        value: 10 * 1000,\n        enumerable: true\n    }]);\n\n    function Subscription(pubnubFactory, platform, cache) {\n        _classCallCheck(this, Subscription);\n\n        _Observable.call(this);\n\n        this.events = {\n            notification: 'notification',\n            removeSuccess: 'removeSuccess',\n            removeError: 'removeError',\n            renewSuccess: 'renewSuccess',\n            renewError: 'renewError',\n            subscribeSuccess: 'subscribeSuccess',\n            subscribeError: 'subscribeError'\n        };\n        this._pubnubFactory = pubnubFactory;\n        this._platform = platform;\n        this._cache = cache;\n        this._pubnub = null;\n        this._timeout = null;\n        this._subscription = {};\n    }\n\n    //export interface ISubscription {\n    //    id?:string;\n    //    uri?: string;\n    //    eventFilters?:string[];\n    //    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n    //    expiresIn?:number;\n    //    deliveryMode?: {\n    //        transportType?:string;\n    //        encryption?:boolean;\n    //        address?:string;\n    //        subscriberKey?:string;\n    //        encryptionKey?:string;\n    //        secretKey?:string;\n    //    };\n    //    creationTime?:string; // 2014-03-12T19:54:35.613Z\n    //    status?:string; // Active\n    //}\n\n    /**\n     * @return {boolean}\n     */\n\n    Subscription.prototype.alive = function alive() {\n\n        return !!(this._subscription.id && this._subscription.deliveryMode && this._subscription.deliveryMode.subscriberKey && this._subscription.deliveryMode.address && Date.now() < this.expirationTime());\n    };\n\n    Subscription.prototype.expirationTime = function expirationTime() {\n        return new Date(this._subscription.expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    };\n\n    Subscription.prototype.setSubscription = function setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n\n        this._subscription = subscription;\n\n        if (!this._pubnub) this._subscribeAtPubnub();\n\n        this._setTimeout();\n\n        return this;\n    };\n\n    Subscription.prototype.subscription = function subscription() {\n        return this._subscription;\n    };\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @param {{events?:string[]}} [options] New array of events\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.register = function register(options) {\n        return regeneratorRuntime.async(function register$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    if (!this.alive()) {\n                        context$2$0.next = 6;\n                        break;\n                    }\n\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this.renew(options));\n\n                case 3:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 6:\n                    context$2$0.next = 8;\n                    return regeneratorRuntime.awrap(this.subscribe(options));\n\n                case 8:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 9:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Subscription.prototype.eventFilters = function eventFilters() {\n        return this._subscription.eventFilters || [];\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n    Subscription.prototype.addEventFilters = function addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n    Subscription.prototype.setEventFilters = function setEventFilters(events) {\n        this._subscription.eventFilters = events;\n        return this;\n    };\n\n    /**\n     * @param {{events?:string[]}} [options] New array of events\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.subscribe = function subscribe(options) {\n        var response, json;\n        return regeneratorRuntime.async(function subscribe$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    options = options || {};\n\n                    if (options.events) this.setEventFilters(options.events);\n\n                    this._clearTimeout();\n\n                    if (this.eventFilters().length) {\n                        context$2$0.next = 6;\n                        break;\n                    }\n\n                    throw new Error('Events are undefined');\n\n                case 6:\n                    context$2$0.next = 8;\n                    return regeneratorRuntime.awrap(this._platform.post('/restapi/v1.0/subscription', {\n                        eventFilters: this._getFullEventFilters(),\n                        deliveryMode: {\n                            transportType: 'PubNub'\n                        }\n                    }));\n\n                case 8:\n                    response = context$2$0.sent;\n                    json = response.json();\n\n                    this.setSubscription(json).emit(this.events.subscribeSuccess, response);\n\n                    return context$2$0.abrupt('return', response);\n\n                case 14:\n                    context$2$0.prev = 14;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._platform.client().makeError(context$2$0.t0);\n\n                    this.reset().emit(this.events.subscribeError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 19:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 14]]);\n    };\n\n    /**\n     * @param {{events?:string[]}} [options] New array of events\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.renew = function renew(options) {\n        var response, json;\n        return regeneratorRuntime.async(function renew$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    options = options || {};\n\n                    if (options.events) this.setEventFilters(options.events);\n\n                    this._clearTimeout();\n\n                    if (this.alive()) {\n                        context$2$0.next = 6;\n                        break;\n                    }\n\n                    throw new Error('Subscription is not alive');\n\n                case 6:\n                    if (this.eventFilters().length) {\n                        context$2$0.next = 8;\n                        break;\n                    }\n\n                    throw new Error('Events are undefined');\n\n                case 8:\n                    context$2$0.next = 10;\n                    return regeneratorRuntime.awrap(this._platform.put('/restapi/v1.0/subscription/' + this._subscription.id, {\n                        eventFilters: this._getFullEventFilters()\n                    }));\n\n                case 10:\n                    response = context$2$0.sent;\n                    json = response.json();\n\n                    this.setSubscription(json).emit(this.events.renewSuccess, response);\n\n                    return context$2$0.abrupt('return', response);\n\n                case 16:\n                    context$2$0.prev = 16;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._platform.client().makeError(context$2$0.t0);\n\n                    this.reset().emit(this.events.renewError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 21:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 16]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.remove = function remove() {\n        var response;\n        return regeneratorRuntime.async(function remove$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    if (this.alive()) {\n                        context$2$0.next = 3;\n                        break;\n                    }\n\n                    throw new Error('Subscription is not alive');\n\n                case 3:\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._platform['delete']('/restapi/v1.0/subscription/' + this._subscription.id));\n\n                case 5:\n                    response = context$2$0.sent;\n\n                    this.reset().emit(this.events.removeSuccess, response);\n\n                    return context$2$0.abrupt('return', response);\n\n                case 10:\n                    context$2$0.prev = 10;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._platform.client().makeError(context$2$0.t0);\n\n                    this.emit(this.events.removeError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 15:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 10]]);\n    };\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n\n    Subscription.prototype.reset = function reset() {\n        this._clearTimeout();\n        if (this.alive() && this._pubnub) this._pubnub.unsubscribe({ channel: this._subscription.deliveryMode.address });\n        this._subscription = {};\n        return this;\n    };\n\n    /**\n     *\n     * @param {string} cacheKey\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n    Subscription.prototype.restoreFromCache = function restoreFromCache(cacheKey, events) {\n        var _this = this;\n\n        this.on([this.events.subscribeSuccess, this.events.renewSuccess], function () {\n\n            _this._cache.setItem(cacheKey, _this.subscription());\n        });\n\n        this.on(this.events.renewError, function () {\n\n            _this.reset().setEventFilters(events).register();\n        });\n\n        var cachedSubscriptionData = this._cache.getItem(cacheKey);\n\n        if (cachedSubscriptionData) {\n            try {\n                this.setSubscription(cachedSubscriptionData);\n            } catch (e) {}\n        } else {\n            this.setEventFilters(events);\n        }\n\n        return this;\n    };\n\n    Subscription.prototype._getFullEventFilters = function _getFullEventFilters() {\n        var _this2 = this;\n\n        return this.eventFilters().map(function (event) {\n            return _this2._platform.createUrl(event);\n        });\n    };\n\n    Subscription.prototype._setTimeout = function _setTimeout() {\n        var _this3 = this;\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        _coreUtils.poll(function (next) {\n\n            if (_this3.alive()) return next();\n\n            _this3.renew();\n        }, Subscription._pollInterval, this._timeout);\n\n        return this;\n    };\n\n    Subscription.prototype._clearTimeout = function _clearTimeout() {\n\n        _coreUtils.stopPolling(this._timeout);\n\n        return this;\n    };\n\n    Subscription.prototype._decrypt = function _decrypt(message) {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        if (this._subscription.deliveryMode.encryptionKey) {\n\n            var PUBNUB = this._pubnubFactory;\n\n            message = PUBNUB.crypto_obj.decrypt(message, this._subscription.deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n        }\n\n        return message;\n    };\n\n    Subscription.prototype._notify = function _notify(message) {\n\n        this.emit(this.events.notification, this._decrypt(message));\n\n        return this;\n    };\n\n    Subscription.prototype._subscribeAtPubnub = function _subscribeAtPubnub() {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var PUBNUB = this._pubnubFactory;\n\n        this._pubnub = PUBNUB.init({\n            ssl: true,\n            subscribe_key: this._subscription.deliveryMode.subscriberKey\n        });\n\n        this._pubnub.ready();\n\n        this._pubnub.subscribe({\n            channel: this._subscription.deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: function connect() {}\n        });\n\n        return this;\n    };\n\n    return Subscription;\n})(_coreObservable2['default']);\n\nexports['default'] = Subscription;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 21 */\n/***/ function(module, exports) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=ringcentral.js.map"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c0838cc3f17cb1b5a03c\n **/","import * as Utils from './core/Utils';\nimport Cache from './core/Cache';\nimport * as Externals from './core/Externals';\nimport Observable from './core/Observable';\n\nimport Client from './http/Client';\nimport ApiResponse from './http/ApiResponse';\nimport * as HttpUtils from './http/Utils';\n\nimport {default as ClientMock} from './mocks/ClientMock';\nimport Mock from './mocks/Mock';\nimport Registry from './mocks/Registry';\n\nimport Platform from './platform/Platform';\nimport Auth from './platform/Auth';\nimport Queue from './platform/Queue';\n\nimport PubnubMockFactory from './pubnub/PubnubFactory';\n\nimport Subscription from './subscription/Subscription';\n\nrequire(\"regenerator/runtime\");\n\nexport default class SDK {\n\n    static version = '2.0.0';\n\n    static server = {\n        sandbox: 'https://platform.devtest.ringcentral.com',\n        production: 'https://platform.ringcentral.com'\n    };\n\n    /**\n     * @constructor\n     * @param {object} [options]\n     * @param {string} [options.server]\n     * @param {string} [options.cachePrefix]\n     * @param {string} [options.appSecret]\n     * @param {string} [options.appKey]\n     * @param {string} [options.appName]\n     * @param {string} [options.appVersion]\n     * @param {string} [options.pubnubFactory]\n     * @param {string} [options.client]\n     */\n    constructor(options) {\n\n        options = options || {};\n\n        this._cache = new Cache(Externals.localStorage, options.cachePrefix);\n\n        this._client = options.client || new Client();\n\n        this._platform = new Platform(this._client, this._cache, options.server, options.appKey, options.appSecret);\n\n        this._pubnubFactory = options.pubnubFactory || Externals.PUBNUB;\n\n    }\n\n    /**\n     * @return {Platform}\n     */\n    platform() {\n        return this._platform;\n    }\n\n    /**\n     * @return {Subscription}\n     */\n    createSubscription() {\n        return new Subscription(this._pubnubFactory, this._platform, this._cache);\n    }\n\n    /**\n     * @return {Cache}\n     */\n    cache() {\n        return this._cache;\n    }\n\n    static core = {\n        Cache: Cache,\n        Observable: Observable,\n        Utils: Utils,\n        Externals: Externals\n    };\n\n    static http = {\n        Client: Client,\n        ApiResponse: ApiResponse,\n        Utils: HttpUtils\n    };\n\n    static platform = {\n        Auth: Auth,\n        Platform: Platform,\n        Queue: Queue\n    };\n\n    static subscription = {\n        Subscription: Subscription\n    };\n\n    static mocks = {\n        Client: ClientMock,\n        Registry: Registry,\n        Mock: Mock\n    };\n\n    static pubnub = {\n        PubnubMockFactory: PubnubMockFactory\n    };\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/SDK.js\n **/","import {Promise} from './Externals.js';\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {object} parameters\n * @returns {string}\n */\nexport function queryStringify(parameters) {\n\n    var array = [];\n\n    parameters = parameters || {};\n\n    Object.keys(parameters).forEach((k) => {\n\n        var v = parameters[k];\n\n        if (isArray(v)) {\n            v.forEach((vv) => {\n                array.push(encodeURIComponent(k) + '=' + encodeURIComponent(vv));\n            });\n        } else {\n            array.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n        }\n\n    });\n\n    return array.join('&');\n\n}\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {string} queryString\n * @returns {object}\n */\nexport function parseQueryString(queryString) {\n\n    var argsParsed = {};\n\n    queryString.split('&').forEach((arg) => {\n\n        arg = decodeURIComponent(arg);\n\n        if (arg.indexOf('=') == -1) {\n\n            argsParsed[arg.trim()] = true;\n\n        } else {\n\n            var pair = arg.split('='),\n                key = pair[0].trim(),\n                value = pair[1].trim();\n\n            if (key in argsParsed) {\n                if (key in argsParsed && !isArray(argsParsed[key])) argsParsed[key] = [argsParsed[key]];\n                argsParsed[key].push(value);\n            } else {\n                argsParsed[key] = value;\n            }\n\n        }\n\n    });\n\n    return argsParsed;\n\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\n/**\n * @param fn\n * @param interval\n * @param timeout\n */\nexport function poll(fn, interval, timeout) { //NodeJS.Timer|number\n\n    module.exports.stopPolling(timeout);\n\n    interval = interval || 1000;\n\n    var next = (delay) => {\n\n        delay = delay || interval;\n\n        interval = delay;\n\n        return setTimeout(() => {\n\n            fn(next, delay);\n\n        }, delay);\n\n    };\n\n    return next();\n\n}\n\nexport function stopPolling(timeout) {\n    if (timeout) clearTimeout(timeout);\n}\n\nexport function isNodeJS() {\n    return (typeof process !== 'undefined');\n}\n\nexport function isBrowser() {\n    return (typeof window !== 'undefined');\n}\n\nexport function delay(timeout) {\n    return new Promise((resolve, reject) => {\n        setTimeout(() => {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Utils.js\n **/","import ES6Promise from 'es6-promise';\nimport nodeFetch from 'node-fetch';\nimport pubnub from 'pubnub';\n\nexport var Promise = (ES6Promise && ES6Promise.Promise) || window.Promise;\n\nexport var fetch = nodeFetch || window.fetch;\nexport var Request = fetch.Request || window.Request;\nexport var Response = fetch.Response || window.Response;\nexport var Headers = fetch.Headers || window.Headers;\n\nexport var PUBNUB = pubnub || window.PUBNUB;\n\nexport var localStorage = (typeof window !== 'undefined' &&\n                           typeof window.localStorage !== 'undefined') ? window.localStorage : {};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Externals.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}\n ** module id = 6\n ** module chunks = 0\n **/","export default class Cache {\n\n    static defaultPrefix = 'rc-';\n\n    constructor(storage, prefix) {\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    }\n\n    setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    }\n\n    removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    }\n\n    getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    }\n\n    clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n\n        }\n\n        return this;\n\n    }\n\n    _prefixKey(key) {\n        return this._prefix + key;\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Cache.js\n **/","export default class Observable {\n\n    constructor() {\n        this.off();\n    }\n\n    hasListeners(event) {\n        return (event in this._listeners);\n    }\n\n    on(events, callback) {\n\n        if (typeof events == 'string') events = [events];\n        if (!events) throw new Error('No events to subscribe to');\n        if (typeof callback !== 'function') throw new Error('Callback must be a function');\n\n        events.forEach((event) => {\n\n            if (!this.hasListeners(event)) this._listeners[event] = [];\n\n            this._listeners[event].push(callback);\n\n        });\n\n        return this;\n\n    }\n\n    emit(event, ...args) {\n\n        var result = null;\n\n        if (!this.hasListeners(event)) return null;\n\n        this._listeners[event].some((callback) => {\n\n            result = callback.apply(this, args);\n            return (result === false);\n\n        });\n\n        return result;\n\n    }\n\n    off(event, callback) {\n\n        if (!event) {\n\n            this._listeners = {};\n\n        } else {\n\n            if (!callback) {\n\n                delete this._listeners[event];\n\n            } else {\n\n                if (!this.hasListeners(event)) return this;\n\n                this._listeners[event].forEach((cb, i) => {\n\n                    if (cb === callback) delete this._listeners[event][i];\n\n                });\n\n            }\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Observable.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport {queryStringify} from '../core/Utils';\nimport {findHeaderName} from './Utils';\nimport Observable from '../core/Observable';\nimport ApiResponse from './ApiResponse';\n\nexport default class Client extends Observable {\n\n    static _allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'];\n\n    events = {\n        beforeRequest: 'beforeRequest',\n        requestSuccess: 'requestSuccess',\n        requestError: 'requestError'\n    };\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request) {\n\n        var apiResponse = new ApiResponse(request);\n\n        try {\n\n            //TODO Stop request if listeners return false\n            this.emit(this.events.beforeRequest, apiResponse);\n\n            apiResponse._response = await this._loadResponse(request);\n\n            if (apiResponse._isMultipart() || apiResponse._isJson()) {\n                apiResponse._text = await apiResponse.response().text();\n            }\n\n            if (!apiResponse.ok()) throw new Error('Response has unsuccessful status');\n\n            this.emit(this.events.requestSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            if (!e.apiResponse) e = this.makeError(e, apiResponse);\n\n            this.emit(this.events.requestError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n    async _loadResponse(request) {\n        return await fetch.call(null, request);\n    }\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n    makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = (apiResponse && apiResponse.error(true)) || e.originalMessage;\n\n        }\n\n        return e;\n\n    }\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n    createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) throw new Error('Method has wrong value: ' + init.method);\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + queryStringify(init.query);\n        }\n\n        if (!(findHeaderName('Accept', init.headers))) {\n            init.headers['Accept'] = ApiResponse._jsonContentType;\n        }\n\n        // Serialize body\n        //TODO Check that body is a plain object\n        if (typeof init.body !== 'string' || !init.body) {\n\n            var contentTypeHeaderName = findHeaderName(ApiResponse._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = ApiResponse._contentType;\n                init.headers[contentTypeHeaderName] = ApiResponse._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(ApiResponse._jsonContentType) > -1) {\n                init.body = JSON.stringify(init.body);\n            } else if (contentType.indexOf(ApiResponse._urlencodedContentType) > -1) {\n                init.body = queryStringify(init.body);\n            }\n\n        }\n\n        // Create a request with encoded body\n        var req = new Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n\n    }\n\n}\n\n/**\n * @name IApiError\n * @property {string} stack\n * @property {string} originalMessage\n * @property {ApiResponse} apiResponse\n */\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Client.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport * as utils from '../core/Utils';\n\n/**\n * Creates a response\n * @param stringBody\n * @param init\n * @return {Response}\n */\nexport function createResponse(stringBody, init) {\n\n    init = init || {};\n\n    var response = new Response(stringBody, init);\n\n    //TODO Wait for https://github.com/bitinn/node-fetch/issues/38\n    if (utils.isNodeJS()) {\n\n        response._text = stringBody;\n        response._decode = function() {\n            return this._text;\n        };\n\n    }\n\n    return response;\n\n}\n\nexport function findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function(res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Utils.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport * as utils from './Utils';\n\nexport default class ApiResponse {\n\n    static _contentType = 'Content-Type';\n    static _jsonContentType = 'application/json';\n    static _multipartContentType = 'multipart/mixed';\n    static _urlencodedContentType = 'application/x-www-form-urlencoded';\n    static _headerSeparator = ':';\n    static _bodySeparator = '\\n\\n';\n    static _boundarySeparator = '--';\n\n    /**\n     * @param {Request} request\n     * @param {Response} response\n     * @param {string} responseText\n     */\n    constructor(request, response, responseText) {\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n\n    }\n\n    /**\n     * @return {Response}\n     */\n    response() {\n        return this._response;\n    }\n\n    /**\n     * @return {Request}\n     */\n    request() {\n        return this._request;\n    }\n\n    /**\n     * @return {boolean}\n     */\n    ok() {\n        return this._response && this._response.ok;\n    }\n\n    /**\n     * @return {string}\n     */\n    text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    }\n\n    /**\n     * @return {object}\n     */\n    json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    }\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n    error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') +\n                      (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n\n        } catch (e) {}\n\n        return message;\n\n    }\n\n    /**\n     * @return {ApiResponse[]}\n     */\n    multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map((part:string, i) => {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n\n            });\n\n        }\n\n        return this._multipart;\n\n    }\n\n    _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    }\n\n    _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    }\n\n    _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    }\n\n    _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    }\n\n    _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    }\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n    static create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = (headersAndBody.length > 1) ? headersAndBody.shift() : '';\n\n        text = headersAndBody.join(ApiResponse._bodySeparator);\n\n        (headersText || '')\n            .split('\\n')\n            .forEach((header:string) => {\n\n                var split = header.trim().split(ApiResponse._headerSeparator),\n                    key = split.shift().trim(),\n                    value = split.join(ApiResponse._headerSeparator).trim();\n\n                if (key) headers.append(key, value);\n\n            });\n\n        return new ApiResponse(null, utils.createResponse(text, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/ApiResponse.js\n **/","import Registry from './Registry';\nimport {default as HttpClient} from '../http/Client';\n\nexport default class Client extends HttpClient {\n\n    constructor() {\n        super();\n        this._registry = new Registry();\n    }\n\n    registry() {\n        return this._registry;\n    }\n\n    async _loadResponse(request) {\n\n        var mock = this._registry.find(request);\n\n        return await mock.getResponse(request);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/ClientMock.js\n **/","import Mock from './Mock';\n\nexport default class Registry {\n\n    constructor() {\n        this._mocks = [];\n    }\n\n    add(mock) {\n        this._mocks.push(mock);\n        return this;\n    }\n\n    clear() {\n        this._mocks = [];\n        return this;\n    }\n\n    find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url +\n                                                 ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n\n    }\n\n    apiCall(method:string, path:string, response:any, status, statusText) {\n\n        this.add(new Mock(method, path, response, status, statusText));\n\n        return this;\n\n    }\n\n    authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n\n    }\n\n    logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n\n    }\n\n    presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n\n    }\n\n    subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': [\n                '/restapi/v1.0/account/~/extension/~/presence'\n            ],\n            'expirationTime': new Date(date.getTime() + (expiresIn * 1000)).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + (15 * 60 * 60 * 1000)).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Registry.js\n **/","import ApiResponse from '../http/ApiResponse';\nimport {delay} from '../core/Utils';\nimport {createResponse} from '../http/Utils';\n\nexport default class Mock {\n\n    constructor(method, path, json, status, statusText, delay) {\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    path() {\n        return this._path;\n    }\n\n    method() {\n        return this._method;\n    }\n\n    test(request:Request) {\n\n        return request.url.indexOf(this._path) > -1 &&\n               request.method.toUpperCase() == this._method;\n\n    }\n\n    async getResponse(request) {\n\n        await delay(this._delay);\n\n        return this.createResponse(this._json);\n\n    }\n\n    createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = createResponse(str, init);\n\n        res.headers.set(ApiResponse._contentType, ApiResponse._jsonContentType);\n\n        return res;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Mock.js\n **/","import Observable from '../core/Observable';\nimport Queue from './Queue';\nimport Auth from './Auth';\nimport {Promise} from '../core/Externals';\nimport {queryStringify, parseQueryString, delay} from '../core/Utils';\n\nexport default class Platform extends Observable {\n\n    static _urlPrefix = '/restapi';\n    static _apiVersion = 'v1.0';\n    static _accessTokenTtl = null; // Platform server by default sets it to 60 * 60 = 1 hour\n    static _refreshTokenTtl = 10 * 60 * 60; // 10 hours\n    static _refreshTokenTtlRemember = 7 * 24 * 60 * 60; // 1 week\n    static _tokenEndpoint = '/restapi/oauth/token';\n    static _revokeEndpoint = '/restapi/oauth/revoke';\n    static _authorizeEndpoint = '/restapi/oauth/authorize';\n    static _refreshDelayMs = 100;\n    static _cacheId = 'platform';\n    static _clearCacheOnRefreshError = true;\n\n    events = {\n        beforeLogin: 'beforeLogin',\n        loginSuccess: 'loginSuccess',\n        loginError: 'loginError',\n        beforeRefresh: 'beforeRefresh',\n        refreshSuccess: 'refreshSuccess',\n        refreshError: 'refreshError',\n        beforeLogout: 'beforeLogout',\n        logoutSuccess: 'logoutSuccess',\n        logoutError: 'logoutError'\n    };\n\n    constructor(client, cache, server, appKey, appSecret) {\n\n        super();\n\n        this._server = server;\n        this._appKey = appKey;\n        this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        this._cache = cache;\n\n        /** @type {Client} */\n        this._client = client;\n\n        this._queue = new Queue(this._cache, Platform._cacheId + '-refresh');\n\n        this._auth = new Auth(this._cache, Platform._cacheId);\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    auth() {\n        return this._auth;\n    }\n\n    /**\n     * @return {Client}\n     */\n    client() {\n        return this._client;\n    }\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n    createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += (path.indexOf('?') > -1 ? '&' : '?');\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n\n    }\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @return {string}\n     */\n    authUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + queryStringify({\n                'response_type': 'code',\n                'redirect_uri': options.redirectUri || '',\n                'client_id': this._appKey,\n                'state': options.state || '',\n                'brand_id': options.brandId || '',\n                'display': options.display || '',\n                'prompt': options.prompt || ''\n            }), {addServer: true})\n\n    }\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n    parseAuthRedirectUrl(url:string) {\n\n        var qs = parseQueryString(url.split('?').reverse()[0]),\n            error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n\n    }\n\n    /**\n     * @return {Promise<boolean>}\n     */\n    async loggedIn() {\n\n        try {\n            await this._ensureAuthentication();\n            return true;\n        } catch (e) {\n            return false;\n        }\n\n    }\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @returns {Promise<ApiResponse>}\n     */\n    async login(options) {\n\n        try {\n\n            options = options || {};\n\n            options.remember = options.remember || false;\n\n            this.emit(this.events.beforeLogin);\n\n            var body = {\n                \"access_token_ttl\": Platform._accessTokenTtl,\n                \"refresh_token_ttl\": options.remember ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n            };\n\n            if (!options.code) {\n\n                body.grant_type = 'password';\n                body.username = options.username;\n                body.password = options.password;\n                body.extension = options.extension || '';\n\n            } else if (options.code) {\n\n                body.grant_type = 'authorization_code';\n                body.code = options.code;\n                body.redirect_uri = options.redirectUri;\n                //body.client_id = this.getCredentials().key; // not needed\n\n            }\n\n            if (options.endpointId) body.endpoint_id = options.endpointId;\n\n            var apiResponse = await this._tokenRequest(Platform._tokenEndpoint, body),\n                json = apiResponse.json();\n\n            this._auth\n                .setData(json)\n                .setRemember(options.remember);\n\n            this.emit(this.events.loginSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            this._cache.clean();\n\n            this.emit(this.events.loginError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async refresh() {\n\n        try {\n\n            this.emit(this.events.beforeRefresh);\n\n            if (this._queue.isPaused()) {\n\n                await this._queue.poll();\n\n                if (!this._isAccessTokenValid()) {\n                    throw new Error('Automatic authentification timeout');\n                }\n\n                this.emit(this.events.refreshSuccess, null);\n\n                return null;\n\n            }\n\n            this._queue.pause();\n\n            // Make sure all existing AJAX calls had a chance to reach the server\n            await delay(Platform._refreshDelayMs);\n\n            // Perform sanity checks\n            if (!this._auth.refreshToken()) throw new Error('Refresh token is missing');\n            if (!this._auth.refreshTokenValid()) throw new Error('Refresh token has expired');\n            if (!this._queue.isPaused()) throw new Error('Queue was resumed before refresh call');\n\n            /** @type {ApiResponse} */\n            var res = await this._tokenRequest(Platform._tokenEndpoint, {\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": this._auth.refreshToken(),\n                    \"access_token_ttl\": Platform._accessTokenTtl,\n                    \"refresh_token_ttl\": this._auth.remember() ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                }),\n                json = res.json();\n\n            if (!json.access_token) {\n                throw this._client.makeError(new Error('Malformed OAuth response'), res);\n            }\n\n            this._auth.setData(json);\n            this._queue.resume();\n\n            this.emit(this.events.refreshSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            e = this._client.makeError(e);\n\n            if (Platform._clearCacheOnRefreshError) {\n                this._cache.clean();\n            }\n\n            this.emit(this.events.refreshError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async logout() {\n\n        try {\n\n            this.emit(this.events.beforeLogout);\n\n            this._queue.pause();\n\n            var res = await this._tokenRequest(Platform._revokeEndpoint, {\n                token: this._auth.accessToken()\n            });\n\n            this._queue.resume();\n            this._cache.clean();\n\n            this.emit(this.events.logoutSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            this._queue.resume();\n\n            this.emit(this.events.logoutError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n    async inflateRequest(request, options) {\n\n        options = options || {};\n\n        if (options.skipAuthCheck) return request;\n\n        await this._ensureAuthentication();\n\n        request.headers.set('Authorization', this._authHeader());\n        //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n        //TODO Add User-Agent here\n\n        return request;\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request, options) {\n\n        try {\n\n            request = await this.inflateRequest(request, options);\n\n            return (await this._client.sendRequest(request));\n\n        } catch (e) {\n\n            // Guard is for errors that come from polling\n            if (!e.apiResponse || !e.apiResponse.response() || (e.apiResponse.response().status != 401)) throw e;\n\n            this._auth.cancelAccessToken();\n\n            return (await this.sendRequest(request, options));\n\n        }\n\n    }\n\n    /**\n     * General purpose function to send anything to server\n     * @param {object} [options.body]\n     * @param {string} [options.url]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async send(options = {}) {\n\n        //FIXME https://github.com/bitinn/node-fetch/issues/43\n        options.url = this.createUrl(options.url, {addServer: true});\n\n        return await this.sendRequest(this._client.createRequest(options), options);\n\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async get(url, query, options) {\n        options = options || {};\n        options.method = 'GET';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async post(url, body, query, options) {\n        options = options || {};\n        options.method = 'POST';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async put(url, body, query, options) {\n        options = options || {};\n        options.method = 'PUT';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {string} query\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async 'delete'(url, query, options) {\n        options = options || {};\n        options.method = 'DELETE';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    async _tokenRequest(path, body) {\n\n        return await this.send({\n            url: path,\n            skipAuthCheck: true,\n            body: body,\n            method: 'POST',\n            headers: {\n                'Authorization': 'Basic ' + this._apiKey(),\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        });\n\n    }\n\n    async _ensureAuthentication() {\n\n        if (this._isAccessTokenValid()) return null;\n        return await this.refresh();\n\n    }\n\n    _isAccessTokenValid() {\n\n        return (this._auth.accessTokenValid() && !this._queue.isPaused());\n\n    }\n\n    _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return (typeof btoa == 'function') ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    }\n\n    _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Platform.js\n **/","import {Promise} from '../core/Externals';\nimport {poll, stopPolling} from '../core/Utils';\n\nexport default class Queue {\n\n    static _pollInterval = 250;\n    static _releaseTimeout = 5000;\n\n    constructor(cache, cacheId) {\n\n        this._cache = cache;\n        this._cacheId = cacheId;\n        this._promise = null;\n\n    }\n\n    isPaused() {\n\n        var storage = this._cache,\n            cacheId = this._cacheId,\n            time = storage.getItem(cacheId);\n\n        return !!time && Date.now() - parseInt(time) < Queue._releaseTimeout;\n    }\n\n    pause() {\n        this._cache.setItem(this._cacheId, Date.now());\n        return this;\n    }\n\n    resume() {\n        this._cache.removeItem(this._cacheId);\n        return this;\n    }\n\n    poll() {\n\n        if (this._promise) return this._promise;\n\n        this._promise = new Promise((resolve, reject) => {\n\n            poll((next) => {\n\n                if (this.isPaused()) return next();\n\n                this._promise = null;\n\n                this.resume(); // this is actually not needed but why not\n\n                resolve(null);\n\n            }, Queue._pollInterval);\n\n        });\n\n        return this._promise;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Queue.js\n **/","export default class Auth {\n\n    static refreshHandicapMs:number = 60 * 1000; // 1 minute\n    static forcedTokenType = 'forced';\n\n    constructor(cache, cacheId:string) {\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n\n    }\n\n    accessToken() {\n        return this.data().access_token;\n    }\n\n    refreshToken() {\n        return this.data().refresh_token;\n    }\n\n    tokenType() {\n        return this.data().token_type;\n    }\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n    data() {\n\n        return this._cache.getItem(this._cacheId) || {\n                token_type: '',\n                access_token: '',\n                expires_in: 0,\n                refresh_token: '',\n                refresh_token_expires_in: 0\n            };\n\n    }\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n    setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach((key) => {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + (data.expires_in * 1000);\n        data.refresh_token_expire_time = Date.now() + (data.refresh_token_expires_in * 1000);\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    accessTokenValid() {\n\n        var authData = this.data();\n        return (authData.token_type === Auth.forcedTokenType || (authData.expire_time - Auth.refreshHandicapMs > Date.now()));\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    refreshTokenValid() {\n\n        return (this.data().refresh_token_expire_time > Date.now());\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n\n    }\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n    forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n\n    }\n\n    /**\n     * @param remember\n     * @return {Auth}\n     */\n    setRemember(remember) {\n\n        return this.setData({remember: remember});\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    remember() {\n\n        return !!this.data().remember;\n\n    }\n\n}\n\n//export interface IAuthData {\n//    remember?:boolean;\n//    token_type?:string;\n//    access_token?:string;\n//    expires_in?:number; // actually it's string\n//    expire_time?:number;\n//    refresh_token?:string;\n//    refresh_token_expires_in?:number; // actually it's string\n//    refresh_token_expire_time?:number;\n//    scope?:string;\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Auth.js\n **/","import PubnubMock from './PubnubMock.js';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMockFactory {\n\n    constructor() {\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    init(options:PUBNUBInitOptions) {\n        return new PubnubMock(options);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubFactory.js\n **/","import Observable from '../core/Observable';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMock extends Observable {\n\n    constructor(options) {\n        super();\n        this.options = options;\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    ready() {}\n\n    subscribe(options:PUBNUBSubscribeOptions) {\n        this.on('message-' + options.channel, options.message);\n    }\n\n    unsubscribe(options:PUBNUBUnsubscribeOptions) {\n        this.off('message-' + options.channel);\n    }\n\n    receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubMock.js\n **/","import Observable from '../core/Observable';\nimport Client from '../http/Client';\nimport {poll, stopPolling} from '../core/Utils';\n\nexport default class Subscription extends Observable {\n\n    static _renewHandicapMs = 2 * 60 * 1000;\n    static _pollInterval = 10 * 1000;\n\n    events = {\n        notification: 'notification',\n        removeSuccess: 'removeSuccess',\n        removeError: 'removeError',\n        renewSuccess: 'renewSuccess',\n        renewError: 'renewError',\n        subscribeSuccess: 'subscribeSuccess',\n        subscribeError: 'subscribeError'\n    };\n\n    constructor(pubnubFactory, platform, cache) {\n\n        super();\n\n        this._pubnubFactory = pubnubFactory;\n        this._platform = platform;\n        this._cache = cache;\n        this._pubnub = null;\n        this._timeout = null;\n        this._subscription = {};\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    alive() {\n\n        return !!(this._subscription.id &&\n                  this._subscription.deliveryMode &&\n                  this._subscription.deliveryMode.subscriberKey &&\n                  this._subscription.deliveryMode.address &&\n                  Date.now() < this.expirationTime());\n\n    }\n\n    expirationTime() {\n        return new Date(this._subscription.expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    }\n\n    setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n\n        this._subscription = subscription;\n\n        if (!this._pubnub) this._subscribeAtPubnub();\n\n        this._setTimeout();\n\n        return this;\n\n    }\n\n    subscription() {\n        return this._subscription;\n    }\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @param {{events?:string[]}} [options] New array of events\n     * @returns {Promise<ApiResponse>}\n     */\n    async register(options) {\n\n        if (this.alive()) {\n            return await this.renew(options);\n        } else {\n            return await this.subscribe(options);\n        }\n\n    }\n\n    eventFilters() {\n        return this._subscription.eventFilters || [];\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    setEventFilters(events) {\n        this._subscription.eventFilters = events;\n        return this;\n    }\n\n    /**\n     * @param {{events?:string[]}} [options] New array of events\n     * @returns {Promise<ApiResponse>}\n     */\n    async subscribe(options) {\n\n        try {\n\n            options = options || {};\n\n            if (options.events) this.setEventFilters(options.events);\n\n            this._clearTimeout();\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.post('/restapi/v1.0/subscription', {\n                    eventFilters: this._getFullEventFilters(),\n                    deliveryMode: {\n                        transportType: 'PubNub'\n                    }\n                }),\n                json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.subscribeSuccess, response);\n\n            return response;\n\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.subscribeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {{events?:string[]}} [options] New array of events\n     * @returns {Promise<ApiResponse>}\n     */\n    async renew(options) {\n\n        try {\n\n            options = options || {};\n\n            if (options.events) this.setEventFilters(options.events);\n\n            this._clearTimeout();\n\n            if (!this.alive()) throw new Error('Subscription is not alive');\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.put('/restapi/v1.0/subscription/' + this._subscription.id, {\n                eventFilters: this._getFullEventFilters()\n            });\n\n            var json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.renewSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.renewError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async remove() {\n\n        try {\n\n            if (!this.alive()) throw new Error('Subscription is not alive');\n\n            var response = await this._platform.delete('/restapi/v1.0/subscription/' + this._subscription.id);\n\n            this.reset()\n                .emit(this.events.removeSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.emit(this.events.removeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n    reset() {\n        this._clearTimeout();\n        if (this.alive() && this._pubnub) this._pubnub.unsubscribe({channel: this._subscription.deliveryMode.address});\n        this._subscription = {};\n        return this;\n    }\n\n    /**\n     *\n     * @param {string} cacheKey\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    restoreFromCache(cacheKey, events) {\n\n        this.on([this.events.subscribeSuccess, this.events.renewSuccess], () => {\n\n            this._cache.setItem(cacheKey, this.subscription());\n\n        });\n\n        this.on(this.events.renewError, () => {\n\n            this.reset()\n                .setEventFilters(events)\n                .register();\n\n        });\n\n        var cachedSubscriptionData = this._cache.getItem(cacheKey);\n\n        if (cachedSubscriptionData) {\n            try {\n                this.setSubscription(cachedSubscriptionData);\n            } catch (e) {}\n        } else {\n            this.setEventFilters(events);\n        }\n\n        return this;\n\n    }\n\n    _getFullEventFilters() {\n\n        return this.eventFilters().map((event) => {\n            return this._platform.createUrl(event);\n        });\n\n    }\n\n    _setTimeout() {\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        poll((next)=> {\n\n            if (this.alive()) return next();\n\n            this.renew();\n\n        }, Subscription._pollInterval, this._timeout);\n\n        return this;\n\n    }\n\n    _clearTimeout() {\n\n        stopPolling(this._timeout);\n\n        return this;\n\n    }\n\n    _decrypt(message:any) {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        if (this._subscription.deliveryMode.encryptionKey) {\n\n            var PUBNUB = this._pubnubFactory;\n\n            message = PUBNUB.crypto_obj.decrypt(message, this._subscription.deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n\n        }\n\n        return message;\n\n    }\n\n    _notify(message:any) {\n\n        this.emit(this.events.notification, this._decrypt(message));\n\n        return this;\n\n    }\n\n    _subscribeAtPubnub():Subscription {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var PUBNUB = this._pubnubFactory;\n\n        this._pubnub = PUBNUB.init({\n            ssl: true,\n            subscribe_key: this._subscription.deliveryMode.subscriberKey\n        });\n\n        this._pubnub.ready();\n\n        this._pubnub.subscribe({\n            channel: this._subscription.deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: () => {}\n        });\n\n        return this;\n\n    }\n\n}\n\n//export interface ISubscription {\n//    id?:string;\n//    uri?: string;\n//    eventFilters?:string[];\n//    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n//    expiresIn?:number;\n//    deliveryMode?: {\n//        transportType?:string;\n//        encryption?:boolean;\n//        address?:string;\n//        subscriberKey?:string;\n//        encryptionKey?:string;\n//        secretKey?:string;\n//    };\n//    creationTime?:string; // 2014-03-12T19:54:35.613Z\n//    status?:string; // Active\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/Subscription.js\n **/","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/regenerator/runtime.js\n ** module id = 21\n ** module chunks = 0\n **/"],"sourceRoot":"/source/"}