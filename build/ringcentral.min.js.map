{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///ringcentral.min.js","webpack:///webpack/bootstrap 364f94bbf118a020eb87?c8c1","webpack:///./src/SDK.js?d032","webpack:///./~/babel-regenerator-runtime/runtime.js?501e","webpack:///./src/core/Utils.js?8e6c","webpack:///./src/core/Externals.js?fdf1","webpack:///external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}?3dda","webpack:///external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}?bbdd","webpack:///external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}?828f","webpack:///./~/querystring/index.js?fce8","webpack:///./~/querystring/decode.js?c250","webpack:///./~/querystring/encode.js?e86b","webpack:///./src/core/Cache.js?1256","webpack:///./~/events/events.js?7c71","webpack:///./src/http/Client.js?4230","webpack:///./src/http/ApiResponse.js?d4a4","webpack:///./src/mocks/ClientMock.js?440a","webpack:///./src/mocks/Registry.js?07b6","webpack:///./src/mocks/Mock.js?d69d","webpack:///./src/platform/Platform.js?8f42","webpack:///./src/platform/Auth.js?cef5","webpack:///./src/core/Constants.js?22d0","webpack:///./src/pubnub/PubnubFactory.js?e5d0","webpack:///./src/pubnub/PubnubMock.js?03ee","webpack:///./src/subscription/Subscription.js?3ae8","webpack:///./src/subscription/CachedSubscription.js?3294"],"names":["root","factory","exports","module","require","define","amd","undefined","this","__WEBPACK_EXTERNAL_MODULE_5__","__WEBPACK_EXTERNAL_MODULE_6__","__WEBPACK_EXTERNAL_MODULE_7__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_interopRequireWildcard","newObj","key","Object","prototype","hasOwnProperty","_classCallCheck","instance","Constructor","TypeError","_Utils","Utils","_Cache","_Cache2","_Externals","Externals","_events","_events2","_Client","_Client2","_ApiResponse","_ApiResponse2","_ClientMock","_ClientMock2","_Mock","_Mock2","_Registry","_Registry2","_Platform","_Platform2","_Auth","_Auth2","_PubnubFactory","_PubnubFactory2","_Subscription","_Subscription2","_CachedSubscription","_CachedSubscription2","_Constants","_Constants2","SDK","_ref","server","cachePrefix","appSecret","appKey","appName","appVersion","pubnubFactory","client","redirectUri","fetch","Error","Promise","_cache","localStorage","_client","_platform","cache","version","_pubnubFactory","PUBNUB","platform","createSubscription","createCachedSubscription","cacheKey","handleLoginRedirect","origin","_window$opener$postMe","response","window","location","hash","search","opener","postMessage","authResponseProperty","sandbox","production","core","Cache","EventEmitter","http","Client","ApiResponse","Auth","Platform","subscription","Subscription","mocks","Registry","Mock","pubnub","PubnubMockFactory","global","wrap","innerFn","outerFn","self","tryLocsList","generator","create","Generator","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","type","err","GeneratorFunction","GeneratorFunctionPrototype","defineIteratorMethods","forEach","method","AwaitArgument","AsyncIterator","invoke","result","value","resolve","then","invokeNext","invokeThrow","unwrapped","enqueue","callInvokeWithMethodAndArg","previousPromise","process","domain","bind","state","GenStateSuspendedStart","GenStateExecuting","GenStateCompleted","doneResult","delegate","iterator","returnMethod","record","info","done","GenStateSuspendedYield","resultName","next","nextLoc","_sent","sent","dispatchException","abrupt","ContinueSentinel","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","values","iterable","iteratorMethod","iteratorSymbol","isNaN","length","i","hasOwn","Symbol","inModule","runtime","regeneratorRuntime","Gp","constructor","displayName","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","async","iter","toString","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","queryStringify","parameters","_querystring2","stringify","parseQueryString","queryString","parse","isFunction","isArray","Array","isObject","o","_typeof","isObjectObject","isPlainObject","prot","isNodeJS","isBrowser","delay","timeout","reject","setTimeout","_querystring","Headers","Response","Request","_es6Promise","_es6Promise2","_nodeFetch","_nodeFetch2","_pubnub","_pubnub2","Function","decode","encode","prop","qs","sep","eq","options","regexp","split","maxKeys","len","kstr","vstr","k","v","x","replace","idx","indexOf","substr","decodeURIComponent","stringifyPrimitive","isFinite","map","ks","encodeURIComponent","join","storage","prefix","setPrefix","_storage","_prefix","defaultPrefix","setItem","data","_prefixKey","JSON","removeItem","getItem","item","clean","_maxListeners","isNumber","isUndefined","defaultMaxListeners","setMaxListeners","n","emit","er","handler","args","listeners","error","arguments","apply","addListener","listener","newListener","warned","console","trace","on","once","g","removeListener","fired","list","position","splice","removeAllListeners","ret","listenerCount","evlistener","emitter","_asyncToGenerator","gen","step","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","enumerable","writable","configurable","findHeaderName","headers","toLowerCase","reduce","res","_EventEmitter","_temp","_this","_ret","_len","_key","concat","events","beforeRequest","requestSuccess","requestError","sendRequest","_x","_callee","request","apiResponse","_context","_loadResponse","_response","_init","ok","t0","makeError","_x2","_ref2","_callee2","_context2","e","originalMessage","message","createRequest","init","url","toUpperCase","_allowedMethods","credentials","mode","query","_jsonContentType","body","contentTypeHeaderName","_contentType","contentType","_urlencodedContentType","req","originalBody","responseText","_request","_text","_json","_multipart","_isMultipart","_isJson","text","json","skipOKCheck","status","statusText","error_description","description","multipart","boundary","_getContentType","match","parts","_boundarySeparator","trim","shift","statusInfo","part","_isContentType","get","_multipartContentType","_isUrlEncoded","headersAndBody","_bodySeparator","headersText","header","_headerSeparator","append","_HttpClient","_registry","registry","mock","find","getResponse","_mocks","add","clear","test","path","apiCall","authentication","access_token","token_type","expires_in","refresh_token","refresh_token_expires_in","scope","expireTime","Date","getTime","logout","presenceLoad","uri","extension","extensionNumber","activeCalls","presenceStatus","telephonyStatus","userStatus","dndStatus","extensionId","subscribeGeneric","expiresIn","date","eventFilters","expirationTime","toISOString","deliveryMode","transportType","encryption","address","subscriberKey","secretKey","creationTime","subscribeOnPresence","detailed","encryptionAlgorithm","encryptionKey","tokenRefresh","failure","_method","_path","_delay","_status","_statusText","createResponse","str","set","sdkVersion","beforeLogin","loginSuccess","loginError","beforeRefresh","refreshSuccess","refreshError","beforeLogout","logoutSuccess","logoutError","_server","_appKey","_appSecret","_refreshPromise","_auth","_cacheId","_userAgent","_redirectUri","auth","createUrl","builtUrl","hasHttp","addServer","_urlPrefix","_apiVersion","addMethod","addToken","accessToken","loginUrl","_authorizeEndpoint","response_type","implicit","redirect_uri","client_id","brand_id","brandId","display","prompt","parseLoginRedirect","getParts","separator","loginWindow","_this2","width","height","property","target","dualScreenLeft","screenLeft","screen","left","dualScreenTop","screenTop","top","innerWidth","document","documentElement","clientWidth","innerHeight","clientHeight","win","open","focus","eventMethod","addEventListener","eventRemoveMethod","messageEvent","eventListener","close","loginOptions","code","loggedIn","ensureLoggedIn","login","_ref3","grant_type","username","password","endpointId","endpoint_id","accessTokenTtl","refreshTokenTtl","_tokenRequest","_tokenEndpoint","setData","_refresh","_ref4","_callee3","_context3","_refreshDelayMs","refreshToken","refreshTokenValid","access_token_ttl","refresh_token_ttl","_clearCacheOnRefreshError","refresh","_ref5","_callee4","_this3","_context4","_ref6","_callee5","_context5","_revokeEndpoint","token","inflateRequest","_x3","_ref7","_callee6","_context6","skipAuthCheck","_authHeader","_x4","_x5","_ref8","_callee7","_context7","retry","cancelAccessToken","send","_x6","_ref9","_callee8","_context8","_x8","_x9","_x10","_ref10","_callee9","_context9","post","_x11","_x12","_x13","_x14","_ref11","_callee10","_context10","put","_x15","_x16","_x17","_x18","_ref12","_callee11","_context11","_delete","_x19","_x20","_x21","_ref13","_callee12","_context12","_x22","_x23","_ref14","_callee13","_context13","Authorization","_apiKey","Content-Type","_ref15","_callee14","_context14","_isAccessTokenValid","accessTokenValid","apiKey","btoa","Buffer","tokenType","cacheId","newData","expire_time","now","refresh_token_expire_time","authData","forcedTokenType","refreshHandicapMs","forceAuthentication","_PubnubMock","_PubnubMock2","crypto_obj","PubnubMock","ready","subscribe","channel","unsubscribe","receiveMessage","msg","notification","removeSuccess","removeError","renewSuccess","renewError","subscribeSuccess","subscribeError","_pubnubLastChannel","_timeout","_subscription","subscribed","alive","expired","_renewHandicapMs","setSubscription","_clearTimeout","_setSubscription","_subscribeAtPubnub","_setTimeout","register","renew","addEventFilters","setEventFilters","_getFullEventFilters","remove","resubscribe","filters","event","setInterval","_pollInterval","clearInterval","_decrypt","decrypt","encryptKey","keyEncoding","keyLength","_notify","ssl","subscribe_key","connect","_Subscription3","CachedSubscription","_cacheKey","restore"],"mappings":"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","file":"ringcentral.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_7__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_7__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/build/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n__webpack_require__(2);\n\nvar _Utils = __webpack_require__(3);\n\nvar Utils = _interopRequireWildcard(_Utils);\n\nvar _Cache = __webpack_require__(11);\n\nvar _Cache2 = _interopRequireDefault(_Cache);\n\nvar _Externals = __webpack_require__(4);\n\nvar Externals = _interopRequireWildcard(_Externals);\n\nvar _events = __webpack_require__(12);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _Client = __webpack_require__(13);\n\nvar _Client2 = _interopRequireDefault(_Client);\n\nvar _ApiResponse = __webpack_require__(14);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nvar _ClientMock = __webpack_require__(15);\n\nvar _ClientMock2 = _interopRequireDefault(_ClientMock);\n\nvar _Mock = __webpack_require__(17);\n\nvar _Mock2 = _interopRequireDefault(_Mock);\n\nvar _Registry = __webpack_require__(16);\n\nvar _Registry2 = _interopRequireDefault(_Registry);\n\nvar _Platform = __webpack_require__(18);\n\nvar _Platform2 = _interopRequireDefault(_Platform);\n\nvar _Auth = __webpack_require__(19);\n\nvar _Auth2 = _interopRequireDefault(_Auth);\n\nvar _PubnubFactory = __webpack_require__(21);\n\nvar _PubnubFactory2 = _interopRequireDefault(_PubnubFactory);\n\nvar _Subscription = __webpack_require__(23);\n\nvar _Subscription2 = _interopRequireDefault(_Subscription);\n\nvar _CachedSubscription = __webpack_require__(24);\n\nvar _CachedSubscription2 = _interopRequireDefault(_CachedSubscription);\n\nvar _Constants = __webpack_require__(20);\n\nvar _Constants2 = _interopRequireDefault(_Constants);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SDK = function () {\n\n    /**\n     * @namespace RingCentral\n     * @constructor\n     * @param {object} [options]\n     * @param {string} [options.server]\n     * @param {string} [options.cachePrefix]\n     * @param {string} [options.appSecret]\n     * @param {string} [options.appKey]\n     * @param {string} [options.appName]\n     * @param {string} [options.appVersion]\n     * @param {string} [options.pubnubFactory]\n     * @param {string} [options.client]\n     * @param {string} [options.redirectUri]\n     */\n\n    function SDK(_ref) {\n        var server = _ref.server;\n        var cachePrefix = _ref.cachePrefix;\n        var appSecret = _ref.appSecret;\n        var appKey = _ref.appKey;\n        var appName = _ref.appName;\n        var appVersion = _ref.appVersion;\n        var pubnubFactory = _ref.pubnubFactory;\n        var client = _ref.client;\n        var redirectUri = _ref.redirectUri;\n\n        _classCallCheck(this, SDK);\n\n        if (!Externals.fetch) {\n            throw new Error('Native Fetch is missing, set RingCentral.SDK.core.Externals.fetch to your favorite alternative');\n        }\n\n        if (!Externals.Promise) {\n            throw new Error('Native Promise is missing, set RingCentral.SDK.core.Externals.Promise to your favorite alternative');\n        }\n\n        this._cache = new _Cache2.default(Externals.localStorage, cachePrefix);\n\n        this._client = client || new _Client2.default();\n\n        this._platform = new _Platform2.default({\n            client: this._client,\n            cache: this._cache,\n            version: SDK.version,\n            server: server,\n            appKey: appKey,\n            appSecret: appSecret,\n            appName: appName,\n            appVersion: appVersion,\n            redirectUri: redirectUri\n        });\n\n        this._pubnubFactory = pubnubFactory || Externals.PUBNUB;\n    }\n\n    /**\n     * @return {Platform}\n     */\n\n\n    SDK.prototype.platform = function platform() {\n        return this._platform;\n    };\n\n    /**\n     * @return {Subscription}\n     */\n\n\n    SDK.prototype.createSubscription = function createSubscription() {\n        return new _Subscription2.default(this._pubnubFactory, this._platform);\n    };\n\n    /**\n     * @return {CachedSubscription}\n     */\n\n\n    SDK.prototype.createCachedSubscription = function createCachedSubscription(cacheKey) {\n        return new _CachedSubscription2.default(this._pubnubFactory, this._platform, this._cache, cacheKey);\n    };\n\n    /**\n     * @return {Cache}\n     */\n\n\n    SDK.prototype.cache = function cache() {\n        return this._cache;\n    };\n\n    SDK.handleLoginRedirect = function handleLoginRedirect(origin) {\n        var _window$opener$postMe;\n\n        var response = window.location.hash ? window.location.hash : window.location.search;\n        window.opener.postMessage((_window$opener$postMe = {}, _window$opener$postMe[_Constants2.default.authResponseProperty] = response, _window$opener$postMe), origin || window.location.origin);\n    };\n\n    return SDK;\n}();\n\nSDK.version = _Constants2.default.version;\nSDK.server = {\n    sandbox: 'https://platform.devtest.ringcentral.com',\n    production: 'https://platform.ringcentral.com'\n};\nSDK.core = {\n    Cache: _Cache2.default,\n    EventEmitter: _events2.default,\n    Utils: Utils,\n    Externals: Externals\n};\nSDK.http = {\n    Client: _Client2.default,\n    ApiResponse: _ApiResponse2.default\n};\nSDK.platform = {\n    Auth: _Auth2.default,\n    Platform: _Platform2.default\n};\nSDK.subscription = {\n    Subscription: _Subscription2.default\n};\nSDK.mocks = {\n    Client: _ClientMock2.default,\n    Registry: _Registry2.default,\n    Mock: _Mock2.default\n};\nSDK.pubnub = {\n    PubnubMockFactory: _PubnubFactory2.default\n};\n\n\nmodule.exports = SDK;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          context._sent = arg;\n\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nexports.queryStringify = queryStringify;\nexports.parseQueryString = parseQueryString;\nexports.isFunction = isFunction;\nexports.isArray = isArray;\nexports.isObject = isObject;\nexports.isObjectObject = isObjectObject;\nexports.isPlainObject = isPlainObject;\nexports.isNodeJS = isNodeJS;\nexports.isBrowser = isBrowser;\nexports.delay = delay;\n\nvar _Externals = __webpack_require__(4);\n\nvar _querystring = __webpack_require__(8);\n\nvar _querystring2 = _interopRequireDefault(_querystring);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * @param {object} parameters\n * @returns {string}\n */\nfunction queryStringify(parameters) {\n    return _querystring2.default.stringify(parameters);\n}\n\n/**\n * @param {string} queryString\n * @returns {object}\n */\nfunction parseQueryString(queryString) {\n    return _querystring2.default.parse(queryString);\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nfunction isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nfunction isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\nfunction isObject(o) {\n    return o != null && (typeof o === \"undefined\" ? \"undefined\" : _typeof(o)) === 'object' && !isArray(o);\n}\n\nfunction isObjectObject(o) {\n    return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n    var ctor, prot;\n\n    if (isObjectObject(o) === false) return false;\n\n    // If has modified constructor\n    ctor = o.constructor;\n    if (typeof ctor !== 'function') return false;\n\n    // If has modified prototype\n    prot = ctor.prototype;\n    if (isObjectObject(prot) === false) return false;\n\n    // If constructor does not have an Object-specific method\n    if (prot.hasOwnProperty('isPrototypeOf') === false) {\n        return false;\n    }\n\n    // Most likely a plain Object\n    return true;\n}\n\nfunction isNodeJS() {\n    return typeof process !== 'undefined';\n}\n\nfunction isBrowser() {\n    return typeof window !== 'undefined';\n}\n\nfunction delay(timeout) {\n    return new _Externals.Promise(function (resolve, reject) {\n        setTimeout(function () {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\nexports.__esModule = true;\nexports.localStorage = exports.PUBNUB = exports.Headers = exports.Response = exports.Request = exports.fetch = exports.Promise = undefined;\n\nvar _es6Promise = __webpack_require__(5);\n\nvar _es6Promise2 = _interopRequireDefault(_es6Promise);\n\nvar _nodeFetch = __webpack_require__(6);\n\nvar _nodeFetch2 = _interopRequireDefault(_nodeFetch);\n\nvar _pubnub = __webpack_require__(7);\n\nvar _pubnub2 = _interopRequireDefault(_pubnub);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar root = typeof window !== \"undefined\" && window || typeof global !== \"undefined\" && global || Function(\"return this;\")();\n\nvar Promise = _es6Promise2.default && _es6Promise2.default.Promise || root.Promise;\n\nvar fetch = _nodeFetch2.default && typeof _nodeFetch2.default == 'function' ? _nodeFetch2.default : root.fetch;\nvar Request = fetch.Request || root.Request;\nvar Response = fetch.Response || root.Response;\nvar Headers = fetch.Headers || root.Headers;\n\nvar PUBNUB = _pubnub2.default || root.PUBNUB;\n\nvar localStorage = typeof root.localStorage !== 'undefined' ? root.localStorage : {};\n\nexports.Promise = Promise;\nexports.fetch = fetch;\nexports.Request = Request;\nexports.Response = Response;\nexports.Headers = Headers;\nexports.PUBNUB = PUBNUB;\nexports.localStorage = localStorage;\n/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.decode = exports.parse = __webpack_require__(9);\nexports.encode = exports.stringify = __webpack_require__(10);\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (Array.isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return Object.keys(obj).map(function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (Array.isArray(obj[k])) {\n        return obj[k].map(function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Cache = function () {\n    function Cache(storage, prefix) {\n        _classCallCheck(this, Cache);\n\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    Cache.prototype.setPrefix = function setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    };\n\n    Cache.prototype.setItem = function setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    };\n\n    Cache.prototype.removeItem = function removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    };\n\n    Cache.prototype.getItem = function getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    };\n\n    Cache.prototype.clean = function clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n        }\n\n        return this;\n    };\n\n    Cache.prototype._prefixKey = function _prefixKey(key) {\n        return this._prefix + key;\n    };\n\n    return Cache;\n}();\n\nCache.defaultPrefix = 'rc-';\nexports.default = Cache;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nexports.__esModule = true;\nexports.findHeaderName = findHeaderName;\n\nvar _Externals = __webpack_require__(4);\n\nvar _Utils = __webpack_require__(3);\n\nvar _events = __webpack_require__(12);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _ApiResponse = __webpack_require__(14);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Client = function (_EventEmitter) {\n    _inherits(Client, _EventEmitter);\n\n    function Client() {\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, Client);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, _EventEmitter.call.apply(_EventEmitter, [this].concat(args))), _this), _this.events = {\n            beforeRequest: 'beforeRequest',\n            requestSuccess: 'requestSuccess',\n            requestError: 'requestError'\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n\n    Client.prototype.sendRequest = function () {\n        var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(request) {\n            var apiResponse;\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            apiResponse = new _ApiResponse2.default(request);\n                            _context.prev = 1;\n\n\n                            //TODO Stop request if listeners return false\n                            this.emit(this.events.beforeRequest, apiResponse);\n\n                            _context.next = 5;\n                            return this._loadResponse(request);\n\n                        case 5:\n                            apiResponse._response = _context.sent;\n                            _context.next = 8;\n                            return apiResponse._init();\n\n                        case 8:\n                            if (apiResponse.ok()) {\n                                _context.next = 10;\n                                break;\n                            }\n\n                            throw new Error('Response has unsuccessful status');\n\n                        case 10:\n\n                            this.emit(this.events.requestSuccess, apiResponse);\n\n                            return _context.abrupt(\"return\", apiResponse);\n\n                        case 14:\n                            _context.prev = 14;\n                            _context.t0 = _context[\"catch\"](1);\n\n\n                            if (!_context.t0.apiResponse) _context.t0 = this.makeError(_context.t0, apiResponse);\n\n                            this.emit(this.events.requestError, _context.t0);\n\n                            throw _context.t0;\n\n                        case 19:\n                        case \"end\":\n                            return _context.stop();\n                    }\n                }\n            }, _callee, this, [[1, 14]]);\n        }));\n\n        function sendRequest(_x) {\n            return _ref.apply(this, arguments);\n        }\n\n        return sendRequest;\n    }();\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n\n\n    Client.prototype._loadResponse = function () {\n        var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(request) {\n            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                    switch (_context2.prev = _context2.next) {\n                        case 0:\n                            _context2.next = 2;\n                            return _Externals.fetch.call(null, request);\n\n                        case 2:\n                            return _context2.abrupt(\"return\", _context2.sent);\n\n                        case 3:\n                        case \"end\":\n                            return _context2.stop();\n                    }\n                }\n            }, _callee2, this);\n        }));\n\n        function _loadResponse(_x2) {\n            return _ref2.apply(this, arguments);\n        }\n\n        return _loadResponse;\n    }();\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n\n\n    Client.prototype.makeError = function makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = apiResponse && apiResponse.error(true) || e.originalMessage;\n        }\n\n        return e;\n    };\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n\n\n    Client.prototype.createRequest = function createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        init.method = init.method.toUpperCase();\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) {\n            throw new Error('Method has wrong value: ' + init.method);\n        }\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + (0, _Utils.queryStringify)(init.query);\n        }\n\n        if (!findHeaderName('Accept', init.headers)) {\n            init.headers['Accept'] = _ApiResponse2.default._jsonContentType;\n        }\n\n        // Serialize body\n        if ((0, _Utils.isPlainObject)(init.body) || !init.body) {\n\n            var contentTypeHeaderName = findHeaderName(_ApiResponse2.default._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = _ApiResponse2.default._contentType;\n                init.headers[contentTypeHeaderName] = _ApiResponse2.default._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(_ApiResponse2.default._jsonContentType) > -1) {\n                if ((init.method === 'GET' || init.method === 'HEAD') && !!init.body) {\n                    // oddly setting body to null still result in TypeError in phantomjs\n                    init.body = undefined;\n                } else {\n                    init.body = JSON.stringify(init.body);\n                }\n            } else if (contentType.indexOf(_ApiResponse2.default._urlencodedContentType) > -1) {\n                init.body = (0, _Utils.queryStringify)(init.body);\n            }\n        }\n\n        // Create a request with encoded body\n        var req = new _Externals.Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n    };\n\n    return Client;\n}(_events2.default);\n\nClient._allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'];\nexports.default = Client;\nfunction findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function (res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n/**\n * @name IApiError\n * @property {string} stack\n * @property {string} originalMessage\n * @property {ApiResponse} apiResponse\n */\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _Externals = __webpack_require__(4);\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _Externals.Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _Externals.Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ApiResponse = function () {\n\n    /**\n     * @param {Request} request\n     * @param {Response} response\n     * @param {string} responseText\n     */\n\n    function ApiResponse(request, response, responseText) {\n        _classCallCheck(this, ApiResponse);\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n    }\n\n    ApiResponse.prototype._init = function () {\n        var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            if (!(this._isMultipart() || this._isJson())) {\n                                _context.next = 4;\n                                break;\n                            }\n\n                            _context.next = 3;\n                            return this.response().text();\n\n                        case 3:\n                            this._text = _context.sent;\n\n                        case 4:\n                            return _context.abrupt('return', this);\n\n                        case 5:\n                        case 'end':\n                            return _context.stop();\n                    }\n                }\n            }, _callee, this);\n        }));\n\n        function _init() {\n            return _ref.apply(this, arguments);\n        }\n\n        return _init;\n    }();\n\n    /**\n     * @return {Response}\n     */\n\n\n    ApiResponse.prototype.response = function response() {\n        return this._response;\n    };\n\n    /**\n     * @return {Request}\n     */\n\n\n    ApiResponse.prototype.request = function request() {\n        return this._request;\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n\n    ApiResponse.prototype.ok = function ok() {\n        return this._response && this._response.ok;\n    };\n\n    /**\n     * @return {string}\n     */\n\n\n    ApiResponse.prototype.text = function text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    };\n\n    /**\n     * @return {object}\n     */\n\n\n    ApiResponse.prototype.json = function json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    };\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n\n\n    ApiResponse.prototype.error = function error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') + (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n        } catch (e) {}\n\n        return message;\n    };\n\n    /**\n     * @return {ApiResponse[]}\n     */\n\n\n    ApiResponse.prototype.multipart = function multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map(function (part, i) {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n            });\n        }\n\n        return this._multipart;\n    };\n\n    ApiResponse.prototype._isContentType = function _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    };\n\n    ApiResponse.prototype._getContentType = function _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    };\n\n    ApiResponse.prototype._isMultipart = function _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    };\n\n    ApiResponse.prototype._isUrlEncoded = function _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    };\n\n    ApiResponse.prototype._isJson = function _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    };\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n\n\n    ApiResponse.create = function create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new _Externals.Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = headersAndBody.length > 1 ? headersAndBody.shift() : '';\n\n        text = headersAndBody.length > 0 ? headersAndBody.join(ApiResponse._bodySeparator) : null;\n\n        (headersText || '').split('\\n').forEach(function (header) {\n\n            var split = header.trim().split(ApiResponse._headerSeparator),\n                key = split.shift().trim(),\n                value = split.join(ApiResponse._headerSeparator).trim();\n\n            if (key) headers.append(key, value);\n        });\n\n        return new ApiResponse(null, new _Externals.Response(text ? text : undefined, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n    };\n\n    return ApiResponse;\n}();\n\nApiResponse._contentType = 'Content-Type';\nApiResponse._jsonContentType = 'application/json';\nApiResponse._multipartContentType = 'multipart/mixed';\nApiResponse._urlencodedContentType = 'application/x-www-form-urlencoded';\nApiResponse._headerSeparator = ':';\nApiResponse._bodySeparator = '\\n\\n';\nApiResponse._boundarySeparator = '--';\nexports.default = ApiResponse;\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _Registry = __webpack_require__(16);\n\nvar _Registry2 = _interopRequireDefault(_Registry);\n\nvar _Client = __webpack_require__(13);\n\nvar _Client2 = _interopRequireDefault(_Client);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Client = function (_HttpClient) {\n    _inherits(Client, _HttpClient);\n\n    function Client() {\n        _classCallCheck(this, Client);\n\n        var _this = _possibleConstructorReturn(this, _HttpClient.call(this));\n\n        _this._registry = new _Registry2.default();\n        return _this;\n    }\n\n    Client.prototype.registry = function registry() {\n        return this._registry;\n    };\n\n    Client.prototype._loadResponse = function () {\n        var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(request) {\n            var mock;\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            mock = this._registry.find(request);\n                            _context.next = 3;\n                            return mock.getResponse(request);\n\n                        case 3:\n                            return _context.abrupt('return', _context.sent);\n\n                        case 4:\n                        case 'end':\n                            return _context.stop();\n                    }\n                }\n            }, _callee, this);\n        }));\n\n        function _loadResponse(_x) {\n            return _ref.apply(this, arguments);\n        }\n\n        return _loadResponse;\n    }();\n\n    return Client;\n}(_Client2.default);\n\nexports.default = Client;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _Mock = __webpack_require__(17);\n\nvar _Mock2 = _interopRequireDefault(_Mock);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Registry = function () {\n    function Registry() {\n        _classCallCheck(this, Registry);\n\n        this._mocks = [];\n    }\n\n    Registry.prototype.add = function add(mock) {\n        this._mocks.push(mock);\n        return this;\n    };\n\n    Registry.prototype.clear = function clear() {\n        this._mocks = [];\n        return this;\n    };\n\n    Registry.prototype.find = function find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url + ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n    };\n\n    Registry.prototype.apiCall = function apiCall(method, path, response, status, statusText, delay) {\n\n        this.add(new _Mock2.default(method, path, response, status, statusText, delay));\n\n        return this;\n    };\n\n    Registry.prototype.authentication = function authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n    };\n\n    Registry.prototype.logout = function logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n    };\n\n    Registry.prototype.presenceLoad = function presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n    };\n\n    Registry.prototype.subscribeGeneric = function subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/~/presence'],\n            'expirationTime': new Date(date.getTime() + expiresIn * 1000).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n    };\n\n    Registry.prototype.subscribeOnPresence = function subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + 15 * 60 * 60 * 1000).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n    };\n\n    Registry.prototype.tokenRefresh = function tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n        }\n\n        return this;\n    };\n\n    return Registry;\n}();\n\nexports.default = Registry;\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _Externals = __webpack_require__(4);\n\nvar _ApiResponse = __webpack_require__(14);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nvar _Utils = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _Externals.Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _Externals.Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Mock = function () {\n    function Mock(method, path, json, status, statusText, delay) {\n        _classCallCheck(this, Mock);\n\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    Mock.prototype.path = function path() {\n        return this._path;\n    };\n\n    Mock.prototype.method = function method() {\n        return this._method;\n    };\n\n    Mock.prototype.test = function test(request) {\n\n        return request.url.indexOf(this._path) > -1 && request.method.toUpperCase() == this._method;\n    };\n\n    Mock.prototype.getResponse = function () {\n        var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(request) {\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            _context.next = 2;\n                            return (0, _Utils.delay)(this._delay);\n\n                        case 2:\n                            return _context.abrupt('return', this.createResponse(this._json));\n\n                        case 3:\n                        case 'end':\n                            return _context.stop();\n                    }\n                }\n            }, _callee, this);\n        }));\n\n        function getResponse(_x) {\n            return _ref.apply(this, arguments);\n        }\n\n        return getResponse;\n    }();\n\n    Mock.prototype.createResponse = function createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = new _Externals.Response(str, init);\n\n        res.headers.set(_ApiResponse2.default._contentType, _ApiResponse2.default._jsonContentType);\n\n        return res;\n    };\n\n    return Mock;\n}();\n\nexports.default = Mock;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nexports.__esModule = true;\n\nvar _Externals = __webpack_require__(4);\n\nvar _events = __webpack_require__(12);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _Auth = __webpack_require__(19);\n\nvar _Auth2 = _interopRequireDefault(_Auth);\n\nvar _Utils = __webpack_require__(3);\n\nvar _Constants = __webpack_require__(20);\n\nvar _Constants2 = _interopRequireDefault(_Constants);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _Externals.Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _Externals.Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Platform = function (_EventEmitter) {\n    _inherits(Platform, _EventEmitter);\n\n    function Platform(_ref) {\n        var client = _ref.client;\n        var cache = _ref.cache;\n        var server = _ref.server;\n        var appKey = _ref.appKey;\n        var appSecret = _ref.appSecret;\n        var appName = _ref.appName;\n        var appVersion = _ref.appVersion;\n        var sdkVersion = _ref.sdkVersion;\n        var redirectUri = _ref.redirectUri;\n\n        _classCallCheck(this, Platform);\n\n        var _this = _possibleConstructorReturn(this, _EventEmitter.call(this));\n\n        _this.events = {\n            beforeLogin: 'beforeLogin',\n            loginSuccess: 'loginSuccess',\n            loginError: 'loginError',\n            beforeRefresh: 'beforeRefresh',\n            refreshSuccess: 'refreshSuccess',\n            refreshError: 'refreshError',\n            beforeLogout: 'beforeLogout',\n            logoutSuccess: 'logoutSuccess',\n            logoutError: 'logoutError'\n        };\n\n\n        _this._server = server;\n        _this._appKey = appKey;\n        _this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        _this._cache = cache;\n\n        /** @type {Client} */\n        _this._client = client;\n\n        /** @type {Promise<ApiResponse>} */\n        _this._refreshPromise = null;\n\n        _this._auth = new _Auth2.default(_this._cache, Platform._cacheId);\n\n        _this._userAgent = (appName ? appName + (appVersion ? '/' + appVersion : '') + ' ' : '') + 'RCJSSDK/' + sdkVersion;\n\n        _this._redirectUri = redirectUri || '';\n\n        return _this;\n    }\n\n    /**\n     * @return {Auth}\n     */\n\n\n    Platform.prototype.auth = function auth() {\n        return this._auth;\n    };\n\n    /**\n     * @return {Client}\n     */\n\n\n    Platform.prototype.client = function client() {\n        return this._client;\n    };\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n\n\n    Platform.prototype.createUrl = function createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += path.indexOf('?') > -1 ? '&' : '?';\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n    };\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @param {boolean} options.implicit\n     * @param {object} [options]\n     * @return {string}\n     */\n\n\n    Platform.prototype.loginUrl = function loginUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + (0, _Utils.queryStringify)({\n            'response_type': options.implicit ? 'token' : 'code',\n            'redirect_uri': options.redirectUri || this._redirectUri,\n            'client_id': this._appKey,\n            'state': options.state || '',\n            'brand_id': options.brandId || '',\n            'display': options.display || '',\n            'prompt': options.prompt || ''\n        }), { addServer: true });\n    };\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n\n\n    Platform.prototype.parseLoginRedirect = function parseLoginRedirect(url) {\n\n        function getParts(url, separator) {\n            return url.split(separator).reverse()[0];\n        }\n\n        var response = url.indexOf('#') === 0 && getParts(url, '#') || url.indexOf('?') === 0 && getParts(url, '?') || null;\n\n        if (!response) throw new Error('Unable to parse response');\n\n        var qs = (0, _Utils.parseQueryString)(response);\n\n        if (!qs) throw new Error('Unable to parse response');\n\n        var error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n    };\n\n    /**\n     * Convenience method to handle 3-legged OAuth\n     *\n     * Attention! This is an experimental method and it's signature and behavior may change without notice.\n     *\n     * @experimental\n     * @param {number} [options.width]\n     * @param {number} [options.height]\n     * @param {object} [options.login] additional options for login()\n     * @param {string} [options.origin]\n     * @param {string} [options.property] name of window.postMessage's event data property\n     * @param {string} [options.target] target for window.open()\n     * @param {string} options.url\n     * @return {Promise}\n     */\n\n\n    Platform.prototype.loginWindow = function loginWindow(options) {\n        var _this2 = this;\n\n        return new _Externals.Promise(function (resolve, reject) {\n\n            if (!(0, _Utils.isBrowser)()) throw new Error('This method can be used only in browser');\n\n            if (!options.url) throw new Error('Missing mandatory URL parameter');\n\n            options = options || {};\n            options.url = options.url || 400;\n            options.width = options.width || 400;\n            options.height = options.height || 600;\n            options.origin = options.origin || window.location.origin;\n            options.property = options.property || _Constants2.default.authResponseProperty;\n            options.target = options.target || '_blank';\n\n            var dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : screen.left;\n            var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;\n\n            var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\n            var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\n\n            var left = width / 2 - options.width / 2 + dualScreenLeft;\n            var top = height / 2 - options.height / 2 + dualScreenTop;\n            var win = window.open(options.url, '_blank', options.target == '_blank' ? 'scrollbars=yes, status=yes, width=' + options.width + ', height=' + options.height + ', left=' + left + ', top=' + top : '');\n\n            if (window.focus) win.focus();\n\n            var eventMethod = window.addEventListener ? 'addEventListener' : 'attachEvent';\n            var eventRemoveMethod = eventMethod == 'addEventListener' ? 'removeEventListener' : 'detachEvent';\n            var messageEvent = eventMethod == 'addEventListener' ? 'message' : 'onmessage';\n\n            var eventListener = function eventListener(e) {\n\n                if (e.origin != options.origin) return;\n                if (!e.data || !e.data[options.property]) return; // keep waiting\n\n                win.close();\n                window[eventRemoveMethod](messageEvent, eventListener);\n\n                try {\n\n                    var loginOptions = _this2.parseLoginRedirect(e.data[options.property]);\n\n                    if (!loginOptions.code && !loginOptions.access_token) throw new Error('No authorization code or token');\n\n                    resolve(loginOptions);\n                } catch (e) {\n                    reject(e);\n                }\n            };\n\n            window[eventMethod](messageEvent, eventListener, false);\n        });\n    };\n\n    /**\n     * @return {Promise<boolean>}\n     */\n\n\n    Platform.prototype.loggedIn = function () {\n        var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            _context.prev = 0;\n                            _context.next = 3;\n                            return this.ensureLoggedIn();\n\n                        case 3:\n                            return _context.abrupt(\"return\", true);\n\n                        case 6:\n                            _context.prev = 6;\n                            _context.t0 = _context[\"catch\"](0);\n                            return _context.abrupt(\"return\", false);\n\n                        case 9:\n                        case \"end\":\n                            return _context.stop();\n                    }\n                }\n            }, _callee, this, [[0, 6]]);\n        }));\n\n        function loggedIn() {\n            return _ref2.apply(this, arguments);\n        }\n\n        return loggedIn;\n    }();\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @param {string} options.remember\n     * @param {string} options.accessTokenTtl\n     * @param {string} options.refreshTokenTtl\n     * @param {string} options.access_token\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.login = function () {\n        var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(options) {\n            var body, apiResponse, json;\n            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                    switch (_context2.prev = _context2.next) {\n                        case 0:\n                            _context2.prev = 0;\n\n\n                            options = options || {};\n\n                            this.emit(this.events.beforeLogin);\n\n                            body = {};\n\n\n                            if (!options.code) {\n\n                                body.grant_type = 'password';\n                                body.username = options.username;\n                                body.password = options.password;\n                                body.extension = options.extension || '';\n                            } else if (options.code) {\n\n                                body.grant_type = 'authorization_code';\n                                body.code = options.code;\n                                body.redirect_uri = options.redirectUri || this._redirectUri;\n                                //body.client_id = this.getCredentials().key; // not needed\n                            }\n\n                            if (!options.access_token) {\n                                _context2.next = 9;\n                                break;\n                            }\n\n                            //TODO Potentially make a request to /oauth/tokeninfo\n                            json = options;\n\n                            _context2.next = 16;\n                            break;\n\n                        case 9:\n\n                            if (options.endpointId) body.endpoint_id = options.endpointId;\n                            if (options.accessTokenTtl) body.accessTokenTtl = options.accessTokenTtl;\n                            if (options.refreshTokenTtl) body.refreshTokenTtl = options.refreshTokenTtl;\n\n                            _context2.next = 14;\n                            return this._tokenRequest(Platform._tokenEndpoint, body);\n\n                        case 14:\n                            apiResponse = _context2.sent;\n\n                            json = apiResponse.json();\n\n                        case 16:\n\n                            this._auth.setData(json);\n\n                            this.emit(this.events.loginSuccess, apiResponse);\n\n                            return _context2.abrupt(\"return\", apiResponse);\n\n                        case 21:\n                            _context2.prev = 21;\n                            _context2.t0 = _context2[\"catch\"](0);\n\n\n                            this._cache.clean();\n\n                            this.emit(this.events.loginError, _context2.t0);\n\n                            throw _context2.t0;\n\n                        case 26:\n                        case \"end\":\n                            return _context2.stop();\n                    }\n                }\n            }, _callee2, this, [[0, 21]]);\n        }));\n\n        function login(_x) {\n            return _ref3.apply(this, arguments);\n        }\n\n        return login;\n    }();\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     * @private\n     */\n\n\n    Platform.prototype._refresh = function () {\n        var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n            var res, json;\n            return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                while (1) {\n                    switch (_context3.prev = _context3.next) {\n                        case 0:\n                            _context3.prev = 0;\n\n\n                            this.emit(this.events.beforeRefresh);\n\n                            _context3.next = 4;\n                            return (0, _Utils.delay)(Platform._refreshDelayMs);\n\n                        case 4:\n                            if (this._auth.refreshToken()) {\n                                _context3.next = 6;\n                                break;\n                            }\n\n                            throw new Error('Refresh token is missing');\n\n                        case 6:\n                            if (this._auth.refreshTokenValid()) {\n                                _context3.next = 8;\n                                break;\n                            }\n\n                            throw new Error('Refresh token has expired');\n\n                        case 8:\n                            _context3.next = 10;\n                            return this._tokenRequest(Platform._tokenEndpoint, {\n                                \"grant_type\": \"refresh_token\",\n                                \"refresh_token\": this._auth.refreshToken(),\n                                \"access_token_ttl\": this._auth.data().expires_in + 1,\n                                \"refresh_token_ttl\": this._auth.data().refresh_token_expires_in + 1\n                            });\n\n                        case 10:\n                            res = _context3.sent;\n                            json = res.json();\n\n                            if (json.access_token) {\n                                _context3.next = 14;\n                                break;\n                            }\n\n                            throw this._client.makeError(new Error('Malformed OAuth response'), res);\n\n                        case 14:\n\n                            this._auth.setData(json);\n\n                            this.emit(this.events.refreshSuccess, res);\n\n                            return _context3.abrupt(\"return\", res);\n\n                        case 19:\n                            _context3.prev = 19;\n                            _context3.t0 = _context3[\"catch\"](0);\n\n\n                            _context3.t0 = this._client.makeError(_context3.t0);\n\n                            if (Platform._clearCacheOnRefreshError) {\n                                this._cache.clean();\n                            }\n\n                            this.emit(this.events.refreshError, _context3.t0);\n\n                            throw _context3.t0;\n\n                        case 25:\n                        case \"end\":\n                            return _context3.stop();\n                    }\n                }\n            }, _callee3, this, [[0, 19]]);\n        }));\n\n        function _refresh() {\n            return _ref4.apply(this, arguments);\n        }\n\n        return _refresh;\n    }();\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.refresh = function () {\n        var _ref5 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n            var _this3 = this;\n\n            return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                while (1) {\n                    switch (_context4.prev = _context4.next) {\n                        case 0:\n                            if (!this._refreshPromise) {\n                                _context4.next = 2;\n                                break;\n                            }\n\n                            return _context4.abrupt(\"return\", this._refreshPromise);\n\n                        case 2:\n                            _context4.prev = 2;\n\n\n                            this._refreshPromise = this._refresh().then(function (res) {\n                                _this3._refreshPromise = null;\n                                return res;\n                            });\n\n                            return _context4.abrupt(\"return\", this._refreshPromise);\n\n                        case 7:\n                            _context4.prev = 7;\n                            _context4.t0 = _context4[\"catch\"](2);\n\n\n                            this._refreshPromise = null;\n                            throw _context4.t0;\n\n                        case 11:\n                        case \"end\":\n                            return _context4.stop();\n                    }\n                }\n            }, _callee4, this, [[2, 7]]);\n        }));\n\n        function refresh() {\n            return _ref5.apply(this, arguments);\n        }\n\n        return refresh;\n    }();\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.logout = function () {\n        var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee5() {\n            var res;\n            return regeneratorRuntime.wrap(function _callee5$(_context5) {\n                while (1) {\n                    switch (_context5.prev = _context5.next) {\n                        case 0:\n                            _context5.prev = 0;\n\n\n                            this.emit(this.events.beforeLogout);\n\n                            _context5.next = 4;\n                            return this._tokenRequest(Platform._revokeEndpoint, {\n                                token: this._auth.accessToken()\n                            });\n\n                        case 4:\n                            res = _context5.sent;\n\n\n                            this._cache.clean();\n\n                            this.emit(this.events.logoutSuccess, res);\n\n                            return _context5.abrupt(\"return\", res);\n\n                        case 10:\n                            _context5.prev = 10;\n                            _context5.t0 = _context5[\"catch\"](0);\n\n\n                            this.emit(this.events.logoutError, _context5.t0);\n\n                            throw _context5.t0;\n\n                        case 14:\n                        case \"end\":\n                            return _context5.stop();\n                    }\n                }\n            }, _callee5, this, [[0, 10]]);\n        }));\n\n        function logout() {\n            return _ref6.apply(this, arguments);\n        }\n\n        return logout;\n    }();\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n\n\n    Platform.prototype.inflateRequest = function () {\n        var _ref7 = _asyncToGenerator(regeneratorRuntime.mark(function _callee6(request, options) {\n            return regeneratorRuntime.wrap(function _callee6$(_context6) {\n                while (1) {\n                    switch (_context6.prev = _context6.next) {\n                        case 0:\n\n                            options = options || {};\n\n                            if (!options.skipAuthCheck) {\n                                _context6.next = 3;\n                                break;\n                            }\n\n                            return _context6.abrupt(\"return\", request);\n\n                        case 3:\n                            _context6.next = 5;\n                            return this.ensureLoggedIn();\n\n                        case 5:\n\n                            request.headers.set('X-User-Agent', this._userAgent);\n                            request.headers.set('Client-Id', this._appKey);\n                            request.headers.set('Authorization', this._authHeader());\n                            //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n                            return _context6.abrupt(\"return\", request);\n\n                        case 9:\n                        case \"end\":\n                            return _context6.stop();\n                    }\n                }\n            }, _callee6, this);\n        }));\n\n        function inflateRequest(_x2, _x3) {\n            return _ref7.apply(this, arguments);\n        }\n\n        return inflateRequest;\n    }();\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.sendRequest = function () {\n        var _ref8 = _asyncToGenerator(regeneratorRuntime.mark(function _callee7(request, options) {\n            return regeneratorRuntime.wrap(function _callee7$(_context7) {\n                while (1) {\n                    switch (_context7.prev = _context7.next) {\n                        case 0:\n                            _context7.prev = 0;\n                            _context7.next = 3;\n                            return this.inflateRequest(request, options);\n\n                        case 3:\n                            request = _context7.sent;\n                            _context7.next = 6;\n                            return this._client.sendRequest(request);\n\n                        case 6:\n                            return _context7.abrupt(\"return\", _context7.sent);\n\n                        case 9:\n                            _context7.prev = 9;\n                            _context7.t0 = _context7[\"catch\"](0);\n\n                            if (!(!_context7.t0.apiResponse || !_context7.t0.apiResponse.response() || _context7.t0.apiResponse.response().status != 401 || options.retry)) {\n                                _context7.next = 13;\n                                break;\n                            }\n\n                            throw _context7.t0;\n\n                        case 13:\n\n                            this._auth.cancelAccessToken();\n\n                            options.retry = true;\n\n                            _context7.next = 17;\n                            return this.sendRequest(request, options);\n\n                        case 17:\n                            return _context7.abrupt(\"return\", _context7.sent);\n\n                        case 18:\n                        case \"end\":\n                            return _context7.stop();\n                    }\n                }\n            }, _callee7, this, [[0, 9]]);\n        }));\n\n        function sendRequest(_x4, _x5) {\n            return _ref8.apply(this, arguments);\n        }\n\n        return sendRequest;\n    }();\n\n    /**\n     * General purpose function to send anything to server\n     * @param {string} options.url\n     * @param {object} [options.body]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.send = function () {\n        var _ref9 = _asyncToGenerator(regeneratorRuntime.mark(function _callee8() {\n            var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n            return regeneratorRuntime.wrap(function _callee8$(_context8) {\n                while (1) {\n                    switch (_context8.prev = _context8.next) {\n                        case 0:\n\n                            //FIXME https://github.com/bitinn/node-fetch/issues/43\n                            options.url = this.createUrl(options.url, { addServer: true });\n\n                            _context8.next = 3;\n                            return this.sendRequest(this._client.createRequest(options), options);\n\n                        case 3:\n                            return _context8.abrupt(\"return\", _context8.sent);\n\n                        case 4:\n                        case \"end\":\n                            return _context8.stop();\n                    }\n                }\n            }, _callee8, this);\n        }));\n\n        function send(_x6) {\n            return _ref9.apply(this, arguments);\n        }\n\n        return send;\n    }();\n\n    /**\n     * @param {string} url\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.get = function () {\n        var _ref10 = _asyncToGenerator(regeneratorRuntime.mark(function _callee9(url, query, options) {\n            return regeneratorRuntime.wrap(function _callee9$(_context9) {\n                while (1) {\n                    switch (_context9.prev = _context9.next) {\n                        case 0:\n                            options = options || {};\n                            options.method = 'GET';\n                            options.url = url;\n                            options.query = query;\n                            _context9.next = 6;\n                            return this.send(options);\n\n                        case 6:\n                            return _context9.abrupt(\"return\", _context9.sent);\n\n                        case 7:\n                        case \"end\":\n                            return _context9.stop();\n                    }\n                }\n            }, _callee9, this);\n        }));\n\n        function get(_x8, _x9, _x10) {\n            return _ref10.apply(this, arguments);\n        }\n\n        return get;\n    }();\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.post = function () {\n        var _ref11 = _asyncToGenerator(regeneratorRuntime.mark(function _callee10(url, body, query, options) {\n            return regeneratorRuntime.wrap(function _callee10$(_context10) {\n                while (1) {\n                    switch (_context10.prev = _context10.next) {\n                        case 0:\n                            options = options || {};\n                            options.method = 'POST';\n                            options.url = url;\n                            options.query = query;\n                            options.body = body;\n                            _context10.next = 7;\n                            return this.send(options);\n\n                        case 7:\n                            return _context10.abrupt(\"return\", _context10.sent);\n\n                        case 8:\n                        case \"end\":\n                            return _context10.stop();\n                    }\n                }\n            }, _callee10, this);\n        }));\n\n        function post(_x11, _x12, _x13, _x14) {\n            return _ref11.apply(this, arguments);\n        }\n\n        return post;\n    }();\n\n    /**\n     * @param {string} url\n     * @param {object} [body]\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype.put = function () {\n        var _ref12 = _asyncToGenerator(regeneratorRuntime.mark(function _callee11(url, body, query, options) {\n            return regeneratorRuntime.wrap(function _callee11$(_context11) {\n                while (1) {\n                    switch (_context11.prev = _context11.next) {\n                        case 0:\n                            options = options || {};\n                            options.method = 'PUT';\n                            options.url = url;\n                            options.query = query;\n                            options.body = body;\n                            _context11.next = 7;\n                            return this.send(options);\n\n                        case 7:\n                            return _context11.abrupt(\"return\", _context11.sent);\n\n                        case 8:\n                        case \"end\":\n                            return _context11.stop();\n                    }\n                }\n            }, _callee11, this);\n        }));\n\n        function put(_x15, _x16, _x17, _x18) {\n            return _ref12.apply(this, arguments);\n        }\n\n        return put;\n    }();\n\n    /**\n     * @param {string} url\n     * @param {string} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n\n    Platform.prototype['delete'] = function () {\n        var _ref13 = _asyncToGenerator(regeneratorRuntime.mark(function _callee12(url, query, options) {\n            return regeneratorRuntime.wrap(function _callee12$(_context12) {\n                while (1) {\n                    switch (_context12.prev = _context12.next) {\n                        case 0:\n                            options = options || {};\n                            options.method = 'DELETE';\n                            options.url = url;\n                            options.query = query;\n                            _context12.next = 6;\n                            return this.send(options);\n\n                        case 6:\n                            return _context12.abrupt(\"return\", _context12.sent);\n\n                        case 7:\n                        case \"end\":\n                            return _context12.stop();\n                    }\n                }\n            }, _callee12, this);\n        }));\n\n        function _delete(_x19, _x20, _x21) {\n            return _ref13.apply(this, arguments);\n        }\n\n        return _delete;\n    }();\n\n    Platform.prototype._tokenRequest = function () {\n        var _ref14 = _asyncToGenerator(regeneratorRuntime.mark(function _callee13(path, body) {\n            return regeneratorRuntime.wrap(function _callee13$(_context13) {\n                while (1) {\n                    switch (_context13.prev = _context13.next) {\n                        case 0:\n                            _context13.next = 2;\n                            return this.send({\n                                url: path,\n                                skipAuthCheck: true,\n                                body: body,\n                                method: 'POST',\n                                headers: {\n                                    'Authorization': 'Basic ' + this._apiKey(),\n                                    'Content-Type': 'application/x-www-form-urlencoded'\n                                }\n                            });\n\n                        case 2:\n                            return _context13.abrupt(\"return\", _context13.sent);\n\n                        case 3:\n                        case \"end\":\n                            return _context13.stop();\n                    }\n                }\n            }, _callee13, this);\n        }));\n\n        function _tokenRequest(_x22, _x23) {\n            return _ref14.apply(this, arguments);\n        }\n\n        return _tokenRequest;\n    }();\n\n    Platform.prototype.ensureLoggedIn = function () {\n        var _ref15 = _asyncToGenerator(regeneratorRuntime.mark(function _callee14() {\n            return regeneratorRuntime.wrap(function _callee14$(_context14) {\n                while (1) {\n                    switch (_context14.prev = _context14.next) {\n                        case 0:\n                            if (!this._isAccessTokenValid()) {\n                                _context14.next = 2;\n                                break;\n                            }\n\n                            return _context14.abrupt(\"return\", null);\n\n                        case 2:\n                            _context14.next = 4;\n                            return this.refresh();\n\n                        case 4:\n                            return _context14.abrupt(\"return\", _context14.sent);\n\n                        case 5:\n                        case \"end\":\n                            return _context14.stop();\n                    }\n                }\n            }, _callee14, this);\n        }));\n\n        function ensureLoggedIn() {\n            return _ref15.apply(this, arguments);\n        }\n\n        return ensureLoggedIn;\n    }();\n\n    Platform.prototype._isAccessTokenValid = function _isAccessTokenValid() {\n        return this._auth.accessTokenValid();\n    };\n\n    Platform.prototype._apiKey = function _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return typeof btoa == 'function' ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    };\n\n    Platform.prototype._authHeader = function _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    };\n\n    return Platform;\n}(_events2.default);\n\nPlatform._urlPrefix = '/restapi';\nPlatform._apiVersion = 'v1.0';\nPlatform._tokenEndpoint = '/restapi/oauth/token';\nPlatform._revokeEndpoint = '/restapi/oauth/revoke';\nPlatform._authorizeEndpoint = '/restapi/oauth/authorize';\nPlatform._refreshDelayMs = 100;\nPlatform._cacheId = 'platform';\nPlatform._clearCacheOnRefreshError = false;\nexports.default = Platform;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Auth = function () {\n    function Auth(cache, cacheId) {\n        _classCallCheck(this, Auth);\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n    } // 1 minute\n\n\n    Auth.prototype.accessToken = function accessToken() {\n        return this.data().access_token;\n    };\n\n    Auth.prototype.refreshToken = function refreshToken() {\n        return this.data().refresh_token;\n    };\n\n    Auth.prototype.tokenType = function tokenType() {\n        return this.data().token_type;\n    };\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n\n\n    Auth.prototype.data = function data() {\n\n        return this._cache.getItem(this._cacheId) || {\n            token_type: '',\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        };\n    };\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n\n\n    Auth.prototype.setData = function setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach(function (key) {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + data.expires_in * 1000;\n        data.refresh_token_expire_time = Date.now() + data.refresh_token_expires_in * 1000;\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n    };\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n\n\n    Auth.prototype.accessTokenValid = function accessTokenValid() {\n\n        var authData = this.data();\n        return authData.token_type === Auth.forcedTokenType || authData.expire_time - Auth.refreshHandicapMs > Date.now();\n    };\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n\n\n    Auth.prototype.refreshTokenValid = function refreshTokenValid() {\n\n        return this.data().refresh_token_expire_time > Date.now();\n    };\n\n    /**\n     * @return {Auth}\n     */\n\n\n    Auth.prototype.cancelAccessToken = function cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n    };\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n\n\n    Auth.prototype.forceAuthentication = function forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n    };\n\n    return Auth;\n}();\n\n//export interface IAuthData {\n//    remember?:boolean;\n//    token_type?:string;\n//    access_token?:string;\n//    expires_in?:number; // actually it's string\n//    expire_time?:number;\n//    refresh_token?:string;\n//    refresh_token_expires_in?:number; // actually it's string\n//    refresh_token_expire_time?:number;\n//    scope?:string;\n//}\n\n\nAuth.refreshHandicapMs = 60 * 1000;\nAuth.forcedTokenType = 'forced';\nexports.default = Auth;\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\nexports.default = {\n    authResponseProperty: 'RCAuthorizationResponse',\n    version:  true ? (\"3.0.0-rc2\") : 'x.x.x'\n};\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _PubnubMock = __webpack_require__(22);\n\nvar _PubnubMock2 = _interopRequireDefault(_PubnubMock);\n\nvar _Externals = __webpack_require__(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PubnubMockFactory = function () {\n    function PubnubMockFactory() {\n        _classCallCheck(this, PubnubMockFactory);\n\n        this.crypto_obj = _Externals.PUBNUB.crypto_obj;\n    }\n\n    PubnubMockFactory.prototype.init = function init(options) {\n        return new _PubnubMock2.default(options);\n    };\n\n    return PubnubMockFactory;\n}();\n\nexports.default = PubnubMockFactory;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nexports.__esModule = true;\n\nvar _events = __webpack_require__(12);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _Externals = __webpack_require__(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar PubnubMock = function (_EventEmitter) {\n    _inherits(PubnubMock, _EventEmitter);\n\n    function PubnubMock(options) {\n        _classCallCheck(this, PubnubMock);\n\n        var _this = _possibleConstructorReturn(this, _EventEmitter.call(this));\n\n        _this.options = options;\n        _this.crypto_obj = _Externals.PUBNUB.crypto_obj;\n        return _this;\n    }\n\n    PubnubMock.prototype.init = function init(options) {\n        this.options = options;\n    };\n\n    PubnubMock.prototype.ready = function ready() {};\n\n    PubnubMock.prototype.subscribe = function subscribe(options) {\n        this.on('message-' + options.channel, options.message);\n    };\n\n    PubnubMock.prototype.unsubscribe = function unsubscribe(options) {\n        this.removeAllListeners('message-' + options.channel);\n    };\n\n    PubnubMock.prototype.receiveMessage = function receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    };\n\n    return PubnubMock;\n}(_events2.default);\n\nexports.default = PubnubMock;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _events = __webpack_require__(12);\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Subscription = function (_EventEmitter) {\n    _inherits(Subscription, _EventEmitter);\n\n    function Subscription(pubnubFactory, platform) {\n        _classCallCheck(this, Subscription);\n\n        var _this = _possibleConstructorReturn(this, _EventEmitter.call(this));\n\n        _this.events = {\n            notification: 'notification',\n            removeSuccess: 'removeSuccess',\n            removeError: 'removeError',\n            renewSuccess: 'renewSuccess',\n            renewError: 'renewError',\n            subscribeSuccess: 'subscribeSuccess',\n            subscribeError: 'subscribeError'\n        };\n\n\n        _this._pubnubFactory = pubnubFactory;\n        _this._platform = platform;\n        _this._pubnub = null;\n        _this._pubnubLastChannel = null;\n        _this._timeout = null;\n        _this._subscription = null;\n\n        return _this;\n    }\n\n    Subscription.prototype.subscribed = function subscribed() {\n\n        var subscription = this.subscription();\n\n        return !!(subscription.id && subscription.deliveryMode && subscription.deliveryMode.subscriberKey && subscription.deliveryMode.address);\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n\n    Subscription.prototype.alive = function alive() {\n        return this.subscribed() && Date.now() < this.expirationTime();\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n\n    Subscription.prototype.expired = function expired() {\n        if (!this.subscribed()) return true;\n        return !this.subscribed() || Date.now() > this.subscription().expirationTime;\n    };\n\n    Subscription.prototype.expirationTime = function expirationTime() {\n        return new Date(this.subscription().expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    };\n\n    Subscription.prototype.setSubscription = function setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n        this._setSubscription(subscription);\n        this._subscribeAtPubnub();\n        this._setTimeout();\n\n        return this;\n    };\n\n    Subscription.prototype.subscription = function subscription() {\n        return this._subscription || {};\n    };\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Subscription.prototype.register = function () {\n        var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            if (!this.alive()) {\n                                _context.next = 6;\n                                break;\n                            }\n\n                            _context.next = 3;\n                            return this.renew();\n\n                        case 3:\n                            return _context.abrupt('return', _context.sent);\n\n                        case 6:\n                            _context.next = 8;\n                            return this.subscribe();\n\n                        case 8:\n                            return _context.abrupt('return', _context.sent);\n\n                        case 9:\n                        case 'end':\n                            return _context.stop();\n                    }\n                }\n            }, _callee, this);\n        }));\n\n        function register() {\n            return _ref.apply(this, arguments);\n        }\n\n        return register;\n    }();\n\n    Subscription.prototype.eventFilters = function eventFilters() {\n        return this.subscription().eventFilters || [];\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n\n    Subscription.prototype.addEventFilters = function addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n\n    Subscription.prototype.setEventFilters = function setEventFilters(events) {\n        var subscription = this.subscription();\n        subscription.eventFilters = events;\n        this._setSubscription(subscription);\n        return this;\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Subscription.prototype.subscribe = function () {\n        var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n            var response, json;\n            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                    switch (_context2.prev = _context2.next) {\n                        case 0:\n                            _context2.prev = 0;\n\n\n                            this._clearTimeout();\n\n                            if (this.eventFilters().length) {\n                                _context2.next = 4;\n                                break;\n                            }\n\n                            throw new Error('Events are undefined');\n\n                        case 4:\n                            _context2.next = 6;\n                            return this._platform.post('/subscription', {\n                                eventFilters: this._getFullEventFilters(),\n                                deliveryMode: {\n                                    transportType: 'PubNub'\n                                }\n                            });\n\n                        case 6:\n                            response = _context2.sent;\n                            json = response.json();\n\n\n                            this.setSubscription(json).emit(this.events.subscribeSuccess, response);\n\n                            return _context2.abrupt('return', response);\n\n                        case 12:\n                            _context2.prev = 12;\n                            _context2.t0 = _context2['catch'](0);\n\n\n                            _context2.t0 = this._platform.client().makeError(_context2.t0);\n\n                            this.reset().emit(this.events.subscribeError, _context2.t0);\n\n                            throw _context2.t0;\n\n                        case 17:\n                        case 'end':\n                            return _context2.stop();\n                    }\n                }\n            }, _callee2, this, [[0, 12]]);\n        }));\n\n        function subscribe() {\n            return _ref2.apply(this, arguments);\n        }\n\n        return subscribe;\n    }();\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Subscription.prototype.renew = function () {\n        var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n            var response, json;\n            return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                while (1) {\n                    switch (_context3.prev = _context3.next) {\n                        case 0:\n                            _context3.prev = 0;\n\n\n                            this._clearTimeout();\n\n                            if (this.subscribed()) {\n                                _context3.next = 4;\n                                break;\n                            }\n\n                            throw new Error('No subscription');\n\n                        case 4:\n                            if (this.eventFilters().length) {\n                                _context3.next = 6;\n                                break;\n                            }\n\n                            throw new Error('Events are undefined');\n\n                        case 6:\n                            _context3.next = 8;\n                            return this._platform.put('/subscription/' + this.subscription().id, {\n                                eventFilters: this._getFullEventFilters()\n                            });\n\n                        case 8:\n                            response = _context3.sent;\n                            json = response.json();\n\n\n                            this.setSubscription(json).emit(this.events.renewSuccess, response);\n\n                            return _context3.abrupt('return', response);\n\n                        case 14:\n                            _context3.prev = 14;\n                            _context3.t0 = _context3['catch'](0);\n\n\n                            _context3.t0 = this._platform.client().makeError(_context3.t0);\n\n                            this.reset().emit(this.events.renewError, _context3.t0);\n\n                            throw _context3.t0;\n\n                        case 19:\n                        case 'end':\n                            return _context3.stop();\n                    }\n                }\n            }, _callee3, this, [[0, 14]]);\n        }));\n\n        function renew() {\n            return _ref3.apply(this, arguments);\n        }\n\n        return renew;\n    }();\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Subscription.prototype.remove = function () {\n        var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n            var response;\n            return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                while (1) {\n                    switch (_context4.prev = _context4.next) {\n                        case 0:\n                            _context4.prev = 0;\n\n                            if (this.subscribed()) {\n                                _context4.next = 3;\n                                break;\n                            }\n\n                            throw new Error('No subscription');\n\n                        case 3:\n                            _context4.next = 5;\n                            return this._platform.delete('/subscription/' + this.subscription().id);\n\n                        case 5:\n                            response = _context4.sent;\n\n\n                            this.reset().emit(this.events.removeSuccess, response);\n\n                            return _context4.abrupt('return', response);\n\n                        case 10:\n                            _context4.prev = 10;\n                            _context4.t0 = _context4['catch'](0);\n\n\n                            _context4.t0 = this._platform.client().makeError(_context4.t0);\n\n                            this.emit(this.events.removeError, _context4.t0);\n\n                            throw _context4.t0;\n\n                        case 15:\n                        case 'end':\n                            return _context4.stop();\n                    }\n                }\n            }, _callee4, this, [[0, 10]]);\n        }));\n\n        function remove() {\n            return _ref4.apply(this, arguments);\n        }\n\n        return remove;\n    }();\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n\n    Subscription.prototype.resubscribe = function resubscribe() {\n        var filters = this.eventFilters();\n        return this.reset().setEventFilters(filters).subscribe();\n    };\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n\n\n    Subscription.prototype.reset = function reset() {\n        this._clearTimeout();\n        if (this.subscribed() && this._pubnub) this._pubnub.unsubscribe({ channel: this.subscription().deliveryMode.address });\n        this._setSubscription(null);\n        return this;\n    };\n\n    Subscription.prototype._setSubscription = function _setSubscription(subscription) {\n        this._subscription = subscription;\n    };\n\n    Subscription.prototype._getFullEventFilters = function _getFullEventFilters() {\n        var _this2 = this;\n\n        return this.eventFilters().map(function (event) {\n            return _this2._platform.createUrl(event);\n        });\n    };\n\n    Subscription.prototype._setTimeout = function _setTimeout() {\n        var _this3 = this;\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        this._timeout = setInterval(function () {\n\n            if (_this3.alive()) return;\n\n            if (_this3.expired()) {\n                _this3.subscribe();\n            } else {\n                _this3.renew();\n            }\n        }, Subscription._pollInterval);\n\n        return this;\n    };\n\n    Subscription.prototype._clearTimeout = function _clearTimeout() {\n        clearInterval(this._timeout);\n        return this;\n    };\n\n    Subscription.prototype._decrypt = function _decrypt(message) {\n\n        if (!this.subscribed()) throw new Error('No subscription');\n\n        if (this.subscription().deliveryMode.encryptionKey) {\n\n            message = this._pubnubFactory.crypto_obj.decrypt(message, this.subscription().deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n        }\n\n        return message;\n    };\n\n    Subscription.prototype._notify = function _notify(message) {\n        this.emit(this.events.notification, this._decrypt(message));\n        return this;\n    };\n\n    Subscription.prototype._subscribeAtPubnub = function _subscribeAtPubnub() {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var deliveryMode = this.subscription().deliveryMode;\n\n        if (this._pubnub) {\n\n            if (this._pubnubLastChannel == deliveryMode.address) {\n                // Nothing to update, keep listening to same channel\n                return this;\n            } else if (this._pubnubLastChannel) {\n                // Need to subscribe to new channel\n                this._pubnub.unsubscribe({ channel: this._pubnubLastChannel });\n            }\n\n            // Re-init for new data\n            this._pubnub = this._pubnub.init({\n                ssl: true,\n                subscribe_key: deliveryMode.subscriberKey\n            });\n        } else {\n\n            // Init from scratch\n            this._pubnub = this._pubnubFactory.init({\n                ssl: true,\n                subscribe_key: deliveryMode.subscriberKey\n            });\n\n            this._pubnub.ready(); //TODO This may be not needed anymore\n        }\n\n        this._pubnubLastChannel = deliveryMode.address;\n\n        this._pubnub.subscribe({\n            channel: deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: function connect() {}\n        });\n\n        return this;\n    };\n\n    return Subscription;\n}(_events2.default);\n\n//export interface ISubscription {\n//    id?:string;\n//    uri?: string;\n//    eventFilters?:string[];\n//    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n//    expiresIn?:number;\n//    deliveryMode?: {\n//        transportType?:string;\n//        encryption?:boolean;\n//        address?:string;\n//        subscriberKey?:string;\n//        encryptionKey?:string;\n//        secretKey?:string;\n//    };\n//    creationTime?:string; // 2014-03-12T19:54:35.613Z\n//    status?:string; // Active\n//}\n\n\nSubscription._renewHandicapMs = 2 * 60 * 1000;\nSubscription._pollInterval = 10 * 1000;\nexports.default = Subscription;\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nexports.__esModule = true;\n\nvar _Subscription2 = __webpack_require__(23);\n\nvar _Subscription3 = _interopRequireDefault(_Subscription2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CachedSubscription = function (_Subscription) {\n    _inherits(CachedSubscription, _Subscription);\n\n    function CachedSubscription(pubnubFactory, platform, cache, cacheKey) {\n        _classCallCheck(this, CachedSubscription);\n\n        /** @type {Cache} */\n\n        var _this = _possibleConstructorReturn(this, _Subscription.call(this, pubnubFactory, platform));\n\n        _this._cache = cache;\n        _this._cacheKey = cacheKey;\n\n        return _this;\n    }\n\n    CachedSubscription.prototype.subscription = function subscription() {\n        return this._cache.getItem(this._cacheKey) || {};\n    };\n\n    CachedSubscription.prototype._setSubscription = function _setSubscription(subscription) {\n        return this._cache.setItem(this._cacheKey, subscription);\n    };\n\n    /**\n     * This function checks whether there are any pre-defined eventFilters in cache and if not -- uses provided as defaults\n     * @param {string[]} events\n     * @return {CachedSubscription}\n     */\n\n\n    CachedSubscription.prototype.restore = function restore(events) {\n\n        if (!this.eventFilters().length) {\n            this.setEventFilters(events);\n        }\n\n        return this;\n    };\n\n    return CachedSubscription;\n}(_Subscription3.default);\n\nexports.default = CachedSubscription;\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** ringcentral.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 364f94bbf118a020eb87\n **/","import \"babel-regenerator-runtime\";\nimport * as Utils from \"./core/Utils\";\nimport Cache from \"./core/Cache\";\nimport * as Externals from \"./core/Externals\";\nimport EventEmitter from \"events\";\nimport Client from \"./http/Client\";\nimport ApiResponse from \"./http/ApiResponse\";\nimport {default as ClientMock} from \"./mocks/ClientMock\";\nimport Mock from \"./mocks/Mock\";\nimport Registry from \"./mocks/Registry\";\nimport Platform from \"./platform/Platform\";\nimport Auth from \"./platform/Auth\";\nimport PubnubMockFactory from \"./pubnub/PubnubFactory\";\nimport Subscription from \"./subscription/Subscription\";\nimport CachedSubscription from \"./subscription/CachedSubscription\";\nimport constants from \"./core/Constants\";\n\nclass SDK {\n\n    static version = constants.version;\n\n    static server = {\n        sandbox: 'https://platform.devtest.ringcentral.com',\n        production: 'https://platform.ringcentral.com'\n    };\n\n    /**\n     * @namespace RingCentral\n     * @constructor\n     * @param {object} [options]\n     * @param {string} [options.server]\n     * @param {string} [options.cachePrefix]\n     * @param {string} [options.appSecret]\n     * @param {string} [options.appKey]\n     * @param {string} [options.appName]\n     * @param {string} [options.appVersion]\n     * @param {string} [options.pubnubFactory]\n     * @param {string} [options.client]\n     * @param {string} [options.redirectUri]\n     */\n    constructor({server, cachePrefix, appSecret, appKey, appName, appVersion, pubnubFactory, client, redirectUri}) {\n\n        if (!Externals.fetch) {\n            throw new Error('Native Fetch is missing, set RingCentral.SDK.core.Externals.fetch to your favorite alternative');\n        }\n\n        if (!Externals.Promise) {\n            throw new Error('Native Promise is missing, set RingCentral.SDK.core.Externals.Promise to your favorite alternative');\n        }\n\n        this._cache = new Cache(Externals.localStorage, cachePrefix);\n\n        this._client = client || new Client();\n\n        this._platform = new Platform({\n            client: this._client,\n            cache: this._cache,\n            version: SDK.version,\n            server,\n            appKey,\n            appSecret,\n            appName,\n            appVersion,\n            redirectUri\n        });\n\n        this._pubnubFactory = pubnubFactory || Externals.PUBNUB;\n\n    }\n\n    /**\n     * @return {Platform}\n     */\n    platform() {\n        return this._platform;\n    }\n\n    /**\n     * @return {Subscription}\n     */\n    createSubscription() {\n        return new Subscription(this._pubnubFactory, this._platform);\n    }\n\n    /**\n     * @return {CachedSubscription}\n     */\n    createCachedSubscription(cacheKey) {\n        return new CachedSubscription(this._pubnubFactory, this._platform, this._cache, cacheKey);\n    }\n\n    /**\n     * @return {Cache}\n     */\n    cache() {\n        return this._cache;\n    }\n\n    static core = {\n        Cache: Cache,\n        EventEmitter: EventEmitter,\n        Utils: Utils,\n        Externals: Externals\n    };\n\n    static http = {\n        Client: Client,\n        ApiResponse: ApiResponse\n    };\n\n    static platform = {\n        Auth: Auth,\n        Platform: Platform\n    };\n\n    static subscription = {\n        Subscription: Subscription\n    };\n\n    static mocks = {\n        Client: ClientMock,\n        Registry: Registry,\n        Mock: Mock\n    };\n\n    static pubnub = {\n        PubnubMockFactory: PubnubMockFactory\n    };\n\n    static handleLoginRedirect(origin) {\n        var response = window.location.hash ? window.location.hash : window.location.search;\n        window.opener.postMessage({[constants.authResponseProperty]: response}, origin || window.location.origin);\n    }\n\n}\n\nmodule.exports = SDK;\n\n\n/** WEBPACK FOOTER **\n ** ./src/SDK.js\n **/","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          context._sent = arg;\n\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-regenerator-runtime/runtime.js\n ** module id = 2\n ** module chunks = 0 1\n **/","import {Promise} from \"./Externals.js\";\nimport qs from \"querystring\";\n\n/**\n * @param {object} parameters\n * @returns {string}\n */\nexport function queryStringify(parameters) {\n    return qs.stringify(parameters);\n}\n\n/**\n * @param {string} queryString\n * @returns {object}\n */\nexport function parseQueryString(queryString) {\n    return qs.parse(queryString);\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\nexport function isObject(o) {\n    return o != null && typeof o === 'object' && !isArray(o);\n}\n\nexport function isObjectObject(o) {\n    return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nexport function isPlainObject(o) {\n    var ctor, prot;\n\n    if (isObjectObject(o) === false) return false;\n\n    // If has modified constructor\n    ctor = o.constructor;\n    if (typeof ctor !== 'function') return false;\n\n    // If has modified prototype\n    prot = ctor.prototype;\n    if (isObjectObject(prot) === false) return false;\n\n    // If constructor does not have an Object-specific method\n    if (prot.hasOwnProperty('isPrototypeOf') === false) {\n        return false;\n    }\n\n    // Most likely a plain Object\n    return true;\n}\n\nexport function isNodeJS() {\n    return (typeof process !== 'undefined');\n}\n\nexport function isBrowser() {\n    return (typeof window !== 'undefined');\n}\n\nexport function delay(timeout) {\n    return new Promise((resolve, reject) => {\n        setTimeout(() => {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Utils.js\n **/","import es6Promise from \"es6-promise\";\nimport nodeFetch from \"node-fetch\";\nimport pubnub from \"pubnub\";\n\nvar root = (typeof window !== \"undefined\" && window) ||\n           (typeof global !== \"undefined\" && global) ||\n           Function(\"return this;\")();\n\nvar Promise = (es6Promise && es6Promise.Promise) || root.Promise;\n\nvar fetch = (nodeFetch && typeof nodeFetch == 'function')  ? nodeFetch : root.fetch;\nvar Request = fetch.Request || root.Request;\nvar Response = fetch.Response || root.Response;\nvar Headers = fetch.Headers || root.Headers;\n\nvar PUBNUB = pubnub || root.PUBNUB;\n\nvar localStorage = (typeof root.localStorage !== 'undefined') ? root.localStorage : {};\n\nexport {Promise, fetch, Request, Response, Headers, PUBNUB, localStorage};\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Externals.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}\n ** module id = 5\n ** module chunks = 0 1\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}\n ** module id = 6\n ** module chunks = 0 1\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}\n ** module id = 7\n ** module chunks = 0 1\n **/","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/querystring/index.js\n ** module id = 8\n ** module chunks = 0 1\n **/","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (Array.isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/querystring/decode.js\n ** module id = 9\n ** module chunks = 0 1\n **/","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return Object.keys(obj).map(function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (Array.isArray(obj[k])) {\n        return obj[k].map(function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/querystring/encode.js\n ** module id = 10\n ** module chunks = 0 1\n **/","export default class Cache {\n\n    static defaultPrefix = 'rc-';\n\n    constructor(storage, prefix) {\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    }\n\n    setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    }\n\n    removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    }\n\n    getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    }\n\n    clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n\n        }\n\n        return this;\n\n    }\n\n    _prefixKey(key) {\n        return this._prefix + key;\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Cache.js\n **/","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/events/events.js\n ** module id = 12\n ** module chunks = 0 1\n **/","import {fetch, Request} from \"../core/Externals\";\nimport {queryStringify, isPlainObject} from \"../core/Utils\";\nimport EventEmitter from \"events\";\nimport ApiResponse from \"./ApiResponse\";\n\nexport default class Client extends EventEmitter {\n\n    static _allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'];\n\n    events = {\n        beforeRequest: 'beforeRequest',\n        requestSuccess: 'requestSuccess',\n        requestError: 'requestError'\n    };\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request) {\n\n        var apiResponse = new ApiResponse(request);\n\n        try {\n\n            //TODO Stop request if listeners return false\n            this.emit(this.events.beforeRequest, apiResponse);\n\n            apiResponse._response = await this._loadResponse(request);\n\n            await apiResponse._init();\n\n            if (!apiResponse.ok()) throw new Error('Response has unsuccessful status');\n\n            this.emit(this.events.requestSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            if (!e.apiResponse) e = this.makeError(e, apiResponse);\n\n            this.emit(this.events.requestError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n    async _loadResponse(request) {\n        return await fetch.call(null, request);\n    }\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n    makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = (apiResponse && apiResponse.error(true)) || e.originalMessage;\n\n        }\n\n        return e;\n\n    }\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n    createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        init.method = init.method.toUpperCase();\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) {\n            throw new Error('Method has wrong value: ' + init.method);\n        }\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + queryStringify(init.query);\n        }\n\n        if (!(findHeaderName('Accept', init.headers))) {\n            init.headers['Accept'] = ApiResponse._jsonContentType;\n        }\n\n        // Serialize body\n        if (isPlainObject(init.body) || !init.body) {\n\n            var contentTypeHeaderName = findHeaderName(ApiResponse._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = ApiResponse._contentType;\n                init.headers[contentTypeHeaderName] = ApiResponse._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(ApiResponse._jsonContentType) > -1) {\n                if((init.method === 'GET' || init.method === 'HEAD') && !!init.body) {\n                    // oddly setting body to null still result in TypeError in phantomjs\n                    init.body = undefined;\n                } else {\n                    init.body = JSON.stringify(init.body);\n                }\n\n            } else if (contentType.indexOf(ApiResponse._urlencodedContentType) > -1) {\n                init.body = queryStringify(init.body);\n            }\n\n        }\n\n        // Create a request with encoded body\n        var req = new Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n\n    }\n\n}\n\nexport function findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function(res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n/**\n * @name IApiError\n * @property {string} stack\n * @property {string} originalMessage\n * @property {ApiResponse} apiResponse\n */\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Client.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\n\nexport default class ApiResponse {\n\n    static _contentType = 'Content-Type';\n    static _jsonContentType = 'application/json';\n    static _multipartContentType = 'multipart/mixed';\n    static _urlencodedContentType = 'application/x-www-form-urlencoded';\n    static _headerSeparator = ':';\n    static _bodySeparator = '\\n\\n';\n    static _boundarySeparator = '--';\n\n    /**\n     * @param {Request} request\n     * @param {Response} response\n     * @param {string} responseText\n     */\n    constructor(request, response, responseText) {\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n\n    }\n\n    async _init(){\n\n        if (this._isMultipart() || this._isJson()) {\n            this._text = await this.response().text();\n        }\n\n        return this;\n\n    }\n\n    /**\n     * @return {Response}\n     */\n    response() {\n        return this._response;\n    }\n\n    /**\n     * @return {Request}\n     */\n    request() {\n        return this._request;\n    }\n\n    /**\n     * @return {boolean}\n     */\n    ok() {\n        return this._response && this._response.ok;\n    }\n\n    /**\n     * @return {string}\n     */\n    text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    }\n\n    /**\n     * @return {object}\n     */\n    json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    }\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n    error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') +\n                      (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n\n        } catch (e) {}\n\n        return message;\n\n    }\n\n    /**\n     * @return {ApiResponse[]}\n     */\n    multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map((part, i) => {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n\n            });\n\n        }\n\n        return this._multipart;\n\n    }\n\n    _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    }\n\n    _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    }\n\n    _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    }\n\n    _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    }\n\n    _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    }\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n    static create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = (headersAndBody.length > 1) ? headersAndBody.shift() : '';\n\n        text = headersAndBody.length > 0 ? headersAndBody.join(ApiResponse._bodySeparator) : null;\n\n        (headersText || '')\n            .split('\\n')\n            .forEach((header) => {\n\n                var split = header.trim().split(ApiResponse._headerSeparator),\n                    key = split.shift().trim(),\n                    value = split.join(ApiResponse._headerSeparator).trim();\n\n                if (key) headers.append(key, value);\n\n            });\n\n        return new ApiResponse(null, new Response(text ? text : undefined, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/ApiResponse.js\n **/","import Registry from './Registry';\nimport {default as HttpClient} from '../http/Client';\n\nexport default class Client extends HttpClient {\n\n    constructor() {\n        super();\n        this._registry = new Registry();\n    }\n\n    registry() {\n        return this._registry;\n    }\n\n    async _loadResponse(request) {\n\n        var mock = this._registry.find(request);\n\n        return await mock.getResponse(request);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/ClientMock.js\n **/","import Mock from './Mock';\n\nexport default class Registry {\n\n    constructor() {\n        this._mocks = [];\n    }\n\n    add(mock) {\n        this._mocks.push(mock);\n        return this;\n    }\n\n    clear() {\n        this._mocks = [];\n        return this;\n    }\n\n    find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url +\n                                                 ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n\n    }\n\n    apiCall(method, path, response, status, statusText, delay) {\n\n        this.add(new Mock(method, path, response, status, statusText, delay));\n\n        return this;\n\n    }\n\n    authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n\n    }\n\n    logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n\n    }\n\n    presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n\n    }\n\n    subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': [\n                '/restapi/v1.0/account/~/extension/~/presence'\n            ],\n            'expirationTime': new Date(date.getTime() + (expiresIn * 1000)).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + (15 * 60 * 60 * 1000)).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Registry.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport ApiResponse from '../http/ApiResponse';\nimport {delay} from '../core/Utils';\n\nexport default class Mock {\n\n    constructor(method, path, json, status, statusText, delay) {\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    path() {\n        return this._path;\n    }\n\n    method() {\n        return this._method;\n    }\n\n    test(request) {\n\n        return request.url.indexOf(this._path) > -1 &&\n               request.method.toUpperCase() == this._method;\n\n    }\n\n    async getResponse(request) {\n\n        await delay(this._delay);\n\n        return this.createResponse(this._json);\n\n    }\n\n    createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = new Response(str, init);\n\n        res.headers.set(ApiResponse._contentType, ApiResponse._jsonContentType);\n\n        return res;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Mock.js\n **/","import {Promise} from \"../core/Externals\";\nimport EventEmitter from \"events\";\nimport Auth from \"./Auth\";\nimport {queryStringify, parseQueryString, isBrowser, delay} from \"../core/Utils\";\nimport constants from \"../core/Constants\";\n\nexport default class Platform extends EventEmitter {\n\n    static _urlPrefix = '/restapi';\n    static _apiVersion = 'v1.0';\n    static _tokenEndpoint = '/restapi/oauth/token';\n    static _revokeEndpoint = '/restapi/oauth/revoke';\n    static _authorizeEndpoint = '/restapi/oauth/authorize';\n    static _refreshDelayMs = 100;\n    static _cacheId = 'platform';\n    static _clearCacheOnRefreshError = false;\n\n    events = {\n        beforeLogin: 'beforeLogin',\n        loginSuccess: 'loginSuccess',\n        loginError: 'loginError',\n        beforeRefresh: 'beforeRefresh',\n        refreshSuccess: 'refreshSuccess',\n        refreshError: 'refreshError',\n        beforeLogout: 'beforeLogout',\n        logoutSuccess: 'logoutSuccess',\n        logoutError: 'logoutError'\n    };\n\n    constructor({client, cache, server, appKey, appSecret, appName, appVersion, sdkVersion, redirectUri}) {\n\n        super();\n\n        this._server = server;\n        this._appKey = appKey;\n        this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        this._cache = cache;\n\n        /** @type {Client} */\n        this._client = client;\n\n        /** @type {Promise<ApiResponse>} */\n        this._refreshPromise = null;\n\n        this._auth = new Auth(this._cache, Platform._cacheId);\n\n        this._userAgent = (appName ? (appName + (appVersion ? '/' + appVersion : '')) + ' ' : '') + 'RCJSSDK/' + sdkVersion;\n\n        this._redirectUri = redirectUri || '';\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    auth() {\n        return this._auth;\n    }\n\n    /**\n     * @return {Client}\n     */\n    client() {\n        return this._client;\n    }\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n    createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += (path.indexOf('?') > -1 ? '&' : '?');\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n\n    }\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @param {boolean} options.implicit\n     * @param {object} [options]\n     * @return {string}\n     */\n    loginUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + queryStringify({\n                'response_type': options.implicit ? 'token' : 'code',\n                'redirect_uri': options.redirectUri || this._redirectUri,\n                'client_id': this._appKey,\n                'state': options.state || '',\n                'brand_id': options.brandId || '',\n                'display': options.display || '',\n                'prompt': options.prompt || ''\n            }), {addServer: true})\n\n    }\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n    parseLoginRedirect(url) {\n\n        function getParts(url, separator) {\n            return url.split(separator).reverse()[0];\n        }\n\n        var response = (url.indexOf('#') === 0 && getParts(url, '#')) ||\n                       (url.indexOf('?') === 0 && getParts(url, '?')) ||\n                       null;\n\n        if (!response) throw new Error('Unable to parse response');\n\n        var qs = parseQueryString(response);\n\n        if (!qs) throw new Error('Unable to parse response');\n\n        var error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n\n    }\n\n    /**\n     * Convenience method to handle 3-legged OAuth\n     *\n     * Attention! This is an experimental method and it's signature and behavior may change without notice.\n     *\n     * @experimental\n     * @param {number} [options.width]\n     * @param {number} [options.height]\n     * @param {object} [options.login] additional options for login()\n     * @param {string} [options.origin]\n     * @param {string} [options.property] name of window.postMessage's event data property\n     * @param {string} [options.target] target for window.open()\n     * @param {string} options.url\n     * @return {Promise}\n     */\n    loginWindow(options) {\n\n        return new Promise((resolve, reject) => {\n\n            if (!isBrowser()) throw new Error('This method can be used only in browser');\n\n            if (!options.url) throw new Error('Missing mandatory URL parameter');\n\n            options = options || {};\n            options.url = options.url || 400;\n            options.width = options.width || 400;\n            options.height = options.height || 600;\n            options.origin = options.origin || window.location.origin;\n            options.property = options.property || constants.authResponseProperty;\n            options.target = options.target || '_blank';\n\n            var dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : screen.left;\n            var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;\n\n            var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\n            var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\n\n            var left = ((width / 2) - (options.width / 2)) + dualScreenLeft;\n            var top = ((height / 2) - (options.height / 2)) + dualScreenTop;\n            var win = window.open(options.url, '_blank', (options.target == '_blank') ? 'scrollbars=yes, status=yes, width=' + options.width + ', height=' + options.height + ', left=' + left + ', top=' + top : '');\n\n            if (window.focus) win.focus();\n\n            var eventMethod = window.addEventListener ? 'addEventListener' : 'attachEvent';\n            var eventRemoveMethod = eventMethod == 'addEventListener' ? 'removeEventListener' : 'detachEvent';\n            var messageEvent = eventMethod == 'addEventListener' ? 'message' : 'onmessage';\n\n            var eventListener = (e) => {\n\n                if (e.origin != options.origin) return;\n                if (!e.data || !e.data[options.property]) return; // keep waiting\n\n                win.close();\n                window[eventRemoveMethod](messageEvent, eventListener);\n\n                try {\n\n                    var loginOptions = this.parseLoginRedirect(e.data[options.property]);\n\n                    if (!loginOptions.code && !loginOptions.access_token) throw new Error('No authorization code or token');\n\n                    resolve(loginOptions);\n\n                } catch (e) {\n                    reject(e);\n                }\n\n            };\n\n            window[eventMethod](messageEvent, eventListener, false);\n\n        });\n\n    }\n\n    /**\n     * @return {Promise<boolean>}\n     */\n    async loggedIn() {\n\n        try {\n            await this.ensureLoggedIn();\n            return true;\n        } catch (e) {\n            return false;\n        }\n\n    }\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @param {string} options.remember\n     * @param {string} options.accessTokenTtl\n     * @param {string} options.refreshTokenTtl\n     * @param {string} options.access_token\n     * @returns {Promise<ApiResponse>}\n     */\n    async login(options) {\n\n        try {\n\n            options = options || {};\n\n            this.emit(this.events.beforeLogin);\n\n            var body = {};\n\n            if (!options.code) {\n\n                body.grant_type = 'password';\n                body.username = options.username;\n                body.password = options.password;\n                body.extension = options.extension || '';\n\n            } else if (options.code) {\n\n                body.grant_type = 'authorization_code';\n                body.code = options.code;\n                body.redirect_uri = options.redirectUri || this._redirectUri;\n                //body.client_id = this.getCredentials().key; // not needed\n\n            }\n\n            var apiResponse;\n            var json;\n\n            if (options.access_token) {\n\n                //TODO Potentially make a request to /oauth/tokeninfo\n                json = options;\n\n            } else {\n\n                if (options.endpointId) body.endpoint_id = options.endpointId;\n                if (options.accessTokenTtl) body.accessTokenTtl = options.accessTokenTtl;\n                if (options.refreshTokenTtl) body.refreshTokenTtl = options.refreshTokenTtl;\n\n                apiResponse = await this._tokenRequest(Platform._tokenEndpoint, body);\n                json = apiResponse.json();\n\n            }\n\n            this._auth.setData(json);\n\n            this.emit(this.events.loginSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            this._cache.clean();\n\n            this.emit(this.events.loginError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     * @private\n     */\n    async _refresh() {\n\n        try {\n\n            this.emit(this.events.beforeRefresh);\n\n            await delay(Platform._refreshDelayMs);\n\n            // Perform sanity checks\n            if (!this._auth.refreshToken()) throw new Error('Refresh token is missing');\n            if (!this._auth.refreshTokenValid()) throw new Error('Refresh token has expired');\n\n            /** @type {ApiResponse} */\n            var res = await this._tokenRequest(Platform._tokenEndpoint, {\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": this._auth.refreshToken(),\n                    \"access_token_ttl\": this._auth.data().expires_in + 1,\n                    \"refresh_token_ttl\": this._auth.data().refresh_token_expires_in + 1\n                }),\n                json = res.json();\n\n            if (!json.access_token) {\n                throw this._client.makeError(new Error('Malformed OAuth response'), res);\n            }\n\n            this._auth.setData(json);\n\n            this.emit(this.events.refreshSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            e = this._client.makeError(e);\n\n            if (Platform._clearCacheOnRefreshError) {\n                this._cache.clean();\n            }\n\n            this.emit(this.events.refreshError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async refresh() {\n\n        if (this._refreshPromise) {\n            return this._refreshPromise;\n        }\n\n        try {\n\n            this._refreshPromise = this._refresh()\n                .then((res) => {\n                    this._refreshPromise = null;\n                    return res;\n                });\n\n            return this._refreshPromise;\n\n        } catch (e) {\n\n            this._refreshPromise = null;\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async logout() {\n\n        try {\n\n            this.emit(this.events.beforeLogout);\n\n            var res = await this._tokenRequest(Platform._revokeEndpoint, {\n                token: this._auth.accessToken()\n            });\n\n            this._cache.clean();\n\n            this.emit(this.events.logoutSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            this.emit(this.events.logoutError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n    async inflateRequest(request, options) {\n\n        options = options || {};\n\n        if (options.skipAuthCheck) return request;\n\n        await this.ensureLoggedIn();\n\n        request.headers.set('X-User-Agent', this._userAgent);\n        request.headers.set('Client-Id', this._appKey);\n        request.headers.set('Authorization', this._authHeader());\n        //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n        return request;\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request, options) {\n\n        try {\n\n            request = await this.inflateRequest(request, options);\n\n            return (await this._client.sendRequest(request));\n\n        } catch (e) {\n\n            // Guard is for errors that come from polling\n            if (!e.apiResponse || !e.apiResponse.response() || (e.apiResponse.response().status != 401) || options.retry) throw e;\n\n            this._auth.cancelAccessToken();\n\n            options.retry = true;\n\n            return (await this.sendRequest(request, options));\n\n        }\n\n    }\n\n    /**\n     * General purpose function to send anything to server\n     * @param {string} options.url\n     * @param {object} [options.body]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async send(options = {}) {\n\n        //FIXME https://github.com/bitinn/node-fetch/issues/43\n        options.url = this.createUrl(options.url, {addServer: true});\n\n        return await this.sendRequest(this._client.createRequest(options), options);\n\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async get(url, query, options) {\n        options = options || {};\n        options.method = 'GET';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async post(url, body, query, options) {\n        options = options || {};\n        options.method = 'POST';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} [body]\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async put(url, body, query, options) {\n        options = options || {};\n        options.method = 'PUT';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {string} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async 'delete'(url, query, options) {\n        options = options || {};\n        options.method = 'DELETE';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    async _tokenRequest(path, body) {\n\n        return await this.send({\n            url: path,\n            skipAuthCheck: true,\n            body: body,\n            method: 'POST',\n            headers: {\n                'Authorization': 'Basic ' + this._apiKey(),\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        });\n\n    }\n\n    async ensureLoggedIn() {\n        if (this._isAccessTokenValid()) return null;\n        return await this.refresh();\n    }\n\n    _isAccessTokenValid() {\n        return (this._auth.accessTokenValid());\n    }\n\n    _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return (typeof btoa == 'function') ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    }\n\n    _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Platform.js\n **/","export default class Auth {\n\n    static refreshHandicapMs = 60 * 1000; // 1 minute\n    static forcedTokenType = 'forced';\n\n    constructor(cache, cacheId) {\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n\n    }\n\n    accessToken() {\n        return this.data().access_token;\n    }\n\n    refreshToken() {\n        return this.data().refresh_token;\n    }\n\n    tokenType() {\n        return this.data().token_type;\n    }\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n    data() {\n\n        return this._cache.getItem(this._cacheId) || {\n                token_type: '',\n                access_token: '',\n                expires_in: 0,\n                refresh_token: '',\n                refresh_token_expires_in: 0\n            };\n\n    }\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n    setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach((key) => {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + (data.expires_in * 1000);\n        data.refresh_token_expire_time = Date.now() + (data.refresh_token_expires_in * 1000);\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    accessTokenValid() {\n\n        var authData = this.data();\n        return (authData.token_type === Auth.forcedTokenType || (authData.expire_time - Auth.refreshHandicapMs > Date.now()));\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    refreshTokenValid() {\n\n        return (this.data().refresh_token_expire_time > Date.now());\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n\n    }\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n    forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n\n    }\n\n}\n\n//export interface IAuthData {\n//    remember?:boolean;\n//    token_type?:string;\n//    access_token?:string;\n//    expires_in?:number; // actually it's string\n//    expire_time?:number;\n//    refresh_token?:string;\n//    refresh_token_expires_in?:number; // actually it's string\n//    refresh_token_expire_time?:number;\n//    scope?:string;\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Auth.js\n **/","export default {\n    authResponseProperty: 'RCAuthorizationResponse',\n    version: (typeof VERSION !== 'undefined' ? VERSION : 'x.x.x')\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Constants.js\n **/","import PubnubMock from './PubnubMock.js';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMockFactory {\n\n    constructor() {\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    init(options) {\n        return new PubnubMock(options);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubFactory.js\n **/","import EventEmitter from \"events\";\nimport {PUBNUB} from \"../core/Externals\";\n\nexport default class PubnubMock extends EventEmitter {\n\n    constructor(options) {\n        super();\n        this.options = options;\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    init(options) {\n        this.options = options;\n    }\n\n    ready() {}\n\n    subscribe(options) {\n        this.on('message-' + options.channel, options.message);\n    }\n\n    unsubscribe(options) {\n        this.removeAllListeners('message-' + options.channel);\n    }\n\n    receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubMock.js\n **/","import EventEmitter from \"events\";\n\nexport default class Subscription extends EventEmitter {\n\n    static _renewHandicapMs = 2 * 60 * 1000;\n    static _pollInterval = 10 * 1000;\n\n    events = {\n        notification: 'notification',\n        removeSuccess: 'removeSuccess',\n        removeError: 'removeError',\n        renewSuccess: 'renewSuccess',\n        renewError: 'renewError',\n        subscribeSuccess: 'subscribeSuccess',\n        subscribeError: 'subscribeError'\n    };\n\n    constructor(pubnubFactory, platform) {\n\n        super();\n\n        this._pubnubFactory = pubnubFactory;\n        this._platform = platform;\n        this._pubnub = null;\n        this._pubnubLastChannel = null;\n        this._timeout = null;\n        this._subscription = null;\n\n    }\n\n    subscribed() {\n\n        var subscription = this.subscription();\n\n        return !!(subscription.id &&\n                  subscription.deliveryMode &&\n                  subscription.deliveryMode.subscriberKey &&\n                  subscription.deliveryMode.address);\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    alive() {\n        return this.subscribed() && Date.now() < this.expirationTime();\n    }\n\n    /**\n     * @return {boolean}\n     */\n    expired() {\n        if (!this.subscribed()) return true;\n        return !this.subscribed() || Date.now() > this.subscription().expirationTime;\n    }\n\n    expirationTime() {\n        return new Date(this.subscription().expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    }\n\n    setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n        this._setSubscription(subscription);\n        this._subscribeAtPubnub();\n        this._setTimeout();\n\n        return this;\n\n    }\n\n    subscription() {\n        return this._subscription || {};\n    }\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @returns {Promise<ApiResponse>}\n     */\n    async register() {\n\n        if (this.alive()) {\n            return await this.renew();\n        } else {\n            return await this.subscribe();\n        }\n\n    }\n\n    eventFilters() {\n        return this.subscription().eventFilters || [];\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    setEventFilters(events) {\n        var subscription = this.subscription();\n        subscription.eventFilters = events;\n        this._setSubscription(subscription);\n        return this;\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async subscribe() {\n\n        try {\n\n            this._clearTimeout();\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.post('/subscription', {\n                    eventFilters: this._getFullEventFilters(),\n                    deliveryMode: {\n                        transportType: 'PubNub'\n                    }\n                }),\n                json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.subscribeSuccess, response);\n\n            return response;\n\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.subscribeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async renew() {\n\n        try {\n\n            this._clearTimeout();\n\n            if (!this.subscribed()) throw new Error('No subscription');\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.put('/subscription/' + this.subscription().id, {\n                eventFilters: this._getFullEventFilters()\n            });\n\n            var json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.renewSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.renewError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async remove() {\n\n        try {\n\n            if (!this.subscribed()) throw new Error('No subscription');\n\n            var response = await this._platform.delete('/subscription/' + this.subscription().id);\n\n            this.reset()\n                .emit(this.events.removeSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.emit(this.events.removeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    resubscribe() {\n        var filters = this.eventFilters();\n        return this.reset().setEventFilters(filters).subscribe();\n    }\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n    reset() {\n        this._clearTimeout();\n        if (this.subscribed() && this._pubnub) this._pubnub.unsubscribe({channel: this.subscription().deliveryMode.address});\n        this._setSubscription(null);\n        return this;\n    }\n\n    _setSubscription(subscription) {\n        this._subscription = subscription;\n    }\n\n    _getFullEventFilters() {\n\n        return this.eventFilters().map((event) => {\n            return this._platform.createUrl(event);\n        });\n\n    }\n\n    _setTimeout() {\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        this._timeout = setInterval(()=> {\n\n            if (this.alive()) return;\n\n            if (this.expired()) {\n                this.subscribe();\n            } else {\n                this.renew();\n            }\n\n        }, Subscription._pollInterval);\n\n        return this;\n\n    }\n\n    _clearTimeout() {\n        clearInterval(this._timeout);\n        return this;\n    }\n\n    _decrypt(message) {\n\n        if (!this.subscribed()) throw new Error('No subscription');\n\n        if (this.subscription().deliveryMode.encryptionKey) {\n\n            message = this._pubnubFactory.crypto_obj.decrypt(message, this.subscription().deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n\n        }\n\n        return message;\n\n    }\n\n    _notify(message) {\n        this.emit(this.events.notification, this._decrypt(message));\n        return this;\n    }\n\n    _subscribeAtPubnub() {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var deliveryMode = this.subscription().deliveryMode;\n\n        if (this._pubnub) {\n\n            if (this._pubnubLastChannel == deliveryMode.address) { // Nothing to update, keep listening to same channel\n                return this;\n            } else if (this._pubnubLastChannel) { // Need to subscribe to new channel\n                this._pubnub.unsubscribe({channel: this._pubnubLastChannel});\n            }\n\n            // Re-init for new data\n            this._pubnub = this._pubnub.init({\n                ssl: true,\n                subscribe_key: deliveryMode.subscriberKey\n            });\n\n        } else {\n\n            // Init from scratch\n            this._pubnub = this._pubnubFactory.init({\n                ssl: true,\n                subscribe_key: deliveryMode.subscriberKey\n            });\n\n            this._pubnub.ready(); //TODO This may be not needed anymore\n\n        }\n\n        this._pubnubLastChannel = deliveryMode.address;\n\n        this._pubnub.subscribe({\n            channel: deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: () => {}\n        });\n\n        return this;\n\n    }\n\n}\n\n//export interface ISubscription {\n//    id?:string;\n//    uri?: string;\n//    eventFilters?:string[];\n//    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n//    expiresIn?:number;\n//    deliveryMode?: {\n//        transportType?:string;\n//        encryption?:boolean;\n//        address?:string;\n//        subscriberKey?:string;\n//        encryptionKey?:string;\n//        secretKey?:string;\n//    };\n//    creationTime?:string; // 2014-03-12T19:54:35.613Z\n//    status?:string; // Active\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/Subscription.js\n **/","import Subscription from \"./Subscription\";\n\nexport default class CachedSubscription extends Subscription {\n\n    constructor(pubnubFactory, platform, cache, cacheKey) {\n\n        super(pubnubFactory, platform);\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheKey = cacheKey;\n\n    }\n\n    subscription() {\n        return this._cache.getItem(this._cacheKey) || {};\n    }\n\n    _setSubscription(subscription) {\n        return this._cache.setItem(this._cacheKey, subscription);\n    }\n\n    /**\n     * This function checks whether there are any pre-defined eventFilters in cache and if not -- uses provided as defaults\n     * @param {string[]} events\n     * @return {CachedSubscription}\n     */\n    restore(events) {\n\n        if (!this.eventFilters().length) {\n            this.setEventFilters(events);\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/CachedSubscription.js\n **/"],"sourceRoot":""}