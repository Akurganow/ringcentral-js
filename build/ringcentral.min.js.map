{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","ringcentral.js","webpack:/webpack/bootstrap 9b786c8af2a65d85b48f","webpack:///~/babel-regenerator-runtime/runtime.js","webpack:///src/SDK.js","webpack:///src/core/Utils.js","webpack:///src/core/Externals.js","webpack:/external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}","webpack:/external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}","webpack:/external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}","webpack:///src/core/Cache.js","webpack:///src/core/Observable.js","webpack:///src/core/Queue.js","webpack:///src/http/Client.js","webpack:///src/http/Utils.js","webpack:///src/http/ApiResponse.js","webpack:///src/mocks/ClientMock.js","webpack:///src/mocks/Registry.js","webpack:///src/mocks/Mock.js","webpack:///src/platform/Platform.js","webpack:///src/platform/Auth.js","webpack:///src/pubnub/PubnubFactory.js","webpack:///src/pubnub/PubnubMock.js","webpack:///src/subscription/Subscription.js","webpack:///src/subscription/CachedSubscription.js"],"names":["root","factory","exports","module","require","define","amd","undefined","this","__WEBPACK_EXTERNAL_MODULE_5__","__WEBPACK_EXTERNAL_MODULE_6__","__WEBPACK_EXTERNAL_MODULE_7__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","global","wrap","innerFn","outerFn","self","tryLocsList","generator","Object","create","Generator","prototype","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","obj","arg","type","err","GeneratorFunction","GeneratorFunctionPrototype","defineIteratorMethods","forEach","method","AwaitArgument","AsyncIterator","invoke","result","value","Promise","resolve","then","invokeNext","invokeThrow","unwrapped","enqueue","callInvokeWithMethodAndArg","previousPromise","process","domain","bind","state","GenStateSuspendedStart","GenStateExecuting","Error","GenStateCompleted","doneResult","delegate","iterator","returnMethod","record","info","done","GenStateSuspendedYield","resultName","next","nextLoc","_sent","sent","dispatchException","abrupt","ContinueSentinel","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","values","iterable","iteratorMethod","iteratorSymbol","isNaN","length","i","hasOwn","hasOwnProperty","Symbol","inModule","runtime","regeneratorRuntime","Gp","constructor","displayName","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","async","iter","toString","keys","object","key","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","window","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","_Utils","Utils","_Cache","_Cache2","_Externals","Externals","_Observable","_Observable2","_Queue","_Queue2","_Client","_Client2","_ApiResponse","_ApiResponse2","_Utils2","HttpUtils","_ClientMock","_ClientMock2","_Mock","_Mock2","_Registry","_Registry2","_Platform","_Platform2","_Auth","_Auth2","_PubnubFactory","_PubnubFactory2","_Subscription","_Subscription2","_CachedSubscription","_CachedSubscription2","SDK","options","_cache","localStorage","cachePrefix","_client","client","_platform","server","appKey","appSecret","_pubnubFactory","pubnubFactory","PUBNUB","cacheKey","version","sandbox","production","core","Cache","Observable","Queue","http","Client","ApiResponse","platform","Auth","Platform","subscription","Subscription","mocks","Registry","Mock","pubnub","PubnubMockFactory","queryStringify","parameters","array","k","v","isArray","vv","encodeURIComponent","join","parseQueryString","queryString","argsParsed","split","decodeURIComponent","indexOf","trim","pair","isFunction","Array","poll","interval","timeout","stopPolling","delay","setTimeout","clearTimeout","isNodeJS","isBrowser","reject","Headers","Response","Request","fetch","_es6Promise","_es6Promise2","_nodeFetch","_nodeFetch2","_pubnub","_pubnub2","Function","storage","prefix","setPrefix","_storage","_prefix","defaultPrefix","data","_prefixKey","JSON","stringify","item","parse","off","event","_listeners","events","callback","_this","hasListeners","_this2","_len","arguments","args","_key","some","apply","_this3","cb","cache","cacheId","_cacheId","_promise","time","getItem","Date","now","parseInt","_releaseTimeout","setItem","removeItem","isPaused","resume","_pollInterval","_asyncToGenerator","gen","step","error","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","_Observable3","_Object$getPrototypeO","_temp","_ret","getPrototypeOf","concat","beforeRequest","requestSuccess","requestError","ref","_callee","request","apiResponse","_context","emit","_loadResponse","_response","_isMultipart","_isJson","response","text","_text","ok","t0","makeError","_x","_callee2","_context2","_x2","e","originalMessage","message","init","headers","url","_allowedMethods","credentials","mode","query","findHeaderName","_jsonContentType","body","contentTypeHeaderName","_contentType","contentType","_urlencodedContentType","req","originalBody","createResponse","stringBody","utils","_decode","toLowerCase","reduce","res","responseText","_request","_json","_multipart","skipOKCheck","status","statusText","json","error_description","description","boundary","_getContentType","match","parts","_boundarySeparator","shift","statusInfo","map","part","get","_isContentType","_multipartContentType","replace","headersAndBody","_bodySeparator","headersText","header","_headerSeparator","append","_HttpClient","_registry","mock","find","getResponse","_mocks","test","path","add","apiCall","access_token","token_type","expires_in","refresh_token","refresh_token_expires_in","scope","expireTime","getTime","uri","extension","extensionNumber","activeCalls","presenceStatus","telephonyStatus","userStatus","dndStatus","extensionId","expiresIn","date","eventFilters","expirationTime","toISOString","deliveryMode","transportType","encryption","address","subscriberKey","secretKey","creationTime","detailed","encryptionAlgorithm","encryptionKey","failure","_method","toUpperCase","_path","_delay","_status","_statusText","str","set","beforeLogin","loginSuccess","loginError","beforeRefresh","refreshSuccess","refreshError","beforeLogout","logoutSuccess","logoutError","_server","_appKey","_appSecret","_queue","_auth","builtUrl","hasHttp","addServer","_urlPrefix","_apiVersion","addMethod","addToken","accessToken","createUrl","_authorizeEndpoint","response_type","redirect_uri","redirectUri","client_id","brand_id","brandId","display","prompt","qs","_ensureAuthentication","remember","access_token_ttl","_accessTokenTtl","refresh_token_ttl","_refreshTokenTtlRemember","_refreshTokenTtl","code","grant_type","username","password","endpointId","endpoint_id","_tokenRequest","_tokenEndpoint","setData","setRemember","clean","_callee3","_context3","_isAccessTokenValid","pause","_refreshDelayMs","refreshToken","refreshTokenValid","_clearCacheOnRefreshError","_callee4","_context4","_revokeEndpoint","token","_callee5","_context5","skipAuthCheck","_authHeader","_x3","_callee6","_context6","inflateRequest","sendRequest","cancelAccessToken","_x4","_x5","_callee7","_context7","createRequest","_x6","_callee8","_context8","send","_x8","_x9","_x10","_callee9","_context9","_x11","_x12","_x13","_x14","_callee10","_context10","_x15","_x16","_x17","_x18","_callee11","_context11","_x19","_x20","_x21","_callee12","_context12","Authorization","_apiKey","Content-Type","_x22","_x23","_callee13","_context13","refresh","accessTokenValid","apiKey","btoa","Buffer","tokenType","newData","expire_time","refresh_token_expire_time","authData","forcedTokenType","refreshHandicapMs","_PubnubMock","_PubnubMock2","crypto_obj","PubnubMock","on","channel","msg","notification","removeSuccess","removeError","renewSuccess","renewError","subscribeSuccess","subscribeError","_timeout","_subscription","subscribed","_renewHandicapMs","_clearTimeout","_subscribeAtPubnub","_setTimeout","alive","renew","subscribe","setEventFilters","post","_getFullEventFilters","setSubscription","put","unsubscribe","decrypt","encryptKey","keyEncoding","keyLength","_decrypt","ssl","subscribe_key","ready","_notify","connect","_extends","assign","source","_get","property","receiver","desc","getOwnPropertyDescriptor","parent","getter","_Subscription3","CachedSubscription","_cacheKey","_renewQueue","_resubscribeQueue","queuedRenewSuccess","queuedRenewError","queuedResubscribeSuccess","queuedResubscribeError","resubscribe","actionCb","queue","successEvent","errorEvent","errorMessage","cachedSubscriptionData"],"mappings":"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","file":"ringcentral.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_7__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_7__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/build/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n__webpack_require__(1);\nmodule.exports = __webpack_require__(2);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          context._sent = arg;\n\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Utils = __webpack_require__(3);\n\nvar Utils = _interopRequireWildcard(_Utils);\n\nvar _Cache = __webpack_require__(8);\n\nvar _Cache2 = _interopRequireDefault(_Cache);\n\nvar _Externals = __webpack_require__(4);\n\nvar Externals = _interopRequireWildcard(_Externals);\n\nvar _Observable = __webpack_require__(9);\n\nvar _Observable2 = _interopRequireDefault(_Observable);\n\nvar _Queue = __webpack_require__(10);\n\nvar _Queue2 = _interopRequireDefault(_Queue);\n\nvar _Client = __webpack_require__(11);\n\nvar _Client2 = _interopRequireDefault(_Client);\n\nvar _ApiResponse = __webpack_require__(13);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nvar _Utils2 = __webpack_require__(12);\n\nvar HttpUtils = _interopRequireWildcard(_Utils2);\n\nvar _ClientMock = __webpack_require__(14);\n\nvar _ClientMock2 = _interopRequireDefault(_ClientMock);\n\nvar _Mock = __webpack_require__(16);\n\nvar _Mock2 = _interopRequireDefault(_Mock);\n\nvar _Registry = __webpack_require__(15);\n\nvar _Registry2 = _interopRequireDefault(_Registry);\n\nvar _Platform = __webpack_require__(17);\n\nvar _Platform2 = _interopRequireDefault(_Platform);\n\nvar _Auth = __webpack_require__(18);\n\nvar _Auth2 = _interopRequireDefault(_Auth);\n\nvar _PubnubFactory = __webpack_require__(19);\n\nvar _PubnubFactory2 = _interopRequireDefault(_PubnubFactory);\n\nvar _Subscription = __webpack_require__(21);\n\nvar _Subscription2 = _interopRequireDefault(_Subscription);\n\nvar _CachedSubscription = __webpack_require__(22);\n\nvar _CachedSubscription2 = _interopRequireDefault(_CachedSubscription);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SDK = (function () {\n\n    /**\n     * @constructor\n     * @param {object} [options]\n     * @param {string} [options.server]\n     * @param {string} [options.cachePrefix]\n     * @param {string} [options.appSecret]\n     * @param {string} [options.appKey]\n     * @param {string} [options.appName]\n     * @param {string} [options.appVersion]\n     * @param {string} [options.pubnubFactory]\n     * @param {string} [options.client]\n     */\n\n    function SDK(options) {\n        _classCallCheck(this, SDK);\n\n        options = options || {};\n\n        this._cache = new _Cache2.default(Externals.localStorage, options.cachePrefix);\n\n        this._client = options.client || new _Client2.default();\n\n        this._platform = new _Platform2.default(this._client, this._cache, options.server, options.appKey, options.appSecret);\n\n        this._pubnubFactory = options.pubnubFactory || Externals.PUBNUB;\n    }\n\n    /**\n     * @return {Platform}\n     */\n\n    _createClass(SDK, [{\n        key: 'platform',\n        value: function platform() {\n            return this._platform;\n        }\n\n        /**\n         * @return {Subscription}\n         */\n\n    }, {\n        key: 'createSubscription',\n        value: function createSubscription() {\n            return new _Subscription2.default(this._pubnubFactory, this._platform);\n        }\n\n        /**\n         * @return {CachedSubscription}\n         */\n\n    }, {\n        key: 'createCachedSubscription',\n        value: function createCachedSubscription(cacheKey) {\n            return new _CachedSubscription2.default(this._pubnubFactory, this._platform, this._cache, cacheKey);\n        }\n\n        /**\n         * @return {Cache}\n         */\n\n    }, {\n        key: 'cache',\n        value: function cache() {\n            return this._cache;\n        }\n    }]);\n\n    return SDK;\n})();\n\nSDK.version = '2.0.1';\nSDK.server = {\n    sandbox: 'https://platform.devtest.ringcentral.com',\n    production: 'https://platform.ringcentral.com'\n};\nSDK.core = {\n    Cache: _Cache2.default,\n    Observable: _Observable2.default,\n    Utils: Utils,\n    Externals: Externals,\n    Queue: _Queue2.default\n};\nSDK.http = {\n    Client: _Client2.default,\n    ApiResponse: _ApiResponse2.default,\n    Utils: HttpUtils\n};\nSDK.platform = {\n    Auth: _Auth2.default,\n    Platform: _Platform2.default\n};\nSDK.subscription = {\n    Subscription: _Subscription2.default\n};\nSDK.mocks = {\n    Client: _ClientMock2.default,\n    Registry: _Registry2.default,\n    Mock: _Mock2.default\n};\nSDK.pubnub = {\n    PubnubMockFactory: _PubnubFactory2.default\n};\nexports.default = SDK;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.queryStringify = queryStringify;\nexports.parseQueryString = parseQueryString;\nexports.isFunction = isFunction;\nexports.isArray = isArray;\nexports.poll = poll;\nexports.stopPolling = stopPolling;\nexports.isNodeJS = isNodeJS;\nexports.isBrowser = isBrowser;\nexports.delay = delay;\n\nvar _Externals = __webpack_require__(4);\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {object} parameters\n * @returns {string}\n */\nfunction queryStringify(parameters) {\n\n    var array = [];\n\n    parameters = parameters || {};\n\n    Object.keys(parameters).forEach(function (k) {\n\n        var v = parameters[k];\n\n        if (isArray(v)) {\n            v.forEach(function (vv) {\n                array.push(encodeURIComponent(k) + '=' + encodeURIComponent(vv));\n            });\n        } else {\n            array.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n        }\n    });\n\n    return array.join('&');\n}\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {string} queryString\n * @returns {object}\n */\nfunction parseQueryString(queryString) {\n\n    var argsParsed = {};\n\n    queryString.split('&').forEach(function (arg) {\n\n        arg = decodeURIComponent(arg);\n\n        if (arg.indexOf('=') == -1) {\n\n            argsParsed[arg.trim()] = true;\n        } else {\n\n            var pair = arg.split('='),\n                key = pair[0].trim(),\n                value = pair[1].trim();\n\n            if (key in argsParsed) {\n                if (key in argsParsed && !isArray(argsParsed[key])) argsParsed[key] = [argsParsed[key]];\n                argsParsed[key].push(value);\n            } else {\n                argsParsed[key] = value;\n            }\n        }\n    });\n\n    return argsParsed;\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nfunction isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nfunction isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\n/**\n * @param fn\n * @param interval\n * @param timeout\n */\nfunction poll(fn, interval, timeout) {\n    //NodeJS.Timer|number\n\n    module.exports.stopPolling(timeout);\n\n    interval = interval || 1000;\n\n    var next = function next(delay) {\n\n        delay = delay || interval;\n\n        interval = delay;\n\n        return setTimeout(function () {\n\n            fn(next, delay);\n        }, delay);\n    };\n\n    return next();\n}\n\nfunction stopPolling(timeout) {\n    if (timeout) clearTimeout(timeout);\n}\n\nfunction isNodeJS() {\n    return typeof process !== 'undefined';\n}\n\nfunction isBrowser() {\n    return typeof window !== 'undefined';\n}\n\nfunction delay(timeout) {\n    return new _Externals.Promise(function (resolve, reject) {\n        setTimeout(function () {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.localStorage = exports.PUBNUB = exports.Headers = exports.Response = exports.Request = exports.fetch = exports.Promise = undefined;\n\nvar _es6Promise = __webpack_require__(5);\n\nvar _es6Promise2 = _interopRequireDefault(_es6Promise);\n\nvar _nodeFetch = __webpack_require__(6);\n\nvar _nodeFetch2 = _interopRequireDefault(_nodeFetch);\n\nvar _pubnub = __webpack_require__(7);\n\nvar _pubnub2 = _interopRequireDefault(_pubnub);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar root = new Function('return this')();\n\nvar Promise = exports.Promise = _es6Promise2.default && _es6Promise2.default.Promise || root.Promise;\n\nvar fetch = exports.fetch = root.fetch || _nodeFetch2.default;\nvar Request = exports.Request = root.Request || fetch.Request;\nvar Response = exports.Response = root.Response || fetch.Response;\nvar Headers = exports.Headers = root.Headers || fetch.Headers;\n\nvar PUBNUB = exports.PUBNUB = root.PUBNUB || _pubnub2.default;\n\nvar localStorage = exports.localStorage = typeof root.localStorage !== 'undefined' ? root.localStorage : {};\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Cache = (function () {\n    function Cache(storage, prefix) {\n        _classCallCheck(this, Cache);\n\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    _createClass(Cache, [{\n        key: 'setPrefix',\n        value: function setPrefix(prefix) {\n            this._prefix = prefix || Cache.defaultPrefix;\n            return this;\n        }\n    }, {\n        key: 'setItem',\n        value: function setItem(key, data) {\n            this._storage[this._prefixKey(key)] = JSON.stringify(data);\n            return this;\n        }\n    }, {\n        key: 'removeItem',\n        value: function removeItem(key) {\n            delete this._storage[this._prefixKey(key)];\n            return this;\n        }\n    }, {\n        key: 'getItem',\n        value: function getItem(key) {\n            var item = this._storage[this._prefixKey(key)];\n            if (!item) return null;\n            return JSON.parse(item);\n        }\n    }, {\n        key: 'clean',\n        value: function clean() {\n\n            for (var key in this._storage) {\n\n                if (!this._storage.hasOwnProperty(key)) continue;\n\n                if (key.indexOf(this._prefix) === 0) {\n                    delete this._storage[key];\n                }\n            }\n\n            return this;\n        }\n    }, {\n        key: '_prefixKey',\n        value: function _prefixKey(key) {\n            return this._prefix + key;\n        }\n    }]);\n\n    return Cache;\n})();\n\nCache.defaultPrefix = 'rc-';\nexports.default = Cache;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Observable = (function () {\n    function Observable() {\n        _classCallCheck(this, Observable);\n\n        this.off();\n    }\n\n    _createClass(Observable, [{\n        key: 'hasListeners',\n        value: function hasListeners(event) {\n            return event in this._listeners;\n        }\n    }, {\n        key: 'on',\n        value: function on(events, callback) {\n            var _this = this;\n\n            if (typeof events == 'string') events = [events];\n            if (!events) throw new Error('No events to subscribe to');\n            if (typeof callback !== 'function') throw new Error('Callback must be a function');\n\n            events.forEach(function (event) {\n\n                if (!_this.hasListeners(event)) _this._listeners[event] = [];\n\n                _this._listeners[event].push(callback);\n            });\n\n            return this;\n        }\n    }, {\n        key: 'emit',\n        value: function emit(event) {\n            var _this2 = this;\n\n            for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                args[_key - 1] = arguments[_key];\n            }\n\n            var result = null;\n\n            if (!this.hasListeners(event)) return null;\n\n            this._listeners[event].some(function (callback) {\n\n                result = callback.apply(_this2, args);\n                return result === false;\n            });\n\n            return result;\n        }\n    }, {\n        key: 'off',\n        value: function off(event, callback) {\n            var _this3 = this;\n\n            if (!event) {\n\n                this._listeners = {};\n            } else {\n\n                if (!callback) {\n\n                    delete this._listeners[event];\n                } else {\n\n                    if (!this.hasListeners(event)) return this;\n\n                    this._listeners[event].forEach(function (cb, i) {\n\n                        if (cb === callback) delete _this3._listeners[event][i];\n                    });\n                }\n            }\n\n            return this;\n        }\n    }]);\n\n    return Observable;\n})();\n\nexports.default = Observable;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Externals = __webpack_require__(4);\n\nvar _Utils = __webpack_require__(3);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Queue = (function () {\n    function Queue(cache, cacheId) {\n        _classCallCheck(this, Queue);\n\n        this._cache = cache;\n        this._cacheId = cacheId;\n        this._promise = null;\n    }\n\n    _createClass(Queue, [{\n        key: 'isPaused',\n        value: function isPaused() {\n\n            var time = this._cache.getItem(this._cacheId);\n\n            return !!time && Date.now() - parseInt(time) < Queue._releaseTimeout;\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._cache.setItem(this._cacheId, Date.now());\n            return this;\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            this._cache.removeItem(this._cacheId);\n            return this;\n        }\n    }, {\n        key: 'poll',\n        value: function poll() {\n            var _this = this;\n\n            if (this._promise) return this._promise;\n\n            this._promise = new _Externals.Promise(function (resolve, reject) {\n\n                (0, _Utils.poll)(function (next) {\n\n                    if (_this.isPaused()) return next();\n\n                    _this._promise = null;\n\n                    _this.resume(); // this is actually not needed but why not\n\n                    resolve(null);\n                }, Queue._pollInterval);\n            });\n\n            return this._promise;\n        }\n    }]);\n\n    return Queue;\n})();\n\nQueue._pollInterval = 250;\nQueue._releaseTimeout = 5000;\nexports.default = Queue;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Externals = __webpack_require__(4);\n\nvar _Utils = __webpack_require__(3);\n\nvar _Utils2 = __webpack_require__(12);\n\nvar _Observable2 = __webpack_require__(9);\n\nvar _Observable3 = _interopRequireDefault(_Observable2);\n\nvar _ApiResponse = __webpack_require__(13);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _Externals.Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { _Externals.Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Client = (function (_Observable) {\n    _inherits(Client, _Observable);\n\n    function Client() {\n        var _Object$getPrototypeO;\n\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, Client);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_Object$getPrototypeO = Object.getPrototypeOf(Client)).call.apply(_Object$getPrototypeO, [this].concat(args))), _this), _this.events = {\n            beforeRequest: 'beforeRequest',\n            requestSuccess: 'requestSuccess',\n            requestError: 'requestError'\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    _createClass(Client, [{\n        key: 'sendRequest',\n\n        /**\n         * @param {Request} request\n         * @return {Promise<ApiResponse>}\n         */\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(request) {\n                var apiResponse;\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                apiResponse = new _ApiResponse2.default(request);\n                                _context.prev = 1;\n\n                                //TODO Stop request if listeners return false\n                                this.emit(this.events.beforeRequest, apiResponse);\n\n                                _context.next = 5;\n                                return this._loadResponse(request);\n\n                            case 5:\n                                apiResponse._response = _context.sent;\n\n                                if (!(apiResponse._isMultipart() || apiResponse._isJson())) {\n                                    _context.next = 10;\n                                    break;\n                                }\n\n                                _context.next = 9;\n                                return apiResponse.response().text();\n\n                            case 9:\n                                apiResponse._text = _context.sent;\n\n                            case 10:\n                                if (apiResponse.ok()) {\n                                    _context.next = 12;\n                                    break;\n                                }\n\n                                throw new Error('Response has unsuccessful status');\n\n                            case 12:\n\n                                this.emit(this.events.requestSuccess, apiResponse);\n\n                                return _context.abrupt('return', apiResponse);\n\n                            case 16:\n                                _context.prev = 16;\n                                _context.t0 = _context['catch'](1);\n\n                                if (!_context.t0.apiResponse) _context.t0 = this.makeError(_context.t0, apiResponse);\n\n                                this.emit(this.events.requestError, _context.t0);\n\n                                throw _context.t0;\n\n                            case 21:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this, [[1, 16]]);\n            }));\n\n            return function sendRequest(_x) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {Request} request\n         * @return {Promise<Response>}\n         * @private\n         */\n\n    }, {\n        key: '_loadResponse',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(request) {\n                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                        switch (_context2.prev = _context2.next) {\n                            case 0:\n                                _context2.next = 2;\n                                return _Externals.fetch.call(null, request);\n\n                            case 2:\n                                return _context2.abrupt('return', _context2.sent);\n\n                            case 3:\n                            case 'end':\n                                return _context2.stop();\n                        }\n                    }\n                }, _callee2, this);\n            }));\n\n            return function _loadResponse(_x2) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * Wraps the JS Error object with transaction information\n         * @param {Error|IApiError} e\n         * @param {ApiResponse} apiResponse\n         * @return {IApiError}\n         */\n\n    }, {\n        key: 'makeError',\n        value: function makeError(e, apiResponse) {\n\n            // Wrap only if regular error\n            if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n                e.apiResponse = apiResponse;\n                e.originalMessage = e.message;\n                e.message = apiResponse && apiResponse.error(true) || e.originalMessage;\n            }\n\n            return e;\n        }\n\n        /**\n         *\n         * @param {object} init\n         * @param {object} [init.url]\n         * @param {object} [init.body]\n         * @param {string} [init.method]\n         * @param {object} [init.query]\n         * @param {object} [init.headers]\n         * @return {Request}\n         */\n\n    }, {\n        key: 'createRequest',\n        value: function createRequest(init) {\n\n            init = init || {};\n            init.headers = init.headers || {};\n\n            // Sanity checks\n            if (!init.url) throw new Error('Url is not defined');\n            if (!init.method) init.method = 'GET';\n            if (init.method && Client._allowedMethods.indexOf(init.method) < 0) throw new Error('Method has wrong value: ' + init.method);\n\n            // Defaults\n            init.credentials = init.credentials || 'include';\n            init.mode = init.mode || 'cors';\n\n            // Append Query String\n            if (init.query) {\n                init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + (0, _Utils.queryStringify)(init.query);\n            }\n\n            if (!(0, _Utils2.findHeaderName)('Accept', init.headers)) {\n                init.headers['Accept'] = _ApiResponse2.default._jsonContentType;\n            }\n\n            // Serialize body\n            //TODO Check that body is a plain object\n            if (typeof init.body !== 'string' || !init.body) {\n\n                var contentTypeHeaderName = (0, _Utils2.findHeaderName)(_ApiResponse2.default._contentType, init.headers);\n\n                if (!contentTypeHeaderName) {\n                    contentTypeHeaderName = _ApiResponse2.default._contentType;\n                    init.headers[contentTypeHeaderName] = _ApiResponse2.default._jsonContentType;\n                }\n\n                var contentType = init.headers[contentTypeHeaderName];\n\n                // Assign a new encoded body\n                if (contentType.indexOf(_ApiResponse2.default._jsonContentType) > -1) {\n                    init.body = JSON.stringify(init.body);\n                } else if (contentType.indexOf(_ApiResponse2.default._urlencodedContentType) > -1) {\n                    init.body = (0, _Utils.queryStringify)(init.body);\n                }\n            }\n\n            // Create a request with encoded body\n            var req = new _Externals.Request(init.url, init);\n\n            // Keep the original body accessible directly (for mocks)\n            req.originalBody = init.body;\n\n            return req;\n        }\n    }]);\n\n    return Client;\n})(_Observable3.default);\n\n/**\n * @name IApiError\n * @property {string} stack\n * @property {string} originalMessage\n * @property {ApiResponse} apiResponse\n */\n\nClient._allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'];\nexports.default = Client;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.createResponse = createResponse;\nexports.findHeaderName = findHeaderName;\n\nvar _Externals = __webpack_require__(4);\n\nvar _Utils = __webpack_require__(3);\n\nvar utils = _interopRequireWildcard(_Utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\n * Creates a response\n * @param stringBody\n * @param init\n * @return {Response}\n */\nfunction createResponse(stringBody, init) {\n\n    init = init || {};\n\n    var response = new _Externals.Response(stringBody, init);\n\n    //TODO Wait for https://github.com/bitinn/node-fetch/issues/38\n    if (utils.isNodeJS()) {\n\n        response._text = stringBody;\n        response._decode = function () {\n            return this._text;\n        };\n    }\n\n    return response;\n}\n\nfunction findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function (res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Externals = __webpack_require__(4);\n\nvar _Utils = __webpack_require__(12);\n\nvar utils = _interopRequireWildcard(_Utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ApiResponse = (function () {\n\n    /**\n     * @param {Request} request\n     * @param {Response} response\n     * @param {string} responseText\n     */\n\n    function ApiResponse(request, response, responseText) {\n        _classCallCheck(this, ApiResponse);\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n    }\n\n    /**\n     * @return {Response}\n     */\n\n    _createClass(ApiResponse, [{\n        key: 'response',\n        value: function response() {\n            return this._response;\n        }\n\n        /**\n         * @return {Request}\n         */\n\n    }, {\n        key: 'request',\n        value: function request() {\n            return this._request;\n        }\n\n        /**\n         * @return {boolean}\n         */\n\n    }, {\n        key: 'ok',\n        value: function ok() {\n            return this._response && this._response.ok;\n        }\n\n        /**\n         * @return {string}\n         */\n\n    }, {\n        key: 'text',\n        value: function text() {\n            if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n            return this._text;\n        }\n\n        /**\n         * @return {object}\n         */\n\n    }, {\n        key: 'json',\n        value: function json() {\n            if (!this._isJson()) throw new Error('Response is not JSON');\n            if (!this._json) {\n                this._json = this._text ? JSON.parse(this._text) : null;\n            }\n            return this._json;\n        }\n\n        /**\n         * @param [skipOKCheck]\n         * @return {string}\n         */\n\n    }, {\n        key: 'error',\n        value: function error(skipOKCheck) {\n\n            if (this.ok() && !skipOKCheck) return null;\n\n            var message = (this._response && this._response.status ? this._response.status + ' ' : '') + (this._response && this._response.statusText ? this._response.statusText : '');\n\n            try {\n\n                if (this.json().message) message = this.json().message;\n                if (this.json().error_description) message = this.json().error_description;\n                if (this.json().description) message = this.json().description;\n            } catch (e) {}\n\n            return message;\n        }\n\n        /**\n         * @return {ApiResponse[]}\n         */\n\n    }, {\n        key: 'multipart',\n        value: function multipart() {\n\n            if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n            if (!this._multipart.length) {\n\n                // Step 1. Split multipart response\n\n                var text = this.text();\n\n                if (!text) throw new Error('No response body');\n\n                var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n                if (!boundary) throw new Error('Cannot find boundary');\n\n                var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n                if (parts[0].trim() === '') parts.shift();\n                if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n                if (parts.length < 1) throw new Error('No parts in body');\n\n                // Step 2. Parse status info\n\n                var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n                // Step 3. Parse all other parts\n\n                this._multipart = parts.map(function (part, i) {\n\n                    var status = statusInfo.response[i].status;\n\n                    return ApiResponse.create(part, status);\n                });\n            }\n\n            return this._multipart;\n        }\n    }, {\n        key: '_isContentType',\n        value: function _isContentType(contentType) {\n            return this._getContentType().indexOf(contentType) > -1;\n        }\n    }, {\n        key: '_getContentType',\n        value: function _getContentType() {\n            return this._response.headers.get(ApiResponse._contentType) || '';\n        }\n    }, {\n        key: '_isMultipart',\n        value: function _isMultipart() {\n            return this._isContentType(ApiResponse._multipartContentType);\n        }\n    }, {\n        key: '_isUrlEncoded',\n        value: function _isUrlEncoded() {\n            return this._isContentType(ApiResponse._urlencodedContentType);\n        }\n    }, {\n        key: '_isJson',\n        value: function _isJson() {\n            return this._isContentType(ApiResponse._jsonContentType);\n        }\n\n        /**\n         * Method is used to create ApiResponse object from string parts of multipart/mixed response\n         * @param {string} [text]\n         * @param {number} [status]\n         * @param {string} [statusText]\n         * @return {ApiResponse}\n         */\n\n    }], [{\n        key: 'create',\n        value: function create(text, status, statusText) {\n\n            text = text || '';\n            status = status || 200;\n            statusText = statusText || 'OK';\n\n            text = text.replace(/\\r/g, '');\n\n            var headers = new _Externals.Headers(),\n                headersAndBody = text.split(ApiResponse._bodySeparator),\n                headersText = headersAndBody.length > 1 ? headersAndBody.shift() : '';\n\n            text = headersAndBody.join(ApiResponse._bodySeparator);\n\n            (headersText || '').split('\\n').forEach(function (header) {\n\n                var split = header.trim().split(ApiResponse._headerSeparator),\n                    key = split.shift().trim(),\n                    value = split.join(ApiResponse._headerSeparator).trim();\n\n                if (key) headers.append(key, value);\n            });\n\n            return new ApiResponse(null, utils.createResponse(text, {\n                headers: headers,\n                status: status,\n                statusText: statusText\n            }), text);\n        }\n    }]);\n\n    return ApiResponse;\n})();\n\nApiResponse._contentType = 'Content-Type';\nApiResponse._jsonContentType = 'application/json';\nApiResponse._multipartContentType = 'multipart/mixed';\nApiResponse._urlencodedContentType = 'application/x-www-form-urlencoded';\nApiResponse._headerSeparator = ':';\nApiResponse._bodySeparator = '\\n\\n';\nApiResponse._boundarySeparator = '--';\nexports.default = ApiResponse;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Registry = __webpack_require__(15);\n\nvar _Registry2 = _interopRequireDefault(_Registry);\n\nvar _Client = __webpack_require__(11);\n\nvar _Client2 = _interopRequireDefault(_Client);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Client = (function (_HttpClient) {\n    _inherits(Client, _HttpClient);\n\n    function Client() {\n        _classCallCheck(this, Client);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Client).call(this));\n\n        _this._registry = new _Registry2.default();\n        return _this;\n    }\n\n    _createClass(Client, [{\n        key: 'registry',\n        value: function registry() {\n            return this._registry;\n        }\n    }, {\n        key: '_loadResponse',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(request) {\n                var mock;\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                mock = this._registry.find(request);\n                                _context.next = 3;\n                                return mock.getResponse(request);\n\n                            case 3:\n                                return _context.abrupt('return', _context.sent);\n\n                            case 4:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this);\n            }));\n\n            return function _loadResponse(_x) {\n                return ref.apply(this, arguments);\n            };\n        })()\n    }]);\n\n    return Client;\n})(_Client2.default);\n\nexports.default = Client;\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Mock = __webpack_require__(16);\n\nvar _Mock2 = _interopRequireDefault(_Mock);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Registry = (function () {\n    function Registry() {\n        _classCallCheck(this, Registry);\n\n        this._mocks = [];\n    }\n\n    _createClass(Registry, [{\n        key: 'add',\n        value: function add(mock) {\n            this._mocks.push(mock);\n            return this;\n        }\n    }, {\n        key: 'clear',\n        value: function clear() {\n            this._mocks = [];\n            return this;\n        }\n    }, {\n        key: 'find',\n        value: function find(request) {\n\n            //console.log('Registry is looking for', request);\n\n            var mock = this._mocks.shift();\n\n            if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n            if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url + ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n            return mock;\n        }\n    }, {\n        key: 'apiCall',\n        value: function apiCall(method, path, response, status, statusText) {\n\n            this.add(new _Mock2.default(method, path, response, status, statusText));\n\n            return this;\n        }\n    }, {\n        key: 'authentication',\n        value: function authentication() {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo',\n                'expireTime': new Date().getTime() + 3600000\n            });\n\n            return this;\n        }\n    }, {\n        key: 'logout',\n        value: function logout() {\n\n            this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n            return this;\n        }\n    }, {\n        key: 'presenceLoad',\n        value: function presenceLoad(id) {\n\n            this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n                \"extension\": {\n                    \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                    \"id\": id,\n                    \"extensionNumber\": \"101\"\n                },\n                \"activeCalls\": [],\n                \"presenceStatus\": \"Available\",\n                \"telephonyStatus\": \"Ringing\",\n                \"userStatus\": \"Available\",\n                \"dndStatus\": \"TakeAllCalls\",\n                \"extensionId\": id\n            });\n\n            return this;\n        }\n    }, {\n        key: 'subscribeGeneric',\n        value: function subscribeGeneric(expiresIn) {\n\n            expiresIn = expiresIn || 15 * 60 * 60;\n\n            var date = new Date();\n\n            this.apiCall('POST', '/restapi/v1.0/subscription', {\n                'eventFilters': ['/restapi/v1.0/account/~/extension/~/presence'],\n                'expirationTime': new Date(date.getTime() + expiresIn * 1000).toISOString(),\n                'expiresIn': expiresIn,\n                'deliveryMode': {\n                    'transportType': 'PubNub',\n                    'encryption': false,\n                    'address': '123_foo',\n                    'subscriberKey': 'sub-c-foo',\n                    'secretKey': 'sec-c-bar'\n                },\n                'id': 'foo-bar-baz',\n                'creationTime': date.toISOString(),\n                'status': 'Active',\n                'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n            });\n\n            return this;\n        }\n    }, {\n        key: 'subscribeOnPresence',\n        value: function subscribeOnPresence(id, detailed) {\n\n            id = id || '1';\n\n            var date = new Date();\n\n            this.apiCall('POST', '/restapi/v1.0/subscription', {\n                'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n                'expirationTime': new Date(date.getTime() + 15 * 60 * 60 * 1000).toISOString(),\n                'deliveryMode': {\n                    'transportType': 'PubNub',\n                    'encryption': true,\n                    'address': '123_foo',\n                    'subscriberKey': 'sub-c-foo',\n                    'secretKey': 'sec-c-bar',\n                    'encryptionAlgorithm': 'AES',\n                    'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n                },\n                'creationTime': date.toISOString(),\n                'id': 'foo-bar-baz',\n                'status': 'Active',\n                'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n            });\n\n            return this;\n        }\n    }, {\n        key: 'tokenRefresh',\n        value: function tokenRefresh(failure) {\n\n            if (!failure) {\n\n                this.apiCall('POST', '/restapi/oauth/token', {\n                    'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                    'token_type': 'bearer',\n                    'expires_in': 3600,\n                    'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                    'refresh_token_expires_in': 60480,\n                    'scope': 'SMS RCM Foo Boo'\n                });\n            } else {\n\n                this.apiCall('POST', '/restapi/oauth/token', {\n                    'message': 'Wrong token',\n                    'error_description': 'Wrong token',\n                    'description': 'Wrong token'\n                }, 400);\n            }\n\n            return this;\n        }\n    }]);\n\n    return Registry;\n})();\n\nexports.default = Registry;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ApiResponse = __webpack_require__(13);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nvar _Utils = __webpack_require__(3);\n\nvar _Utils2 = __webpack_require__(12);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Mock = (function () {\n    function Mock(method, path, json, status, statusText, delay) {\n        _classCallCheck(this, Mock);\n\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    _createClass(Mock, [{\n        key: 'path',\n        value: function path() {\n            return this._path;\n        }\n    }, {\n        key: 'method',\n        value: function method() {\n            return this._method;\n        }\n    }, {\n        key: 'test',\n        value: function test(request) {\n\n            return request.url.indexOf(this._path) > -1 && request.method.toUpperCase() == this._method;\n        }\n    }, {\n        key: 'getResponse',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(request) {\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                _context.next = 2;\n                                return (0, _Utils.delay)(this._delay);\n\n                            case 2:\n                                return _context.abrupt('return', this.createResponse(this._json));\n\n                            case 3:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this);\n            }));\n\n            return function getResponse(_x) {\n                return ref.apply(this, arguments);\n            };\n        })()\n    }, {\n        key: 'createResponse',\n        value: function createResponse(json, init) {\n\n            init = init || {};\n\n            init.status = init.status || this._status;\n            init.statusText = init.statusText || this._statusText;\n\n            var str = JSON.stringify(json),\n                res = (0, _Utils2.createResponse)(str, init);\n\n            res.headers.set(_ApiResponse2.default._contentType, _ApiResponse2.default._jsonContentType);\n\n            return res;\n        }\n    }]);\n\n    return Mock;\n})();\n\nexports.default = Mock;\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Observable2 = __webpack_require__(9);\n\nvar _Observable3 = _interopRequireDefault(_Observable2);\n\nvar _Queue = __webpack_require__(10);\n\nvar _Queue2 = _interopRequireDefault(_Queue);\n\nvar _Auth = __webpack_require__(18);\n\nvar _Auth2 = _interopRequireDefault(_Auth);\n\nvar _Externals = __webpack_require__(4);\n\nvar _Utils = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _Externals.Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { _Externals.Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Platform = (function (_Observable) {\n    _inherits(Platform, _Observable);\n\n    // 10 hours\n\n    function Platform(client, cache, server, appKey, appSecret) {\n        _classCallCheck(this, Platform);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Platform).call(this));\n\n        _this.events = {\n            beforeLogin: 'beforeLogin',\n            loginSuccess: 'loginSuccess',\n            loginError: 'loginError',\n            beforeRefresh: 'beforeRefresh',\n            refreshSuccess: 'refreshSuccess',\n            refreshError: 'refreshError',\n            beforeLogout: 'beforeLogout',\n            logoutSuccess: 'logoutSuccess',\n            logoutError: 'logoutError'\n        };\n\n        _this._server = server;\n        _this._appKey = appKey;\n        _this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        _this._cache = cache;\n\n        /** @type {Client} */\n        _this._client = client;\n\n        _this._queue = new _Queue2.default(_this._cache, Platform._cacheId + '-refresh');\n\n        _this._auth = new _Auth2.default(_this._cache, Platform._cacheId);\n\n        return _this;\n    }\n\n    /**\n     * @return {Auth}\n     */\n    // 1 week\n    // Platform server by default sets it to 60 * 60 = 1 hour\n\n    _createClass(Platform, [{\n        key: 'auth',\n        value: function auth() {\n            return this._auth;\n        }\n\n        /**\n         * @return {Client}\n         */\n\n    }, {\n        key: 'client',\n        value: function client() {\n            return this._client;\n        }\n\n        /**\n         * @param {string} path\n         * @param {object} [options]\n         * @param {boolean} [options.addServer]\n         * @param {string} [options.addMethod]\n         * @param {boolean} [options.addToken]\n         * @return {string}\n         */\n\n    }, {\n        key: 'createUrl',\n        value: function createUrl(path, options) {\n\n            path = path || '';\n            options = options || {};\n\n            var builtUrl = '',\n                hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n            if (options.addServer && !hasHttp) builtUrl += this._server;\n\n            if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n            builtUrl += path;\n\n            if (options.addMethod || options.addToken) builtUrl += path.indexOf('?') > -1 ? '&' : '?';\n\n            if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n            if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n            return builtUrl;\n        }\n\n        /**\n         * @param {string} options.redirectUri\n         * @param {string} options.state\n         * @param {string} options.brandId\n         * @param {string} options.display\n         * @param {string} options.prompt\n         * @return {string}\n         */\n\n    }, {\n        key: 'authUrl',\n        value: function authUrl(options) {\n\n            options = options || {};\n\n            return this.createUrl(Platform._authorizeEndpoint + '?' + (0, _Utils.queryStringify)({\n                'response_type': 'code',\n                'redirect_uri': options.redirectUri || '',\n                'client_id': this._appKey,\n                'state': options.state || '',\n                'brand_id': options.brandId || '',\n                'display': options.display || '',\n                'prompt': options.prompt || ''\n            }), { addServer: true });\n        }\n\n        /**\n         * @param {string} url\n         * @return {Object}\n         */\n\n    }, {\n        key: 'parseAuthRedirectUrl',\n        value: function parseAuthRedirectUrl(url) {\n\n            var qs = (0, _Utils.parseQueryString)(url.split('?').reverse()[0]),\n                error = qs.error_description || qs.error;\n\n            if (error) {\n                var e = new Error(error);\n                e.error = qs.error;\n                throw e;\n            }\n\n            return qs;\n        }\n\n        /**\n         * @return {Promise<boolean>}\n         */\n\n    }, {\n        key: 'loggedIn',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                _context.prev = 0;\n                                _context.next = 3;\n                                return this._ensureAuthentication();\n\n                            case 3:\n                                return _context.abrupt('return', true);\n\n                            case 6:\n                                _context.prev = 6;\n                                _context.t0 = _context['catch'](0);\n                                return _context.abrupt('return', false);\n\n                            case 9:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this, [[0, 6]]);\n            }));\n\n            return function loggedIn() {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {string} options.username\n         * @param {string} options.password\n         * @param {string} options.extension\n         * @param {string} options.code\n         * @param {string} options.redirectUri\n         * @param {string} options.endpointId\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'login',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(options) {\n                var body, apiResponse, json;\n                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                        switch (_context2.prev = _context2.next) {\n                            case 0:\n                                _context2.prev = 0;\n\n                                options = options || {};\n\n                                options.remember = options.remember || false;\n\n                                this.emit(this.events.beforeLogin);\n\n                                body = {\n                                    \"access_token_ttl\": Platform._accessTokenTtl,\n                                    \"refresh_token_ttl\": options.remember ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                                };\n\n                                if (!options.code) {\n\n                                    body.grant_type = 'password';\n                                    body.username = options.username;\n                                    body.password = options.password;\n                                    body.extension = options.extension || '';\n                                } else if (options.code) {\n\n                                    body.grant_type = 'authorization_code';\n                                    body.code = options.code;\n                                    body.redirect_uri = options.redirectUri;\n                                    //body.client_id = this.getCredentials().key; // not needed\n                                }\n\n                                if (options.endpointId) body.endpoint_id = options.endpointId;\n\n                                _context2.next = 9;\n                                return this._tokenRequest(Platform._tokenEndpoint, body);\n\n                            case 9:\n                                apiResponse = _context2.sent;\n                                json = apiResponse.json();\n\n                                this._auth.setData(json).setRemember(options.remember);\n\n                                this.emit(this.events.loginSuccess, apiResponse);\n\n                                return _context2.abrupt('return', apiResponse);\n\n                            case 16:\n                                _context2.prev = 16;\n                                _context2.t0 = _context2['catch'](0);\n\n                                this._cache.clean();\n\n                                this.emit(this.events.loginError, _context2.t0);\n\n                                throw _context2.t0;\n\n                            case 21:\n                            case 'end':\n                                return _context2.stop();\n                        }\n                    }\n                }, _callee2, this, [[0, 16]]);\n            }));\n\n            return function login(_x) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'refresh',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n                var res, json;\n                return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                        switch (_context3.prev = _context3.next) {\n                            case 0:\n                                _context3.prev = 0;\n\n                                this.emit(this.events.beforeRefresh);\n\n                                if (!this._queue.isPaused()) {\n                                    _context3.next = 9;\n                                    break;\n                                }\n\n                                _context3.next = 5;\n                                return this._queue.poll();\n\n                            case 5:\n                                if (this._isAccessTokenValid()) {\n                                    _context3.next = 7;\n                                    break;\n                                }\n\n                                throw new Error('Automatic authentification timeout');\n\n                            case 7:\n\n                                this.emit(this.events.refreshSuccess, null);\n\n                                return _context3.abrupt('return', null);\n\n                            case 9:\n\n                                this._queue.pause();\n\n                                // Make sure all existing AJAX calls had a chance to reach the server\n                                _context3.next = 12;\n                                return (0, _Utils.delay)(Platform._refreshDelayMs);\n\n                            case 12:\n                                if (this._auth.refreshToken()) {\n                                    _context3.next = 14;\n                                    break;\n                                }\n\n                                throw new Error('Refresh token is missing');\n\n                            case 14:\n                                if (this._auth.refreshTokenValid()) {\n                                    _context3.next = 16;\n                                    break;\n                                }\n\n                                throw new Error('Refresh token has expired');\n\n                            case 16:\n                                if (this._queue.isPaused()) {\n                                    _context3.next = 18;\n                                    break;\n                                }\n\n                                throw new Error('Queue was resumed before refresh call');\n\n                            case 18:\n                                _context3.next = 20;\n                                return this._tokenRequest(Platform._tokenEndpoint, {\n                                    \"grant_type\": \"refresh_token\",\n                                    \"refresh_token\": this._auth.refreshToken(),\n                                    \"access_token_ttl\": Platform._accessTokenTtl,\n                                    \"refresh_token_ttl\": this._auth.remember() ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                                });\n\n                            case 20:\n                                res = _context3.sent;\n                                json = res.json();\n\n                                if (json.access_token) {\n                                    _context3.next = 24;\n                                    break;\n                                }\n\n                                throw this._client.makeError(new Error('Malformed OAuth response'), res);\n\n                            case 24:\n\n                                this._auth.setData(json);\n                                this._queue.resume();\n\n                                this.emit(this.events.refreshSuccess, res);\n\n                                return _context3.abrupt('return', res);\n\n                            case 30:\n                                _context3.prev = 30;\n                                _context3.t0 = _context3['catch'](0);\n\n                                _context3.t0 = this._client.makeError(_context3.t0);\n\n                                if (Platform._clearCacheOnRefreshError) {\n                                    this._cache.clean();\n                                }\n\n                                this.emit(this.events.refreshError, _context3.t0);\n\n                                throw _context3.t0;\n\n                            case 36:\n                            case 'end':\n                                return _context3.stop();\n                        }\n                    }\n                }, _callee3, this, [[0, 30]]);\n            }));\n\n            return function refresh() {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'logout',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n                var res;\n                return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                        switch (_context4.prev = _context4.next) {\n                            case 0:\n                                _context4.prev = 0;\n\n                                this.emit(this.events.beforeLogout);\n\n                                this._queue.pause();\n\n                                _context4.next = 5;\n                                return this._tokenRequest(Platform._revokeEndpoint, {\n                                    token: this._auth.accessToken()\n                                });\n\n                            case 5:\n                                res = _context4.sent;\n\n                                this._queue.resume();\n                                this._cache.clean();\n\n                                this.emit(this.events.logoutSuccess, res);\n\n                                return _context4.abrupt('return', res);\n\n                            case 12:\n                                _context4.prev = 12;\n                                _context4.t0 = _context4['catch'](0);\n\n                                this._queue.resume();\n\n                                this.emit(this.events.logoutError, _context4.t0);\n\n                                throw _context4.t0;\n\n                            case 17:\n                            case 'end':\n                                return _context4.stop();\n                        }\n                    }\n                }, _callee4, this, [[0, 12]]);\n            }));\n\n            return function logout() {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {Request} request\n         * @param {object} [options]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<Request>}\n         */\n\n    }, {\n        key: 'inflateRequest',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee5(request, options) {\n                return regeneratorRuntime.wrap(function _callee5$(_context5) {\n                    while (1) {\n                        switch (_context5.prev = _context5.next) {\n                            case 0:\n\n                                options = options || {};\n\n                                if (!options.skipAuthCheck) {\n                                    _context5.next = 3;\n                                    break;\n                                }\n\n                                return _context5.abrupt('return', request);\n\n                            case 3:\n                                _context5.next = 5;\n                                return this._ensureAuthentication();\n\n                            case 5:\n\n                                request.headers.set('Authorization', this._authHeader());\n                                //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n                                //TODO Add User-Agent here\n\n                                return _context5.abrupt('return', request);\n\n                            case 7:\n                            case 'end':\n                                return _context5.stop();\n                        }\n                    }\n                }, _callee5, this);\n            }));\n\n            return function inflateRequest(_x2, _x3) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {Request} request\n         * @param {object} [options]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'sendRequest',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee6(request, options) {\n                return regeneratorRuntime.wrap(function _callee6$(_context6) {\n                    while (1) {\n                        switch (_context6.prev = _context6.next) {\n                            case 0:\n                                _context6.prev = 0;\n                                _context6.next = 3;\n                                return this.inflateRequest(request, options);\n\n                            case 3:\n                                request = _context6.sent;\n                                _context6.next = 6;\n                                return this._client.sendRequest(request);\n\n                            case 6:\n                                return _context6.abrupt('return', _context6.sent);\n\n                            case 9:\n                                _context6.prev = 9;\n                                _context6.t0 = _context6['catch'](0);\n\n                                if (!(!_context6.t0.apiResponse || !_context6.t0.apiResponse.response() || _context6.t0.apiResponse.response().status != 401)) {\n                                    _context6.next = 13;\n                                    break;\n                                }\n\n                                throw _context6.t0;\n\n                            case 13:\n\n                                this._auth.cancelAccessToken();\n\n                                _context6.next = 16;\n                                return this.sendRequest(request, options);\n\n                            case 16:\n                                return _context6.abrupt('return', _context6.sent);\n\n                            case 17:\n                            case 'end':\n                                return _context6.stop();\n                        }\n                    }\n                }, _callee6, this, [[0, 9]]);\n            }));\n\n            return function sendRequest(_x4, _x5) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * General purpose function to send anything to server\n         * @param {string} options.url\n         * @param {object} [options.body]\n         * @param {string} [options.method]\n         * @param {object} [options.query]\n         * @param {object} [options.headers]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'send',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee7() {\n                var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n                return regeneratorRuntime.wrap(function _callee7$(_context7) {\n                    while (1) {\n                        switch (_context7.prev = _context7.next) {\n                            case 0:\n\n                                //FIXME https://github.com/bitinn/node-fetch/issues/43\n                                options.url = this.createUrl(options.url, { addServer: true });\n\n                                _context7.next = 3;\n                                return this.sendRequest(this._client.createRequest(options), options);\n\n                            case 3:\n                                return _context7.abrupt('return', _context7.sent);\n\n                            case 4:\n                            case 'end':\n                                return _context7.stop();\n                        }\n                    }\n                }, _callee7, this);\n            }));\n\n            return function send(_x6) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {string} url\n         * @param {object} [query]\n         * @param {object} [options]\n         * @param {object} [options.headers]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'get',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee8(url, query, options) {\n                return regeneratorRuntime.wrap(function _callee8$(_context8) {\n                    while (1) {\n                        switch (_context8.prev = _context8.next) {\n                            case 0:\n                                options = options || {};\n                                options.method = 'GET';\n                                options.url = url;\n                                options.query = query;\n                                _context8.next = 6;\n                                return this.send(options);\n\n                            case 6:\n                                return _context8.abrupt('return', _context8.sent);\n\n                            case 7:\n                            case 'end':\n                                return _context8.stop();\n                        }\n                    }\n                }, _callee8, this);\n            }));\n\n            return function get(_x8, _x9, _x10) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {string} url\n         * @param {object} body\n         * @param {object} [query]\n         * @param {object} [options]\n         * @param {object} [options.headers]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'post',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee9(url, body, query, options) {\n                return regeneratorRuntime.wrap(function _callee9$(_context9) {\n                    while (1) {\n                        switch (_context9.prev = _context9.next) {\n                            case 0:\n                                options = options || {};\n                                options.method = 'POST';\n                                options.url = url;\n                                options.query = query;\n                                options.body = body;\n                                _context9.next = 7;\n                                return this.send(options);\n\n                            case 7:\n                                return _context9.abrupt('return', _context9.sent);\n\n                            case 8:\n                            case 'end':\n                                return _context9.stop();\n                        }\n                    }\n                }, _callee9, this);\n            }));\n\n            return function post(_x11, _x12, _x13, _x14) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {string} url\n         * @param {object} [body]\n         * @param {object} [query]\n         * @param {object} [options]\n         * @param {object} [options.headers]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'put',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee10(url, body, query, options) {\n                return regeneratorRuntime.wrap(function _callee10$(_context10) {\n                    while (1) {\n                        switch (_context10.prev = _context10.next) {\n                            case 0:\n                                options = options || {};\n                                options.method = 'PUT';\n                                options.url = url;\n                                options.query = query;\n                                options.body = body;\n                                _context10.next = 7;\n                                return this.send(options);\n\n                            case 7:\n                                return _context10.abrupt('return', _context10.sent);\n\n                            case 8:\n                            case 'end':\n                                return _context10.stop();\n                        }\n                    }\n                }, _callee10, this);\n            }));\n\n            return function put(_x15, _x16, _x17, _x18) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @param {string} url\n         * @param {string} [query]\n         * @param {object} [options]\n         * @param {object} [options.headers]\n         * @param {boolean} [options.skipAuthCheck]\n         * @return {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'delete',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee11(url, query, options) {\n                return regeneratorRuntime.wrap(function _callee11$(_context11) {\n                    while (1) {\n                        switch (_context11.prev = _context11.next) {\n                            case 0:\n                                options = options || {};\n                                options.method = 'DELETE';\n                                options.url = url;\n                                options.query = query;\n                                _context11.next = 6;\n                                return this.send(options);\n\n                            case 6:\n                                return _context11.abrupt('return', _context11.sent);\n\n                            case 7:\n                            case 'end':\n                                return _context11.stop();\n                        }\n                    }\n                }, _callee11, this);\n            }));\n\n            return function _delete(_x19, _x20, _x21) {\n                return ref.apply(this, arguments);\n            };\n        })()\n    }, {\n        key: '_tokenRequest',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee12(path, body) {\n                return regeneratorRuntime.wrap(function _callee12$(_context12) {\n                    while (1) {\n                        switch (_context12.prev = _context12.next) {\n                            case 0:\n                                _context12.next = 2;\n                                return this.send({\n                                    url: path,\n                                    skipAuthCheck: true,\n                                    body: body,\n                                    method: 'POST',\n                                    headers: {\n                                        'Authorization': 'Basic ' + this._apiKey(),\n                                        'Content-Type': 'application/x-www-form-urlencoded'\n                                    }\n                                });\n\n                            case 2:\n                                return _context12.abrupt('return', _context12.sent);\n\n                            case 3:\n                            case 'end':\n                                return _context12.stop();\n                        }\n                    }\n                }, _callee12, this);\n            }));\n\n            return function _tokenRequest(_x22, _x23) {\n                return ref.apply(this, arguments);\n            };\n        })()\n    }, {\n        key: '_ensureAuthentication',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee13() {\n                return regeneratorRuntime.wrap(function _callee13$(_context13) {\n                    while (1) {\n                        switch (_context13.prev = _context13.next) {\n                            case 0:\n                                if (!this._isAccessTokenValid()) {\n                                    _context13.next = 2;\n                                    break;\n                                }\n\n                                return _context13.abrupt('return', null);\n\n                            case 2:\n                                _context13.next = 4;\n                                return this.refresh();\n\n                            case 4:\n                                return _context13.abrupt('return', _context13.sent);\n\n                            case 5:\n                            case 'end':\n                                return _context13.stop();\n                        }\n                    }\n                }, _callee13, this);\n            }));\n\n            return function _ensureAuthentication() {\n                return ref.apply(this, arguments);\n            };\n        })()\n    }, {\n        key: '_isAccessTokenValid',\n        value: function _isAccessTokenValid() {\n\n            return this._auth.accessTokenValid() && !this._queue.isPaused();\n        }\n    }, {\n        key: '_apiKey',\n        value: function _apiKey() {\n            var apiKey = this._appKey + ':' + this._appSecret;\n            return typeof btoa == 'function' ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n        }\n    }, {\n        key: '_authHeader',\n        value: function _authHeader() {\n            var token = this._auth.accessToken();\n            return this._auth.tokenType() + (token ? ' ' + token : '');\n        }\n    }]);\n\n    return Platform;\n})(_Observable3.default);\n\nPlatform._urlPrefix = '/restapi';\nPlatform._apiVersion = 'v1.0';\nPlatform._accessTokenTtl = null;\nPlatform._refreshTokenTtl = 10 * 60 * 60;\nPlatform._refreshTokenTtlRemember = 7 * 24 * 60 * 60;\nPlatform._tokenEndpoint = '/restapi/oauth/token';\nPlatform._revokeEndpoint = '/restapi/oauth/revoke';\nPlatform._authorizeEndpoint = '/restapi/oauth/authorize';\nPlatform._refreshDelayMs = 100;\nPlatform._cacheId = 'platform';\nPlatform._clearCacheOnRefreshError = true;\nexports.default = Platform;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Auth = (function () {\n    function Auth(cache, cacheId) {\n        _classCallCheck(this, Auth);\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n    } // 1 minute\n\n    _createClass(Auth, [{\n        key: 'accessToken',\n        value: function accessToken() {\n            return this.data().access_token;\n        }\n    }, {\n        key: 'refreshToken',\n        value: function refreshToken() {\n            return this.data().refresh_token;\n        }\n    }, {\n        key: 'tokenType',\n        value: function tokenType() {\n            return this.data().token_type;\n        }\n\n        /**\n         * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n         */\n\n    }, {\n        key: 'data',\n        value: function data() {\n\n            return this._cache.getItem(this._cacheId) || {\n                token_type: '',\n                access_token: '',\n                expires_in: 0,\n                refresh_token: '',\n                refresh_token_expires_in: 0\n            };\n        }\n\n        /**\n         * @param {object} newData\n         * @return {Auth}\n         */\n\n    }, {\n        key: 'setData',\n        value: function setData(newData) {\n\n            newData = newData || {};\n\n            var data = this.data();\n\n            Object.keys(newData).forEach(function (key) {\n                data[key] = newData[key];\n            });\n\n            data.expire_time = Date.now() + data.expires_in * 1000;\n            data.refresh_token_expire_time = Date.now() + data.refresh_token_expires_in * 1000;\n\n            this._cache.setItem(this._cacheId, data);\n\n            return this;\n        }\n\n        /**\n         * Check if there is a valid (not expired) access token\n         * @return {boolean}\n         */\n\n    }, {\n        key: 'accessTokenValid',\n        value: function accessTokenValid() {\n\n            var authData = this.data();\n            return authData.token_type === Auth.forcedTokenType || authData.expire_time - Auth.refreshHandicapMs > Date.now();\n        }\n\n        /**\n         * Check if there is a valid (not expired) access token\n         * @return {boolean}\n         */\n\n    }, {\n        key: 'refreshTokenValid',\n        value: function refreshTokenValid() {\n\n            return this.data().refresh_token_expire_time > Date.now();\n        }\n\n        /**\n         * @return {Auth}\n         */\n\n    }, {\n        key: 'cancelAccessToken',\n        value: function cancelAccessToken() {\n\n            return this.setData({\n                access_token: '',\n                expires_in: 0\n            });\n        }\n\n        /**\n         * This method sets a special authentication mode used in Service Web\n         * @return {Auth}\n         */\n\n    }, {\n        key: 'forceAuthentication',\n        value: function forceAuthentication() {\n\n            this.setData({\n                token_type: Auth.forcedTokenType,\n                access_token: '',\n                expires_in: 0,\n                refresh_token: '',\n                refresh_token_expires_in: 0\n            });\n\n            return this;\n        }\n\n        /**\n         * @param remember\n         * @return {Auth}\n         */\n\n    }, {\n        key: 'setRemember',\n        value: function setRemember(remember) {\n\n            return this.setData({ remember: remember });\n        }\n\n        /**\n         * @return {boolean}\n         */\n\n    }, {\n        key: 'remember',\n        value: function remember() {\n\n            return !!this.data().remember;\n        }\n    }]);\n\n    return Auth;\n})();\n\n//export interface IAuthData {\n//    remember?:boolean;\n//    token_type?:string;\n//    access_token?:string;\n//    expires_in?:number; // actually it's string\n//    expire_time?:number;\n//    refresh_token?:string;\n//    refresh_token_expires_in?:number; // actually it's string\n//    refresh_token_expire_time?:number;\n//    scope?:string;\n//}\n\nAuth.refreshHandicapMs = 60 * 1000;\nAuth.forcedTokenType = 'forced';\nexports.default = Auth;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _PubnubMock = __webpack_require__(20);\n\nvar _PubnubMock2 = _interopRequireDefault(_PubnubMock);\n\nvar _Externals = __webpack_require__(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PubnubMockFactory = (function () {\n    function PubnubMockFactory() {\n        _classCallCheck(this, PubnubMockFactory);\n\n        this.crypto_obj = _Externals.PUBNUB.crypto_obj;\n    }\n\n    _createClass(PubnubMockFactory, [{\n        key: 'init',\n        value: function init(options) {\n            return new _PubnubMock2.default(options);\n        }\n    }]);\n\n    return PubnubMockFactory;\n})();\n\nexports.default = PubnubMockFactory;\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Observable2 = __webpack_require__(9);\n\nvar _Observable3 = _interopRequireDefault(_Observable2);\n\nvar _Externals = __webpack_require__(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar PubnubMock = (function (_Observable) {\n    _inherits(PubnubMock, _Observable);\n\n    function PubnubMock(options) {\n        _classCallCheck(this, PubnubMock);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(PubnubMock).call(this));\n\n        _this.options = options;\n        _this.crypto_obj = _Externals.PUBNUB.crypto_obj;\n        return _this;\n    }\n\n    _createClass(PubnubMock, [{\n        key: 'ready',\n        value: function ready() {}\n    }, {\n        key: 'subscribe',\n        value: function subscribe(options) {\n            this.on('message-' + options.channel, options.message);\n        }\n    }, {\n        key: 'unsubscribe',\n        value: function unsubscribe(options) {\n            this.off('message-' + options.channel);\n        }\n    }, {\n        key: 'receiveMessage',\n        value: function receiveMessage(msg, channel) {\n            this.emit('message-' + channel, msg, 'env', channel);\n        }\n    }]);\n\n    return PubnubMock;\n})(_Observable3.default);\n\nexports.default = PubnubMock;\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Observable2 = __webpack_require__(9);\n\nvar _Observable3 = _interopRequireDefault(_Observable2);\n\nvar _Client = __webpack_require__(11);\n\nvar _Client2 = _interopRequireDefault(_Client);\n\nvar _Utils = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Subscription = (function (_Observable) {\n    _inherits(Subscription, _Observable);\n\n    function Subscription(pubnubFactory, platform) {\n        _classCallCheck(this, Subscription);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Subscription).call(this));\n\n        _this.events = {\n            notification: 'notification',\n            removeSuccess: 'removeSuccess',\n            removeError: 'removeError',\n            renewSuccess: 'renewSuccess',\n            renewError: 'renewError',\n            subscribeSuccess: 'subscribeSuccess',\n            subscribeError: 'subscribeError'\n        };\n\n        _this._pubnubFactory = pubnubFactory;\n        _this._platform = platform;\n        _this._pubnub = null;\n        _this._timeout = null;\n        _this._subscription = {};\n\n        return _this;\n    }\n\n    _createClass(Subscription, [{\n        key: 'subscribed',\n        value: function subscribed() {\n\n            return !!(this._subscription.id && this._subscription.deliveryMode && this._subscription.deliveryMode.subscriberKey && this._subscription.deliveryMode.address);\n        }\n\n        /**\n         * @return {boolean}\n         */\n\n    }, {\n        key: 'alive',\n        value: function alive() {\n\n            return this.subscribed() && Date.now() < this.expirationTime();\n        }\n    }, {\n        key: 'expirationTime',\n        value: function expirationTime() {\n            return new Date(this._subscription.expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n        }\n    }, {\n        key: 'setSubscription',\n        value: function setSubscription(subscription) {\n\n            subscription = subscription || {};\n\n            this._clearTimeout();\n\n            this._subscription = subscription;\n\n            if (!this._pubnub) this._subscribeAtPubnub();\n\n            this._setTimeout();\n\n            return this;\n        }\n    }, {\n        key: 'subscription',\n        value: function subscription() {\n            return this._subscription;\n        }\n\n        /**\n         * Creates or updates subscription if there is an active one\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'register',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                if (!this.alive()) {\n                                    _context.next = 6;\n                                    break;\n                                }\n\n                                _context.next = 3;\n                                return this.renew();\n\n                            case 3:\n                                return _context.abrupt('return', _context.sent);\n\n                            case 6:\n                                _context.next = 8;\n                                return this.subscribe();\n\n                            case 8:\n                                return _context.abrupt('return', _context.sent);\n\n                            case 9:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this);\n            }));\n\n            return function register() {\n                return ref.apply(this, arguments);\n            };\n        })()\n    }, {\n        key: 'eventFilters',\n        value: function eventFilters() {\n            return this._subscription.eventFilters || [];\n        }\n\n        /**\n         * @param {string[]} events\n         * @return {Subscription}\n         */\n\n    }, {\n        key: 'addEventFilters',\n        value: function addEventFilters(events) {\n            this.setEventFilters(this.eventFilters().concat(events));\n            return this;\n        }\n\n        /**\n         * @param {string[]} events\n         * @return {Subscription}\n         */\n\n    }, {\n        key: 'setEventFilters',\n        value: function setEventFilters(events) {\n            this._subscription.eventFilters = events;\n            return this;\n        }\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'subscribe',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n                var response, json;\n                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                        switch (_context2.prev = _context2.next) {\n                            case 0:\n                                _context2.prev = 0;\n\n                                this._clearTimeout();\n\n                                if (this.eventFilters().length) {\n                                    _context2.next = 4;\n                                    break;\n                                }\n\n                                throw new Error('Events are undefined');\n\n                            case 4:\n                                _context2.next = 6;\n                                return this._platform.post('/restapi/v1.0/subscription', {\n                                    eventFilters: this._getFullEventFilters(),\n                                    deliveryMode: {\n                                        transportType: 'PubNub'\n                                    }\n                                });\n\n                            case 6:\n                                response = _context2.sent;\n                                json = response.json();\n\n                                this.setSubscription(json).emit(this.events.subscribeSuccess, response);\n\n                                return _context2.abrupt('return', response);\n\n                            case 12:\n                                _context2.prev = 12;\n                                _context2.t0 = _context2['catch'](0);\n\n                                _context2.t0 = this._platform.client().makeError(_context2.t0);\n\n                                this.reset().emit(this.events.subscribeError, _context2.t0);\n\n                                throw _context2.t0;\n\n                            case 17:\n                            case 'end':\n                                return _context2.stop();\n                        }\n                    }\n                }, _callee2, this, [[0, 12]]);\n            }));\n\n            return function subscribe() {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'renew',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n                var response, json;\n                return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                        switch (_context3.prev = _context3.next) {\n                            case 0:\n                                _context3.prev = 0;\n\n                                this._clearTimeout();\n\n                                if (this.alive()) {\n                                    _context3.next = 4;\n                                    break;\n                                }\n\n                                throw new Error('Subscription is not alive');\n\n                            case 4:\n                                if (this.eventFilters().length) {\n                                    _context3.next = 6;\n                                    break;\n                                }\n\n                                throw new Error('Events are undefined');\n\n                            case 6:\n                                _context3.next = 8;\n                                return this._platform.put('/restapi/v1.0/subscription/' + this._subscription.id, {\n                                    eventFilters: this._getFullEventFilters()\n                                });\n\n                            case 8:\n                                response = _context3.sent;\n                                json = response.json();\n\n                                this.setSubscription(json).emit(this.events.renewSuccess, response);\n\n                                return _context3.abrupt('return', response);\n\n                            case 14:\n                                _context3.prev = 14;\n                                _context3.t0 = _context3['catch'](0);\n\n                                _context3.t0 = this._platform.client().makeError(_context3.t0);\n\n                                this.reset().emit(this.events.renewError, _context3.t0);\n\n                                throw _context3.t0;\n\n                            case 19:\n                            case 'end':\n                                return _context3.stop();\n                        }\n                    }\n                }, _callee3, this, [[0, 14]]);\n            }));\n\n            return function renew() {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'remove',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n                var response;\n                return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                        switch (_context4.prev = _context4.next) {\n                            case 0:\n                                _context4.prev = 0;\n\n                                if (this.subscribed()) {\n                                    _context4.next = 3;\n                                    break;\n                                }\n\n                                throw new Error('No subscription');\n\n                            case 3:\n                                _context4.next = 5;\n                                return this._platform.delete('/restapi/v1.0/subscription/' + this._subscription.id);\n\n                            case 5:\n                                response = _context4.sent;\n\n                                this.reset().emit(this.events.removeSuccess, response);\n\n                                return _context4.abrupt('return', response);\n\n                            case 10:\n                                _context4.prev = 10;\n                                _context4.t0 = _context4['catch'](0);\n\n                                _context4.t0 = this._platform.client().makeError(_context4.t0);\n\n                                this.emit(this.events.removeError, _context4.t0);\n\n                                throw _context4.t0;\n\n                            case 15:\n                            case 'end':\n                                return _context4.stop();\n                        }\n                    }\n                }, _callee4, this, [[0, 10]]);\n            }));\n\n            return function remove() {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'resubscribe',\n        value: function resubscribe() {\n\n            return this.reset().setEventFilters(this.eventFilters()).subscribe();\n        }\n\n        /**\n         * Remove subscription and disconnect from PUBNUB\n         * This method resets subscription at client side but backend is not notified\n         */\n\n    }, {\n        key: 'reset',\n        value: function reset() {\n            this._clearTimeout();\n            if (this.subscribed() && this._pubnub) this._pubnub.unsubscribe({ channel: this._subscription.deliveryMode.address });\n            this._subscription = {};\n            return this;\n        }\n    }, {\n        key: '_getFullEventFilters',\n        value: function _getFullEventFilters() {\n            var _this2 = this;\n\n            return this.eventFilters().map(function (event) {\n                return _this2._platform.createUrl(event);\n            });\n        }\n    }, {\n        key: '_setTimeout',\n        value: function _setTimeout() {\n            var _this3 = this;\n\n            this._clearTimeout();\n\n            if (!this.alive()) throw new Error('Subscription is not alive');\n\n            (0, _Utils.poll)(function (next) {\n\n                if (_this3.alive()) return next();\n\n                _this3.renew();\n            }, Subscription._pollInterval, this._timeout);\n\n            return this;\n        }\n    }, {\n        key: '_clearTimeout',\n        value: function _clearTimeout() {\n\n            (0, _Utils.stopPolling)(this._timeout);\n\n            return this;\n        }\n    }, {\n        key: '_decrypt',\n        value: function _decrypt(message) {\n\n            if (!this.subscribed()) throw new Error('No subscription');\n\n            if (this._subscription.deliveryMode.encryptionKey) {\n\n                var PUBNUB = this._pubnubFactory;\n\n                message = PUBNUB.crypto_obj.decrypt(message, this._subscription.deliveryMode.encryptionKey, {\n                    encryptKey: false,\n                    keyEncoding: 'base64',\n                    keyLength: 128,\n                    mode: 'ecb'\n                });\n            }\n\n            return message;\n        }\n    }, {\n        key: '_notify',\n        value: function _notify(message) {\n\n            this.emit(this.events.notification, this._decrypt(message));\n\n            return this;\n        }\n    }, {\n        key: '_subscribeAtPubnub',\n        value: function _subscribeAtPubnub() {\n\n            if (!this.alive()) throw new Error('Subscription is not alive');\n\n            var PUBNUB = this._pubnubFactory;\n\n            this._pubnub = PUBNUB.init({\n                ssl: true,\n                subscribe_key: this._subscription.deliveryMode.subscriberKey\n            });\n\n            this._pubnub.ready();\n\n            this._pubnub.subscribe({\n                channel: this._subscription.deliveryMode.address,\n                message: this._notify.bind(this),\n                connect: function connect() {}\n            });\n\n            return this;\n        }\n    }]);\n\n    return Subscription;\n})(_Observable3.default);\n\n//export interface ISubscription {\n//    id?:string;\n//    uri?: string;\n//    eventFilters?:string[];\n//    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n//    expiresIn?:number;\n//    deliveryMode?: {\n//        transportType?:string;\n//        encryption?:boolean;\n//        address?:string;\n//        subscriberKey?:string;\n//        encryptionKey?:string;\n//        secretKey?:string;\n//    };\n//    creationTime?:string; // 2014-03-12T19:54:35.613Z\n//    status?:string; // Active\n//}\n\nSubscription._renewHandicapMs = 2 * 60 * 1000;\nSubscription._pollInterval = 10 * 1000;\nexports.default = Subscription;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Subscription2 = __webpack_require__(21);\n\nvar _Subscription3 = _interopRequireDefault(_Subscription2);\n\nvar _Queue = __webpack_require__(10);\n\nvar _Queue2 = _interopRequireDefault(_Queue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CachedSubscription = (function (_Subscription) {\n    _inherits(CachedSubscription, _Subscription);\n\n    function CachedSubscription(pubnubFactory, platform, cache, cacheKey) {\n        _classCallCheck(this, CachedSubscription);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(CachedSubscription).call(this, pubnubFactory, platform));\n\n        _this._cache = cache;\n        _this._cacheKey = cacheKey;\n        _this._renewQueue = new _Queue2.default(_this._cache, cacheKey + '-renew');\n        _this._resubscribeQueue = new _Queue2.default(_this._cache, cacheKey + '-resubscribe');\n\n        _this.events = _extends({}, _this.events, {\n            queuedRenewSuccess: 'queuedRenewSuccess',\n            queuedRenewError: 'queuedRenewError',\n            queuedResubscribeSuccess: 'queuedResubscribeSuccess',\n            queuedResubscribeError: 'queuedResubscribeError'\n        });\n\n        _this.on(_this.events.renewError, function () {\n            _this.resubscribe();\n        });\n\n        _this.on([_this.events.subscribeSuccess, _this.events.renewSuccess], function () {\n            _this._cache.setItem(_this._cacheKey, _this.subscription());\n        });\n\n        _this.on(_this.events.removeSuccess, function () {\n            _this._cache.removeItem(_this._cacheKey);\n        });\n\n        return _this;\n    }\n\n    /**\n     * TODO Combine with Platform.refresh and move elsewhere\n     * @param actionCb\n     * @param queue\n     * @param successEvent\n     * @param errorEvent\n     * @param errorMessage\n     * @return {*}\n     * @private\n     */\n\n    _createClass(CachedSubscription, [{\n        key: '_queue',\n        value: (function () {\n            var ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(actionCb, queue, successEvent, errorEvent, errorMessage) {\n                var res;\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                _context.prev = 0;\n\n                                if (!queue.isPaused()) {\n                                    _context.next = 8;\n                                    break;\n                                }\n\n                                _context.next = 4;\n                                return queue.poll();\n\n                            case 4:\n                                if (this.alive()) {\n                                    _context.next = 6;\n                                    break;\n                                }\n\n                                throw new Error(errorMessage);\n\n                            case 6:\n\n                                this.emit(successEvent, null);\n\n                                return _context.abrupt('return', null);\n\n                            case 8:\n\n                                queue.pause();\n\n                                _context.next = 11;\n                                return actionCb.call(this);\n\n                            case 11:\n                                res = _context.sent;\n\n                                queue.resume();\n\n                                this.emit(successEvent, res);\n\n                                return _context.abrupt('return', res);\n\n                            case 17:\n                                _context.prev = 17;\n                                _context.t0 = _context['catch'](0);\n\n                                this.emit(errorEvent, _context.t0);\n\n                                throw _context.t0;\n\n                            case 21:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this, [[0, 17]]);\n            }));\n\n            return function _queue(_x, _x2, _x3, _x4, _x5) {\n                return ref.apply(this, arguments);\n            };\n        })()\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'renew',\n        value: function renew() {\n\n            return this._queue(_get(Object.getPrototypeOf(CachedSubscription.prototype), 'renew', this), this._renewQueue, this.events.queuedRenewSuccess, this.events.queuedRenewError, 'Subscription is not alive after renew timeout');\n        }\n\n        /**\n         * @returns {Promise<ApiResponse>}\n         */\n\n    }, {\n        key: 'resubscribe',\n        value: function resubscribe() {\n\n            return this._queue(_get(Object.getPrototypeOf(CachedSubscription.prototype), 'resubscribe', this), this._resubscribeQueue, this.events.queuedResubscribeSuccess, this.events.queuedResubscribeError, 'Subscription is not alive after resubscribe timeout');\n        }\n\n        /**\n         * @param {string[]} events\n         * @return {CachedSubscription}\n         */\n\n    }, {\n        key: 'restore',\n        value: function restore(events) {\n\n            var cachedSubscriptionData = this._cache.getItem(this._cacheKey);\n\n            if (cachedSubscriptionData) {\n                try {\n                    this.setSubscription(cachedSubscriptionData);\n                } catch (e) {}\n            } else {\n                this.setEventFilters(events);\n            }\n\n            return this;\n        }\n    }]);\n\n    return CachedSubscription;\n})(_Subscription3.default);\n\nexports.default = CachedSubscription;\n\n/***/ }\n/******/ ])\n});\n;\n"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9b786c8af2a65d85b48f\n **/","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          context._sent = arg;\n\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-regenerator-runtime/runtime.js\n ** module id = 1\n ** module chunks = 0\n **/","import * as Utils from './core/Utils';\nimport Cache from './core/Cache';\nimport * as Externals from './core/Externals';\nimport Observable from './core/Observable';\nimport Queue from './core/Queue';\n\nimport Client from './http/Client';\nimport ApiResponse from './http/ApiResponse';\nimport * as HttpUtils from './http/Utils';\n\nimport {default as ClientMock} from './mocks/ClientMock';\nimport Mock from './mocks/Mock';\nimport Registry from './mocks/Registry';\n\nimport Platform from './platform/Platform';\nimport Auth from './platform/Auth';\n\nimport PubnubMockFactory from './pubnub/PubnubFactory';\n\nimport Subscription from './subscription/Subscription';\nimport CachedSubscription from './subscription/CachedSubscription';\n\nexport default class SDK {\n\n    static version = '2.0.1';\n\n    static server = {\n        sandbox: 'https://platform.devtest.ringcentral.com',\n        production: 'https://platform.ringcentral.com'\n    };\n\n    /**\n     * @constructor\n     * @param {object} [options]\n     * @param {string} [options.server]\n     * @param {string} [options.cachePrefix]\n     * @param {string} [options.appSecret]\n     * @param {string} [options.appKey]\n     * @param {string} [options.appName]\n     * @param {string} [options.appVersion]\n     * @param {string} [options.pubnubFactory]\n     * @param {string} [options.client]\n     */\n    constructor(options) {\n\n        options = options || {};\n\n        this._cache = new Cache(Externals.localStorage, options.cachePrefix);\n\n        this._client = options.client || new Client();\n\n        this._platform = new Platform(this._client, this._cache, options.server, options.appKey, options.appSecret);\n\n        this._pubnubFactory = options.pubnubFactory || Externals.PUBNUB;\n\n    }\n\n    /**\n     * @return {Platform}\n     */\n    platform() {\n        return this._platform;\n    }\n\n    /**\n     * @return {Subscription}\n     */\n    createSubscription() {\n        return new Subscription(this._pubnubFactory, this._platform);\n    }\n\n    /**\n     * @return {CachedSubscription}\n     */\n    createCachedSubscription(cacheKey) {\n        return new CachedSubscription(this._pubnubFactory, this._platform, this._cache, cacheKey);\n    }\n\n    /**\n     * @return {Cache}\n     */\n    cache() {\n        return this._cache;\n    }\n\n    static core = {\n        Cache: Cache,\n        Observable: Observable,\n        Utils: Utils,\n        Externals: Externals,\n        Queue: Queue\n    };\n\n    static http = {\n        Client: Client,\n        ApiResponse: ApiResponse,\n        Utils: HttpUtils\n    };\n\n    static platform = {\n        Auth: Auth,\n        Platform: Platform\n    };\n\n    static subscription = {\n        Subscription: Subscription\n    };\n\n    static mocks = {\n        Client: ClientMock,\n        Registry: Registry,\n        Mock: Mock\n    };\n\n    static pubnub = {\n        PubnubMockFactory: PubnubMockFactory\n    };\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/SDK.js\n **/","import {Promise} from './Externals.js';\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {object} parameters\n * @returns {string}\n */\nexport function queryStringify(parameters) {\n\n    var array = [];\n\n    parameters = parameters || {};\n\n    Object.keys(parameters).forEach((k) => {\n\n        var v = parameters[k];\n\n        if (isArray(v)) {\n            v.forEach((vv) => {\n                array.push(encodeURIComponent(k) + '=' + encodeURIComponent(vv));\n            });\n        } else {\n            array.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n        }\n\n    });\n\n    return array.join('&');\n\n}\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {string} queryString\n * @returns {object}\n */\nexport function parseQueryString(queryString) {\n\n    var argsParsed = {};\n\n    queryString.split('&').forEach((arg) => {\n\n        arg = decodeURIComponent(arg);\n\n        if (arg.indexOf('=') == -1) {\n\n            argsParsed[arg.trim()] = true;\n\n        } else {\n\n            var pair = arg.split('='),\n                key = pair[0].trim(),\n                value = pair[1].trim();\n\n            if (key in argsParsed) {\n                if (key in argsParsed && !isArray(argsParsed[key])) argsParsed[key] = [argsParsed[key]];\n                argsParsed[key].push(value);\n            } else {\n                argsParsed[key] = value;\n            }\n\n        }\n\n    });\n\n    return argsParsed;\n\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\n/**\n * @param fn\n * @param interval\n * @param timeout\n */\nexport function poll(fn, interval, timeout) { //NodeJS.Timer|number\n\n    module.exports.stopPolling(timeout);\n\n    interval = interval || 1000;\n\n    var next = (delay) => {\n\n        delay = delay || interval;\n\n        interval = delay;\n\n        return setTimeout(() => {\n\n            fn(next, delay);\n\n        }, delay);\n\n    };\n\n    return next();\n\n}\n\nexport function stopPolling(timeout) {\n    if (timeout) clearTimeout(timeout);\n}\n\nexport function isNodeJS() {\n    return (typeof process !== 'undefined');\n}\n\nexport function isBrowser() {\n    return (typeof window !== 'undefined');\n}\n\nexport function delay(timeout) {\n    return new Promise((resolve, reject) => {\n        setTimeout(() => {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Utils.js\n **/","import ES6Promise from 'es6-promise';\nimport nodeFetch from 'node-fetch';\nimport pubnub from 'pubnub';\n\nvar root = (new Function('return this'))();\n\nexport var Promise = (ES6Promise && ES6Promise.Promise) || root.Promise;\n\nexport var fetch = root.fetch || nodeFetch;\nexport var Request = root.Request || fetch.Request;\nexport var Response = root.Response || fetch.Response;\nexport var Headers = root.Headers || fetch.Headers;\n\nexport var PUBNUB = root.PUBNUB || pubnub;\n\nexport var localStorage = (typeof root.localStorage !== 'undefined') ? root.localStorage : {};\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Externals.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}\n ** module id = 7\n ** module chunks = 0\n **/","export default class Cache {\n\n    static defaultPrefix = 'rc-';\n\n    constructor(storage, prefix) {\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    }\n\n    setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    }\n\n    removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    }\n\n    getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    }\n\n    clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n\n        }\n\n        return this;\n\n    }\n\n    _prefixKey(key) {\n        return this._prefix + key;\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Cache.js\n **/","export default class Observable {\n\n    constructor() {\n        this.off();\n    }\n\n    hasListeners(event) {\n        return (event in this._listeners);\n    }\n\n    on(events, callback) {\n\n        if (typeof events == 'string') events = [events];\n        if (!events) throw new Error('No events to subscribe to');\n        if (typeof callback !== 'function') throw new Error('Callback must be a function');\n\n        events.forEach((event) => {\n\n            if (!this.hasListeners(event)) this._listeners[event] = [];\n\n            this._listeners[event].push(callback);\n\n        });\n\n        return this;\n\n    }\n\n    emit(event, ...args) {\n\n        var result = null;\n\n        if (!this.hasListeners(event)) return null;\n\n        this._listeners[event].some((callback) => {\n\n            result = callback.apply(this, args);\n            return (result === false);\n\n        });\n\n        return result;\n\n    }\n\n    off(event, callback) {\n\n        if (!event) {\n\n            this._listeners = {};\n\n        } else {\n\n            if (!callback) {\n\n                delete this._listeners[event];\n\n            } else {\n\n                if (!this.hasListeners(event)) return this;\n\n                this._listeners[event].forEach((cb, i) => {\n\n                    if (cb === callback) delete this._listeners[event][i];\n\n                });\n\n            }\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Observable.js\n **/","import {Promise} from '../core/Externals';\nimport {poll, stopPolling} from './Utils';\n\nexport default class Queue {\n\n    static _pollInterval = 250;\n    static _releaseTimeout = 5000;\n\n    constructor(cache, cacheId) {\n\n        this._cache = cache;\n        this._cacheId = cacheId;\n        this._promise = null;\n\n    }\n\n    isPaused() {\n\n        var time = this._cache.getItem(this._cacheId);\n\n        return !!time && Date.now() - parseInt(time) < Queue._releaseTimeout;\n    }\n\n    pause() {\n        this._cache.setItem(this._cacheId, Date.now());\n        return this;\n    }\n\n    resume() {\n        this._cache.removeItem(this._cacheId);\n        return this;\n    }\n\n    poll() {\n\n        if (this._promise) return this._promise;\n\n        this._promise = new Promise((resolve, reject) => {\n\n            poll((next) => {\n\n                if (this.isPaused()) return next();\n\n                this._promise = null;\n\n                this.resume(); // this is actually not needed but why not\n\n                resolve(null);\n\n            }, Queue._pollInterval);\n\n        });\n\n        return this._promise;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Queue.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport {queryStringify} from '../core/Utils';\nimport {findHeaderName} from './Utils';\nimport Observable from '../core/Observable';\nimport ApiResponse from './ApiResponse';\n\nexport default class Client extends Observable {\n\n    static _allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'];\n\n    events = {\n        beforeRequest: 'beforeRequest',\n        requestSuccess: 'requestSuccess',\n        requestError: 'requestError'\n    };\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request) {\n\n        var apiResponse = new ApiResponse(request);\n\n        try {\n\n            //TODO Stop request if listeners return false\n            this.emit(this.events.beforeRequest, apiResponse);\n\n            apiResponse._response = await this._loadResponse(request);\n\n            if (apiResponse._isMultipart() || apiResponse._isJson()) {\n                apiResponse._text = await apiResponse.response().text();\n            }\n\n            if (!apiResponse.ok()) throw new Error('Response has unsuccessful status');\n\n            this.emit(this.events.requestSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            if (!e.apiResponse) e = this.makeError(e, apiResponse);\n\n            this.emit(this.events.requestError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n    async _loadResponse(request) {\n        return await fetch.call(null, request);\n    }\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n    makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = (apiResponse && apiResponse.error(true)) || e.originalMessage;\n\n        }\n\n        return e;\n\n    }\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n    createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) throw new Error('Method has wrong value: ' + init.method);\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + queryStringify(init.query);\n        }\n\n        if (!(findHeaderName('Accept', init.headers))) {\n            init.headers['Accept'] = ApiResponse._jsonContentType;\n        }\n\n        // Serialize body\n        //TODO Check that body is a plain object\n        if (typeof init.body !== 'string' || !init.body) {\n\n            var contentTypeHeaderName = findHeaderName(ApiResponse._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = ApiResponse._contentType;\n                init.headers[contentTypeHeaderName] = ApiResponse._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(ApiResponse._jsonContentType) > -1) {\n                init.body = JSON.stringify(init.body);\n            } else if (contentType.indexOf(ApiResponse._urlencodedContentType) > -1) {\n                init.body = queryStringify(init.body);\n            }\n\n        }\n\n        // Create a request with encoded body\n        var req = new Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n\n    }\n\n}\n\n/**\n * @name IApiError\n * @property {string} stack\n * @property {string} originalMessage\n * @property {ApiResponse} apiResponse\n */\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Client.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport * as utils from '../core/Utils';\n\n/**\n * Creates a response\n * @param stringBody\n * @param init\n * @return {Response}\n */\nexport function createResponse(stringBody, init) {\n\n    init = init || {};\n\n    var response = new Response(stringBody, init);\n\n    //TODO Wait for https://github.com/bitinn/node-fetch/issues/38\n    if (utils.isNodeJS()) {\n\n        response._text = stringBody;\n        response._decode = function() {\n            return this._text;\n        };\n\n    }\n\n    return response;\n\n}\n\nexport function findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function(res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Utils.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport * as utils from './Utils';\n\nexport default class ApiResponse {\n\n    static _contentType = 'Content-Type';\n    static _jsonContentType = 'application/json';\n    static _multipartContentType = 'multipart/mixed';\n    static _urlencodedContentType = 'application/x-www-form-urlencoded';\n    static _headerSeparator = ':';\n    static _bodySeparator = '\\n\\n';\n    static _boundarySeparator = '--';\n\n    /**\n     * @param {Request} request\n     * @param {Response} response\n     * @param {string} responseText\n     */\n    constructor(request, response, responseText) {\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n\n    }\n\n    /**\n     * @return {Response}\n     */\n    response() {\n        return this._response;\n    }\n\n    /**\n     * @return {Request}\n     */\n    request() {\n        return this._request;\n    }\n\n    /**\n     * @return {boolean}\n     */\n    ok() {\n        return this._response && this._response.ok;\n    }\n\n    /**\n     * @return {string}\n     */\n    text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    }\n\n    /**\n     * @return {object}\n     */\n    json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    }\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n    error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') +\n                      (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n\n        } catch (e) {}\n\n        return message;\n\n    }\n\n    /**\n     * @return {ApiResponse[]}\n     */\n    multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map((part, i) => {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n\n            });\n\n        }\n\n        return this._multipart;\n\n    }\n\n    _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    }\n\n    _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    }\n\n    _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    }\n\n    _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    }\n\n    _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    }\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n    static create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = (headersAndBody.length > 1) ? headersAndBody.shift() : '';\n\n        text = headersAndBody.join(ApiResponse._bodySeparator);\n\n        (headersText || '')\n            .split('\\n')\n            .forEach((header) => {\n\n                var split = header.trim().split(ApiResponse._headerSeparator),\n                    key = split.shift().trim(),\n                    value = split.join(ApiResponse._headerSeparator).trim();\n\n                if (key) headers.append(key, value);\n\n            });\n\n        return new ApiResponse(null, utils.createResponse(text, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/ApiResponse.js\n **/","import Registry from './Registry';\nimport {default as HttpClient} from '../http/Client';\n\nexport default class Client extends HttpClient {\n\n    constructor() {\n        super();\n        this._registry = new Registry();\n    }\n\n    registry() {\n        return this._registry;\n    }\n\n    async _loadResponse(request) {\n\n        var mock = this._registry.find(request);\n\n        return await mock.getResponse(request);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/ClientMock.js\n **/","import Mock from './Mock';\n\nexport default class Registry {\n\n    constructor() {\n        this._mocks = [];\n    }\n\n    add(mock) {\n        this._mocks.push(mock);\n        return this;\n    }\n\n    clear() {\n        this._mocks = [];\n        return this;\n    }\n\n    find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url +\n                                                 ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n\n    }\n\n    apiCall(method, path, response, status, statusText) {\n\n        this.add(new Mock(method, path, response, status, statusText));\n\n        return this;\n\n    }\n\n    authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n\n    }\n\n    logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n\n    }\n\n    presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n\n    }\n\n    subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': [\n                '/restapi/v1.0/account/~/extension/~/presence'\n            ],\n            'expirationTime': new Date(date.getTime() + (expiresIn * 1000)).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + (15 * 60 * 60 * 1000)).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Registry.js\n **/","import ApiResponse from '../http/ApiResponse';\nimport {delay} from '../core/Utils';\nimport {createResponse} from '../http/Utils';\n\nexport default class Mock {\n\n    constructor(method, path, json, status, statusText, delay) {\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    path() {\n        return this._path;\n    }\n\n    method() {\n        return this._method;\n    }\n\n    test(request) {\n\n        return request.url.indexOf(this._path) > -1 &&\n               request.method.toUpperCase() == this._method;\n\n    }\n\n    async getResponse(request) {\n\n        await delay(this._delay);\n\n        return this.createResponse(this._json);\n\n    }\n\n    createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = createResponse(str, init);\n\n        res.headers.set(ApiResponse._contentType, ApiResponse._jsonContentType);\n\n        return res;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Mock.js\n **/","import Observable from '../core/Observable';\nimport Queue from '../core/Queue';\nimport Auth from './Auth';\nimport {Promise} from '../core/Externals';\nimport {queryStringify, parseQueryString, delay} from '../core/Utils';\n\nexport default class Platform extends Observable {\n\n    static _urlPrefix = '/restapi';\n    static _apiVersion = 'v1.0';\n    static _accessTokenTtl = null; // Platform server by default sets it to 60 * 60 = 1 hour\n    static _refreshTokenTtl = 10 * 60 * 60; // 10 hours\n    static _refreshTokenTtlRemember = 7 * 24 * 60 * 60; // 1 week\n    static _tokenEndpoint = '/restapi/oauth/token';\n    static _revokeEndpoint = '/restapi/oauth/revoke';\n    static _authorizeEndpoint = '/restapi/oauth/authorize';\n    static _refreshDelayMs = 100;\n    static _cacheId = 'platform';\n    static _clearCacheOnRefreshError = true;\n\n    events = {\n        beforeLogin: 'beforeLogin',\n        loginSuccess: 'loginSuccess',\n        loginError: 'loginError',\n        beforeRefresh: 'beforeRefresh',\n        refreshSuccess: 'refreshSuccess',\n        refreshError: 'refreshError',\n        beforeLogout: 'beforeLogout',\n        logoutSuccess: 'logoutSuccess',\n        logoutError: 'logoutError'\n    };\n\n    constructor(client, cache, server, appKey, appSecret) {\n\n        super();\n\n        this._server = server;\n        this._appKey = appKey;\n        this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        this._cache = cache;\n\n        /** @type {Client} */\n        this._client = client;\n\n        this._queue = new Queue(this._cache, Platform._cacheId + '-refresh');\n\n        this._auth = new Auth(this._cache, Platform._cacheId);\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    auth() {\n        return this._auth;\n    }\n\n    /**\n     * @return {Client}\n     */\n    client() {\n        return this._client;\n    }\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n    createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += (path.indexOf('?') > -1 ? '&' : '?');\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n\n    }\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @return {string}\n     */\n    authUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + queryStringify({\n                'response_type': 'code',\n                'redirect_uri': options.redirectUri || '',\n                'client_id': this._appKey,\n                'state': options.state || '',\n                'brand_id': options.brandId || '',\n                'display': options.display || '',\n                'prompt': options.prompt || ''\n            }), {addServer: true})\n\n    }\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n    parseAuthRedirectUrl(url) {\n\n        var qs = parseQueryString(url.split('?').reverse()[0]),\n            error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n\n    }\n\n    /**\n     * @return {Promise<boolean>}\n     */\n    async loggedIn() {\n\n        try {\n            await this._ensureAuthentication();\n            return true;\n        } catch (e) {\n            return false;\n        }\n\n    }\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @returns {Promise<ApiResponse>}\n     */\n    async login(options) {\n\n        try {\n\n            options = options || {};\n\n            options.remember = options.remember || false;\n\n            this.emit(this.events.beforeLogin);\n\n            var body = {\n                \"access_token_ttl\": Platform._accessTokenTtl,\n                \"refresh_token_ttl\": options.remember ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n            };\n\n            if (!options.code) {\n\n                body.grant_type = 'password';\n                body.username = options.username;\n                body.password = options.password;\n                body.extension = options.extension || '';\n\n            } else if (options.code) {\n\n                body.grant_type = 'authorization_code';\n                body.code = options.code;\n                body.redirect_uri = options.redirectUri;\n                //body.client_id = this.getCredentials().key; // not needed\n\n            }\n\n            if (options.endpointId) body.endpoint_id = options.endpointId;\n\n            var apiResponse = await this._tokenRequest(Platform._tokenEndpoint, body),\n                json = apiResponse.json();\n\n            this._auth\n                .setData(json)\n                .setRemember(options.remember);\n\n            this.emit(this.events.loginSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            this._cache.clean();\n\n            this.emit(this.events.loginError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async refresh() {\n\n        try {\n\n            this.emit(this.events.beforeRefresh);\n\n            if (this._queue.isPaused()) {\n\n                await this._queue.poll();\n\n                if (!this._isAccessTokenValid()) {\n                    throw new Error('Automatic authentification timeout');\n                }\n\n                this.emit(this.events.refreshSuccess, null);\n\n                return null;\n\n            }\n\n            this._queue.pause();\n\n            // Make sure all existing AJAX calls had a chance to reach the server\n            await delay(Platform._refreshDelayMs);\n\n            // Perform sanity checks\n            if (!this._auth.refreshToken()) throw new Error('Refresh token is missing');\n            if (!this._auth.refreshTokenValid()) throw new Error('Refresh token has expired');\n            if (!this._queue.isPaused()) throw new Error('Queue was resumed before refresh call');\n\n            /** @type {ApiResponse} */\n            var res = await this._tokenRequest(Platform._tokenEndpoint, {\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": this._auth.refreshToken(),\n                    \"access_token_ttl\": Platform._accessTokenTtl,\n                    \"refresh_token_ttl\": this._auth.remember() ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                }),\n                json = res.json();\n\n            if (!json.access_token) {\n                throw this._client.makeError(new Error('Malformed OAuth response'), res);\n            }\n\n            this._auth.setData(json);\n            this._queue.resume();\n\n            this.emit(this.events.refreshSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            e = this._client.makeError(e);\n\n            if (Platform._clearCacheOnRefreshError) {\n                this._cache.clean();\n            }\n\n            this.emit(this.events.refreshError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async logout() {\n\n        try {\n\n            this.emit(this.events.beforeLogout);\n\n            this._queue.pause();\n\n            var res = await this._tokenRequest(Platform._revokeEndpoint, {\n                token: this._auth.accessToken()\n            });\n\n            this._queue.resume();\n            this._cache.clean();\n\n            this.emit(this.events.logoutSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            this._queue.resume();\n\n            this.emit(this.events.logoutError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n    async inflateRequest(request, options) {\n\n        options = options || {};\n\n        if (options.skipAuthCheck) return request;\n\n        await this._ensureAuthentication();\n\n        request.headers.set('Authorization', this._authHeader());\n        //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n        //TODO Add User-Agent here\n\n        return request;\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request, options) {\n\n        try {\n\n            request = await this.inflateRequest(request, options);\n\n            return (await this._client.sendRequest(request));\n\n        } catch (e) {\n\n            // Guard is for errors that come from polling\n            if (!e.apiResponse || !e.apiResponse.response() || (e.apiResponse.response().status != 401)) throw e;\n\n            this._auth.cancelAccessToken();\n\n            return (await this.sendRequest(request, options));\n\n        }\n\n    }\n\n    /**\n     * General purpose function to send anything to server\n     * @param {string} options.url\n     * @param {object} [options.body]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async send(options = {}) {\n\n        //FIXME https://github.com/bitinn/node-fetch/issues/43\n        options.url = this.createUrl(options.url, {addServer: true});\n\n        return await this.sendRequest(this._client.createRequest(options), options);\n\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async get(url, query, options) {\n        options = options || {};\n        options.method = 'GET';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async post(url, body, query, options) {\n        options = options || {};\n        options.method = 'POST';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} [body]\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async put(url, body, query, options) {\n        options = options || {};\n        options.method = 'PUT';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {string} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async 'delete'(url, query, options) {\n        options = options || {};\n        options.method = 'DELETE';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    async _tokenRequest(path, body) {\n\n        return await this.send({\n            url: path,\n            skipAuthCheck: true,\n            body: body,\n            method: 'POST',\n            headers: {\n                'Authorization': 'Basic ' + this._apiKey(),\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        });\n\n    }\n\n    async _ensureAuthentication() {\n\n        if (this._isAccessTokenValid()) return null;\n        return await this.refresh();\n\n    }\n\n    _isAccessTokenValid() {\n\n        return (this._auth.accessTokenValid() && !this._queue.isPaused());\n\n    }\n\n    _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return (typeof btoa == 'function') ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    }\n\n    _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Platform.js\n **/","export default class Auth {\n\n    static refreshHandicapMs = 60 * 1000; // 1 minute\n    static forcedTokenType = 'forced';\n\n    constructor(cache, cacheId) {\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n\n    }\n\n    accessToken() {\n        return this.data().access_token;\n    }\n\n    refreshToken() {\n        return this.data().refresh_token;\n    }\n\n    tokenType() {\n        return this.data().token_type;\n    }\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n    data() {\n\n        return this._cache.getItem(this._cacheId) || {\n                token_type: '',\n                access_token: '',\n                expires_in: 0,\n                refresh_token: '',\n                refresh_token_expires_in: 0\n            };\n\n    }\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n    setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach((key) => {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + (data.expires_in * 1000);\n        data.refresh_token_expire_time = Date.now() + (data.refresh_token_expires_in * 1000);\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    accessTokenValid() {\n\n        var authData = this.data();\n        return (authData.token_type === Auth.forcedTokenType || (authData.expire_time - Auth.refreshHandicapMs > Date.now()));\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    refreshTokenValid() {\n\n        return (this.data().refresh_token_expire_time > Date.now());\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n\n    }\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n    forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n\n    }\n\n    /**\n     * @param remember\n     * @return {Auth}\n     */\n    setRemember(remember) {\n\n        return this.setData({remember: remember});\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    remember() {\n\n        return !!this.data().remember;\n\n    }\n\n}\n\n//export interface IAuthData {\n//    remember?:boolean;\n//    token_type?:string;\n//    access_token?:string;\n//    expires_in?:number; // actually it's string\n//    expire_time?:number;\n//    refresh_token?:string;\n//    refresh_token_expires_in?:number; // actually it's string\n//    refresh_token_expire_time?:number;\n//    scope?:string;\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Auth.js\n **/","import PubnubMock from './PubnubMock.js';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMockFactory {\n\n    constructor() {\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    init(options) {\n        return new PubnubMock(options);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubFactory.js\n **/","import Observable from '../core/Observable';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMock extends Observable {\n\n    constructor(options) {\n        super();\n        this.options = options;\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    ready() {}\n\n    subscribe(options) {\n        this.on('message-' + options.channel, options.message);\n    }\n\n    unsubscribe(options) {\n        this.off('message-' + options.channel);\n    }\n\n    receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubMock.js\n **/","import Observable from '../core/Observable';\nimport Client from '../http/Client';\nimport {poll, stopPolling, delay} from '../core/Utils';\n\nexport default class Subscription extends Observable {\n\n    static _renewHandicapMs = 2 * 60 * 1000;\n    static _pollInterval = 10 * 1000;\n\n    events = {\n        notification: 'notification',\n        removeSuccess: 'removeSuccess',\n        removeError: 'removeError',\n        renewSuccess: 'renewSuccess',\n        renewError: 'renewError',\n        subscribeSuccess: 'subscribeSuccess',\n        subscribeError: 'subscribeError'\n    };\n\n    constructor(pubnubFactory, platform) {\n\n        super();\n\n        this._pubnubFactory = pubnubFactory;\n        this._platform = platform;\n        this._pubnub = null;\n        this._timeout = null;\n        this._subscription = {};\n\n    }\n\n    subscribed(){\n\n        return !!(this._subscription.id &&\n                  this._subscription.deliveryMode &&\n                  this._subscription.deliveryMode.subscriberKey &&\n                  this._subscription.deliveryMode.address);\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    alive() {\n\n        return this.subscribed() && Date.now() < this.expirationTime();\n\n    }\n\n    expirationTime() {\n        return new Date(this._subscription.expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    }\n\n    setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n\n        this._subscription = subscription;\n\n        if (!this._pubnub) this._subscribeAtPubnub();\n\n        this._setTimeout();\n\n        return this;\n\n    }\n\n    subscription() {\n        return this._subscription;\n    }\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @returns {Promise<ApiResponse>}\n     */\n    async register() {\n\n        if (this.alive()) {\n            return await this.renew();\n        } else {\n            return await this.subscribe();\n        }\n\n    }\n\n    eventFilters() {\n        return this._subscription.eventFilters || [];\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    setEventFilters(events) {\n        this._subscription.eventFilters = events;\n        return this;\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async subscribe() {\n\n        try {\n\n            this._clearTimeout();\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.post('/restapi/v1.0/subscription', {\n                    eventFilters: this._getFullEventFilters(),\n                    deliveryMode: {\n                        transportType: 'PubNub'\n                    }\n                }),\n                json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.subscribeSuccess, response);\n\n            return response;\n\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.subscribeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async renew() {\n\n        try {\n\n            this._clearTimeout();\n\n            if (!this.alive()) throw new Error('Subscription is not alive');\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.put('/restapi/v1.0/subscription/' + this._subscription.id, {\n                eventFilters: this._getFullEventFilters()\n            });\n\n            var json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.renewSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.renewError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async remove() {\n\n        try {\n\n            if (!this.subscribed()) throw new Error('No subscription');\n\n            var response = await this._platform.delete('/restapi/v1.0/subscription/' + this._subscription.id);\n\n            this.reset()\n                .emit(this.events.removeSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.emit(this.events.removeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    resubscribe() {\n\n        return this.reset().setEventFilters(this.eventFilters()).subscribe();\n\n    }\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n    reset() {\n        this._clearTimeout();\n        if (this.subscribed() && this._pubnub) this._pubnub.unsubscribe({channel: this._subscription.deliveryMode.address});\n        this._subscription = {};\n        return this;\n    }\n\n    _getFullEventFilters() {\n\n        return this.eventFilters().map((event) => {\n            return this._platform.createUrl(event);\n        });\n\n    }\n\n    _setTimeout() {\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        poll((next)=> {\n\n            if (this.alive()) return next();\n\n            this.renew();\n\n        }, Subscription._pollInterval, this._timeout);\n\n        return this;\n\n    }\n\n    _clearTimeout() {\n\n        stopPolling(this._timeout);\n\n        return this;\n\n    }\n\n    _decrypt(message) {\n\n        if (!this.subscribed()) throw new Error('No subscription');\n\n        if (this._subscription.deliveryMode.encryptionKey) {\n\n            var PUBNUB = this._pubnubFactory;\n\n            message = PUBNUB.crypto_obj.decrypt(message, this._subscription.deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n\n        }\n\n        return message;\n\n    }\n\n    _notify(message) {\n\n        this.emit(this.events.notification, this._decrypt(message));\n\n        return this;\n\n    }\n\n    _subscribeAtPubnub() {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var PUBNUB = this._pubnubFactory;\n\n        this._pubnub = PUBNUB.init({\n            ssl: true,\n            subscribe_key: this._subscription.deliveryMode.subscriberKey\n        });\n\n        this._pubnub.ready();\n\n        this._pubnub.subscribe({\n            channel: this._subscription.deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: () => {}\n        });\n\n        return this;\n\n    }\n\n}\n\n//export interface ISubscription {\n//    id?:string;\n//    uri?: string;\n//    eventFilters?:string[];\n//    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n//    expiresIn?:number;\n//    deliveryMode?: {\n//        transportType?:string;\n//        encryption?:boolean;\n//        address?:string;\n//        subscriberKey?:string;\n//        encryptionKey?:string;\n//        secretKey?:string;\n//    };\n//    creationTime?:string; // 2014-03-12T19:54:35.613Z\n//    status?:string; // Active\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/Subscription.js\n **/","import Subscription from './Subscription';\nimport Queue from '../core/Queue';\n\nexport default class CachedSubscription extends Subscription {\n\n    constructor(pubnubFactory, platform, cache, cacheKey) {\n\n        super(pubnubFactory, platform);\n\n        this._cache = cache;\n        this._cacheKey = cacheKey;\n        this._renewQueue = new Queue(this._cache, cacheKey + '-renew');\n        this._resubscribeQueue = new Queue(this._cache, cacheKey + '-resubscribe');\n\n        this.events = {\n            ...this.events,\n            queuedRenewSuccess: 'queuedRenewSuccess',\n            queuedRenewError: 'queuedRenewError',\n            queuedResubscribeSuccess: 'queuedResubscribeSuccess',\n            queuedResubscribeError: 'queuedResubscribeError'\n        };\n\n        this.on(this.events.renewError, () => {\n            this.resubscribe();\n        });\n\n        this.on([this.events.subscribeSuccess, this.events.renewSuccess], () => {\n            this._cache.setItem(this._cacheKey, this.subscription());\n        });\n\n        this.on(this.events.removeSuccess, () => {\n            this._cache.removeItem(this._cacheKey);\n        });\n\n    }\n\n    /**\n     * TODO Combine with Platform.refresh and move elsewhere\n     * @param actionCb\n     * @param queue\n     * @param successEvent\n     * @param errorEvent\n     * @param errorMessage\n     * @return {*}\n     * @private\n     */\n    async _queue(actionCb, queue, successEvent, errorEvent, errorMessage) {\n\n        try {\n\n            if (queue.isPaused()) {\n\n                await queue.poll();\n\n                if (!this.alive()) {\n                    throw new Error(errorMessage);\n                }\n\n                this.emit(successEvent, null);\n\n                return null;\n\n            }\n\n            queue.pause();\n\n            var res = await actionCb.call(this);\n\n            queue.resume();\n\n            this.emit(successEvent, res);\n\n            return res;\n\n        } catch (e) {\n\n            this.emit(errorEvent, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    renew() {\n\n        return this._queue(\n            super.renew,\n            this._renewQueue,\n            this.events.queuedRenewSuccess,\n            this.events.queuedRenewError,\n            'Subscription is not alive after renew timeout'\n        );\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    resubscribe() {\n\n        return this._queue(\n            super.resubscribe,\n            this._resubscribeQueue,\n            this.events.queuedResubscribeSuccess,\n            this.events.queuedResubscribeError,\n            'Subscription is not alive after resubscribe timeout'\n        );\n\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {CachedSubscription}\n     */\n    restore(events) {\n\n        var cachedSubscriptionData = this._cache.getItem(this._cacheKey);\n\n        if (cachedSubscriptionData) {\n            try {\n                this.setSubscription(cachedSubscriptionData);\n            } catch (e) {}\n        } else {\n            this.setEventFilters(events);\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/CachedSubscription.js\n **/"],"sourceRoot":"/source/"}