{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","ringcentral.js","webpack:/webpack/bootstrap 5d800152b5167bf356e8","webpack:///src/SDK.js","webpack:///src/core/Utils.js","webpack:///src/core/Externals.js","webpack:/external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}","webpack:/external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}","webpack:/external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}","webpack:///src/core/Cache.js","webpack:///src/core/Observable.js","webpack:///src/core/Queue.js","webpack:///src/http/Client.js","webpack:///src/http/Utils.js","webpack:///src/http/ApiResponse.js","webpack:///src/mocks/ClientMock.js","webpack:///src/mocks/Registry.js","webpack:///src/mocks/Mock.js","webpack:///src/platform/Platform.js","webpack:///src/platform/Auth.js","webpack:///src/pubnub/PubnubFactory.js","webpack:///src/pubnub/PubnubMock.js","webpack:///src/subscription/Subscription.js","webpack:///src/subscription/CachedSubscription.js","webpack:///~/regenerator/runtime.js"],"names":["root","factory","exports","module","require","define","amd","undefined","this","__WEBPACK_EXTERNAL_MODULE_4__","__WEBPACK_EXTERNAL_MODULE_5__","__WEBPACK_EXTERNAL_MODULE_6__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_interopRequireWildcard","newObj","key","Object","prototype","hasOwnProperty","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","_coreUtils","Utils","_coreCache","_coreCache2","_coreExternals","Externals","_coreObservable","_coreObservable2","_coreQueue","_coreQueue2","_httpClient","_httpClient2","_httpApiResponse","_httpApiResponse2","_httpUtils","HttpUtils","_mocksClientMock","_mocksClientMock2","_mocksMock","_mocksMock2","_mocksRegistry","_mocksRegistry2","_platformPlatform","_platformPlatform2","_platformAuth","_platformAuth2","_pubnubPubnubFactory","_pubnubPubnubFactory2","_subscriptionSubscription","_subscriptionSubscription2","_subscriptionCachedSubscription","_subscriptionCachedSubscription2","SDK","options","_cache","localStorage","cachePrefix","_client","client","_platform","server","appKey","appSecret","_pubnubFactory","pubnubFactory","PUBNUB","value","sandbox","production","platform","createSubscription","createCachedSubscription","cacheKey","cache","Cache","Observable","Queue","Client","ApiResponse","Auth","Platform","Subscription","Registry","Mock","PubnubMockFactory","queryStringify","parameters","array","keys","forEach","k","v","isArray","vv","push","encodeURIComponent","join","parseQueryString","queryString","argsParsed","split","arg","decodeURIComponent","indexOf","trim","pair","isFunction","Array","poll","fn","interval","timeout","stopPolling","next","delay","setTimeout","clearTimeout","isNodeJS","process","isBrowser","window","_ExternalsJs","Promise","resolve","reject","_es6Promise","_es6Promise2","_nodeFetch","_nodeFetch2","_pubnub","_pubnub2","Function","fetch","Request","Response","Headers","storage","prefix","setPrefix","_storage","_prefix","defaultPrefix","setItem","data","_prefixKey","JSON","stringify","removeItem","getItem","item","parse","clean","off","hasListeners","event","_listeners","on","events","callback","_this","Error","emit","_this2","_len","arguments","args","_key","result","some","apply","_this3","cb","_Utils","cacheId","_cacheId","_promise","isPaused","time","Date","now","parseInt","_releaseTimeout","pause","resume","_pollInterval","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_ApiResponse","_ApiResponse2","_Observable","beforeRequest","requestSuccess","requestError","sendRequest","request","apiResponse","regeneratorRuntime","async","context$2$0","prev","awrap","_loadResponse","_response","sent","_isMultipart","_isJson","response","text","_text","ok","abrupt","t0","makeError","stop","e","originalMessage","message","error","createRequest","init","headers","url","method","_allowedMethods","credentials","mode","query","findHeaderName","_jsonContentType","body","contentTypeHeaderName","_contentType","contentType","_urlencodedContentType","req","originalBody","createResponse","stringBody","utils","_decode","name","toLowerCase","reduce","res","responseText","_request","_json","_multipart","json","skipOKCheck","status","statusText","error_description","description","multipart","boundary","_getContentType","match","parts","toString","_boundarySeparator","shift","pop","statusInfo","map","part","_isContentType","get","_multipartContentType","_isUrlEncoded","replace","headersAndBody","_bodySeparator","headersText","header","_headerSeparator","append","_Registry","_Registry2","_HttpClient","_registry","registry","mock","find","getResponse","_Mock","_Mock2","_mocks","add","clear","test","path","apiCall","authentication","access_token","token_type","expires_in","refresh_token","refresh_token_expires_in","scope","expireTime","getTime","logout","presenceLoad","uri","extension","extensionNumber","activeCalls","presenceStatus","telephonyStatus","userStatus","dndStatus","extensionId","subscribeGeneric","expiresIn","date","eventFilters","expirationTime","toISOString","deliveryMode","transportType","encryption","address","subscriberKey","secretKey","creationTime","subscribeOnPresence","detailed","encryptionAlgorithm","encryptionKey","tokenRefresh","failure","_method","toUpperCase","_path","_delay","_status","_statusText","str","set","_Auth","_Auth2","beforeLogin","loginSuccess","loginError","beforeRefresh","refreshSuccess","refreshError","beforeLogout","logoutSuccess","logoutError","_server","_appKey","_appSecret","_queue","_auth","auth","createUrl","builtUrl","hasHttp","addServer","_urlPrefix","_apiVersion","addMethod","addToken","accessToken","authUrl","_authorizeEndpoint","response_type","redirect_uri","redirectUri","client_id","state","brand_id","brandId","display","prompt","parseAuthRedirectUrl","qs","reverse","loggedIn","_ensureAuthentication","login","remember","access_token_ttl","_accessTokenTtl","refresh_token_ttl","_refreshTokenTtlRemember","_refreshTokenTtl","code","grant_type","username","password","endpointId","endpoint_id","_tokenRequest","_tokenEndpoint","setData","setRemember","refresh","_isAccessTokenValid","_refreshDelayMs","refreshToken","refreshTokenValid","_clearCacheOnRefreshError","_revokeEndpoint","token","inflateRequest","skipAuthCheck","_authHeader","cancelAccessToken","send","post","put","Authorization","_apiKey","Content-Type","accessTokenValid","apiKey","btoa","Buffer","tokenType","newData","expire_time","refresh_token_expire_time","authData","forcedTokenType","refreshHandicapMs","forceAuthentication","_PubnubMockJs","_PubnubMockJs2","crypto_obj","PubnubMock","ready","subscribe","channel","unsubscribe","receiveMessage","msg","notification","removeSuccess","removeError","renewSuccess","renewError","subscribeSuccess","subscribeError","_timeout","_subscription","subscribed","alive","_renewHandicapMs","setSubscription","subscription","_clearTimeout","_subscribeAtPubnub","_setTimeout","register","renew","addEventFilters","setEventFilters","concat","_getFullEventFilters","reset","remove","resubscribe","_decrypt","decrypt","encryptKey","keyEncoding","keyLength","_notify","ssl","subscribe_key","bind","connect","_extends","assign","source","_Subscription2","_Subscription3","CachedSubscription","_Subscription","_cacheKey","_renewQueue","_resubscribeQueue","queuedRenewSuccess","queuedRenewError","queuedResubscribeSuccess","queuedResubscribeError","actionCb","queue","successEvent","errorEvent","errorMessage","restore","cachedSubscriptionData","global","wrap","innerFn","outerFn","self","tryLocsList","generator","Generator","context","Context","_invoke","makeInvokeMethod","tryCatch","type","err","GeneratorFunction","GeneratorFunctionPrototype","defineIteratorMethods","AwaitArgument","AsyncIterator","invoke","then","invokeNext","invokeThrow","unwrapped","enqueue","callInvokeWithMethodAndArg","previousPromise","domain","GenStateSuspendedStart","GenStateExecuting","GenStateCompleted","doneResult","delegate","iterator","returnMethod","record","info","done","GenStateSuspendedYield","resultName","nextLoc","dispatchException","ContinueSentinel","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","values","iterable","iteratorMethod","iteratorSymbol","isNaN","hasOwn","Symbol","inModule","runtime","Gp","displayName","isGeneratorFunction","genFun","ctor","mark","iter","object","skipTempReset","charAt","slice","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield"],"mappings":"CAAA,SAAAA,EAAAC,GACA,gBAAAC,UAAA,gBAAAC,QACAA,OAAAD,QAAAD,EAAAG,QAAA,eAAAA,QAAA,cAAAA,QAAA,WACA,kBAAAC,SAAAA,OAAAC,IACAD,QAAA,CAAA,CAAA,UAAAJ,GACA,gBAAAC,SACAA,QAAA,IAAAD,EAAAG,QAAA,eAAAA,QAAA,cAAAA,QAAA,YAEAJ,EAAA,YAAAA,EAAA,gBAAiDA,EAAA,YAAA,IAAAC,EAAAD,EAAAO,QAAAP,EAAAO,QAAAP,EAAAO,WAChDC,KAAA,SAAAC,EAAAC,EAAAC,GACD,MCAgB,UAAUC,GCN1B,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAZ,OAGA,IAAAC,GAAAY,EAAAD,IACAZ,WACAc,GAAAF,EACAG,QAAA,EAUA,OANAL,GAAAE,GAAAI,KAAAf,EAAAD,QAAAC,EAAAA,EAAAD,QAAAW,GAGAV,EAAAc,QAAA,EAGAd,EAAAD,QAvBA,GAAAa,KAqCA,OATAF,GAAAM,EAAAP,EAGAC,EAAAO,EAAAL,EAGAF,EAAAQ,EAAA,UAGAR,EAAA,KDgBM,SAASV,EAAQD,EAASW,GAEhCV,EAAOD,QAAUW,EAAoB,IAK/B,SAASV,EAAQD,EAASW,GAEhC,YAMA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASG,GAAwBH,GAAO,GAAIA,GAAOA,EAAIC,WAAc,MAAOD,EAAc,IAAII,KAAa,IAAW,MAAPJ,EAAe,IAAK,GAAIK,KAAOL,GAAWM,OAAOC,UAAUC,eAAeb,KAAKK,EAAKK,KAAMD,EAAOC,GAAOL,EAAIK,GAAmC,OAAzBD,GAAO,WAAaJ,EAAYI,EAErQ,QAASK,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCARhHjC,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MAQ7hBe,EAAapC,EE3EM,GAAXqC,EAAKxB,EAAAuB,GF+EbE,EAAatC,EE9EC,GFgFduC,EAAc9B,EAAuB6B,GAErCE,EAAiBxC,EEjFM,GAAfyC,EAAS5B,EAAA2B,GFqFjBE,EAAkB1C,EEpFC,GFsFnB2C,EAAmBlC,EAAuBiC,GAE1CE,EAAa5C,EEvFC,GFyFd6C,EAAcpC,EAAuBmC,GAErCE,EAAc9C,EEzFC,IF2Ff+C,EAAetC,EAAuBqC,GAEtCE,EAAmBhD,EE5FC,IF8FpBiD,EAAoBxC,EAAuBuC,GAE3CE,EAAalD,EE/FU,IAAfmD,EAAStC,EAAAqC,GFmGjBE,EAAmBpD,EEjGa,IFmGhCqD,EAAoB5C,EAAuB2C,GAE3CE,EAAatD,EEpGA,IFsGbuD,EAAc9C,EAAuB6C,GAErCE,EAAiBxD,EEvGA,IFyGjByD,EAAkBhD,EAAuB+C,GAEzCE,EAAoB1D,EEzGH,IF2GjB2D,EAAqBlD,EAAuBiD,GAE5CE,EAAgB5D,EE5GH,IF8Gb6D,EAAiBpD,EAAuBmD,GAExCE,EAAuB9D,EE9GG,IFgH1B+D,EAAwBtD,EAAuBqD,GAE/CE,EAA4BhE,EEhHP,IFkHrBiE,EAA6BxD,EAAuBuD,GAEpDE,EAAkClE,EEnHP,IFqH3BmE,EAAmC1D,EAAuByD,EEnH9DlE,GAAQ,GFuHR,IErHqBoE,GAAG,WAqBT,QArBMA,GAqBLC,GF4HRlD,EAAgBxB,KEjJHyE,GAuBbC,EAAUA,MAEV1E,KAAK2E,OAAS,GAAA/B,GAAA,WAAUE,EAAU8B,aAAcF,EAAQG,aAExD7E,KAAK8E,QAAUJ,EAAQK,QAAU,GAAA3B,GAAA,WAEjCpD,KAAKgF,UAAY,GAAAhB,GAAA,WAAahE,KAAK8E,QAAS9E,KAAK2E,OAAQD,EAAQO,OAAQP,EAAQQ,OAAQR,EAAQS,WAEjGnF,KAAKoF,eAAiBV,EAAQW,eAAiBvC,EAAUwC,OF8M7D,MAvHA1D,GEtHiB6C,EAAG,OFuHhBrD,IAAK,UACLmE,MEtHa,QFuHbpD,YAAY,IAEZf,IAAK,SACLmE,OEvHAC,QAAS,2CACTC,WAAY,oCFuIZtD,YAAY,KE7ICsC,EAAGnD,UAsCpBoE,SAAQ,WACJ,MAAO1F,MAAKgF,WAvCCP,EAAGnD,UA6CpBqE,mBAAkB,WACd,MAAO,IAAArB,GAAA,WAAiBtE,KAAKoF,eAAgBpF,KAAKgF,YA9CrCP,EAAGnD,UAoDpBsE,yBAAwB,SAACC,GACrB,MAAO,IAAArB,GAAA,WAAuBxE,KAAKoF,eAAgBpF,KAAKgF,UAAWhF,KAAK2E,OAAQkB,IArDnEpB,EAAGnD,UA2DpBwE,MAAK,WACD,MAAO9F,MAAK2E,QFkIhB/C,EE9LiB6C,EAAG,OF+LhBrD,IAAK,OACLmE,OEhIAQ,MAAKnD,EAAA,WACLoD,WAAUhD,EAAA,WACVN,MAAOA,EACPI,UAAWA,EACXmD,MAAK/C,EAAA,YFmILf,YAAY,IAEZf,IAAK,OACLmE,OElIAW,OAAM9C,EAAA,WACN+C,YAAW7C,EAAA,WACXZ,MAAOc,GFqIPrB,YAAY,IAEZf,IAAK,WACLmE,OEpIAa,KAAIlC,EAAA,WACJmC,SAAQrC,EAAA,YFuIR7B,YAAY,IAEZf,IAAK,eACLmE,OEtIAe,aAAYhC,EAAA,YFyIZnC,YAAY,IAEZf,IAAK,QACLmE,OExIAW,OAAMxC,EAAA,WACN6C,SAAQzC,EAAA,WACR0C,KAAI5C,EAAA,YF2IJzB,YAAY,IAEZf,IAAK,SACLmE,OE1IAkB,kBAAiBrC,EAAA,YF6IjBjC,YAAY,KE1OCsC,IFgPrB/E,GAAQ,WEhPa+E,EFiPrB9E,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YGvQO,SAASqG,GAAeC,GAE3B,GAAIC,KAkBJ,OAhBAD,GAAaA,MAEbtF,OAAOwF,KAAKF,GAAYG,QAAQ,SAACC,GAE7B,GAAIC,GAAIL,EAAWI,EAEfE,GAAQD,GACRA,EAAEF,QAAQ,SAACI,GACPN,EAAMO,KAAKC,mBAAmBL,GAAK,IAAMK,mBAAmBF,MAGhEN,EAAMO,KAAKC,mBAAmBL,GAAK,IAAMK,mBAAmBJ,MAK7DJ,EAAMS,KAAK,KAUf,QAASC,GAAiBC,GAE7B,GAAIC,KA2BJ,OAzBAD,GAAYE,MAAM,KAAKX,QAAQ,SAACY,GAI5B,GAFAA,EAAMC,mBAAmBD,GAED,IAApBA,EAAIE,QAAQ,KAEZJ,EAAWE,EAAIG,SAAU,MAEtB,CAEH,GAAIC,GAAOJ,EAAID,MAAM,KACjBrG,EAAM0G,EAAK,GAAGD,OACdtC,EAAQuC,EAAK,GAAGD,MAEhBzG,KAAOoG,IACHpG,IAAOoG,KAAeP,EAAQO,EAAWpG,MAAOoG,EAAWpG,IAAQoG,EAAWpG,KAClFoG,EAAWpG,GAAK+F,KAAK5B,IAErBiC,EAAWpG,GAAOmE,KAOvBiC,EAQJ,QAASO,GAAWhH,GACvB,MAAsB,kBAARA,GAOX,QAASkG,GAAQlG,GACpB,MAAOiH,OAAMf,QAAUe,MAAMf,QAAQlG,GAAsB,eAARA,GAQhD,QAASkH,GAAKC,EAAIC,EAAUC,GAE/BzI,EAAOD,QAAQ2I,YAAYD,GAE3BD,EAAWA,GAAY,GAEvB,IAAIG,GAAO,QAAPA,GAAQC,GAMR,MAJAA,GAAQA,GAASJ,EAEjBA,EAAWI,EAEJC,WAAW,WAEdN,EAAGI,EAAMC,IAEVA,GAIP,OAAOD,KAIJ,QAASD,GAAYD,GACpBA,GAASK,aAAaL,GAGvB,QAASM,KACZ,MAA2B,mBAAZC,SAGZ,QAASC,KACZ,MAA0B,mBAAXC,QAGZ,QAASN,GAAMH,GAClB,MAAO,IAAAU,GAAAC,QAAY,SAACC,EAASC,GACzBT,WAAW,WACPQ,EAAQ,OACTZ,KH6IX1I,EAAQsB,YAAa,EACrBtB,EAAQgH,eAAiBA,EACzBhH,EAAQ4H,iBAAmBA,EAC3B5H,EAAQqI,WAAaA,EACrBrI,EAAQuH,QAAUA,EAClBvH,EAAQuI,KAAOA,EACfvI,EAAQ2I,YAAcA,EACtB3I,EAAQgJ,SAAWA,EACnBhJ,EAAQkJ,UAAYA,EACpBlJ,EAAQ6I,MAAQA,CAEhB,IAAIO,GAAezI,EG5RG,IHmahB,SAASV,EAAQD,EAASW,GAEhC,YAIA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAFzFrB,EAAQsB,YAAa,CAIrB,IAAIkI,GAAc7I,EI3aK,GJ6anB8I,EAAerI,EAAuBoI,GAEtCE,EAAa/I,EI9aK,GJgblBgJ,EAAcvI,EAAuBsI,GAErCE,EAAUjJ,EIjbK,GJmbfkJ,EAAWzI,EAAuBwI,GIjblC9J,EAAQ,GAAIgK,UAAS,iBAEdT,EAAWI,EAAA,YAAcA,EAAA,WAAWJ,SAAYvJ,EAAKuJ,OJqbhErJ,GAAQqJ,QAAUA,CInbX,IAAIU,GAAQjK,EAAKiK,OAAKJ,EAAA,UJqb7B3J,GAAQ+J,MAAQA,CIpbT,IAAIC,GAAUlK,EAAKkK,SAAWD,EAAMC,OJsb3ChK,GAAQgK,QAAUA,CIrbX,IAAIC,GAAWnK,EAAKmK,UAAYF,EAAME,QJub7CjK,GAAQiK,SAAWA,CItbZ,IAAIC,GAAUpK,EAAKoK,SAAWH,EAAMG,OJyb3ClK,GAAQkK,QAAUA,CIvbX,IAAItE,GAAS9F,EAAK8F,QAAMiE,EAAA,UJ0b/B7J,GAAQ4F,OAASA,CIxbV,IAAIV,GAA6C,mBAAtBpF,GAAKoF,aAAgCpF,EAAKoF,eJ0b5ElF,GAAQkF,aAAeA,GAIjB,SAASjF,EAAQD,GK7cvBC,EAAAD,QAAAO,GLmdM,SAASN,EAAQD,GMndvBC,EAAAD,QAAAQ,GNydM,SAASP,EAAQD,GOzdvBC,EAAAD,QAAAS,GP+dM,SAASR,EAAQD,GAEvB,YAMA,SAAS8B,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjC,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MQre5gBqE,EAAK,WAIX,QAJMA,GAIL8D,EAASC,GR6ejBtI,EAAgBxB,KQjfH+F,GAKb/F,KAAK+J,UAAUD,GACf9J,KAAKgK,SAAWH,ERwhBpB,MApDAjI,GQ1eiBmE,EAAK,OR2elB3E,IAAK,gBACLmE,MQ1emB,MR2enBpD,YAAY,KQ7eC4D,EAAKzE,UAStByI,UAAS,SAACD,GAEN,MADA9J,MAAKiK,QAAUH,GAAU/D,EAAMmE,cACxBlK,MAXM+F,EAAKzE,UActB6I,QAAO,SAAC/I,EAAKgJ,GAET,MADApK,MAAKgK,SAAShK,KAAKqK,WAAWjJ,IAAQkJ,KAAKC,UAAUH,GAC9CpK,MAhBM+F,EAAKzE,UAmBtBkJ,WAAU,SAACpJ,GAEP,aADOpB,MAAKgK,SAAShK,KAAKqK,WAAWjJ,IAC9BpB,MArBM+F,EAAKzE,UAwBtBmJ,QAAO,SAACrJ,GACJ,GAAIsJ,GAAO1K,KAAKgK,SAAShK,KAAKqK,WAAWjJ,GACzC,OAAKsJ,GACEJ,KAAKK,MAAMD,GADA,MA1BL3E,EAAKzE,UA8BtBsJ,MAAK,WAED,IAAK,GAAIxJ,KAAOpB,MAAKgK,SAEZhK,KAAKgK,SAASzI,eAAeH,IAEA,IAA9BA,EAAIwG,QAAQ5H,KAAKiK,gBACVjK,MAAKgK,SAAS5I,EAK7B,OAAOpB,OA1CM+F,EAAKzE,UA8CtB+I,WAAU,SAACjJ,GACP,MAAOpB,MAAKiK,QAAU7I,GA/CT2E,IRiiBrBrG,GAAQ,WQjiBaqG,ERkiBrBpG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,GAEvB,YAIA,SAAS8B,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhHjC,EAAQsB,YAAa,CAIrB,IS9iBqBgF,GAAU,WAEhB,QAFMA,KTgjBbxE,EAAgBxB,KShjBHgG,GAGbhG,KAAK6K,MTonBT,MSvnBiB7E,GAAU1E,UAM3BwJ,aAAY,SAACC,GACT,MAAQA,KAAS/K,MAAKgL,YAPThF,EAAU1E,UAU3B2J,GAAE,SAACC,EAAQC,GTgjBP,GAAIC,GAAQpL,IS7iBZ,IADqB,gBAAVkL,KAAoBA,GAAUA,KACpCA,EAAQ,KAAM,IAAIG,OAAM,4BAC7B,IAAwB,kBAAbF,GAAyB,KAAM,IAAIE,OAAM,8BAUpD,OARAH,GAAOpE,QAAQ,SAACiE,GAEPK,EAAKN,aAAaC,KAAQK,EAAKJ,WAAWD,OAE/CK,EAAKJ,WAAWD,GAAO5D,KAAKgE,KAIzBnL,MAxBMgG,EAAU1E,UA4B3BgK,KAAI,SAACP,GTijBD,IAAK,GAFDQ,GAASvL,KAEJwL,EAAOC,UAAUxJ,OSjjBfyJ,EAAI1D,MAAAwD,EAAA,EAAAA,EAAA,EAAA,GAAAG,EAAA,EAAAH,EAAAG,EAAAA,IAAJD,EAAIC,EAAA,GAAAF,UAAAE,EAEf,IAAIC,GAAS,IAEb,OAAK5L,MAAK8K,aAAaC,IAEvB/K,KAAKgL,WAAWD,GAAOc,KAAK,SAACV,GAGzB,MADAS,GAAST,EAASW,MAAKP,EAAOG,GACtBE,KAAW,IAIhBA,GAT+B,MAhCzB5F,EAAU1E,UA6C3BuJ,IAAG,SAACE,EAAOI,GTkjBP,GAAIY,GAAS/L,IShjBb,IAAK+K,EAMD,GAAKI,EAIE,CAEH,IAAKnL,KAAK8K,aAAaC,GAAQ,MAAO/K,KAEtCA,MAAKgL,WAAWD,GAAOjE,QAAQ,SAACkF,EAAIhK,GAE5BgK,IAAOb,SAAiBY,GAAKf,WAAWD,GAAO/I,gBARhDhC,MAAKgL,WAAWD,OAN3B/K,MAAKgL,aAsBT,OAAOhL,OAvEMgG,IT0nBrBtG,GAAQ,WS1nBasG,ET2nBrBrG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAMA,SAASmB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjC,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MAI7hBmB,EAAiBxC,EUzoBC,GV2oBlB4L,EAAS5L,EU1oBmB,GAEX4F,EAAK,WAKX,QALMA,GAKLH,EAAOoG,GVipBf1K,EAAgBxB,KUtpBHiG,GAObjG,KAAK2E,OAASmB,EACd9F,KAAKmM,SAAWD,EAChBlM,KAAKoM,SAAW,KV2rBpB,MAzDAxK,GU3oBiBqE,EAAK,OV4oBlB7E,IAAK,gBACLmE,MU3oBmB,IV4oBnBpD,YAAY,IAEZf,IAAK,kBACLmE,MU9oBqB,IV+oBrBpD,YAAY,KUlpBC8D,EAAK3E,UAatB+K,SAAQ,WAEJ,GAAIC,GAAOtM,KAAK2E,OAAO8F,QAAQzK,KAAKmM,SAEpC,SAASG,GAAQC,KAAKC,MAAQC,SAASH,GAAQrG,EAAMyG,iBAjBxCzG,EAAK3E,UAoBtBqL,MAAK,WAED,MADA3M,MAAK2E,OAAOwF,QAAQnK,KAAKmM,SAAUI,KAAKC,OACjCxM,MAtBMiG,EAAK3E,UAyBtBsL,OAAM,WAEF,MADA5M,MAAK2E,OAAO6F,WAAWxK,KAAKmM,UACrBnM,MA3BMiG,EAAK3E,UA8BtB2G,KAAI,WVipBA,GAAImD,GAAQpL,IU/oBZ,OAAIA,MAAKoM,SAAiBpM,KAAKoM,UAE/BpM,KAAKoM,SAAW,GAAAvJ,GAAAkG,QAAY,SAACC,EAASC,GAElCgD,EAAAhE,KAAK,SAACK,GAEF,MAAI8C,GAAKiB,WAAmB/D,KAE5B8C,EAAKgB,SAAW,KAEhBhB,EAAKwB,aAEL5D,GAAQ,QAET/C,EAAM4G,iBAIN7M,KAAKoM,WAlDCnG,IVusBrBvG,GAAQ,WUvsBauG,EVwsBrBtG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAMA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASmL,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIrL,WAAU,iEAAoEqL,GAAeD,GAASzL,UAAYD,OAAO4L,OAAOD,GAAcA,EAAW1L,WAAa4L,aAAe3H,MAAOwH,EAAU5K,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAe4K,IAAY3L,OAAO8L,eAAiB9L,OAAO8L,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,GARjetN,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MAQ7hBmB,EAAiBxC,EW7tBoC,GX+tBrDoC,EAAapC,EW9tBY,GXguBzB4L,EAAS5L,EW/tBgB,IXiuBzB0C,EAAkB1C,EWhuBC,GXkuBnB2C,EAAmBlC,EAAuBiC,GAE1CsK,EAAehN,EWnuBK,IXquBpBiN,EAAgBxM,EAAuBuM,GWnuBtBnH,EAAM,SAAAqH,GXwuBvB,QWxuBiBrH,KXyuBb1E,EAAgBxB,KWzuBHkG,GX2uBbqH,EAAYzB,MAAM9L,KAAMyL,WAExBzL,KWzuBJkL,QACIsC,cAAe,gBACfC,eAAgB,iBAChBC,aAAc,gBXq6BlB,MAtMAZ,GWtuBiB5G,EAAMqH,GAANrH,EAAM5E,UAcjBqM,YAAW,SAACC,GXmvBd,GWjvBIC,EXkvBJ,OAAOC,oBAAmBC,MAAM,SAAsBC,GAClD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAQD,MW5vBRuF,GAAc,GAAAP,GAAA,WAAgBM,GXsvBtBI,EAAYC,KAAO,EWjvB3BjO,KAAKsL,KAAKtL,KAAKkL,OAAOsC,cAAeK,GXsvB7BG,EAAY1F,KAAO,EACZwF,mBAAmBI,MWrvBJlO,KAAKmO,cAAcP,GXuvB7C,KAAK,GAGD,GW1vBRC,EAAYO,UAASJ,EAAAK,MAEjBR,EAAYS,iBAAkBT,EAAYU,UAAS,CXyvB3CP,EAAY1F,KAAO,EACnB,OAIJ,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MW7vBJL,EAAYW,WAAWC,OX+vBjD,KAAK,GW/vBLZ,EAAYa,MAAKV,EAAAK,IXkwBjB,KAAK,IACD,GWhwBHR,EAAYc,KAAI,CXiwBTX,EAAY1F,KAAO,EACnB,OAGJ,KWrwBqB,IAAI+C,OAAM,mCXuwBnC,KAAK,IAID,MWzwBRrL,MAAKsL,KAAKtL,KAAKkL,OAAOuC,eAAgBI,GXywBvBG,EAAYY,OAAO,SWvwB3Bf,EXywBH,KAAK,IAQD,KAPAG,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GWvwBzCA,EAAAa,GAAEhB,cAAaG,EAAAa,GAAI7O,KAAK8O,UAASd,EAAAa,GAAIhB,IAE1C7N,KAAKsL,KAAKtL,KAAKkL,OAAOwC,aAAYM,EAAAa,IX2wBpBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OWxzBPkG,EAAM5E,UAoDjB6M,cAAa,SAACP,GX8wBhB,MAAOE,oBAAmBC,MAAM,SAAwBC,GACpD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAED,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MWjxBzBrL,EAAA4G,MAAM/I,KAAK,KAAMkN,GXmxBtB,KAAK,GACD,MAAOI,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OW/0BIkG,EAAM5E,UA8DvBwN,UAAS,SAACE,EAAGnB,GAWT,MARKmB,GAAEzN,eAAe,gBAAmByN,EAAEzN,eAAe,qBAEtDyN,EAAEnB,YAAcA,EAChBmB,EAAEC,gBAAkBD,EAAEE,QACtBF,EAAEE,QAAWrB,GAAeA,EAAYsB,OAAM,IAAUH,EAAEC,iBAIvDD,GAzEM9I,EAAM5E,UAuFvB8N,cAAa,SAACC,GAMV,GAJAA,EAAOA,MACPA,EAAKC,QAAUD,EAAKC,aAGfD,EAAKE,IAAK,KAAM,IAAIlE,OAAM,qBAE/B,IADKgE,EAAKG,SAAQH,EAAKG,OAAS,OAC5BH,EAAKG,QAAUtJ,EAAOuJ,gBAAgB7H,QAAQyH,EAAKG,QAAU,EAAG,KAAM,IAAInE,OAAM,2BAA6BgE,EAAKG,OAiBtH,IAdAH,EAAKK,YAAcL,EAAKK,aAAe,UACvCL,EAAKM,KAAON,EAAKM,MAAQ,OAGrBN,EAAKO,QACLP,EAAKE,IAAMF,EAAKE,KAAOF,EAAKE,IAAI3H,QAAQ,KAAO,GAAK,IAAM,KAAOnF,EAAAiE,eAAe2I,EAAKO,QAGnF3D,EAAA4D,eAAe,SAAUR,EAAKC,WAChCD,EAAKC,QAAgB,OAAIhC,EAAA,WAAYwC,kBAKhB,gBAAdT,GAAKU,OAAsBV,EAAKU,KAAM,CAE7C,GAAIC,GAAwB/D,EAAA4D,eAAevC,EAAA,WAAY2C,aAAcZ,EAAKC,QAErEU,KACDA,EAAwB1C,EAAA,WAAY2C,aACpCZ,EAAKC,QAAQU,GAAyB1C,EAAA,WAAYwC,iBAGtD,IAAII,GAAcb,EAAKC,QAAQU,EAG3BE,GAAYtI,QAAQ0F,EAAA,WAAYwC,kBAAoB,GACpDT,EAAKU,KAAOzF,KAAKC,UAAU8E,EAAKU,MACzBG,EAAYtI,QAAQ0F,EAAA,WAAY6C,wBAA0B,KACjEd,EAAKU,KAAOtN,EAAAiE,eAAe2I,EAAKU,OAMxC,GAAIK,GAAM,GAAAvN,GAAA6G,QAAY2F,EAAKE,IAAKF,EAKhC,OAFAe,GAAIC,aAAehB,EAAKU,KAEjBK,GX4xBXxO,EWt6BiBsE,EAAM,OXu6BnB9E,IAAK,kBACLmE,OWt6BsB,MAAO,OAAQ,MAAO,SAAU,QAAS,UAAW,QXu6B1EpD,YAAY,KWz6BC+D,GX66BlBlD,EAAiB,WAEpBtD,GAAQ,WW/6BawG,EXg7BrBvG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAMA,SAASa,GAAwBH,GAAO,GAAIA,GAAOA,EAAIC,WAAc,MAAOD,EAAc,IAAII,KAAa,IAAW,MAAPJ,EAAe,IAAK,GAAIK,KAAOL,GAAWM,OAAOC,UAAUC,eAAeb,KAAKK,EAAKK,KAAMD,EAAOC,GAAOL,EAAIK,GAAmC,OAAzBD,GAAO,WAAaJ,EAAYI,EYz7B9P,QAASmP,GAAeC,EAAYlB,GAEvCA,EAAOA,KAEP,IAAIb,GAAW,GAAA3L,GAAA8G,SAAa4G,EAAYlB,EAYxC,OATImB,GAAM9H,aAEN8F,EAASE,MAAQ6B,EACjB/B,EAASiC,QAAU,WACf,MAAOzQ,MAAK0O,QAKbF,EAIJ,QAASqB,GAAea,EAAMpB,GAEjC,MADAoB,GAAOA,EAAKC,cACLtP,OAAOwF,KAAKyI,GAASsB,OAAO,SAASC,EAAKzP,GAC7C,MAAIyP,GAAYA,EACZH,GAAQtP,EAAIuP,cAAsBvP,EAC/ByP,GACR,MZ25BPnR,EAAQsB,YAAa,EACrBtB,EAAQ4Q,eAAiBA,EACzB5Q,EAAQmQ,eAAiBA,CAIzB,IAAIhN,GAAiBxC,EYp8BoC,GZs8BrDoC,EAAapC,EYr8BM,GAAXmQ,EAAKtP,EAAAuB,IZ6+BX,SAAS9C,EAAQD,EAASW,GAEhC,YAMA,SAASa,GAAwBH,GAAO,GAAIA,GAAOA,EAAIC,WAAc,MAAOD,EAAc,IAAII,KAAa,IAAW,MAAPJ,EAAe,IAAK,GAAIK,KAAOL,GAAWM,OAAOC,UAAUC,eAAeb,KAAKK,EAAKK,KAAMD,EAAOC,GAAOL,EAAIK,GAAmC,OAAzBD,GAAO,WAAaJ,EAAYI,EAErQ,QAASK,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhHjC,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MAM7hBmB,EAAiBxC,Ea1/BoC,Gb4/BrD4L,EAAS5L,Ea3/BU,IAAXmQ,EAAKtP,EAAA+K,GAEI9F,EAAW,WAejB,QAfMA,GAeLyH,EAASY,EAAUsC,GbohC3BtP,EAAgBxB,KaniCHmG,GAkBbnG,KAAK+Q,SAAWnD,EAGhB5N,KAAKoO,UAAYI,EAEjBxO,KAAK0O,MAAQoC,EACb9Q,KAAKgR,MAAQ,KACbhR,KAAKiR,cb+rCT,MA1NArP,Ga9/BiBuE,EAAW,Ob+/BxB/E,IAAK,eACLmE,Ma9/BkB,eb+/BlBpD,YAAY,IAEZf,IAAK,mBACLmE,MajgCsB,mBbkgCtBpD,YAAY,IAEZf,IAAK,wBACLmE,MapgC2B,kBbqgC3BpD,YAAY,IAEZf,IAAK,yBACLmE,MavgC4B,oCbwgC5BpD,YAAY,IAEZf,IAAK,mBACLmE,Ma1gCsB,Ib2gCtBpD,YAAY,IAEZf,IAAK,iBACLmE,Ma7gCoB,Ob8gCpBpD,YAAY,IAEZf,IAAK,qBACLmE,MahhCwB,KbuhCxBpD,YAAY,Ka/hCCgE,EAAW7E,UAgC5BkN,SAAQ,WACJ,MAAOxO,MAAKoO,WAjCCjI,EAAW7E,UAuC5BsM,QAAO,WACH,MAAO5N,MAAK+Q,UAxCC5K,EAAW7E,UA8C5BqN,GAAE,WACE,MAAO3O,MAAKoO,WAAapO,KAAKoO,UAAUO,IA/C3BxI,EAAW7E,UAqD5BmN,KAAI,WACA,IAAKzO,KAAKuO,YAAcvO,KAAKsO,eAAgB,KAAM,IAAIjD,OAAM,uBAC7D,OAAOrL,MAAK0O,OAvDCvI,EAAW7E,UA6D5B4P,KAAI,WACA,IAAKlR,KAAKuO,UAAW,KAAM,IAAIlD,OAAM,uBAIrC,OAHKrL,MAAKgR,QACNhR,KAAKgR,MAAQhR,KAAK0O,MAAQpE,KAAKK,MAAM3K,KAAK0O,OAAS,MAEhD1O,KAAKgR,OAlEC7K,EAAW7E,UAyE5B6N,MAAK,SAACgC,GAEF,GAAInR,KAAK2O,OAASwC,EAAa,MAAO,KAEtC,IAAIjC,IAAWlP,KAAKoO,WAAapO,KAAKoO,UAAUgD,OAASpR,KAAKoO,UAAUgD,OAAS,IAAM,KACxEpR,KAAKoO,WAAapO,KAAKoO,UAAUiD,WAAarR,KAAKoO,UAAUiD,WAAa,GAEzF,KAEQrR,KAAKkR,OAAOhC,UAASA,EAAUlP,KAAKkR,OAAOhC,SAC3ClP,KAAKkR,OAAOI,oBAAmBpC,EAAUlP,KAAKkR,OAAOI,mBACrDtR,KAAKkR,OAAOK,cAAarC,EAAUlP,KAAKkR,OAAOK,aAErD,MAAOvC,IAET,MAAOE,IAxFM/I,EAAW7E,UA+F5BkQ,UAAS,WAEL,IAAKxR,KAAKsO,eAAgB,KAAM,IAAIjD,OAAM,4BAE1C,KAAKrL,KAAKiR,WAAWhP,OAAQ,CAIzB,GAAIwM,GAAOzO,KAAKyO,MAEhB,KAAKA,EAAM,KAAM,IAAIpD,OAAM,mBAE3B,IAAIoG,GAAWzR,KAAK0R,kBAAkBC,MAAM,qBAAqB,EAEjE,KAAKF,EAAU,KAAM,IAAIpG,OAAM,uBAE/B,IAAIuG,GAAQnD,EAAKoD,WAAWpK,MAAMtB,EAAY2L,mBAAqBL,EAKnE,IAHwB,KAApBG,EAAM,GAAG/J,QAAe+J,EAAMG,QAC9BH,EAAMA,EAAM3P,OAAS,GAAG4F,QAAU1B,EAAY2L,oBAAoBF,EAAMI,MAExEJ,EAAM3P,OAAS,EAAG,KAAM,IAAIoJ,OAAM,mBAItC,IAAI4G,GAAa9L,EAAY8G,OAAO2E,EAAMG,QAAS/R,KAAKoO,UAAUgD,OAAQpR,KAAKoO,UAAUiD,YAAYH,MAIrGlR,MAAKiR,WAAaW,EAAMM,IAAI,SAACC,EAAanQ,GAEtC,GAAIoP,GAASa,EAAWzD,SAASxM,GAAGoP,MAEpC,OAAOjL,GAAY8G,OAAOkF,EAAMf,KAMxC,MAAOpR,MAAKiR,YAtIC9K,EAAW7E,UA0I5B8Q,eAAc,SAAClC,GACX,MAAOlQ,MAAK0R,kBAAkB9J,QAAQsI,GAAe,IA3IxC/J,EAAW7E,UA8I5BoQ,gBAAe,WACX,MAAO1R,MAAKoO,UAAUkB,QAAQ+C,IAAIlM,EAAY8J,eAAiB,IA/IlD9J,EAAW7E,UAkJ5BgN,aAAY,WACR,MAAOtO,MAAKoS,eAAejM,EAAYmM,wBAnJ1BnM,EAAW7E,UAsJ5BiR,cAAa,WACT,MAAOvS,MAAKoS,eAAejM,EAAYgK,yBAvJ1BhK,EAAW7E,UA0J5BiN,QAAO,WACH,MAAOvO,MAAKoS,eAAejM,EAAY2J,mBA3J1B3J,EAqKV8G,OAAM,SAACwB,EAAM2C,EAAQC,GAExB5C,EAAOA,GAAQ,GACf2C,EAASA,GAAU,IACnBC,EAAaA,GAAc,KAE3B5C,EAAOA,EAAK+D,QAAQ,MAAO,GAE3B,IAAIlD,GAAU,GAAAzM,GAAA+G,QACV6I,EAAiBhE,EAAKhH,MAAMtB,EAAYuM,gBACxCC,EAAeF,EAAexQ,OAAS,EAAKwQ,EAAeV,QAAU,EAgBzE,OAdAtD,GAAOgE,EAAepL,KAAKlB,EAAYuM,iBAEtCC,GAAe,IACXlL,MAAM,MACNX,QAAQ,SAAC8L,GAEN,GAAInL,GAAQmL,EAAO/K,OAAOJ,MAAMtB,EAAY0M,kBACxCzR,EAAMqG,EAAMsK,QAAQlK,OACpBtC,EAAQkC,EAAMJ,KAAKlB,EAAY0M,kBAAkBhL,MAEjDzG,IAAKkO,EAAQwD,OAAO1R,EAAKmE,KAI9B,GAAIY,GAAY,KAAMqK,EAAMF,eAAe7B,GAC9Ca,QAASA,EACT8B,OAAQA,EACRC,WAAYA,IACZ5C,IAnMStI,Ib2tCrBzG,GAAQ,Wa3tCayG,Eb4tCrBxG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAIA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASmL,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIrL,WAAU,iEAAoEqL,GAAeD,GAASzL,UAAYD,OAAO4L,OAAOD,GAAcA,EAAW1L,WAAa4L,aAAe3H,MAAOwH,EAAU5K,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAe4K,IAAY3L,OAAO8L,eAAiB9L,OAAO8L,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,GANjetN,EAAQsB,YAAa,CAQrB,IAAI+R,GAAY1S,Ec/uCK,IdivCjB2S,EAAalS,EAAuBiS,GAEpC5P,EAAc9C,EclvCkB,IdovChC+C,EAAetC,EAAuBqC,GclvCrB+C,EAAM,SAAA+M,GAEZ,QAFM/M,KdwvCb1E,EAAgBxB,KcxvCHkG,GAGb+M,EAAAvS,KAAAV,MACAA,KAAKkT,UAAY,GAAAF,GAAA,WdixCrB,MAhCAlG,GcrvCiB5G,EAAM+M,GAAN/M,EAAM5E,UAOvB6R,SAAQ,WACJ,MAAOnT,MAAKkT,WARChN,EAAM5E,UAWjB6M,cAAa,SAACP,GdwvChB,GctvCIwF,EduvCJ,OAAOtF,oBAAmBC,MAAM,SAAwBC,GACpD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAGD,Mc5vCR8K,GAAOpT,KAAKkT,UAAUG,KAAKzF,Gd2vCnBI,EAAY1F,KAAO,EACZwF,mBAAmBI,Mc1vCzBkF,EAAKE,YAAY1F,Gd4vCtB,KAAK,GACD,MAAOI,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OclxCIkG,GdsxClB9C,EAAa,WAEhB1D,GAAQ,WcxxCawG,EdyxCrBvG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAIA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjC,EAAQsB,YAAa,CAMrB,IAAIuS,GAAQlT,Ee1yCK,If4yCbmT,EAAS1S,EAAuByS,Ge1yCfhN,EAAQ,WAEd,QAFMA,Kf8yCb/E,EAAgBxB,Ke9yCHuG,GAGbvG,KAAKyT,Ufq8CT,Mex8CiBlN,GAAQjF,UAMzBoS,IAAG,SAACN,GAEA,MADApT,MAAKyT,OAAOtM,KAAKiM,GACVpT,MARMuG,EAAQjF,UAWzBqS,MAAK,WAED,MADA3T,MAAKyT,UACEzT,MAbMuG,EAAQjF,UAgBzB+R,KAAI,SAACzF,GAID,GAAIwF,GAAOpT,KAAKyT,OAAO1B,OAEvB,KAAKqB,EAAM,KAAM,IAAI/H,OAAM,mCAAqCuC,EAAQ4B,OAAS,IAAM5B,EAAQ2B,IAE/F,KAAK6D,EAAKQ,KAAKhG,GAAU,KAAM,IAAIvC,OAAM,iBAAmBuC,EAAQ4B,OAAS,IAAM5B,EAAQ2B,IAClD,sBAAwB6D,EAAK5D,SAAW,IAAM4D,EAAKS,OAE5F,OAAOT,IA3BM7M,EAAQjF,UA+BzBwS,QAAO,SAACtE,EAAeqE,EAAarF,EAAc4C,EAAQC,GAItD,MAFArR,MAAK0T,IAAI,GAAAF,GAAA,WAAShE,EAAQqE,EAAMrF,EAAU4C,EAAQC,IAE3CrR,MAnCMuG,EAAQjF,UAuCzByS,eAAc,WAYV,MAVA/T,MAAK8T,QAAQ,OAAQ,wBACjBE,aAAgB,eAChBC,WAAc,SACdC,WAAc,KACdC,cAAiB,gBACjBC,yBAA4B,MAC5BC,MAAS,kBACTC,YAAc,GAAI/H,OAAOgI,UAAY,OAGlCvU,MAnDMuG,EAAQjF,UAuDzBkT,OAAM,WAIF,MAFAxU,MAAK8T,QAAQ,OAAQ,4BAEd9T,MA3DMuG,EAAQjF,UA+DzBmT,aAAY,SAACjU,GAiBT,MAfAR,MAAK8T,QAAQ,MAAO,qCAAuCtT,EAAK,aAC5DkU,IAAO,uEAAyElU,EAAK,YACrFmU,WACID,IAAO,uEAAyElU,EAChFA,GAAMA,EACNoU,gBAAmB,OAEvBC,eACAC,eAAkB,YAClBC,gBAAmB,UACnBC,WAAc,YACdC,UAAa,eACbC,YAAe1U,IAGZR,MAhFMuG,EAAQjF,UAoFzB6T,iBAAgB,SAACC,GAEbA,EAAYA,GAAa,IAEzB,IAAIC,GAAO,GAAI9I,KAqBf,OAnBAvM,MAAK8T,QAAQ,OAAQ,8BACjBwB,cACI,gDAEJC,eAAkB,GAAIhJ,MAAK8I,EAAKd,UAAyB,IAAZa,GAAmBI,cAChEJ,UAAaA,EACbK,cACIC,cAAiB,SACjBC,YAAc,EACdC,QAAW,UACXC,cAAiB,YACjBC,UAAa,aAEjBtV,GAAM,cACNuV,aAAgBV,EAAKG,cACrBpE,OAAU,SACVsD,IAAO,2EAGJ1U,MA7GMuG,EAAQjF,UAiHzB0U,oBAAmB,SAACxV,EAAIyV,GAEpBzV,EAAKA,GAAM,GAEX,IAAI6U,GAAO,GAAI9I,KAoBf,OAlBAvM,MAAK8T,QAAQ,OAAQ,8BACjBwB,cAAiB,qCAAuC9U,EAAK,aAAeyV,EAAW,+BAAiC,KACxHV,eAAkB,GAAIhJ,MAAK8I,EAAKd,UAAa,MAAsBiB,cACnEC,cACIC,cAAiB,SACjBC,YAAc,EACdC,QAAW,UACXC,cAAiB,YACjBC,UAAa,YACbI,oBAAuB,MACvBC,cAAiB,4BAErBJ,aAAgBV,EAAKG,cACrBhV,GAAM,cACN4Q,OAAU,SACVsD,IAAO,2EAGJ1U,MAzIMuG,EAAQjF,UA6IzB8U,aAAY,SAACC,GAuBT,MArBKA,GAaDrW,KAAK8T,QAAQ,OAAQ,wBACjB5E,QAAW,cACXoC,kBAAqB,cACrBC,YAAe,eAChB,KAfHvR,KAAK8T,QAAQ,OAAQ,wBACjBE,aAAgB,4BAChBC,WAAc,SACdC,WAAc,KACdC,cAAiB,6BACjBC,yBAA4B,MAC5BC,MAAS,oBAaVrU,MApKMuG,If28CrB7G,GAAQ,We38Ca6G,Ef48CrB5G,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAIA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjC,EAAQsB,YAAa,CAMrB,IAAIqC,GAAmBhD,EgB59CC,IhB89CpBiD,EAAoBxC,EAAuBuC,GAE3CZ,EAAapC,EgB/9CG,GhBi+ChBkD,EAAalD,EgBh+CY,IAERmG,EAAI,WAEV,QAFMA,GAELgJ,EAAQqE,EAAM3C,EAAME,EAAQC,EAAY9I,GhBg+ChD/G,EAAgBxB,KgBl+CHwG,GAGbxG,KAAKsW,QAAU9G,EAAO+G,cACtBvW,KAAKwW,MAAQ3C,EACb7T,KAAKgR,MAAQE,MACblR,KAAKyW,OAASlO,GAAS,GACvBvI,KAAK0W,QAAUtF,GAAU,IACzBpR,KAAK2W,YAActF,GAAc,KhBihDrC,MgBzhDiB7K,GAAIlF,UAWrBuS,KAAI,WACA,MAAO7T,MAAKwW,OAZChQ,EAAIlF,UAerBkO,OAAM,WACF,MAAOxP,MAAKsW,SAhBC9P,EAAIlF,UAmBrBsS,KAAI,SAAChG,GAED,MAAOA,GAAQ2B,IAAI3H,QAAQ5H,KAAKwW,OAAS,IAClC5I,EAAQ4B,OAAO+G,eAAiBvW,KAAKsW,SAtB/B9P,EAAIlF,UA0BfgS,YAAW,SAAC1F,GhBg+Cd,MAAOE,oBAAmBC,MAAM,SAAsBC,GAClD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAED,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MgBl+ChCzL,EAAA8F,MAAMvI,KAAKyW,QhBo+CT,KAAK,GACD,MAAOzI,GAAYY,OAAO,SgBn+C/B5O,KAAKsQ,eAAetQ,KAAKgR,OhBq+CxB,KAAK,GACL,IAAK,MACD,MAAOhD,GAAYe,SAE5B,KAAM/O,OgBvgDIwG,EAAIlF,UAkCrBgP,eAAc,SAACY,EAAM7B,GAEjBA,EAAOA,MAEPA,EAAK+B,OAAS/B,EAAK+B,QAAUpR,KAAK0W,QAClCrH,EAAKgC,WAAahC,EAAKgC,YAAcrR,KAAK2W,WAE1C,IAAIC,GAAMtM,KAAKC,UAAU2G,GACrBL,EAAMtN,EAAA+M,eAAesG,EAAKvH,EAI9B,OAFAwB,GAAIvB,QAAQuH,IAAIvT,EAAA,WAAY2M,aAAc3M,EAAA,WAAYwM,kBAE/Ce,GA9CMrK,IhB4hDrB9G,GAAQ,WgB5hDa8G,EhB6hDrB7G,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAMA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASmL,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIrL,WAAU,iEAAoEqL,GAAeD,GAASzL,UAAYD,OAAO4L,OAAOD,GAAcA,EAAW1L,WAAa4L,aAAe3H,MAAOwH,EAAU5K,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAe4K,IAAY3L,OAAO8L,eAAiB9L,OAAO8L,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,GARjetN,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MAQ7hBqB,EAAkB1C,EiBnjDC,GjBqjDnB2C,EAAmBlC,EAAuBiC,GAE1CE,EAAa5C,EiBtjDC,GjBwjDd6C,EAAcpC,EAAuBmC,GAErC6T,EAAQzW,EiBzjDK,IjB2jDb0W,EAASjW,EAAuBgW,GAIhCrU,GAFiBpC,EiB5jDC,GjB8jDLA,EiB7jDqC,IAEjCgG,EAAQ,SAAAkH,GA0Bd,QA1BMlH,GA0BLtB,EAAQe,EAAOb,EAAQC,EAAQC,GjBwlDvC3D,EAAgBxB,KiBlnDHqG,GA4BbkH,EAAA7M,KAAAV,MjB0lDAA,KiBxmDJkL,QACI8L,YAAa,cACbC,aAAc,eACdC,WAAY,aACZC,cAAe,gBACfC,eAAgB,iBAChBC,aAAc,eACdC,aAAc,eACdC,cAAe,gBACfC,YAAa,eAObxX,KAAKyX,QAAUxS,EACfjF,KAAK0X,QAAUxS,EACflF,KAAK2X,WAAaxS,EAGlBnF,KAAK2E,OAASmB,EAGd9F,KAAK8E,QAAUC,EAEf/E,KAAK4X,OAAS,GAAA1U,GAAA,WAAUlD,KAAK2E,OAAQ0B,EAAS8F,SAAW,YAEzDnM,KAAK6X,MAAQ,GAAAd,GAAA,WAAS/W,KAAK2E,OAAQ0B,EAAS8F,UjBowEhD,MAhvBAW,GiB9jDiBzG,EAAQkH,GjBgkDzB3L,EiBhkDiByE,EAAQ,OjBikDrBjF,IAAK,aACLmE,MiBhkDgB,WjBikDhBpD,YAAY,IAEZf,IAAK,cACLmE,MiBnkDiB,OjBokDjBpD,YAAY,IAEZf,IAAK,kBACLmE,MiBtkDqB,KjBwkDrBpD,YAAY,IAEZf,IAAK,mBACLmE,MiB1kDsB,KjB4kDtBpD,YAAY,IAEZf,IAAK,2BACLmE,MiB9kD8B,OjBglD9BpD,YAAY,IAEZf,IAAK,iBACLmE,MiBllDoB,uBjBmlDpBpD,YAAY,IAEZf,IAAK,kBACLmE,MiBrlDqB,wBjBslDrBpD,YAAY,IAEZf,IAAK,qBACLmE,MiBxlDwB,2BjBylDxBpD,YAAY,IAEZf,IAAK,kBACLmE,MiB3lDqB,IjB4lDrBpD,YAAY,IAEZf,IAAK,WACLmE,MiB9lDc,WjB+lDdpD,YAAY,IAEZf,IAAK,4BACLmE,OiBjmD+B,EjBkmD/BpD,YAAY,KiB9mDCkE,EAAQ/E,UAiDzBwW,KAAI,WACA,MAAO9X,MAAK6X,OAlDCxR,EAAQ/E,UAwDzByD,OAAM,WACF,MAAO/E,MAAK8E,SAzDCuB,EAAQ/E,UAoEzByW,UAAS,SAAClE,EAAMnP,GAEZmP,EAAOA,GAAQ,GACfnP,EAAUA,KAEV,IAAIsT,GAAW,GACXC,EAAqC,IAA3BpE,EAAKjM,QAAQ,YAAgD,IAA5BiM,EAAKjM,QAAQ,WAa5D,OAXIlD,GAAQwT,YAAcD,IAASD,GAAYhY,KAAKyX,SAEX,IAArC5D,EAAKjM,QAAQvB,EAAS8R,aAAsBF,IAASD,GAAY3R,EAAS8R,WAAa,IAAM9R,EAAS+R,aAE1GJ,GAAYnE,GAERnP,EAAQ2T,WAAa3T,EAAQ4T,YAAUN,GAAanE,EAAKjM,QAAQ,KAAO,GAAK,IAAM,KAEnFlD,EAAQ2T,YAAWL,GAAY,WAAatT,EAAQ2T,WACpD3T,EAAQ4T,WAAUN,IAAatT,EAAQ2T,UAAY,IAAM,IAAM,gBAAkBrY,KAAK6X,MAAMU,eAEzFP,GAvFM3R,EAAQ/E,UAmGzBkX,QAAO,SAAC9T,GAIJ,MAFAA,GAAUA,MAEH1E,KAAK+X,UAAU1R,EAASoS,mBAAqB,IAAMhW,EAAAiE,gBAClDgS,cAAiB,OACjBC,aAAgBjU,EAAQkU,aAAe,GACvCC,UAAa7Y,KAAK0X,QAClBoB,MAASpU,EAAQoU,OAAS,GAC1BC,SAAYrU,EAAQsU,SAAW,GAC/BC,QAAWvU,EAAQuU,SAAW,GAC9BC,OAAUxU,EAAQwU,QAAU,MAC3BhB,WAAW,KA/GP7R,EAAQ/E,UAuHzB6X,qBAAoB,SAAC5J,GAEjB,GAAI6J,GAAK3W,EAAA6E,iBAAiBiI,EAAI9H,MAAM,KAAK4R,UAAU,IAC/ClK,EAAQiK,EAAG9H,mBAAqB8H,EAAGjK,KAEvC,IAAIA,EAAO,CACP,GAAIH,GAAI,GAAI3D,OAAM8D,EAElB,MADAH,GAAEG,MAAQiK,EAAGjK,MACPH,EAGV,MAAOoK,IAlIM/S,EAAQ/E,UAyInBgY,SAAQ,WjBsmDV,MAAOxL,oBAAmBC,MAAM,SAAmBC,GAC/C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAGD,MAFA0F,GAAYC,KAAO,EACnBD,EAAY1F,KAAO,EACZwF,mBAAmBI,MiBxmD5BlO,KAAKuZ,wBjB0mDP,KAAK,GACD,MAAOvL,GAAYY,OAAO,UiB1mD3B,EjB4mDH,KAAK,GAGD,MAFAZ,GAAYC,KAAO,EACnBD,EAAYa,GAAKb,EAAY,SAAS,GAC/BA,EAAYY,OAAO,UiB7mD3B,EjB+mDH,KAAK,GACL,IAAK,MACD,MAAOZ,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,MiBlwDPqG,EAAQ/E,UA6JnBkY,MAAK,SAAC9U,GjBmnDR,GiBzmDQqL,GAuBAlC,EACAqD,CjBklDR,OAAOpD,oBAAmBC,MAAM,SAAgBC,GAC5C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GA+BD,MA9BA0F,GAAYC,KAAO,EiBnnD3BvJ,EAAUA,MAEVA,EAAQ+U,SAAW/U,EAAQ+U,WAAY,EAEvCzZ,KAAKsL,KAAKtL,KAAKkL,OAAO8L,aAElBjH,GACA2J,iBAAoBrT,EAASsT,gBAC7BC,kBAAqBlV,EAAQ+U,SAAWpT,EAASwT,yBAA2BxT,EAASyT,kBAGpFpV,EAAQqV,KAOFrV,EAAQqV,OAEfhK,EAAKiK,WAAa,qBAClBjK,EAAKgK,KAAOrV,EAAQqV,KACpBhK,EAAK4I,aAAejU,EAAQkU,cAT5B7I,EAAKiK,WAAa,WAClBjK,EAAKkK,SAAWvV,EAAQuV,SACxBlK,EAAKmK,SAAWxV,EAAQwV,SACxBnK,EAAK4E,UAAYjQ,EAAQiQ,WAAa,IAWtCjQ,EAAQyV,aAAYpK,EAAKqK,YAAc1V,EAAQyV,YjBqnD3CnM,EAAY1F,KAAO,EACZwF,mBAAmBI,MiBpnDVlO,KAAKqa,cAAchU,EAASiU,eAAgBvK,GjBsnDhE,KAAK,GAQD,MiB9nDJlC,GAAWG,EAAAK,KACX6C,EAAOrD,EAAYqD,OAEvBlR,KAAK6X,MACA0C,QAAQrJ,GACRsJ,YAAY9V,EAAQ+U,UAEzBzZ,KAAKsL,KAAKtL,KAAKkL,OAAO+L,aAAcpJ,GjBunDrBG,EAAYY,OAAO,SiBrnD3Bf,EjBunDH,KAAK,IAQD,KAPAG,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GiBrnD9ChO,KAAK2E,OAAOiG,QAEZ5K,KAAKsL,KAAKtL,KAAKkL,OAAOgM,WAAUlJ,EAAAa,IjBynDlBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OiB50DPqG,EAAQ/E,UAwNnBmZ,QAAO,WjB4nDT,GiB7lDQ5J,GAMAK,CjBwlDR,OAAOpD,oBAAmBC,MAAM,SAAkBC,GAC9C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAKD,GAJA0F,EAAYC,KAAO,EiB5nD3BjO,KAAKsL,KAAKtL,KAAKkL,OAAOiM,gBAElBnX,KAAK4X,OAAOvL,WAAU,CjB+nDd2B,EAAY1F,KAAO,CACnB,OAIJ,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MiBloDxBlO,KAAK4X,OAAO3P,OjBooDlB,KAAK,GACD,GiBnoDCjI,KAAK0a,sBAAqB,CjBooDvB1M,EAAY1F,KAAO,CACnB,OAGJ,KiBvoDM,IAAI+C,OAAM,qCjByoDpB,KAAK,GAID,MiB1oDJrL,MAAKsL,KAAKtL,KAAKkL,OAAOkM,eAAgB,MjB0oD3BpJ,EAAYY,OAAO,SiBxoDvB,KjB0oDP,KAAK,GAMD,MiB5oDR5O,MAAK4X,OAAOjL,QjB2oDJqB,EAAY1F,KAAO,GACZwF,mBAAmBI,MiBzoD5BzL,EAAA8F,MAAMlC,EAASsU,iBjB2oDjB,KAAK,IACD,GiBzoDH3a,KAAK6X,MAAM+C,eAAc,CjB0oDlB5M,EAAY1F,KAAO,EACnB,OAGJ,KiB9oD8B,IAAI+C,OAAM,2BjBgpD5C,KAAK,IACD,GiBhpDHrL,KAAK6X,MAAMgD,oBAAmB,CjBipDvB7M,EAAY1F,KAAO,EACnB,OAGJ,KiBrpDmC,IAAI+C,OAAM,4BjBupDjD,KAAK,IACD,GiBvpDHrL,KAAK4X,OAAOvL,WAAU,CjBwpDf2B,EAAY1F,KAAO,EACnB,OAGJ,KiB5pD2B,IAAI+C,OAAM,wCjB8pDzC,KAAK,IAED,MADA2C,GAAY1F,KAAO,GACZwF,mBAAmBI,MiB7pDlBlO,KAAKqa,cAAchU,EAASiU,gBACpCN,WAAc,gBACd7F,cAAiBnU,KAAK6X,MAAM+C,eAC5BlB,iBAAoBrT,EAASsT,gBAC7BC,kBAAqB5Z,KAAK6X,MAAM4B,WAAapT,EAASwT,yBAA2BxT,EAASyT,mBjBgqD9F,KAAK,IAID,GiBxqDJjJ,EAAG7C,EAAAK,KAMH6C,EAAOL,EAAIK,OAEVA,EAAK8C,aAAY,CjBiqDVhG,EAAY1F,KAAO,EACnB,OAGJ,KiBpqDEtI,MAAK8E,QAAQgK,UAAU,GAAIzD,OAAM,4BAA6BwF,EjBsqDpE,KAAK,IAOD,MiB1qDR7Q,MAAK6X,MAAM0C,QAAQrJ,GACnBlR,KAAK4X,OAAOhL,SAEZ5M,KAAKsL,KAAKtL,KAAKkL,OAAOkM,eAAgBvG,GjBuqDvB7C,EAAYY,OAAO,SiBrqD3BiC,EjBuqDH,KAAK,IAYD,KAXA7C,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GiBrqD9CA,EAAAa,GAAI7O,KAAK8E,QAAQgK,UAASd,EAAAa,IAEtBxI,EAASyU,2BACT9a,KAAK2E,OAAOiG,QAGhB5K,KAAKsL,KAAKtL,KAAKkL,OAAOmM,aAAYrJ,EAAAa,IjByqDpBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OiBj8DPqG,EAAQ/E,UA6RnBkT,OAAM,WjB4qDR,GiBpqDQ3D,EjBqqDR,OAAO/C,oBAAmBC,MAAM,SAAiBC,GAC7C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAQD,MAPA0F,GAAYC,KAAO,EiB5qD3BjO,KAAKsL,KAAKtL,KAAKkL,OAAOoM,cAEtBtX,KAAK4X,OAAOjL,QjBgrDJqB,EAAY1F,KAAO,EACZwF,mBAAmBI,MiB/qDlBlO,KAAKqa,cAAchU,EAAS0U,iBACxCC,MAAOhb,KAAK6X,MAAMU,gBjBkrDlB,KAAK,GAQD,MiB3rDJ1H,GAAG7C,EAAAK,KAIPrO,KAAK4X,OAAOhL,SACZ5M,KAAK2E,OAAOiG,QAEZ5K,KAAKsL,KAAKtL,KAAKkL,OAAOqM,cAAe1G,GjBorDtB7C,EAAYY,OAAO,SiBlrD3BiC,EjBorDH,KAAK,IAQD,KAPA7C,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GiBlrD9ChO,KAAK4X,OAAOhL,SAEZ5M,KAAKsL,KAAKtL,KAAKkL,OAAOsM,YAAWxJ,EAAAa,IjBsrDnBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OiBh/DPqG,EAAQ/E,UAkUnB2Z,eAAc,SAACrN,EAASlJ,GjByrD1B,MAAOoJ,oBAAmBC,MAAM,SAAyBC,GACrD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAID,GiB7rDZ5D,EAAUA,OAENA,EAAQwW,cAAa,CjB4rDTlN,EAAY1F,KAAO,CACnB,OAGJ,MAAO0F,GAAYY,OAAO,SiBhsDJhB,EjBksD1B,KAAK,GAED,MADAI,GAAY1F,KAAO,EACZwF,mBAAmBI,MiBlsDhClO,KAAKuZ,wBjBosDH,KAAK,GAOD,MiBzsDZ3L,GAAQ0B,QAAQuH,IAAI,gBAAiB7W,KAAKmb,ejBysDvBnN,EAAYY,OAAO,SiBpsD/BhB,EjBssDC,KAAK,GACL,IAAK,MACD,MAAOI,GAAYe,SAE5B,KAAM/O,OiBzhEIqG,EAAQ/E,UAyVnBqM,YAAW,SAACC,EAASlJ,GjB2sDvB,MAAOoJ,oBAAmBC,MAAM,SAAsBC,GAClD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAGD,MAFA0F,GAAYC,KAAO,EACnBD,EAAY1F,KAAO,EACZwF,mBAAmBI,MiB5sDlBlO,KAAKib,eAAerN,EAASlJ,GjB8sDzC,KAAK,GAGD,MiBjtDRkJ,GAAOI,EAAAK,KjBgtDCL,EAAY1F,KAAO,EACZwF,mBAAmBI,MiB/sDpBlO,KAAK8E,QAAQ6I,YAAYC,GjBitDnC,KAAK,GACD,MAAOI,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GAID,GAHAL,EAAYC,KAAO,EACnBD,EAAYa,GAAKb,EAAY,SAAS,GiBjtDzCA,EAAAa,GAAEhB,aAAgBG,EAAAa,GAAEhB,YAAYW,YAAkD,KAAnCR,EAAAa,GAAEhB,YAAYW,WAAW4C,OAAc,CjBotD/EpD,EAAY1F,KAAO,EACnB,OAGJ,KAAM0F,GAAYa,EAEtB,KAAK,IAKD,MiB7tDR7O,MAAK6X,MAAMuD,oBjB4tDHpN,EAAY1F,KAAO,GACZwF,mBAAmBI,MiB3tDpBlO,KAAK2N,YAAYC,EAASlJ,GjB6tDpC,KAAK,IACD,MAAOsJ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,IACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,MiB5kEPqG,EAAQ/E,UAwXnB+Z,KAAI,WjBmuDN,GiBnuDO3W,GAAO+G,UAAAxJ,QAAA,GAAAlC,SAAA0L,UAAA,MAAKA,UAAA,EjBouDnB,OAAOqC,oBAAmBC,MAAM,SAAeC,GAC3C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAMD,MiBzuDZ5D,GAAQ6K,IAAMvP,KAAK+X,UAAUrT,EAAQ6K,KAAM2I,WAAW,IjBwuD1ClK,EAAY1F,KAAO,EACZwF,mBAAmBI,MiBvuDzBlO,KAAK2N,YAAY3N,KAAK8E,QAAQsK,cAAc1K,GAAUA,GjByuD3D,KAAK,GACD,MAAOsJ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiB7mEIqG,EAAQ/E,UAyYnB+Q,IAAG,SAAC9C,EAAKK,EAAOlL,GjBivDlB,MAAOoJ,oBAAmBC,MAAM,SAAcC,GAC1C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAMD,MiBxvDZ5D,GAAUA,MACVA,EAAQ8K,OAAS,MACjB9K,EAAQ6K,IAAMA,EACd7K,EAAQkL,MAAQA,EjBovDJ5B,EAAY1F,KAAO,EACZwF,mBAAmBI,MiBpvDzBlO,KAAKqb,KAAK3W,GjBsvDf,KAAK,GACD,MAAOsJ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiB3oEIqG,EAAQ/E,UA0ZnBga,KAAI,SAAC/L,EAAKQ,EAAMH,EAAOlL,GjB+vDzB,MAAOoJ,oBAAmBC,MAAM,SAAeC,GAC3C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAOD,MiBvwDZ5D,GAAUA,MACVA,EAAQ8K,OAAS,OACjB9K,EAAQ6K,IAAMA,EACd7K,EAAQkL,MAAQA,EAChBlL,EAAQqL,KAAOA,EjBkwDH/B,EAAY1F,KAAO,EACZwF,mBAAmBI,MiBlwDzBlO,KAAKqb,KAAK3W,GjBowDf,KAAK,GACD,MAAOsJ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiB3qEIqG,EAAQ/E,UA4anBia,IAAG,SAAChM,EAAKQ,EAAMH,EAAOlL,GjB6wDxB,MAAOoJ,oBAAmBC,MAAM,SAAcC,GAC1C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAOD,MiBrxDZ5D,GAAUA,MACVA,EAAQ8K,OAAS,MACjB9K,EAAQ6K,IAAMA,EACd7K,EAAQkL,MAAQA,EAChBlL,EAAQqL,KAAOA,EjBgxDH/B,EAAY1F,KAAO,EACZwF,mBAAmBI,MiBhxDzBlO,KAAKqb,KAAK3W,GjBkxDf,KAAK,GACD,MAAOsJ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiB3sEIqG,EAAQ/E,UA6bnB,UAAQ,SAACiO,EAAKK,EAAOlL,GjB2xDvB,MAAOoJ,oBAAmBC,MAAM,SAAkBC,GAC9C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAMD,MiBlyDZ5D,GAAUA,MACVA,EAAQ8K,OAAS,SACjB9K,EAAQ6K,IAAMA,EACd7K,EAAQkL,MAAQA,EjB8xDJ5B,EAAY1F,KAAO,EACZwF,mBAAmBI,MiB9xDzBlO,KAAKqb,KAAK3W,GjBgyDf,KAAK,GACD,MAAOsJ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiBzuEIqG,EAAQ/E,UAqcnB+Y,cAAa,SAACxG,EAAM9D,GjBwyDtB,MAAOjC,oBAAmBC,MAAM,SAAwBC,GACpD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAED,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MiB1yDzBlO,KAAKqb,MACd9L,IAAKsE,EACLqH,eAAe,EACfnL,KAAMA,EACNP,OAAQ,OACRF,SACIkM,cAAiB,SAAWxb,KAAKyb,UACjCC,eAAgB,uCjB8yDhB,KAAK,GACD,MAAO1N,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiBnwEIqG,EAAQ/E,UAodnBiY,sBAAqB,WjBmzDvB,MAAOzL,oBAAmBC,MAAM,SAAgCC,GAC5D,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GACD,IiBpzDRtI,KAAK0a,sBAAqB,CjBqzDd1M,EAAY1F,KAAO,CACnB,OAGJ,MAAO0F,GAAYY,OAAO,SiBzzDC,KjB2zD/B,KAAK,GAED,MADAZ,GAAY1F,KAAO,EACZwF,mBAAmBI,MiB5zDzBlO,KAAKya,UjB8zDV,KAAK,GACD,MAAOzM,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OiB5xEIqG,EAAQ/E,UA2dzBoZ,oBAAmB,WAEf,MAAQ1a,MAAK6X,MAAM8D,qBAAuB3b,KAAK4X,OAAOvL,YA7dzChG,EAAQ/E,UAiezBma,QAAO,WACH,GAAIG,GAAS5b,KAAK0X,QAAU,IAAM1X,KAAK2X,UACvC,OAAuB,kBAARkE,MAAsBA,KAAKD,GAAU,GAAIE,QAAOF,GAAQ/J,SAAS,WAnenExL,EAAQ/E,UAsezB6Z,YAAW,WACP,GAAIH,GAAQhb,KAAK6X,MAAMU,aACvB,OAAOvY,MAAK6X,MAAMkE,aAAef,EAAQ,IAAMA,EAAQ,KAxe1C3U,GjB+yElBrD,EAAiB,WAEpBtD,GAAQ,WiBjzEa2G,EjBkzErB1G,EAAOD,QAAUA,EAAQ,YAUnB,SAASC,EAAQD,GAEvB,YAMA,SAAS8B,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjC,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MkBx0E5gB0E,EAAI,WAKV,QALMA,GAKLN,EAAOoG,GlBo1Ef1K,EAAgBxB,KkBz1EHoG,GAQbpG,KAAK2E,OAASmB,EACd9F,KAAKmM,SAAWD,ElB29EpB,MAvJAtK,GkB70EiBwE,EAAI,OlB80EjBhF,IAAK,oBACLmE,MkB70E8B,IlB+0E9BpD,YAAY,IAEZf,IAAK,kBACLmE,MkBj1EqB,SlBk1ErBpD,YAAY,KkBr1ECiE,EAAI9E,UAarBiX,YAAW,WACP,MAAOvY,MAAKoK,OAAO4J,cAdN5N,EAAI9E,UAiBrBsZ,aAAY,WACR,MAAO5a,MAAKoK,OAAO+J,eAlBN/N,EAAI9E,UAqBrBya,UAAS,WACL,MAAO/b,MAAKoK,OAAO6J,YAtBN7N,EAAI9E,UA4BrB8I,KAAI,WAEA,MAAOpK,MAAK2E,OAAO8F,QAAQzK,KAAKmM,YACxB8H,WAAY,GACZD,aAAc,GACdE,WAAY,EACZC,cAAe,GACfC,yBAA0B,IAnCrBhO,EAAI9E,UA4CrBiZ,QAAO,SAACyB,GAEJA,EAAUA;AAEV,GAAI5R,GAAOpK,KAAKoK,MAWhB,OATA/I,QAAOwF,KAAKmV,GAASlV,QAAQ,SAAC1F,GAC1BgJ,EAAKhJ,GAAO4a,EAAQ5a,KAGxBgJ,EAAK6R,YAAc1P,KAAKC,MAA2B,IAAlBpC,EAAK8J,WACtC9J,EAAK8R,0BAA4B3P,KAAKC,MAAyC,IAAhCpC,EAAKgK,yBAEpDpU,KAAK2E,OAAOwF,QAAQnK,KAAKmM,SAAU/B,GAE5BpK,MA3DMoG,EAAI9E,UAmErBqa,iBAAgB,WAEZ,GAAIQ,GAAWnc,KAAKoK,MACpB,OAAQ+R,GAASlI,aAAe7N,EAAKgW,iBAAoBD,EAASF,YAAc7V,EAAKiW,kBAAoB9P,KAAKC,OAtEjGpG,EAAI9E,UA8ErBuZ,kBAAiB,WAEb,MAAQ7a,MAAKoK,OAAO8R,0BAA4B3P,KAAKC,OAhFxCpG,EAAI9E,UAuFrB8Z,kBAAiB,WAEb,MAAOpb,MAAKua,SACRvG,aAAc,GACdE,WAAY,KA3FH9N,EAAI9E,UAoGrBgb,oBAAmB,WAUf,MARAtc,MAAKua,SACDtG,WAAY7N,EAAKgW,gBACjBpI,aAAc,GACdE,WAAY,EACZC,cAAe,GACfC,yBAA0B,IAGvBpU,MA9GMoG,EAAI9E,UAsHrBkZ,YAAW,SAACf,GAER,MAAOzZ,MAAKua,SAASd,SAAUA,KAxHlBrT,EAAI9E,UA+HrBmY,SAAQ,WAEJ,QAASzZ,KAAKoK,OAAOqP,UAjIRrT,IlBu+ErB1G,GAAQ,WkBv+Ea0G,ElBw+ErBzG,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAIA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjC,EAAQsB,YAAa,CAMrB,IAAIub,GAAgBlc,EmBt/EG,InBw/EnBmc,EAAiB1b,EAAuByb,GAExC1Z,EAAiBxC,EmBz/EA,GAEAoG,EAAiB,WAEvB,QAFMA,KnB2/EbjF,EAAgBxB,KmB3/EHyG,GAGbzG,KAAKyc,WAAa5Z,EAAAyC,OAAOmX,WnBigF7B,MmBpgFiBhW,GAAiBnF,UAMlC+N,KAAI,SAAC3K,GACD,MAAO,IAAA8X,GAAA,WAAe9X,IAPT+B,InBugFrB/G,GAAQ,WmBvgFa+G,EnBwgFrB9G,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAIA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASmL,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIrL,WAAU,iEAAoEqL,GAAeD,GAASzL,UAAYD,OAAO4L,OAAOD,GAAcA,EAAW1L,WAAa4L,aAAe3H,MAAOwH,EAAU5K,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAe4K,IAAY3L,OAAO8L,eAAiB9L,OAAO8L,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,GANjetN,EAAQsB,YAAa,CAQrB,IAAI+B,GAAkB1C,EoB3hFC,GpB6hFnB2C,EAAmBlC,EAAuBiC,GAE1CF,EAAiBxC,EoB9hFA,GAEAqc,EAAU,SAAAnP,GAEhB,QAFMmP,GAELhY,GpBgiFRlD,EAAgBxB,KoBliFH0c,GAGbnP,EAAA7M,KAAAV,MACAA,KAAK0E,QAAUA,EACf1E,KAAKyc,WAAa5Z,EAAAyC,OAAOmX,WpBkjF7B,MAxBA3P,GoB/hFiB4P,EAAUnP,GAAVmP,EAAUpb,UAQ3Bqb,MAAK,aARYD,EAAUpb,UAU3Bsb,UAAS,SAAClY,GACN1E,KAAKiL,GAAG,WAAavG,EAAQmY,QAASnY,EAAQwK,UAXjCwN,EAAUpb,UAc3Bwb,YAAW,SAACpY,GACR1E,KAAK6K,IAAI,WAAanG,EAAQmY,UAfjBH,EAAUpb,UAkB3Byb,eAAc,SAACC,EAAKH,GAChB7c,KAAKsL,KAAK,WAAauR,EAASG,EAAK,MAAOH,IAnB/BH,GpBwjFlB1Z,EAAiB,WAEpBtD,GAAQ,WoB1jFagd,EpB2jFrB/c,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAMA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASmL,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIrL,WAAU,iEAAoEqL,GAAeD,GAASzL,UAAYD,OAAO4L,OAAOD,GAAcA,EAAW1L,WAAa4L,aAAe3H,MAAOwH,EAAU5K,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAe4K,IAAY3L,OAAO8L,eAAiB9L,OAAO8L,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,GARjetN,EAAQsB,YAAa,CAErB,IAAIY,GAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMhB,OAAOiB,eAAeR,EAAQI,EAAWd,IAAKc,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYJ,UAAWiB,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MAQ7hBqB,EAAkB1C,EqBhlFC,GrBklFnB2C,EAAmBlC,EAAuBiC,GAE1CI,EAAc9C,EqBnlFC,IrBulFfoC,GAFe3B,EAAuBqC,GAEzB9C,EqBtlFsB,IAElBiG,EAAY,SAAAiH,GAelB,QAfMjH,GAeLjB,EAAeK,GrBqlFvBlE,EAAgBxB,KqBpmFHsG,GAiBbiH,EAAA7M,KAAAV,MrBulFAA,KqBnmFJkL,QACI+R,aAAc,eACdC,cAAe,gBACfC,YAAa,cACbC,aAAc,eACdC,WAAY,aACZC,iBAAkB,mBAClBC,eAAgB,kBAOhBvd,KAAKoF,eAAiBC,EACtBrF,KAAKgF,UAAYU,EACjB1F,KAAKsJ,QAAU,KACftJ,KAAKwd,SAAW,KAChBxd,KAAKyd,iBrBs9FT,MAtZA3Q,GqBvlFiBxG,EAAYiH,GrBylF7B3L,EqBzlFiB0E,EAAY,OrB0lFzBlF,IAAK,mBACLmE,MqBzlFsB,KrB0lFtBpD,YAAY,IAEZf,IAAK,gBACLmE,MqB5lFmB,IrB6lFnBpD,YAAY,KqBhmFCmE,EAAYhF,UA2B7Boc,WAAU,WAEN,SAAU1d,KAAKyd,cAAcjd,IACnBR,KAAKyd,cAAchI,cACnBzV,KAAKyd,cAAchI,aAAaI,eAChC7V,KAAKyd,cAAchI,aAAaG,UAhC7BtP,EAAYhF,UAuC7Bqc,MAAK,WAED,MAAO3d,MAAK0d,cAAgBnR,KAAKC,MAAQxM,KAAKuV,kBAzCjCjP,EAAYhF,UA6C7BiU,eAAc,WACV,MAAO,IAAIhJ,MAAKvM,KAAKyd,cAAclI,gBAAkB,GAAGhB,UAAYjO,EAAasX,kBA9CpEtX,EAAYhF,UAiD7Buc,gBAAe,SAACC,GAYZ,MAVAA,GAAeA,MAEf9d,KAAK+d,gBAEL/d,KAAKyd,cAAgBK,EAEhB9d,KAAKsJ,SAAStJ,KAAKge,qBAExBhe,KAAKie,cAEEje,MA7DMsG,EAAYhF,UAiE7Bwc,aAAY,WACR,MAAO9d,MAAKyd,eAlECnX,EAAYhF,UAyEvB4c,SAAQ,WrB4mFV,MAAOpQ,oBAAmBC,MAAM,SAAmBC,GAC/C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GACD,IqB7mFRtI,KAAK2d,QAAO,CrB8mFA3P,EAAY1F,KAAO,CACnB,OAIJ,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MqBlnFrBlO,KAAKme,QrBonFd,KAAK,GACD,MAAOnQ,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GAED,MADAL,GAAY1F,KAAO,EACZwF,mBAAmBI,MqBvnFrBlO,KAAK4c,YrBynFd,KAAK,GACD,MAAO5O,GAAYY,OAAO,SAAUZ,EAAYK,KAEpD,KAAK,GACL,IAAK,MACD,MAAOL,GAAYe,SAE5B,KAAM/O,OqB9sFIsG,EAAYhF,UAmF7BgU,aAAY,WACR,MAAOtV,MAAKyd,cAAcnI,kBApFbhP,EAAYhF,UA2F7B8c,gBAAe,SAAClT,GAEZ,MADAlL,MAAKqe,gBAAgBre,KAAKsV,eAAegJ,OAAOpT,IACzClL,MA7FMsG,EAAYhF,UAoG7B+c,gBAAe,SAACnT,GAEZ,MADAlL,MAAKyd,cAAcnI,aAAepK,EAC3BlL,MAtGMsG,EAAYhF,UA4GvBsb,UAAS,WrBkoFX,GqB1nFQpO,GAMA0C,CrBqnFR,OAAOpD,oBAAmBC,MAAM,SAAoBC,GAChD,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAKD,GAJA0F,EAAYC,KAAO,EqBloF3BjO,KAAK+d,gBAEA/d,KAAKsV,eAAerT,OAAM,CrBqoFnB+L,EAAY1F,KAAO,CACnB,OAGJ,KqBzoF+B,IAAI+C,OAAM,uBrB2oF7C,KAAK,GAED,MADA2C,GAAY1F,KAAO,EACZwF,mBAAmBI,MqB3oFblO,KAAKgF,UAAUsW,KAAK,8BACjChG,aAActV,KAAKue,uBACnB9I,cACIC,cAAe,YrB+oFvB,KAAK,GAMD,MqBxpFJlH,GAAQR,EAAAK,KAMR6C,EAAO1C,EAAS0C,OAEpBlR,KAAK6d,gBAAgB3M,GAChB5F,KAAKtL,KAAKkL,OAAOoS,iBAAkB9O,GrB+oFzBR,EAAYY,OAAO,SqB7oF3BJ,ErB+oFH,KAAK,IAQD,KAPAR,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GqB5oF9CA,EAAAa,GAAI7O,KAAKgF,UAAUD,SAAS+J,UAASd,EAAAa,IAErC7O,KAAKwe,QACAlT,KAAKtL,KAAKkL,OAAOqS,eAAcvP,EAAAa,IrB+oFtBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OqB5xFPsG,EAAYhF,UAkJvB6c,MAAK,WrBkpFP,GqBxoFQ3P,GAIA0C,CrBqoFR,OAAOpD,oBAAmBC,MAAM,SAAgBC,GAC5C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAKD,GAJA0F,EAAYC,KAAO,EqBlpF3BjO,KAAK+d,gBAEA/d,KAAK2d,QAAO,CrBqpFL3P,EAAY1F,KAAO,CACnB,OAGJ,KqBzpFiB,IAAI+C,OAAM,4BrB2pF/B,KAAK,GACD,GqB1pFHrL,KAAKsV,eAAerT,OAAM,CrB2pFnB+L,EAAY1F,KAAO,CACnB,OAGJ,KqB/pF+B,IAAI+C,OAAM,uBrBiqF7C,KAAK,GAED,MADA2C,GAAY1F,KAAO,EACZwF,mBAAmBI,MqBjqFblO,KAAKgF,UAAUuW,IAAI,8BAAgCvb,KAAKyd,cAAcjd,IACvF8U,aAActV,KAAKue,yBrBoqFnB,KAAK,GAMD,MqB3qFJ/P,GAAQR,EAAAK,KAIR6C,EAAO1C,EAAS0C,OAEpBlR,KAAK6d,gBAAgB3M,GAChB5F,KAAKtL,KAAKkL,OAAOkS,aAAc5O,GrBoqFrBR,EAAYY,OAAO,SqBlqF3BJ,ErBoqFH,KAAK,IAQD,KAPAR,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GqBlqF9CA,EAAAa,GAAI7O,KAAKgF,UAAUD,SAAS+J,UAASd,EAAAa,IAErC7O,KAAKwe,QACAlT,KAAKtL,KAAKkL,OAAOmS,WAAUrP,EAAAa,IrBqqFlBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OqBv1FPsG,EAAYhF,UAuLvBmd,OAAM,WrBwqFR,GqBlqFQjQ,ErBmqFR,OAAOV,oBAAmBC,MAAM,SAAiBC,GAC7C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAGD,GAFA0F,EAAYC,KAAO,EqBxqFtBjO,KAAK0d,aAAY,CrB2qFV1P,EAAY1F,KAAO,CACnB,OAGJ,KqB/qFsB,IAAI+C,OAAM,kBrBirFpC,KAAK,GAED,MADA2C,GAAY1F,KAAO,EACZwF,mBAAmBI,MqBjrFblO,KAAKgF,UAAS,UAAQ,8BAAgChF,KAAKyd,cAAcjd,IrBmrF1F,KAAK,GAKD,MqBxrFJgO,GAAQR,EAAAK,KAEZrO,KAAKwe,QACAlT,KAAKtL,KAAKkL,OAAOgS,cAAe1O,GrBqrFtBR,EAAYY,OAAO,SqBnrF3BJ,ErBqrFH,KAAK,IAQD,KAPAR,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GqBnrF9CA,EAAAa,GAAI7O,KAAKgF,UAAUD,SAAS+J,UAASd,EAAAa,IAErC7O,KAAKsL,KAAKtL,KAAKkL,OAAOiS,YAAWnP,EAAAa,IrBurFnBb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OqBr4FPsG,EAAYhF,UAmN7Bod,YAAW,WAEP,MAAO1e,MAAKwe,QAAQH,gBAAgBre,KAAKsV,gBAAgBsH,aArN5CtW,EAAYhF,UA6N7Bkd,MAAK,WAID,MAHAxe,MAAK+d,gBACD/d,KAAK0d,cAAgB1d,KAAKsJ,SAAStJ,KAAKsJ,QAAQwT,aAAaD,QAAS7c,KAAKyd,cAAchI,aAAaG,UAC1G5V,KAAKyd,iBACEzd,MAjOMsG,EAAYhF,UAoO7Bid,qBAAoB,WrB0rFhB,GAAInT,GAAQpL,IqBxrFZ,OAAOA,MAAKsV,eAAepD,IAAI,SAACnH,GAC5B,MAAOK,GAAKpG,UAAU+S,UAAUhN,MAvOvBzE,EAAYhF,UA4O7B2c,YAAW,WrB0rFP,GAAI1S,GAASvL,IqBtrFb,IAFAA,KAAK+d,iBAEA/d,KAAK2d,QAAS,KAAM,IAAItS,OAAM,4BAUnC,OARA5I,GAAAwF,KAAK,SAACK,GAEF,MAAIiD,GAAKoS,QAAgBrV,QAEzBiD,GAAK4S,SAEN7X,EAAauG,cAAe7M,KAAKwd,UAE7Bxd,MA1PMsG,EAAYhF,UA8P7Byc,cAAa,WAIT,MAFAtb,GAAA4F,YAAYrI,KAAKwd,UAEVxd,MAlQMsG,EAAYhF,UAsQ7Bqd,SAAQ,SAACzP,GAEL,IAAKlP,KAAK0d,aAAc,KAAM,IAAIrS,OAAM,kBAExC,IAAIrL,KAAKyd,cAAchI,aAAaU,cAAe,CAE/C,GAAI7Q,GAAStF,KAAKoF,cAElB8J,GAAU5J,EAAOmX,WAAWmC,QAAQ1P,EAASlP,KAAKyd,cAAchI,aAAaU,eACzE0I,YAAY,EACZC,YAAa,SACbC,UAAW,IACXpP,KAAM,QAKd,MAAOT,IAvRM5I,EAAYhF,UA2R7B0d,QAAO,SAAC9P,GAIJ,MAFAlP,MAAKsL,KAAKtL,KAAKkL,OAAO+R,aAAcjd,KAAK2e,SAASzP,IAE3ClP,MA/RMsG,EAAYhF,UAmS7B0c,mBAAkB,WAEd,IAAKhe,KAAK2d,QAAS,KAAM,IAAItS,OAAM,4BAEnC,IAAI/F,GAAStF,KAAKoF,cAelB,OAbApF,MAAKsJ,QAAUhE,EAAO+J,MAClB4P,KAAK,EACLC,cAAelf,KAAKyd,cAAchI,aAAaI,gBAGnD7V,KAAKsJ,QAAQqT,QAEb3c,KAAKsJ,QAAQsT,WACTC,QAAS7c,KAAKyd,cAAchI,aAAaG,QACzC1G,QAASlP,KAAKgf,QAAQG,KAAKnf,MAC3Bof,QAAS,eAGNpf,MAtTMsG,GrB8+FlBtD,EAAiB,WAEpBtD,GAAQ,WqBh/Fa4G,ErBi/FrB3G,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,EAASW,GAEhC,YAMA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAAWF,GAEzF,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASmL,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIrL,WAAU,iEAAoEqL,GAAeD,GAASzL,UAAYD,OAAO4L,OAAOD,GAAcA,EAAW1L,WAAa4L,aAAe3H,MAAOwH,EAAU5K,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAe4K,IAAY3L,OAAO8L,eAAiB9L,OAAO8L,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,GARjetN,EAAQsB,YAAa,CAErB,IAAIqe,GAAWhe,OAAOie,QAAU,SAAUxd,GAAU,IAAK,GAAIE,GAAI,EAAGA,EAAIyJ,UAAUxJ,OAAQD,IAAK,CAAE,GAAIud,GAAS9T,UAAUzJ,EAAI,KAAK,GAAIZ,KAAOme,GAAcle,OAAOC,UAAUC,eAAeb,KAAK6e,EAAQne,KAAQU,EAAOV,GAAOme,EAAOne,IAAY,MAAOU,IAQnP0d,EAAiBnf,EsBvgGI,ItBygGrBof,EAAiB3e,EAAuB0e,GAExCvc,EAAa5C,EsB1gGC,GtB4gGd6C,EAAcpC,EAAuBmC,GsB1gGpByc,EAAkB,SAAAC,GAExB,QAFMD,GAELra,EAAeK,EAAUI,EAAOD,GtB8gGxC,GAAIuF,GAAQpL,IAEZwB,GAAgBxB,KsBlhGH0f,GAIbC,EAAAjf,KAAAV,KAAMqF,EAAeK,GAErB1F,KAAK2E,OAASmB,EACd9F,KAAK4f,UAAY/Z,EACjB7F,KAAK6f,YAAc,GAAA3c,GAAA,WAAUlD,KAAK2E,OAAQkB,EAAW,UACrD7F,KAAK8f,kBAAoB,GAAA5c,GAAA,WAAUlD,KAAK2E,OAAQkB,EAAW,gBAE3D7F,KAAKkL,OAAMmU,KACJrf,KAAKkL,QACR6U,mBAAoB,qBACpBC,iBAAkB,mBAClBC,yBAA0B,2BAC1BC,uBAAwB,2BAG5BlgB,KAAKiL,GAAGjL,KAAKkL,OAAOmS,WAAY,WAC5BjS,EAAKsT,gBAGT1e,KAAKiL,IAAIjL,KAAKkL,OAAOoS,iBAAkBtd,KAAKkL,OAAOkS,cAAe,WAC9DhS,EAAKzG,OAAOwF,QAAQiB,EAAKwU,UAAWxU,EAAK0S,kBAG7C9d,KAAKiL,GAAGjL,KAAKkL,OAAOgS,cAAe,WAC/B9R,EAAKzG,OAAO6F,WAAWY,EAAKwU,atBgoGpC,MA/IA9S,GsB7gGiB4S,EAAkBC,GAAlBD,EAAkBpe,UA2C7BsW,OAAM,SAACuI,EAAUC,EAAOC,EAAcC,EAAYC,GtBghGpD,GsB5/FQ1P,EtB6/FR,OAAO/C,oBAAmBC,MAAM,SAAiBC,GAC7C,OAAU,OAAQA,EAAYC,KAAOD,EAAY1F,MAC7C,IAAK,GAGD,GAFA0F,EAAYC,KAAO,GsBhhGvBmS,EAAM/T,WAAU,CtBmhGR2B,EAAY1F,KAAO,CACnB,OAIJ,MADA0F,GAAY1F,KAAO,EACZwF,mBAAmBI,MsBthGxBkS,EAAMnY,OtBwhGZ,KAAK,GACD,GsBvhGCjI,KAAK2d,QAAO,CtBwhGT3P,EAAY1F,KAAO,CACnB,OAGJ,KsB3hGM,IAAI+C,OAAMkV,EtB6hGpB,KAAK,GAID,MsB9hGJvgB,MAAKsL,KAAK+U,EAAc,MtB8hGbrS,EAAYY,OAAO,SsB5hGvB,KtB8hGP,KAAK,GAKD,MsB/hGRwR,GAAMzT,QtB8hGEqB,EAAY1F,KAAO,GACZwF,mBAAmBI,MsB7hGlBiS,EAASzf,KAAKV,MtB+hG1B,KAAK,IAOD,MsBtiGJ6Q,GAAG7C,EAAAK,KAEP+R,EAAMxT,SAEN5M,KAAKsL,KAAK+U,EAAcxP,GtBkiGT7C,EAAYY,OAAO,SsBhiG3BiC,EtBkiGH,KAAK,IAMD,KALA7C,GAAYC,KAAO,GACnBD,EAAYa,GAAKb,EAAY,SAAS,GsBhiG9ChO,KAAKsL,KAAKgV,EAAUtS,EAAAa,ItBoiGNb,EAAYa,EAEtB,KAAK,IACL,IAAK,MACD,MAAOb,GAAYe,SAE5B,KAAM/O,OAAQ,EAAG,OsBnnGP0f,EAAkBpe,UAoFnC6c,MAAK,WAED,MAAOne,MAAK4X,OACR+H,EAAAre,UAAM6c,MACNne,KAAK6f,YACL7f,KAAKkL,OAAO6U,mBACZ/f,KAAKkL,OAAO8U,iBACZ,kDA3FSN,EAAkBpe,UAmGnCod,YAAW,WAEP,MAAO1e,MAAK4X,OACR+H,EAAAre,UAAMod,YACN1e,KAAK8f,kBACL9f,KAAKkL,OAAO+U,yBACZjgB,KAAKkL,OAAOgV,uBACZ,wDA1GSR,EAAkBpe,UAmHnCkf,QAAO,SAACtV,GAEJ,GAAIuV,GAAyBzgB,KAAK2E,OAAO8F,QAAQzK,KAAK4f,UAEtD,IAAIa,EACA,IACIzgB,KAAK6d,gBAAgB4C,GACvB,MAAOzR,QAEThP,MAAKqe,gBAAgBnT,EAGzB,OAAOlL,OA/HM0f,GtB6pGlBD,EAAe,WAElB/f,GAAQ,WsB/pGaggB,EtBgqGrB/f,EAAOD,QAAUA,EAAQ,YAInB,SAASC,EAAQD,IuBvqGvB,SAAAghB,IAUA,SAAAA,GACA,YAwBA,SAAAC,GAAAC,EAAAC,EAAAC,EAAAC,GAEA,GAAAC,GAAA3f,OAAA4L,QAAA4T,GAAAI,GAAA3f,WACA4f,EAAA,GAAAC,GAAAJ,MAMA,OAFAC,GAAAI,QAAAC,EAAAT,EAAAE,EAAAI,GAEAF,EAcA,QAAAM,GAAApZ,EAAAnH,EAAA2G,GACA,IACA,OAAc6Z,KAAA,SAAA7Z,IAAAQ,EAAAxH,KAAAK,EAAA2G,IACT,MAAA8Z,GACL,OAAcD,KAAA,QAAA7Z,IAAA8Z,IAiBd,QAAAP,MACA,QAAAQ,MACA,QAAAC,MASA,QAAAC,GAAArgB,IACA,OAAA,QAAA,UAAAwF,QAAA,SAAA0I,GACAlO,EAAAkO,GAAA,SAAA9H,GACA,MAAA1H,MAAAohB,QAAA5R,EAAA9H,MAkCA,QAAAka,GAAAla,GACA1H,KAAA0H,IAAAA,EAGA,QAAAma,GAAAb,GAGA,QAAAc,GAAAtS,EAAA9H,GACA,GAAAkE,GAAAoV,EAAAxR,GAAA9H,GACAnC,EAAAqG,EAAArG,KACA,OAAAA,aAAAqc,GACA7Y,QAAAC,QAAAzD,EAAAmC,KAAAqa,KAAAC,EAAAC,GACAlZ,QAAAC,QAAAzD,GAAAwc,KAAA,SAAAG,GAiBA,MADAtW,GAAArG,MAAA2c,EACAtW,IAaA,QAAAuW,GAAA3S,EAAA9H,GACA,QAAA0a,KACA,MAAAN,GAAAtS,EAAA9H,GAGA,MAAA2a,GAaAA,EAAAA,EAAAN,KACAK,EAGAA,GACA,GAAArZ,SAAA,SAAAC,GACAA,EAAAoZ,OAjCA,gBAAAzZ,UAAAA,QAAA2Z,SACAR,EAAAnZ,QAAA2Z,OAAAnD,KAAA2C,GAGA,IAGAO,GAHAL,EAAAF,EAAA3C,KAAA6B,EAAA,QACAiB,EAAAH,EAAA3C,KAAA6B,EAAA,QACAc,GAAA3C,KAAA6B,EAAA,SAiCAhhB,MAAAohB,QAAAe,EAoBA,QAAAd,GAAAT,EAAAE,EAAAI,GACA,GAAApI,GAAAyJ,CAEA,OAAA,UAAA/S,EAAA9H,GACA,GAAAoR,IAAA0J,EACA,KAAA,IAAAnX,OAAA,+BAGA,IAAAyN,IAAA2J,EAAA,CACA,GAAA,UAAAjT,EACA,KAAA9H,EAKA,OAAAgb,KAGA,OAAA,CACA,GAAAC,GAAAzB,EAAAyB,QACA,IAAAA,EAAA,CACA,GAAA,WAAAnT,GACA,UAAAA,GAAAmT,EAAAC,SAAApT,KAAAzP,EAAA,CAGAmhB,EAAAyB,SAAA,IAIA,IAAAE,GAAAF,EAAAC,SAAA,SACA,IAAAC,EAAA,CACA,GAAAC,GAAAxB,EAAAuB,EAAAF,EAAAC,SAAAlb,EACA,IAAA,UAAAob,EAAAvB,KAAA,CAGA/R,EAAA,QACA9H,EAAAob,EAAApb,GACA,WAIA,GAAA,WAAA8H,EAGA,SAIA,GAAAsT,GAAAxB,EACAqB,EAAAC,SAAApT,GACAmT,EAAAC,SACAlb,EAGA,IAAA,UAAAob,EAAAvB,KAAA,CACAL,EAAAyB,SAAA,KAIAnT,EAAA,QACA9H,EAAAob,EAAApb,GACA,UAMA8H,EAAA,OACA9H,EAAA3H,CAEA,IAAAgjB,GAAAD,EAAApb,GACA,KAAAqb,EAAAC,KAKA,MADAlK,GAAAmK,EACAF,CAJA7B,GAAAyB,EAAAO,YAAAH,EAAAxd,MACA2b,EAAA5Y,KAAAqa,EAAAQ,QAMAjC,EAAAyB,SAAA,KAGA,GAAA,SAAAnT,EACAsJ,IAAAmK,EACA/B,EAAA7S,KAAA3G,EAEAwZ,EAAA7S,KAAAtO,MAGS,IAAA,UAAAyP,EAAA,CACT,GAAAsJ,IAAAyJ,EAEA,KADAzJ,GAAA2J,EACA/a,CAGAwZ,GAAAkC,kBAAA1b,KAGA8H,EAAA,OACA9H,EAAA3H,OAGS,WAAAyP,GACT0R,EAAAtS,OAAA,SAAAlH,EAGAoR,GAAA0J,CAEA,IAAAM,GAAAxB,EAAAV,EAAAE,EAAAI,EACA,IAAA,WAAA4B,EAAAvB,KAAA,CAGAzI,EAAAoI,EAAA8B,KACAP,EACAQ,CAEA,IAAAF,IACAxd,MAAAud,EAAApb,IACAsb,KAAA9B,EAAA8B,KAGA,IAAAF,EAAApb,MAAA2b,EAOA,MAAAN,EANA7B,GAAAyB,UAAA,SAAAnT,IAGA9H,EAAA3H,OAMS,UAAA+iB,EAAAvB,OACTzI,EAAA2J,EAGAjT,EAAA,QACA9H,EAAAob,EAAApb,OAkBA,QAAA4b,GAAAC,GACA,GAAAC,IAAiBC,OAAAF,EAAA,GAEjB,KAAAA,KACAC,EAAAE,SAAAH,EAAA,IAGA,IAAAA,KACAC,EAAAG,WAAAJ,EAAA,GACAC,EAAAI,SAAAL,EAAA,IAGAvjB,KAAA6jB,WAAA1c,KAAAqc,GAGA,QAAAM,GAAAN,GACA,GAAAV,GAAAU,EAAAO,cACAjB,GAAAvB,KAAA,eACAuB,GAAApb,IACA8b,EAAAO,WAAAjB,EAGA,QAAA3B,GAAAJ,GAIA/gB,KAAA6jB,aAAwBJ,OAAA,SACxB1C,EAAAja,QAAAwc,EAAAtjB,MACAA,KAAAwe,OAAA,GA8BA,QAAAwF,GAAAC,GACA,GAAAA,EAAA,CACA,GAAAC,GAAAD,EAAAE,EACA,IAAAD,EACA,MAAAA,GAAAxjB,KAAAujB,EAGA,IAAA,kBAAAA,GAAA3b,KACA,MAAA2b,EAGA,KAAAG,MAAAH,EAAAhiB,QAAA,CACA,GAAAD,GAAA,GAAAsG,EAAA,QAAAA,KACA,OAAAtG,EAAAiiB,EAAAhiB,QACA,GAAAoiB,EAAA3jB,KAAAujB,EAAAjiB,GAGA,MAFAsG,GAAA/C,MAAA0e,EAAAjiB,GACAsG,EAAA0a,MAAA,EACA1a,CAOA,OAHAA,GAAA/C,MAAAxF,EACAuI,EAAA0a,MAAA,EAEA1a,EAGA,OAAAA,GAAAA,KAAAA,GAKA,OAAYA,KAAAoa,GAIZ,QAAAA,KACA,OAAYnd,MAAAxF,EAAAijB,MAAA,GAvcZ,GACAjjB,GADAskB,EAAAhjB,OAAAC,UAAAC,eAEA4iB,EACA,kBAAAG,SAAAA,OAAA1B,UAAA,aAEA2B,EAAA,gBAAA5kB,GACA6kB,EAAA9D,EAAA5S,kBACA,IAAA0W,EAQA,YAPAD,IAGA5kB,EAAAD,QAAA8kB,GASAA,GAAA9D,EAAA5S,mBAAAyW,EAAA5kB,EAAAD,WAaA8kB,EAAA7D,KAAAA,CAoBA,IAAA4B,GAAA,iBACAU,EAAA,iBACAT,EAAA,YACAC,EAAA,YAIAY,KAUAoB,EAAA/C,EAAApgB,UAAA2f,EAAA3f,SACAmgB,GAAAngB,UAAAmjB,EAAAvX,YAAAwU,EACAA,EAAAxU,YAAAuU,EACAA,EAAAiD,YAAA,oBAYAF,EAAAG,oBAAA,SAAAC,GACA,GAAAC,GAAA,kBAAAD,IAAAA,EAAA1X,WACA,OAAA2X,GACAA,IAAApD,GAGA,uBAAAoD,EAAAH,aAAAG,EAAAnU,OACA,GAGA8T,EAAAM,KAAA,SAAAF,GAOA,MANAvjB,QAAA8L,eACA9L,OAAA8L,eAAAyX,EAAAlD,GAEAkD,EAAAxX,UAAAsU,EAEAkD,EAAAtjB,UAAAD,OAAA4L,OAAAwX,GACAG,GAQAJ,EAAAtW,MAAA,SAAAxG,GACA,MAAA,IAAAka,GAAAla,IA8EAia,EAAAE,EAAAvgB,WAKAkjB,EAAAzW,MAAA,SAAA6S,EAAAC,EAAAC,EAAAC,GACA,GAAAgE,GAAA,GAAAlD,GACAlB,EAAAC,EAAAC,EAAAC,EAAAC,GAGA,OAAAyD,GAAAG,oBAAA9D,GACAkE,EACAA,EAAAzc,OAAAyZ,KAAA,SAAAnW,GACA,MAAAA,GAAAoX,KAAApX,EAAArG,MAAAwf,EAAAzc,UAoJAqZ,EAAA8C,GAEAA,EAAAN,GAAA,WACA,MAAAnkB,OAGAykB,EAAA5S,SAAA,WACA,MAAA,sBAkCA2S,EAAA3d,KAAA,SAAAme,GACA,GAAAne,KACA,KAAA,GAAAzF,KAAA4jB,GACAne,EAAAM,KAAA/F,EAMA,OAJAyF,GAAAwS,UAIA,QAAA/Q,KACA,KAAAzB,EAAA5E,QAAA,CACA,GAAAb,GAAAyF,EAAAmL,KACA,IAAA5Q,IAAA4jB,GAGA,MAFA1c,GAAA/C,MAAAnE,EACAkH,EAAA0a,MAAA,EACA1a,EAQA,MADAA,GAAA0a,MAAA,EACA1a,IAsCAkc,EAAAR,OAAAA,EAMA7C,EAAA7f,WACA4L,YAAAiU,EAEA3C,MAAA,SAAAyG,GASA,GARAjlB,KAAAiO,KAAA,EACAjO,KAAAsI,KAAA,EACAtI,KAAAqO,KAAAtO,EACAC,KAAAgjB,MAAA,EACAhjB,KAAA2iB,SAAA,KAEA3iB,KAAA6jB,WAAA/c,QAAAgd,IAEAmB,EACA,IAAA,GAAAvU,KAAA1Q,MAEA,MAAA0Q,EAAAwU,OAAA,IACAb,EAAA3jB,KAAAV,KAAA0Q,KACA0T,OAAA1T,EAAAyU,MAAA,MACAnlB,KAAA0Q,GAAA3Q,IAMAgP,KAAA,WACA/O,KAAAgjB,MAAA,CAEA,IAAAoC,GAAAplB,KAAA6jB,WAAA,GACAwB,EAAAD,EAAArB,UACA,IAAA,UAAAsB,EAAA9D,KACA,KAAA8D,GAAA3d,GAGA,OAAA1H,MAAAslB,MAGAlC,kBAAA,SAAAmC,GAMA,QAAAC,GAAAC,EAAAC,GAIA,MAHA5C,GAAAvB,KAAA,QACAuB,EAAApb,IAAA6d,EACArE,EAAA5Y,KAAAmd,IACAC,EATA,GAAA1lB,KAAAgjB,KACA,KAAAuC,EAWA,KAAA,GARArE,GAAAlhB,KAQAgC,EAAAhC,KAAA6jB,WAAA5hB,OAAA,EAA8CD,GAAA,IAAQA,EAAA,CACtD,GAAAwhB,GAAAxjB,KAAA6jB,WAAA7hB,GACA8gB,EAAAU,EAAAO,UAEA,IAAA,SAAAP,EAAAC,OAIA,MAAA+B,GAAA,MAGA,IAAAhC,EAAAC,QAAAzjB,KAAAiO,KAAA,CACA,GAAA0X,GAAAtB,EAAA3jB,KAAA8iB,EAAA,YACAoC,EAAAvB,EAAA3jB,KAAA8iB,EAAA,aAEA,IAAAmC,GAAAC,EAAA,CACA,GAAA5lB,KAAAiO,KAAAuV,EAAAE,SACA,MAAA8B,GAAAhC,EAAAE,UAAA,EACa,IAAA1jB,KAAAiO,KAAAuV,EAAAG,WACb,MAAA6B,GAAAhC,EAAAG,gBAGW,IAAAgC,GACX,GAAA3lB,KAAAiO,KAAAuV,EAAAE,SACA,MAAA8B,GAAAhC,EAAAE,UAAA,OAGW,CAAA,IAAAkC,EAMX,KAAA,IAAAva,OAAA,yCALA,IAAArL,KAAAiO,KAAAuV,EAAAG,WACA,MAAA6B,GAAAhC,EAAAG,gBAUA/U,OAAA,SAAA2S,EAAA7Z,GACA,IAAA,GAAA1F,GAAAhC,KAAA6jB,WAAA5hB,OAAA,EAA8CD,GAAA,IAAQA,EAAA,CACtD,GAAAwhB,GAAAxjB,KAAA6jB,WAAA7hB,EACA,IAAAwhB,EAAAC,QAAAzjB,KAAAiO,MACAoW,EAAA3jB,KAAA8iB,EAAA,eACAxjB,KAAAiO,KAAAuV,EAAAG,WAAA,CACA,GAAAkC,GAAArC,CACA,QAIAqC,IACA,UAAAtE,GACA,aAAAA,IACAsE,EAAApC,QAAA/b,GACAA,GAAAme,EAAAlC,aAGAkC,EAAA,KAGA,IAAA/C,GAAA+C,EAAAA,EAAA9B,aAUA,OATAjB,GAAAvB,KAAAA,EACAuB,EAAApb,IAAAA,EAEAme,EACA7lB,KAAAsI,KAAAud,EAAAlC,WAEA3jB,KAAA8lB,SAAAhD,GAGAO,GAGAyC,SAAA,SAAAhD,EAAAc,GACA,GAAA,UAAAd,EAAAvB,KACA,KAAAuB,GAAApb,GAGA,WAAAob,EAAAvB,MACA,aAAAuB,EAAAvB,KACAvhB,KAAAsI,KAAAwa,EAAApb,IACO,WAAAob,EAAAvB,MACPvhB,KAAAslB,KAAAxC,EAAApb,IACA1H,KAAAsI,KAAA,OACO,WAAAwa,EAAAvB,MAAAqC,IACP5jB,KAAAsI,KAAAsb,IAIAmC,OAAA,SAAApC,GACA,IAAA,GAAA3hB,GAAAhC,KAAA6jB,WAAA5hB,OAAA,EAA8CD,GAAA,IAAQA,EAAA,CACtD,GAAAwhB,GAAAxjB,KAAA6jB,WAAA7hB,EACA,IAAAwhB,EAAAG,aAAAA,EAGA,MAFA3jB,MAAA8lB,SAAAtC,EAAAO,WAAAP,EAAAI,UACAE,EAAAN,GACAH,IAKA2C,QAAA,SAAAvC,GACA,IAAA,GAAAzhB,GAAAhC,KAAA6jB,WAAA5hB,OAAA,EAA8CD,GAAA,IAAQA,EAAA,CACtD,GAAAwhB,GAAAxjB,KAAA6jB,WAAA7hB,EACA,IAAAwhB,EAAAC,SAAAA,EAAA,CACA,GAAAX,GAAAU,EAAAO,UACA,IAAA,UAAAjB,EAAAvB,KAAA,CACA,GAAA0E,GAAAnD,EAAApb,GACAoc,GAAAN,GAEA,MAAAyC,IAMA,KAAA,IAAA5a,OAAA,0BAGA6a,cAAA,SAAAjC,EAAAf,EAAAC,GAOA,MANAnjB,MAAA2iB,UACAC,SAAAoB,EAAAC,GACAf,WAAAA,EACAC,QAAAA,GAGAE,KAOA,gBAAA3C,GAAAA,EACA,gBAAA7X,QAAAA,OACA,gBAAAiY,MAAAA,KAAA9gB,QvB4qG6BU,KAAKhB,EAAU,WAAa,MAAOM","file":"ringcentral.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([, , \"pubnub\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SDK\"] = factory(require(\"es6-promise\"), require(\"node-fetch\"), require(\"pubnub\"));\n\telse\n\t\troot[\"RingCentral\"] = root[\"RingCentral\"] || {}, root[\"RingCentral\"][\"SDK\"] = factory(root[undefined], root[undefined], root[undefined]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/build/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Utils = _interopRequireWildcard(_coreUtils);\n\nvar _coreCache = __webpack_require__(7);\n\nvar _coreCache2 = _interopRequireDefault(_coreCache);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar Externals = _interopRequireWildcard(_coreExternals);\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _coreQueue = __webpack_require__(9);\n\nvar _coreQueue2 = _interopRequireDefault(_coreQueue);\n\nvar _httpClient = __webpack_require__(10);\n\nvar _httpClient2 = _interopRequireDefault(_httpClient);\n\nvar _httpApiResponse = __webpack_require__(12);\n\nvar _httpApiResponse2 = _interopRequireDefault(_httpApiResponse);\n\nvar _httpUtils = __webpack_require__(11);\n\nvar HttpUtils = _interopRequireWildcard(_httpUtils);\n\nvar _mocksClientMock = __webpack_require__(13);\n\nvar _mocksClientMock2 = _interopRequireDefault(_mocksClientMock);\n\nvar _mocksMock = __webpack_require__(15);\n\nvar _mocksMock2 = _interopRequireDefault(_mocksMock);\n\nvar _mocksRegistry = __webpack_require__(14);\n\nvar _mocksRegistry2 = _interopRequireDefault(_mocksRegistry);\n\nvar _platformPlatform = __webpack_require__(16);\n\nvar _platformPlatform2 = _interopRequireDefault(_platformPlatform);\n\nvar _platformAuth = __webpack_require__(17);\n\nvar _platformAuth2 = _interopRequireDefault(_platformAuth);\n\nvar _pubnubPubnubFactory = __webpack_require__(18);\n\nvar _pubnubPubnubFactory2 = _interopRequireDefault(_pubnubPubnubFactory);\n\nvar _subscriptionSubscription = __webpack_require__(20);\n\nvar _subscriptionSubscription2 = _interopRequireDefault(_subscriptionSubscription);\n\nvar _subscriptionCachedSubscription = __webpack_require__(21);\n\nvar _subscriptionCachedSubscription2 = _interopRequireDefault(_subscriptionCachedSubscription);\n\n__webpack_require__(22);\n\nvar SDK = (function () {\n    _createClass(SDK, null, [{\n        key: 'version',\n        value: '2.0.0',\n        enumerable: true\n    }, {\n        key: 'server',\n        value: {\n            sandbox: 'https://platform.devtest.ringcentral.com',\n            production: 'https://platform.ringcentral.com'\n        },\n\n        /**\n         * @constructor\n         * @param {object} [options]\n         * @param {string} [options.server]\n         * @param {string} [options.cachePrefix]\n         * @param {string} [options.appSecret]\n         * @param {string} [options.appKey]\n         * @param {string} [options.appName]\n         * @param {string} [options.appVersion]\n         * @param {string} [options.pubnubFactory]\n         * @param {string} [options.client]\n         */\n        enumerable: true\n    }]);\n\n    function SDK(options) {\n        _classCallCheck(this, SDK);\n\n        options = options || {};\n\n        this._cache = new _coreCache2['default'](Externals.localStorage, options.cachePrefix);\n\n        this._client = options.client || new _httpClient2['default']();\n\n        this._platform = new _platformPlatform2['default'](this._client, this._cache, options.server, options.appKey, options.appSecret);\n\n        this._pubnubFactory = options.pubnubFactory || Externals.PUBNUB;\n    }\n\n    /**\n     * @return {Platform}\n     */\n\n    SDK.prototype.platform = function platform() {\n        return this._platform;\n    };\n\n    /**\n     * @return {Subscription}\n     */\n\n    SDK.prototype.createSubscription = function createSubscription() {\n        return new _subscriptionSubscription2['default'](this._pubnubFactory, this._platform);\n    };\n\n    /**\n     * @return {CachedSubscription}\n     */\n\n    SDK.prototype.createCachedSubscription = function createCachedSubscription(cacheKey) {\n        return new _subscriptionCachedSubscription2['default'](this._pubnubFactory, this._platform, this._cache, cacheKey);\n    };\n\n    /**\n     * @return {Cache}\n     */\n\n    SDK.prototype.cache = function cache() {\n        return this._cache;\n    };\n\n    _createClass(SDK, null, [{\n        key: 'core',\n        value: {\n            Cache: _coreCache2['default'],\n            Observable: _coreObservable2['default'],\n            Utils: Utils,\n            Externals: Externals,\n            Queue: _coreQueue2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'http',\n        value: {\n            Client: _httpClient2['default'],\n            ApiResponse: _httpApiResponse2['default'],\n            Utils: HttpUtils\n        },\n        enumerable: true\n    }, {\n        key: 'platform',\n        value: {\n            Auth: _platformAuth2['default'],\n            Platform: _platformPlatform2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'subscription',\n        value: {\n            Subscription: _subscriptionSubscription2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'mocks',\n        value: {\n            Client: _mocksClientMock2['default'],\n            Registry: _mocksRegistry2['default'],\n            Mock: _mocksMock2['default']\n        },\n        enumerable: true\n    }, {\n        key: 'pubnub',\n        value: {\n            PubnubMockFactory: _pubnubPubnubFactory2['default']\n        },\n        enumerable: true\n    }]);\n\n    return SDK;\n})();\n\nexports['default'] = SDK;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\nexports.queryStringify = queryStringify;\nexports.parseQueryString = parseQueryString;\nexports.isFunction = isFunction;\nexports.isArray = isArray;\nexports.poll = poll;\nexports.stopPolling = stopPolling;\nexports.isNodeJS = isNodeJS;\nexports.isBrowser = isBrowser;\nexports.delay = delay;\n\nvar _ExternalsJs = __webpack_require__(3);\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {object} parameters\n * @returns {string}\n */\n\nfunction queryStringify(parameters) {\n\n    var array = [];\n\n    parameters = parameters || {};\n\n    Object.keys(parameters).forEach(function (k) {\n\n        var v = parameters[k];\n\n        if (isArray(v)) {\n            v.forEach(function (vv) {\n                array.push(encodeURIComponent(k) + '=' + encodeURIComponent(vv));\n            });\n        } else {\n            array.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n        }\n    });\n\n    return array.join('&');\n}\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {string} queryString\n * @returns {object}\n */\n\nfunction parseQueryString(queryString) {\n\n    var argsParsed = {};\n\n    queryString.split('&').forEach(function (arg) {\n\n        arg = decodeURIComponent(arg);\n\n        if (arg.indexOf('=') == -1) {\n\n            argsParsed[arg.trim()] = true;\n        } else {\n\n            var pair = arg.split('='),\n                key = pair[0].trim(),\n                value = pair[1].trim();\n\n            if (key in argsParsed) {\n                if (key in argsParsed && !isArray(argsParsed[key])) argsParsed[key] = [argsParsed[key]];\n                argsParsed[key].push(value);\n            } else {\n                argsParsed[key] = value;\n            }\n        }\n    });\n\n    return argsParsed;\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\n\nfunction isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\n\nfunction isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\n/**\n * @param fn\n * @param interval\n * @param timeout\n */\n\nfunction poll(fn, interval, timeout) {\n    //NodeJS.Timer|number\n\n    module.exports.stopPolling(timeout);\n\n    interval = interval || 1000;\n\n    var next = function next(delay) {\n\n        delay = delay || interval;\n\n        interval = delay;\n\n        return setTimeout(function () {\n\n            fn(next, delay);\n        }, delay);\n    };\n\n    return next();\n}\n\nfunction stopPolling(timeout) {\n    if (timeout) clearTimeout(timeout);\n}\n\nfunction isNodeJS() {\n    return typeof process !== 'undefined';\n}\n\nfunction isBrowser() {\n    return typeof window !== 'undefined';\n}\n\nfunction delay(timeout) {\n    return new _ExternalsJs.Promise(function (resolve, reject) {\n        setTimeout(function () {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _es6Promise = __webpack_require__(4);\n\nvar _es6Promise2 = _interopRequireDefault(_es6Promise);\n\nvar _nodeFetch = __webpack_require__(5);\n\nvar _nodeFetch2 = _interopRequireDefault(_nodeFetch);\n\nvar _pubnub = __webpack_require__(6);\n\nvar _pubnub2 = _interopRequireDefault(_pubnub);\n\nvar root = new Function('return this')();\n\nvar Promise = _es6Promise2['default'] && _es6Promise2['default'].Promise || root.Promise;\n\nexports.Promise = Promise;\nvar fetch = root.fetch || _nodeFetch2['default'];\nexports.fetch = fetch;\nvar Request = root.Request || fetch.Request;\nexports.Request = Request;\nvar Response = root.Response || fetch.Response;\nexports.Response = Response;\nvar Headers = root.Headers || fetch.Headers;\n\nexports.Headers = Headers;\nvar PUBNUB = root.PUBNUB || _pubnub2['default'];\n\nexports.PUBNUB = PUBNUB;\nvar localStorage = typeof root.localStorage !== 'undefined' ? root.localStorage : {};\nexports.localStorage = localStorage;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar Cache = (function () {\n    _createClass(Cache, null, [{\n        key: 'defaultPrefix',\n        value: 'rc-',\n        enumerable: true\n    }]);\n\n    function Cache(storage, prefix) {\n        _classCallCheck(this, Cache);\n\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    Cache.prototype.setPrefix = function setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    };\n\n    Cache.prototype.setItem = function setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    };\n\n    Cache.prototype.removeItem = function removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    };\n\n    Cache.prototype.getItem = function getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    };\n\n    Cache.prototype.clean = function clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n        }\n\n        return this;\n    };\n\n    Cache.prototype._prefixKey = function _prefixKey(key) {\n        return this._prefix + key;\n    };\n\n    return Cache;\n})();\n\nexports['default'] = Cache;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar Observable = (function () {\n    function Observable() {\n        _classCallCheck(this, Observable);\n\n        this.off();\n    }\n\n    Observable.prototype.hasListeners = function hasListeners(event) {\n        return event in this._listeners;\n    };\n\n    Observable.prototype.on = function on(events, callback) {\n        var _this = this;\n\n        if (typeof events == 'string') events = [events];\n        if (!events) throw new Error('No events to subscribe to');\n        if (typeof callback !== 'function') throw new Error('Callback must be a function');\n\n        events.forEach(function (event) {\n\n            if (!_this.hasListeners(event)) _this._listeners[event] = [];\n\n            _this._listeners[event].push(callback);\n        });\n\n        return this;\n    };\n\n    Observable.prototype.emit = function emit(event) {\n        var _this2 = this;\n\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n        }\n\n        var result = null;\n\n        if (!this.hasListeners(event)) return null;\n\n        this._listeners[event].some(function (callback) {\n\n            result = callback.apply(_this2, args);\n            return result === false;\n        });\n\n        return result;\n    };\n\n    Observable.prototype.off = function off(event, callback) {\n        var _this3 = this;\n\n        if (!event) {\n\n            this._listeners = {};\n        } else {\n\n            if (!callback) {\n\n                delete this._listeners[event];\n            } else {\n\n                if (!this.hasListeners(event)) return this;\n\n                this._listeners[event].forEach(function (cb, i) {\n\n                    if (cb === callback) delete _this3._listeners[event][i];\n                });\n            }\n        }\n\n        return this;\n    };\n\n    return Observable;\n})();\n\nexports['default'] = Observable;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _Utils = __webpack_require__(2);\n\nvar Queue = (function () {\n    _createClass(Queue, null, [{\n        key: '_pollInterval',\n        value: 250,\n        enumerable: true\n    }, {\n        key: '_releaseTimeout',\n        value: 5000,\n        enumerable: true\n    }]);\n\n    function Queue(cache, cacheId) {\n        _classCallCheck(this, Queue);\n\n        this._cache = cache;\n        this._cacheId = cacheId;\n        this._promise = null;\n    }\n\n    Queue.prototype.isPaused = function isPaused() {\n\n        var time = this._cache.getItem(this._cacheId);\n\n        return !!time && Date.now() - parseInt(time) < Queue._releaseTimeout;\n    };\n\n    Queue.prototype.pause = function pause() {\n        this._cache.setItem(this._cacheId, Date.now());\n        return this;\n    };\n\n    Queue.prototype.resume = function resume() {\n        this._cache.removeItem(this._cacheId);\n        return this;\n    };\n\n    Queue.prototype.poll = function poll() {\n        var _this = this;\n\n        if (this._promise) return this._promise;\n\n        this._promise = new _coreExternals.Promise(function (resolve, reject) {\n\n            _Utils.poll(function (next) {\n\n                if (_this.isPaused()) return next();\n\n                _this._promise = null;\n\n                _this.resume(); // this is actually not needed but why not\n\n                resolve(null);\n            }, Queue._pollInterval);\n        });\n\n        return this._promise;\n    };\n\n    return Queue;\n})();\n\nexports['default'] = Queue;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar _Utils = __webpack_require__(11);\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _ApiResponse = __webpack_require__(12);\n\nvar _ApiResponse2 = _interopRequireDefault(_ApiResponse);\n\nvar Client = (function (_Observable) {\n    _inherits(Client, _Observable);\n\n    function Client() {\n        _classCallCheck(this, Client);\n\n        _Observable.apply(this, arguments);\n\n        this.events = {\n            beforeRequest: 'beforeRequest',\n            requestSuccess: 'requestSuccess',\n            requestError: 'requestError'\n        };\n    }\n\n    /**\n     * @name IApiError\n     * @property {string} stack\n     * @property {string} originalMessage\n     * @property {ApiResponse} apiResponse\n     */\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n\n    Client.prototype.sendRequest = function sendRequest(request) {\n        var apiResponse;\n        return regeneratorRuntime.async(function sendRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    apiResponse = new _ApiResponse2['default'](request);\n                    context$2$0.prev = 1;\n\n                    //TODO Stop request if listeners return false\n                    this.emit(this.events.beforeRequest, apiResponse);\n\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._loadResponse(request));\n\n                case 5:\n                    apiResponse._response = context$2$0.sent;\n\n                    if (!(apiResponse._isMultipart() || apiResponse._isJson())) {\n                        context$2$0.next = 10;\n                        break;\n                    }\n\n                    context$2$0.next = 9;\n                    return regeneratorRuntime.awrap(apiResponse.response().text());\n\n                case 9:\n                    apiResponse._text = context$2$0.sent;\n\n                case 10:\n                    if (apiResponse.ok()) {\n                        context$2$0.next = 12;\n                        break;\n                    }\n\n                    throw new Error('Response has unsuccessful status');\n\n                case 12:\n\n                    this.emit(this.events.requestSuccess, apiResponse);\n\n                    return context$2$0.abrupt('return', apiResponse);\n\n                case 16:\n                    context$2$0.prev = 16;\n                    context$2$0.t0 = context$2$0['catch'](1);\n\n                    if (!context$2$0.t0.apiResponse) context$2$0.t0 = this.makeError(context$2$0.t0, apiResponse);\n\n                    this.emit(this.events.requestError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 21:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[1, 16]]);\n    };\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n\n    Client.prototype._loadResponse = function _loadResponse(request) {\n        return regeneratorRuntime.async(function _loadResponse$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.next = 2;\n                    return regeneratorRuntime.awrap(_coreExternals.fetch.call(null, request));\n\n                case 2:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 3:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n\n    Client.prototype.makeError = function makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = apiResponse && apiResponse.error(true) || e.originalMessage;\n        }\n\n        return e;\n    };\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n\n    Client.prototype.createRequest = function createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) throw new Error('Method has wrong value: ' + init.method);\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + _coreUtils.queryStringify(init.query);\n        }\n\n        if (!_Utils.findHeaderName('Accept', init.headers)) {\n            init.headers['Accept'] = _ApiResponse2['default']._jsonContentType;\n        }\n\n        // Serialize body\n        //TODO Check that body is a plain object\n        if (typeof init.body !== 'string' || !init.body) {\n\n            var contentTypeHeaderName = _Utils.findHeaderName(_ApiResponse2['default']._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = _ApiResponse2['default']._contentType;\n                init.headers[contentTypeHeaderName] = _ApiResponse2['default']._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(_ApiResponse2['default']._jsonContentType) > -1) {\n                init.body = JSON.stringify(init.body);\n            } else if (contentType.indexOf(_ApiResponse2['default']._urlencodedContentType) > -1) {\n                init.body = _coreUtils.queryStringify(init.body);\n            }\n        }\n\n        // Create a request with encoded body\n        var req = new _coreExternals.Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n    };\n\n    _createClass(Client, null, [{\n        key: '_allowedMethods',\n        value: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'],\n        enumerable: true\n    }]);\n\n    return Client;\n})(_coreObservable2['default']);\n\nexports['default'] = Client;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\nexports.createResponse = createResponse;\nexports.findHeaderName = findHeaderName;\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar utils = _interopRequireWildcard(_coreUtils);\n\n/**\n * Creates a response\n * @param stringBody\n * @param init\n * @return {Response}\n */\n\nfunction createResponse(stringBody, init) {\n\n    init = init || {};\n\n    var response = new _coreExternals.Response(stringBody, init);\n\n    //TODO Wait for https://github.com/bitinn/node-fetch/issues/38\n    if (utils.isNodeJS()) {\n\n        response._text = stringBody;\n        response._decode = function () {\n            return this._text;\n        };\n    }\n\n    return response;\n}\n\nfunction findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function (res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _Utils = __webpack_require__(11);\n\nvar utils = _interopRequireWildcard(_Utils);\n\nvar ApiResponse = (function () {\n    _createClass(ApiResponse, null, [{\n        key: '_contentType',\n        value: 'Content-Type',\n        enumerable: true\n    }, {\n        key: '_jsonContentType',\n        value: 'application/json',\n        enumerable: true\n    }, {\n        key: '_multipartContentType',\n        value: 'multipart/mixed',\n        enumerable: true\n    }, {\n        key: '_urlencodedContentType',\n        value: 'application/x-www-form-urlencoded',\n        enumerable: true\n    }, {\n        key: '_headerSeparator',\n        value: ':',\n        enumerable: true\n    }, {\n        key: '_bodySeparator',\n        value: '\\n\\n',\n        enumerable: true\n    }, {\n        key: '_boundarySeparator',\n        value: '--',\n\n        /**\n         * @param {Request} request\n         * @param {Response} response\n         * @param {string} responseText\n         */\n        enumerable: true\n    }]);\n\n    function ApiResponse(request, response, responseText) {\n        _classCallCheck(this, ApiResponse);\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n    }\n\n    /**\n     * @return {Response}\n     */\n\n    ApiResponse.prototype.response = function response() {\n        return this._response;\n    };\n\n    /**\n     * @return {Request}\n     */\n\n    ApiResponse.prototype.request = function request() {\n        return this._request;\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n    ApiResponse.prototype.ok = function ok() {\n        return this._response && this._response.ok;\n    };\n\n    /**\n     * @return {string}\n     */\n\n    ApiResponse.prototype.text = function text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    };\n\n    /**\n     * @return {object}\n     */\n\n    ApiResponse.prototype.json = function json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    };\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n\n    ApiResponse.prototype.error = function error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') + (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n        } catch (e) {}\n\n        return message;\n    };\n\n    /**\n     * @return {ApiResponse[]}\n     */\n\n    ApiResponse.prototype.multipart = function multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map(function (part, i) {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n            });\n        }\n\n        return this._multipart;\n    };\n\n    ApiResponse.prototype._isContentType = function _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    };\n\n    ApiResponse.prototype._getContentType = function _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    };\n\n    ApiResponse.prototype._isMultipart = function _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    };\n\n    ApiResponse.prototype._isUrlEncoded = function _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    };\n\n    ApiResponse.prototype._isJson = function _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    };\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n\n    ApiResponse.create = function create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new _coreExternals.Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = headersAndBody.length > 1 ? headersAndBody.shift() : '';\n\n        text = headersAndBody.join(ApiResponse._bodySeparator);\n\n        (headersText || '').split('\\n').forEach(function (header) {\n\n            var split = header.trim().split(ApiResponse._headerSeparator),\n                key = split.shift().trim(),\n                value = split.join(ApiResponse._headerSeparator).trim();\n\n            if (key) headers.append(key, value);\n        });\n\n        return new ApiResponse(null, utils.createResponse(text, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n    };\n\n    return ApiResponse;\n})();\n\nexports['default'] = ApiResponse;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _Registry = __webpack_require__(14);\n\nvar _Registry2 = _interopRequireDefault(_Registry);\n\nvar _httpClient = __webpack_require__(10);\n\nvar _httpClient2 = _interopRequireDefault(_httpClient);\n\nvar Client = (function (_HttpClient) {\n    _inherits(Client, _HttpClient);\n\n    function Client() {\n        _classCallCheck(this, Client);\n\n        _HttpClient.call(this);\n        this._registry = new _Registry2['default']();\n    }\n\n    Client.prototype.registry = function registry() {\n        return this._registry;\n    };\n\n    Client.prototype._loadResponse = function _loadResponse(request) {\n        var mock;\n        return regeneratorRuntime.async(function _loadResponse$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    mock = this._registry.find(request);\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(mock.getResponse(request));\n\n                case 3:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 4:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    return Client;\n})(_httpClient2['default']);\n\nexports['default'] = Client;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _Mock = __webpack_require__(15);\n\nvar _Mock2 = _interopRequireDefault(_Mock);\n\nvar Registry = (function () {\n    function Registry() {\n        _classCallCheck(this, Registry);\n\n        this._mocks = [];\n    }\n\n    Registry.prototype.add = function add(mock) {\n        this._mocks.push(mock);\n        return this;\n    };\n\n    Registry.prototype.clear = function clear() {\n        this._mocks = [];\n        return this;\n    };\n\n    Registry.prototype.find = function find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url + ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n    };\n\n    Registry.prototype.apiCall = function apiCall(method, path, response, status, statusText) {\n\n        this.add(new _Mock2['default'](method, path, response, status, statusText));\n\n        return this;\n    };\n\n    Registry.prototype.authentication = function authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n    };\n\n    Registry.prototype.logout = function logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n    };\n\n    Registry.prototype.presenceLoad = function presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n    };\n\n    Registry.prototype.subscribeGeneric = function subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/~/presence'],\n            'expirationTime': new Date(date.getTime() + expiresIn * 1000).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n    };\n\n    Registry.prototype.subscribeOnPresence = function subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + 15 * 60 * 60 * 1000).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n    };\n\n    Registry.prototype.tokenRefresh = function tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n        }\n\n        return this;\n    };\n\n    return Registry;\n})();\n\nexports['default'] = Registry;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _httpApiResponse = __webpack_require__(12);\n\nvar _httpApiResponse2 = _interopRequireDefault(_httpApiResponse);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar _httpUtils = __webpack_require__(11);\n\nvar Mock = (function () {\n    function Mock(method, path, json, status, statusText, delay) {\n        _classCallCheck(this, Mock);\n\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    Mock.prototype.path = function path() {\n        return this._path;\n    };\n\n    Mock.prototype.method = function method() {\n        return this._method;\n    };\n\n    Mock.prototype.test = function test(request) {\n\n        return request.url.indexOf(this._path) > -1 && request.method.toUpperCase() == this._method;\n    };\n\n    Mock.prototype.getResponse = function getResponse(request) {\n        return regeneratorRuntime.async(function getResponse$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.next = 2;\n                    return regeneratorRuntime.awrap(_coreUtils.delay(this._delay));\n\n                case 2:\n                    return context$2$0.abrupt('return', this.createResponse(this._json));\n\n                case 3:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Mock.prototype.createResponse = function createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = _httpUtils.createResponse(str, init);\n\n        res.headers.set(_httpApiResponse2['default']._contentType, _httpApiResponse2['default']._jsonContentType);\n\n        return res;\n    };\n\n    return Mock;\n})();\n\nexports['default'] = Mock;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _coreQueue = __webpack_require__(9);\n\nvar _coreQueue2 = _interopRequireDefault(_coreQueue);\n\nvar _Auth = __webpack_require__(17);\n\nvar _Auth2 = _interopRequireDefault(_Auth);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Platform = (function (_Observable) {\n    _inherits(Platform, _Observable);\n\n    _createClass(Platform, null, [{\n        key: '_urlPrefix',\n        value: '/restapi',\n        enumerable: true\n    }, {\n        key: '_apiVersion',\n        value: 'v1.0',\n        enumerable: true\n    }, {\n        key: '_accessTokenTtl',\n        value: null,\n        // Platform server by default sets it to 60 * 60 = 1 hour\n        enumerable: true\n    }, {\n        key: '_refreshTokenTtl',\n        value: 10 * 60 * 60,\n        // 10 hours\n        enumerable: true\n    }, {\n        key: '_refreshTokenTtlRemember',\n        value: 7 * 24 * 60 * 60,\n        // 1 week\n        enumerable: true\n    }, {\n        key: '_tokenEndpoint',\n        value: '/restapi/oauth/token',\n        enumerable: true\n    }, {\n        key: '_revokeEndpoint',\n        value: '/restapi/oauth/revoke',\n        enumerable: true\n    }, {\n        key: '_authorizeEndpoint',\n        value: '/restapi/oauth/authorize',\n        enumerable: true\n    }, {\n        key: '_refreshDelayMs',\n        value: 100,\n        enumerable: true\n    }, {\n        key: '_cacheId',\n        value: 'platform',\n        enumerable: true\n    }, {\n        key: '_clearCacheOnRefreshError',\n        value: true,\n        enumerable: true\n    }]);\n\n    function Platform(client, cache, server, appKey, appSecret) {\n        _classCallCheck(this, Platform);\n\n        _Observable.call(this);\n\n        this.events = {\n            beforeLogin: 'beforeLogin',\n            loginSuccess: 'loginSuccess',\n            loginError: 'loginError',\n            beforeRefresh: 'beforeRefresh',\n            refreshSuccess: 'refreshSuccess',\n            refreshError: 'refreshError',\n            beforeLogout: 'beforeLogout',\n            logoutSuccess: 'logoutSuccess',\n            logoutError: 'logoutError'\n        };\n        this._server = server;\n        this._appKey = appKey;\n        this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        this._cache = cache;\n\n        /** @type {Client} */\n        this._client = client;\n\n        this._queue = new _coreQueue2['default'](this._cache, Platform._cacheId + '-refresh');\n\n        this._auth = new _Auth2['default'](this._cache, Platform._cacheId);\n    }\n\n    /**\n     * @return {Auth}\n     */\n\n    Platform.prototype.auth = function auth() {\n        return this._auth;\n    };\n\n    /**\n     * @return {Client}\n     */\n\n    Platform.prototype.client = function client() {\n        return this._client;\n    };\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n\n    Platform.prototype.createUrl = function createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += path.indexOf('?') > -1 ? '&' : '?';\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n    };\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @return {string}\n     */\n\n    Platform.prototype.authUrl = function authUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + _coreUtils.queryStringify({\n            'response_type': 'code',\n            'redirect_uri': options.redirectUri || '',\n            'client_id': this._appKey,\n            'state': options.state || '',\n            'brand_id': options.brandId || '',\n            'display': options.display || '',\n            'prompt': options.prompt || ''\n        }), { addServer: true });\n    };\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n\n    Platform.prototype.parseAuthRedirectUrl = function parseAuthRedirectUrl(url) {\n\n        var qs = _coreUtils.parseQueryString(url.split('?').reverse()[0]),\n            error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n    };\n\n    /**\n     * @return {Promise<boolean>}\n     */\n\n    Platform.prototype.loggedIn = function loggedIn() {\n        return regeneratorRuntime.async(function loggedIn$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this._ensureAuthentication());\n\n                case 3:\n                    return context$2$0.abrupt('return', true);\n\n                case 6:\n                    context$2$0.prev = 6;\n                    context$2$0.t0 = context$2$0['catch'](0);\n                    return context$2$0.abrupt('return', false);\n\n                case 9:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 6]]);\n    };\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.login = function login(options) {\n        var body, apiResponse, json;\n        return regeneratorRuntime.async(function login$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    options = options || {};\n\n                    options.remember = options.remember || false;\n\n                    this.emit(this.events.beforeLogin);\n\n                    body = {\n                        \"access_token_ttl\": Platform._accessTokenTtl,\n                        \"refresh_token_ttl\": options.remember ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                    };\n\n                    if (!options.code) {\n\n                        body.grant_type = 'password';\n                        body.username = options.username;\n                        body.password = options.password;\n                        body.extension = options.extension || '';\n                    } else if (options.code) {\n\n                        body.grant_type = 'authorization_code';\n                        body.code = options.code;\n                        body.redirect_uri = options.redirectUri;\n                        //body.client_id = this.getCredentials().key; // not needed\n                    }\n\n                    if (options.endpointId) body.endpoint_id = options.endpointId;\n\n                    context$2$0.next = 9;\n                    return regeneratorRuntime.awrap(this._tokenRequest(Platform._tokenEndpoint, body));\n\n                case 9:\n                    apiResponse = context$2$0.sent;\n                    json = apiResponse.json();\n\n                    this._auth.setData(json).setRemember(options.remember);\n\n                    this.emit(this.events.loginSuccess, apiResponse);\n\n                    return context$2$0.abrupt('return', apiResponse);\n\n                case 16:\n                    context$2$0.prev = 16;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    this._cache.clean();\n\n                    this.emit(this.events.loginError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 21:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 16]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.refresh = function refresh() {\n        var res, json;\n        return regeneratorRuntime.async(function refresh$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    this.emit(this.events.beforeRefresh);\n\n                    if (!this._queue.isPaused()) {\n                        context$2$0.next = 9;\n                        break;\n                    }\n\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._queue.poll());\n\n                case 5:\n                    if (this._isAccessTokenValid()) {\n                        context$2$0.next = 7;\n                        break;\n                    }\n\n                    throw new Error('Automatic authentification timeout');\n\n                case 7:\n\n                    this.emit(this.events.refreshSuccess, null);\n\n                    return context$2$0.abrupt('return', null);\n\n                case 9:\n\n                    this._queue.pause();\n\n                    // Make sure all existing AJAX calls had a chance to reach the server\n                    context$2$0.next = 12;\n                    return regeneratorRuntime.awrap(_coreUtils.delay(Platform._refreshDelayMs));\n\n                case 12:\n                    if (this._auth.refreshToken()) {\n                        context$2$0.next = 14;\n                        break;\n                    }\n\n                    throw new Error('Refresh token is missing');\n\n                case 14:\n                    if (this._auth.refreshTokenValid()) {\n                        context$2$0.next = 16;\n                        break;\n                    }\n\n                    throw new Error('Refresh token has expired');\n\n                case 16:\n                    if (this._queue.isPaused()) {\n                        context$2$0.next = 18;\n                        break;\n                    }\n\n                    throw new Error('Queue was resumed before refresh call');\n\n                case 18:\n                    context$2$0.next = 20;\n                    return regeneratorRuntime.awrap(this._tokenRequest(Platform._tokenEndpoint, {\n                        \"grant_type\": \"refresh_token\",\n                        \"refresh_token\": this._auth.refreshToken(),\n                        \"access_token_ttl\": Platform._accessTokenTtl,\n                        \"refresh_token_ttl\": this._auth.remember() ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                    }));\n\n                case 20:\n                    res = context$2$0.sent;\n                    json = res.json();\n\n                    if (json.access_token) {\n                        context$2$0.next = 24;\n                        break;\n                    }\n\n                    throw this._client.makeError(new Error('Malformed OAuth response'), res);\n\n                case 24:\n\n                    this._auth.setData(json);\n                    this._queue.resume();\n\n                    this.emit(this.events.refreshSuccess, res);\n\n                    return context$2$0.abrupt('return', res);\n\n                case 30:\n                    context$2$0.prev = 30;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._client.makeError(context$2$0.t0);\n\n                    if (Platform._clearCacheOnRefreshError) {\n                        this._cache.clean();\n                    }\n\n                    this.emit(this.events.refreshError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 36:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 30]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.logout = function logout() {\n        var res;\n        return regeneratorRuntime.async(function logout$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    this.emit(this.events.beforeLogout);\n\n                    this._queue.pause();\n\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._tokenRequest(Platform._revokeEndpoint, {\n                        token: this._auth.accessToken()\n                    }));\n\n                case 5:\n                    res = context$2$0.sent;\n\n                    this._queue.resume();\n                    this._cache.clean();\n\n                    this.emit(this.events.logoutSuccess, res);\n\n                    return context$2$0.abrupt('return', res);\n\n                case 12:\n                    context$2$0.prev = 12;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    this._queue.resume();\n\n                    this.emit(this.events.logoutError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 17:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 12]]);\n    };\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n\n    Platform.prototype.inflateRequest = function inflateRequest(request, options) {\n        return regeneratorRuntime.async(function inflateRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n\n                    options = options || {};\n\n                    if (!options.skipAuthCheck) {\n                        context$2$0.next = 3;\n                        break;\n                    }\n\n                    return context$2$0.abrupt('return', request);\n\n                case 3:\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._ensureAuthentication());\n\n                case 5:\n\n                    request.headers.set('Authorization', this._authHeader());\n                    //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n                    //TODO Add User-Agent here\n\n                    return context$2$0.abrupt('return', request);\n\n                case 7:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.sendRequest = function sendRequest(request, options) {\n        return regeneratorRuntime.async(function sendRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this.inflateRequest(request, options));\n\n                case 3:\n                    request = context$2$0.sent;\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this._client.sendRequest(request));\n\n                case 6:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 9:\n                    context$2$0.prev = 9;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    if (!(!context$2$0.t0.apiResponse || !context$2$0.t0.apiResponse.response() || context$2$0.t0.apiResponse.response().status != 401)) {\n                        context$2$0.next = 13;\n                        break;\n                    }\n\n                    throw context$2$0.t0;\n\n                case 13:\n\n                    this._auth.cancelAccessToken();\n\n                    context$2$0.next = 16;\n                    return regeneratorRuntime.awrap(this.sendRequest(request, options));\n\n                case 16:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 17:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 9]]);\n    };\n\n    /**\n     * General purpose function to send anything to server\n     * @param {string} options.url\n     * @param {object} [options.body]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.send = function send() {\n        var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n        return regeneratorRuntime.async(function send$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n\n                    //FIXME https://github.com/bitinn/node-fetch/issues/43\n                    options.url = this.createUrl(options.url, { addServer: true });\n\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this.sendRequest(this._client.createRequest(options), options));\n\n                case 3:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 4:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.get = function get(url, query, options) {\n        return regeneratorRuntime.async(function get$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'GET';\n                    options.url = url;\n                    options.query = query;\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 6:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 7:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.post = function post(url, body, query, options) {\n        return regeneratorRuntime.async(function post$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'POST';\n                    options.url = url;\n                    options.query = query;\n                    options.body = body;\n                    context$2$0.next = 7;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 7:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 8:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {object} [body]\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype.put = function put(url, body, query, options) {\n        return regeneratorRuntime.async(function put$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'PUT';\n                    options.url = url;\n                    options.query = query;\n                    options.body = body;\n                    context$2$0.next = 7;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 7:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 8:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    /**\n     * @param {string} url\n     * @param {string} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n\n    Platform.prototype['delete'] = function _delete(url, query, options) {\n        return regeneratorRuntime.async(function _delete$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    options = options || {};\n                    options.method = 'DELETE';\n                    options.url = url;\n                    options.query = query;\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this.send(options));\n\n                case 6:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 7:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Platform.prototype._tokenRequest = function _tokenRequest(path, body) {\n        return regeneratorRuntime.async(function _tokenRequest$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.next = 2;\n                    return regeneratorRuntime.awrap(this.send({\n                        url: path,\n                        skipAuthCheck: true,\n                        body: body,\n                        method: 'POST',\n                        headers: {\n                            'Authorization': 'Basic ' + this._apiKey(),\n                            'Content-Type': 'application/x-www-form-urlencoded'\n                        }\n                    }));\n\n                case 2:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 3:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Platform.prototype._ensureAuthentication = function _ensureAuthentication() {\n        return regeneratorRuntime.async(function _ensureAuthentication$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    if (!this._isAccessTokenValid()) {\n                        context$2$0.next = 2;\n                        break;\n                    }\n\n                    return context$2$0.abrupt('return', null);\n\n                case 2:\n                    context$2$0.next = 4;\n                    return regeneratorRuntime.awrap(this.refresh());\n\n                case 4:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 5:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Platform.prototype._isAccessTokenValid = function _isAccessTokenValid() {\n\n        return this._auth.accessTokenValid() && !this._queue.isPaused();\n    };\n\n    Platform.prototype._apiKey = function _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return typeof btoa == 'function' ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    };\n\n    Platform.prototype._authHeader = function _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    };\n\n    return Platform;\n})(_coreObservable2['default']);\n\nexports['default'] = Platform;\nmodule.exports = exports['default'];\n\n// Perform sanity checks\n\n/** @type {ApiResponse} */\n\n// Guard is for errors that come from polling\n\n/***/ },\n/* 17 */\n/***/ function(module, exports) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar Auth = (function () {\n    _createClass(Auth, null, [{\n        key: 'refreshHandicapMs',\n        value: 60 * 1000,\n        // 1 minute\n        enumerable: true\n    }, {\n        key: 'forcedTokenType',\n        value: 'forced',\n        enumerable: true\n    }]);\n\n    function Auth(cache, cacheId) {\n        _classCallCheck(this, Auth);\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n    }\n\n    //export interface IAuthData {\n    //    remember?:boolean;\n    //    token_type?:string;\n    //    access_token?:string;\n    //    expires_in?:number; // actually it's string\n    //    expire_time?:number;\n    //    refresh_token?:string;\n    //    refresh_token_expires_in?:number; // actually it's string\n    //    refresh_token_expire_time?:number;\n    //    scope?:string;\n    //}\n\n    Auth.prototype.accessToken = function accessToken() {\n        return this.data().access_token;\n    };\n\n    Auth.prototype.refreshToken = function refreshToken() {\n        return this.data().refresh_token;\n    };\n\n    Auth.prototype.tokenType = function tokenType() {\n        return this.data().token_type;\n    };\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n\n    Auth.prototype.data = function data() {\n\n        return this._cache.getItem(this._cacheId) || {\n            token_type: '',\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        };\n    };\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n\n    Auth.prototype.setData = function setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach(function (key) {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + data.expires_in * 1000;\n        data.refresh_token_expire_time = Date.now() + data.refresh_token_expires_in * 1000;\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n    };\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n\n    Auth.prototype.accessTokenValid = function accessTokenValid() {\n\n        var authData = this.data();\n        return authData.token_type === Auth.forcedTokenType || authData.expire_time - Auth.refreshHandicapMs > Date.now();\n    };\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n\n    Auth.prototype.refreshTokenValid = function refreshTokenValid() {\n\n        return this.data().refresh_token_expire_time > Date.now();\n    };\n\n    /**\n     * @return {Auth}\n     */\n\n    Auth.prototype.cancelAccessToken = function cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n    };\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n\n    Auth.prototype.forceAuthentication = function forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n    };\n\n    /**\n     * @param remember\n     * @return {Auth}\n     */\n\n    Auth.prototype.setRemember = function setRemember(remember) {\n\n        return this.setData({ remember: remember });\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n    Auth.prototype.remember = function remember() {\n\n        return !!this.data().remember;\n    };\n\n    return Auth;\n})();\n\nexports['default'] = Auth;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _PubnubMockJs = __webpack_require__(19);\n\nvar _PubnubMockJs2 = _interopRequireDefault(_PubnubMockJs);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar PubnubMockFactory = (function () {\n    function PubnubMockFactory() {\n        _classCallCheck(this, PubnubMockFactory);\n\n        this.crypto_obj = _coreExternals.PUBNUB.crypto_obj;\n    }\n\n    PubnubMockFactory.prototype.init = function init(options) {\n        return new _PubnubMockJs2['default'](options);\n    };\n\n    return PubnubMockFactory;\n})();\n\nexports['default'] = PubnubMockFactory;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _coreExternals = __webpack_require__(3);\n\nvar PubnubMock = (function (_Observable) {\n    _inherits(PubnubMock, _Observable);\n\n    function PubnubMock(options) {\n        _classCallCheck(this, PubnubMock);\n\n        _Observable.call(this);\n        this.options = options;\n        this.crypto_obj = _coreExternals.PUBNUB.crypto_obj;\n    }\n\n    PubnubMock.prototype.ready = function ready() {};\n\n    PubnubMock.prototype.subscribe = function subscribe(options) {\n        this.on('message-' + options.channel, options.message);\n    };\n\n    PubnubMock.prototype.unsubscribe = function unsubscribe(options) {\n        this.off('message-' + options.channel);\n    };\n\n    PubnubMock.prototype.receiveMessage = function receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    };\n\n    return PubnubMock;\n})(_coreObservable2['default']);\n\nexports['default'] = PubnubMock;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _coreObservable = __webpack_require__(8);\n\nvar _coreObservable2 = _interopRequireDefault(_coreObservable);\n\nvar _httpClient = __webpack_require__(10);\n\nvar _httpClient2 = _interopRequireDefault(_httpClient);\n\nvar _coreUtils = __webpack_require__(2);\n\nvar Subscription = (function (_Observable) {\n    _inherits(Subscription, _Observable);\n\n    _createClass(Subscription, null, [{\n        key: '_renewHandicapMs',\n        value: 2 * 60 * 1000,\n        enumerable: true\n    }, {\n        key: '_pollInterval',\n        value: 10 * 1000,\n        enumerable: true\n    }]);\n\n    function Subscription(pubnubFactory, platform) {\n        _classCallCheck(this, Subscription);\n\n        _Observable.call(this);\n\n        this.events = {\n            notification: 'notification',\n            removeSuccess: 'removeSuccess',\n            removeError: 'removeError',\n            renewSuccess: 'renewSuccess',\n            renewError: 'renewError',\n            subscribeSuccess: 'subscribeSuccess',\n            subscribeError: 'subscribeError'\n        };\n        this._pubnubFactory = pubnubFactory;\n        this._platform = platform;\n        this._pubnub = null;\n        this._timeout = null;\n        this._subscription = {};\n    }\n\n    //export interface ISubscription {\n    //    id?:string;\n    //    uri?: string;\n    //    eventFilters?:string[];\n    //    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n    //    expiresIn?:number;\n    //    deliveryMode?: {\n    //        transportType?:string;\n    //        encryption?:boolean;\n    //        address?:string;\n    //        subscriberKey?:string;\n    //        encryptionKey?:string;\n    //        secretKey?:string;\n    //    };\n    //    creationTime?:string; // 2014-03-12T19:54:35.613Z\n    //    status?:string; // Active\n    //}\n\n    Subscription.prototype.subscribed = function subscribed() {\n\n        return !!(this._subscription.id && this._subscription.deliveryMode && this._subscription.deliveryMode.subscriberKey && this._subscription.deliveryMode.address);\n    };\n\n    /**\n     * @return {boolean}\n     */\n\n    Subscription.prototype.alive = function alive() {\n\n        return this.subscribed() && Date.now() < this.expirationTime();\n    };\n\n    Subscription.prototype.expirationTime = function expirationTime() {\n        return new Date(this._subscription.expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    };\n\n    Subscription.prototype.setSubscription = function setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n\n        this._subscription = subscription;\n\n        if (!this._pubnub) this._subscribeAtPubnub();\n\n        this._setTimeout();\n\n        return this;\n    };\n\n    Subscription.prototype.subscription = function subscription() {\n        return this._subscription;\n    };\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.register = function register() {\n        return regeneratorRuntime.async(function register$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    if (!this.alive()) {\n                        context$2$0.next = 6;\n                        break;\n                    }\n\n                    context$2$0.next = 3;\n                    return regeneratorRuntime.awrap(this.renew());\n\n                case 3:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 6:\n                    context$2$0.next = 8;\n                    return regeneratorRuntime.awrap(this.subscribe());\n\n                case 8:\n                    return context$2$0.abrupt('return', context$2$0.sent);\n\n                case 9:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this);\n    };\n\n    Subscription.prototype.eventFilters = function eventFilters() {\n        return this._subscription.eventFilters || [];\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n    Subscription.prototype.addEventFilters = function addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n\n    Subscription.prototype.setEventFilters = function setEventFilters(events) {\n        this._subscription.eventFilters = events;\n        return this;\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.subscribe = function subscribe() {\n        var response, json;\n        return regeneratorRuntime.async(function subscribe$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    this._clearTimeout();\n\n                    if (this.eventFilters().length) {\n                        context$2$0.next = 4;\n                        break;\n                    }\n\n                    throw new Error('Events are undefined');\n\n                case 4:\n                    context$2$0.next = 6;\n                    return regeneratorRuntime.awrap(this._platform.post('/restapi/v1.0/subscription', {\n                        eventFilters: this._getFullEventFilters(),\n                        deliveryMode: {\n                            transportType: 'PubNub'\n                        }\n                    }));\n\n                case 6:\n                    response = context$2$0.sent;\n                    json = response.json();\n\n                    this.setSubscription(json).emit(this.events.subscribeSuccess, response);\n\n                    return context$2$0.abrupt('return', response);\n\n                case 12:\n                    context$2$0.prev = 12;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._platform.client().makeError(context$2$0.t0);\n\n                    this.reset().emit(this.events.subscribeError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 17:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 12]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.renew = function renew() {\n        var response, json;\n        return regeneratorRuntime.async(function renew$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    this._clearTimeout();\n\n                    if (this.alive()) {\n                        context$2$0.next = 4;\n                        break;\n                    }\n\n                    throw new Error('Subscription is not alive');\n\n                case 4:\n                    if (this.eventFilters().length) {\n                        context$2$0.next = 6;\n                        break;\n                    }\n\n                    throw new Error('Events are undefined');\n\n                case 6:\n                    context$2$0.next = 8;\n                    return regeneratorRuntime.awrap(this._platform.put('/restapi/v1.0/subscription/' + this._subscription.id, {\n                        eventFilters: this._getFullEventFilters()\n                    }));\n\n                case 8:\n                    response = context$2$0.sent;\n                    json = response.json();\n\n                    this.setSubscription(json).emit(this.events.renewSuccess, response);\n\n                    return context$2$0.abrupt('return', response);\n\n                case 14:\n                    context$2$0.prev = 14;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._platform.client().makeError(context$2$0.t0);\n\n                    this.reset().emit(this.events.renewError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 19:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 14]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.remove = function remove() {\n        var response;\n        return regeneratorRuntime.async(function remove$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    if (this.subscribed()) {\n                        context$2$0.next = 3;\n                        break;\n                    }\n\n                    throw new Error('No subscription');\n\n                case 3:\n                    context$2$0.next = 5;\n                    return regeneratorRuntime.awrap(this._platform['delete']('/restapi/v1.0/subscription/' + this._subscription.id));\n\n                case 5:\n                    response = context$2$0.sent;\n\n                    this.reset().emit(this.events.removeSuccess, response);\n\n                    return context$2$0.abrupt('return', response);\n\n                case 10:\n                    context$2$0.prev = 10;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    context$2$0.t0 = this._platform.client().makeError(context$2$0.t0);\n\n                    this.emit(this.events.removeError, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 15:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 10]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    Subscription.prototype.resubscribe = function resubscribe() {\n\n        return this.reset().setEventFilters(this.eventFilters()).subscribe();\n    };\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n\n    Subscription.prototype.reset = function reset() {\n        this._clearTimeout();\n        if (this.subscribed() && this._pubnub) this._pubnub.unsubscribe({ channel: this._subscription.deliveryMode.address });\n        this._subscription = {};\n        return this;\n    };\n\n    Subscription.prototype._getFullEventFilters = function _getFullEventFilters() {\n        var _this = this;\n\n        return this.eventFilters().map(function (event) {\n            return _this._platform.createUrl(event);\n        });\n    };\n\n    Subscription.prototype._setTimeout = function _setTimeout() {\n        var _this2 = this;\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        _coreUtils.poll(function (next) {\n\n            if (_this2.alive()) return next();\n\n            _this2.renew();\n        }, Subscription._pollInterval, this._timeout);\n\n        return this;\n    };\n\n    Subscription.prototype._clearTimeout = function _clearTimeout() {\n\n        _coreUtils.stopPolling(this._timeout);\n\n        return this;\n    };\n\n    Subscription.prototype._decrypt = function _decrypt(message) {\n\n        if (!this.subscribed()) throw new Error('No subscription');\n\n        if (this._subscription.deliveryMode.encryptionKey) {\n\n            var PUBNUB = this._pubnubFactory;\n\n            message = PUBNUB.crypto_obj.decrypt(message, this._subscription.deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n        }\n\n        return message;\n    };\n\n    Subscription.prototype._notify = function _notify(message) {\n\n        this.emit(this.events.notification, this._decrypt(message));\n\n        return this;\n    };\n\n    Subscription.prototype._subscribeAtPubnub = function _subscribeAtPubnub() {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var PUBNUB = this._pubnubFactory;\n\n        this._pubnub = PUBNUB.init({\n            ssl: true,\n            subscribe_key: this._subscription.deliveryMode.subscriberKey\n        });\n\n        this._pubnub.ready();\n\n        this._pubnub.subscribe({\n            channel: this._subscription.deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: function connect() {}\n        });\n\n        return this;\n    };\n\n    return Subscription;\n})(_coreObservable2['default']);\n\nexports['default'] = Subscription;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _Subscription2 = __webpack_require__(20);\n\nvar _Subscription3 = _interopRequireDefault(_Subscription2);\n\nvar _coreQueue = __webpack_require__(9);\n\nvar _coreQueue2 = _interopRequireDefault(_coreQueue);\n\nvar CachedSubscription = (function (_Subscription) {\n    _inherits(CachedSubscription, _Subscription);\n\n    function CachedSubscription(pubnubFactory, platform, cache, cacheKey) {\n        var _this = this;\n\n        _classCallCheck(this, CachedSubscription);\n\n        _Subscription.call(this, pubnubFactory, platform);\n\n        this._cache = cache;\n        this._cacheKey = cacheKey;\n        this._renewQueue = new _coreQueue2['default'](this._cache, cacheKey + '-renew');\n        this._resubscribeQueue = new _coreQueue2['default'](this._cache, cacheKey + '-resubscribe');\n\n        this.events = _extends({}, this.events, {\n            queuedRenewSuccess: 'queuedRenewSuccess',\n            queuedRenewError: 'queuedRenewError',\n            queuedResubscribeSuccess: 'queuedResubscribeSuccess',\n            queuedResubscribeError: 'queuedResubscribeError'\n        });\n\n        this.on(this.events.renewError, function () {\n            _this.resubscribe();\n        });\n\n        this.on([this.events.subscribeSuccess, this.events.renewSuccess], function () {\n            _this._cache.setItem(_this._cacheKey, _this.subscription());\n        });\n\n        this.on(this.events.removeSuccess, function () {\n            _this._cache.removeItem(_this._cacheKey);\n        });\n    }\n\n    /**\n     * TODO Combine with Platform.refresh and move elsewhere\n     * @param actionCb\n     * @param queue\n     * @param successEvent\n     * @param errorEvent\n     * @param errorMessage\n     * @return {*}\n     * @private\n     */\n\n    CachedSubscription.prototype._queue = function _queue(actionCb, queue, successEvent, errorEvent, errorMessage) {\n        var res;\n        return regeneratorRuntime.async(function _queue$(context$2$0) {\n            while (1) switch (context$2$0.prev = context$2$0.next) {\n                case 0:\n                    context$2$0.prev = 0;\n\n                    if (!queue.isPaused()) {\n                        context$2$0.next = 8;\n                        break;\n                    }\n\n                    context$2$0.next = 4;\n                    return regeneratorRuntime.awrap(queue.poll());\n\n                case 4:\n                    if (this.alive()) {\n                        context$2$0.next = 6;\n                        break;\n                    }\n\n                    throw new Error(errorMessage);\n\n                case 6:\n\n                    this.emit(successEvent, null);\n\n                    return context$2$0.abrupt('return', null);\n\n                case 8:\n\n                    queue.pause();\n\n                    context$2$0.next = 11;\n                    return regeneratorRuntime.awrap(actionCb.call(this));\n\n                case 11:\n                    res = context$2$0.sent;\n\n                    queue.resume();\n\n                    this.emit(successEvent, res);\n\n                    return context$2$0.abrupt('return', res);\n\n                case 17:\n                    context$2$0.prev = 17;\n                    context$2$0.t0 = context$2$0['catch'](0);\n\n                    this.emit(errorEvent, context$2$0.t0);\n\n                    throw context$2$0.t0;\n\n                case 21:\n                case 'end':\n                    return context$2$0.stop();\n            }\n        }, null, this, [[0, 17]]);\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    CachedSubscription.prototype.renew = function renew() {\n\n        return this._queue(_Subscription.prototype.renew, this._renewQueue, this.events.queuedRenewSuccess, this.events.queuedRenewError, 'Subscription is not alive after renew timeout');\n    };\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n\n    CachedSubscription.prototype.resubscribe = function resubscribe() {\n\n        return this._queue(_Subscription.prototype.resubscribe, this._resubscribeQueue, this.events.queuedResubscribeSuccess, this.events.queuedResubscribeError, 'Subscription is not alive after resubscribe timeout');\n    };\n\n    /**\n     * @param {string[]} events\n     * @return {CachedSubscription}\n     */\n\n    CachedSubscription.prototype.restore = function restore(events) {\n\n        var cachedSubscriptionData = this._cache.getItem(this._cacheKey);\n\n        if (cachedSubscriptionData) {\n            try {\n                this.setSubscription(cachedSubscriptionData);\n            } catch (e) {}\n        } else {\n            this.setEventFilters(events);\n        }\n\n        return this;\n    };\n\n    return CachedSubscription;\n})(_Subscription3['default']);\n\nexports['default'] = CachedSubscription;\nmodule.exports = exports['default'];\n\n/***/ },\n/* 22 */\n/***/ function(module, exports) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=ringcentral.js.map"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 5d800152b5167bf356e8\n **/","import * as Utils from './core/Utils';\nimport Cache from './core/Cache';\nimport * as Externals from './core/Externals';\nimport Observable from './core/Observable';\nimport Queue from './core/Queue';\n\nimport Client from './http/Client';\nimport ApiResponse from './http/ApiResponse';\nimport * as HttpUtils from './http/Utils';\n\nimport {default as ClientMock} from './mocks/ClientMock';\nimport Mock from './mocks/Mock';\nimport Registry from './mocks/Registry';\n\nimport Platform from './platform/Platform';\nimport Auth from './platform/Auth';\n\nimport PubnubMockFactory from './pubnub/PubnubFactory';\n\nimport Subscription from './subscription/Subscription';\nimport CachedSubscription from './subscription/CachedSubscription';\n\nrequire(\"regenerator/runtime\");\n\nexport default class SDK {\n\n    static version = '2.0.0';\n\n    static server = {\n        sandbox: 'https://platform.devtest.ringcentral.com',\n        production: 'https://platform.ringcentral.com'\n    };\n\n    /**\n     * @constructor\n     * @param {object} [options]\n     * @param {string} [options.server]\n     * @param {string} [options.cachePrefix]\n     * @param {string} [options.appSecret]\n     * @param {string} [options.appKey]\n     * @param {string} [options.appName]\n     * @param {string} [options.appVersion]\n     * @param {string} [options.pubnubFactory]\n     * @param {string} [options.client]\n     */\n    constructor(options) {\n\n        options = options || {};\n\n        this._cache = new Cache(Externals.localStorage, options.cachePrefix);\n\n        this._client = options.client || new Client();\n\n        this._platform = new Platform(this._client, this._cache, options.server, options.appKey, options.appSecret);\n\n        this._pubnubFactory = options.pubnubFactory || Externals.PUBNUB;\n\n    }\n\n    /**\n     * @return {Platform}\n     */\n    platform() {\n        return this._platform;\n    }\n\n    /**\n     * @return {Subscription}\n     */\n    createSubscription() {\n        return new Subscription(this._pubnubFactory, this._platform);\n    }\n\n    /**\n     * @return {CachedSubscription}\n     */\n    createCachedSubscription(cacheKey) {\n        return new CachedSubscription(this._pubnubFactory, this._platform, this._cache, cacheKey);\n    }\n\n    /**\n     * @return {Cache}\n     */\n    cache() {\n        return this._cache;\n    }\n\n    static core = {\n        Cache: Cache,\n        Observable: Observable,\n        Utils: Utils,\n        Externals: Externals,\n        Queue: Queue\n    };\n\n    static http = {\n        Client: Client,\n        ApiResponse: ApiResponse,\n        Utils: HttpUtils\n    };\n\n    static platform = {\n        Auth: Auth,\n        Platform: Platform\n    };\n\n    static subscription = {\n        Subscription: Subscription\n    };\n\n    static mocks = {\n        Client: ClientMock,\n        Registry: Registry,\n        Mock: Mock\n    };\n\n    static pubnub = {\n        PubnubMockFactory: PubnubMockFactory\n    };\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/SDK.js\n **/","import {Promise} from './Externals.js';\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {object} parameters\n * @returns {string}\n */\nexport function queryStringify(parameters) {\n\n    var array = [];\n\n    parameters = parameters || {};\n\n    Object.keys(parameters).forEach((k) => {\n\n        var v = parameters[k];\n\n        if (isArray(v)) {\n            v.forEach((vv) => {\n                array.push(encodeURIComponent(k) + '=' + encodeURIComponent(vv));\n            });\n        } else {\n            array.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n        }\n\n    });\n\n    return array.join('&');\n\n}\n\n/**\n * TODO Replace with something better\n * @see https://github.com/joyent/node/blob/master/lib/querystring.js\n * @param {string} queryString\n * @returns {object}\n */\nexport function parseQueryString(queryString) {\n\n    var argsParsed = {};\n\n    queryString.split('&').forEach((arg) => {\n\n        arg = decodeURIComponent(arg);\n\n        if (arg.indexOf('=') == -1) {\n\n            argsParsed[arg.trim()] = true;\n\n        } else {\n\n            var pair = arg.split('='),\n                key = pair[0].trim(),\n                value = pair[1].trim();\n\n            if (key in argsParsed) {\n                if (key in argsParsed && !isArray(argsParsed[key])) argsParsed[key] = [argsParsed[key]];\n                argsParsed[key].push(value);\n            } else {\n                argsParsed[key] = value;\n            }\n\n        }\n\n    });\n\n    return argsParsed;\n\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isFunction(obj) {\n    return typeof obj === \"function\";\n}\n\n/**\n * @param obj\n * @return {boolean}\n */\nexport function isArray(obj) {\n    return Array.isArray ? Array.isArray(obj) : typeof obj === \"array\";\n}\n\n/**\n * @param fn\n * @param interval\n * @param timeout\n */\nexport function poll(fn, interval, timeout) { //NodeJS.Timer|number\n\n    module.exports.stopPolling(timeout);\n\n    interval = interval || 1000;\n\n    var next = (delay) => {\n\n        delay = delay || interval;\n\n        interval = delay;\n\n        return setTimeout(() => {\n\n            fn(next, delay);\n\n        }, delay);\n\n    };\n\n    return next();\n\n}\n\nexport function stopPolling(timeout) {\n    if (timeout) clearTimeout(timeout);\n}\n\nexport function isNodeJS() {\n    return (typeof process !== 'undefined');\n}\n\nexport function isBrowser() {\n    return (typeof window !== 'undefined');\n}\n\nexport function delay(timeout) {\n    return new Promise((resolve, reject) => {\n        setTimeout(() => {\n            resolve(null);\n        }, timeout);\n    });\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Utils.js\n **/","import ES6Promise from 'es6-promise';\nimport nodeFetch from 'node-fetch';\nimport pubnub from 'pubnub';\n\nvar root = (new Function('return this'))();\n\nexport var Promise = (ES6Promise && ES6Promise.Promise) || root.Promise;\n\nexport var fetch = root.fetch || nodeFetch;\nexport var Request = root.Request || fetch.Request;\nexport var Response = root.Response || fetch.Response;\nexport var Headers = root.Headers || fetch.Headers;\n\nexport var PUBNUB = root.PUBNUB || pubnub;\n\nexport var localStorage = (typeof root.localStorage !== 'undefined') ? root.localStorage : {};\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Externals.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\"}\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"node-fetch\",\"commonjs2\":\"node-fetch\"}\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"commonjs\":\"pubnub\",\"commonjs2\":\"pubnub\",\"amd\":\"pubnub\"}\n ** module id = 6\n ** module chunks = 0\n **/","export default class Cache {\n\n    static defaultPrefix = 'rc-';\n\n    constructor(storage, prefix) {\n        this.setPrefix(prefix);\n        this._storage = storage;\n    }\n\n    setPrefix(prefix) {\n        this._prefix = prefix || Cache.defaultPrefix;\n        return this;\n    }\n\n    setItem(key, data) {\n        this._storage[this._prefixKey(key)] = JSON.stringify(data);\n        return this;\n    }\n\n    removeItem(key) {\n        delete this._storage[this._prefixKey(key)];\n        return this;\n    }\n\n    getItem(key) {\n        var item = this._storage[this._prefixKey(key)];\n        if (!item) return null;\n        return JSON.parse(item);\n    }\n\n    clean() {\n\n        for (var key in this._storage) {\n\n            if (!this._storage.hasOwnProperty(key)) continue;\n\n            if (key.indexOf(this._prefix) === 0) {\n                delete this._storage[key];\n            }\n\n        }\n\n        return this;\n\n    }\n\n    _prefixKey(key) {\n        return this._prefix + key;\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Cache.js\n **/","export default class Observable {\n\n    constructor() {\n        this.off();\n    }\n\n    hasListeners(event) {\n        return (event in this._listeners);\n    }\n\n    on(events, callback) {\n\n        if (typeof events == 'string') events = [events];\n        if (!events) throw new Error('No events to subscribe to');\n        if (typeof callback !== 'function') throw new Error('Callback must be a function');\n\n        events.forEach((event) => {\n\n            if (!this.hasListeners(event)) this._listeners[event] = [];\n\n            this._listeners[event].push(callback);\n\n        });\n\n        return this;\n\n    }\n\n    emit(event, ...args) {\n\n        var result = null;\n\n        if (!this.hasListeners(event)) return null;\n\n        this._listeners[event].some((callback) => {\n\n            result = callback.apply(this, args);\n            return (result === false);\n\n        });\n\n        return result;\n\n    }\n\n    off(event, callback) {\n\n        if (!event) {\n\n            this._listeners = {};\n\n        } else {\n\n            if (!callback) {\n\n                delete this._listeners[event];\n\n            } else {\n\n                if (!this.hasListeners(event)) return this;\n\n                this._listeners[event].forEach((cb, i) => {\n\n                    if (cb === callback) delete this._listeners[event][i];\n\n                });\n\n            }\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Observable.js\n **/","import {Promise} from '../core/Externals';\nimport {poll, stopPolling} from './Utils';\n\nexport default class Queue {\n\n    static _pollInterval = 250;\n    static _releaseTimeout = 5000;\n\n    constructor(cache, cacheId) {\n\n        this._cache = cache;\n        this._cacheId = cacheId;\n        this._promise = null;\n\n    }\n\n    isPaused() {\n\n        var time = this._cache.getItem(this._cacheId);\n\n        return !!time && Date.now() - parseInt(time) < Queue._releaseTimeout;\n    }\n\n    pause() {\n        this._cache.setItem(this._cacheId, Date.now());\n        return this;\n    }\n\n    resume() {\n        this._cache.removeItem(this._cacheId);\n        return this;\n    }\n\n    poll() {\n\n        if (this._promise) return this._promise;\n\n        this._promise = new Promise((resolve, reject) => {\n\n            poll((next) => {\n\n                if (this.isPaused()) return next();\n\n                this._promise = null;\n\n                this.resume(); // this is actually not needed but why not\n\n                resolve(null);\n\n            }, Queue._pollInterval);\n\n        });\n\n        return this._promise;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/core/Queue.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport {queryStringify} from '../core/Utils';\nimport {findHeaderName} from './Utils';\nimport Observable from '../core/Observable';\nimport ApiResponse from './ApiResponse';\n\nexport default class Client extends Observable {\n\n    static _allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS', 'HEAD'];\n\n    events = {\n        beforeRequest: 'beforeRequest',\n        requestSuccess: 'requestSuccess',\n        requestError: 'requestError'\n    };\n\n    /**\n     * @param {Request} request\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request) {\n\n        var apiResponse = new ApiResponse(request);\n\n        try {\n\n            //TODO Stop request if listeners return false\n            this.emit(this.events.beforeRequest, apiResponse);\n\n            apiResponse._response = await this._loadResponse(request);\n\n            if (apiResponse._isMultipart() || apiResponse._isJson()) {\n                apiResponse._text = await apiResponse.response().text();\n            }\n\n            if (!apiResponse.ok()) throw new Error('Response has unsuccessful status');\n\n            this.emit(this.events.requestSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            if (!e.apiResponse) e = this.makeError(e, apiResponse);\n\n            this.emit(this.events.requestError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @return {Promise<Response>}\n     * @private\n     */\n    async _loadResponse(request) {\n        return await fetch.call(null, request);\n    }\n\n    /**\n     * Wraps the JS Error object with transaction information\n     * @param {Error|IApiError} e\n     * @param {ApiResponse} apiResponse\n     * @return {IApiError}\n     */\n    makeError(e, apiResponse) {\n\n        // Wrap only if regular error\n        if (!e.hasOwnProperty('apiResponse') && !e.hasOwnProperty('originalMessage')) {\n\n            e.apiResponse = apiResponse;\n            e.originalMessage = e.message;\n            e.message = (apiResponse && apiResponse.error(true)) || e.originalMessage;\n\n        }\n\n        return e;\n\n    }\n\n    /**\n     *\n     * @param {object} init\n     * @param {object} [init.url]\n     * @param {object} [init.body]\n     * @param {string} [init.method]\n     * @param {object} [init.query]\n     * @param {object} [init.headers]\n     * @return {Request}\n     */\n    createRequest(init) {\n\n        init = init || {};\n        init.headers = init.headers || {};\n\n        // Sanity checks\n        if (!init.url) throw new Error('Url is not defined');\n        if (!init.method) init.method = 'GET';\n        if (init.method && Client._allowedMethods.indexOf(init.method) < 0) throw new Error('Method has wrong value: ' + init.method);\n\n        // Defaults\n        init.credentials = init.credentials || 'include';\n        init.mode = init.mode || 'cors';\n\n        // Append Query String\n        if (init.query) {\n            init.url = init.url + (init.url.indexOf('?') > -1 ? '&' : '?') + queryStringify(init.query);\n        }\n\n        if (!(findHeaderName('Accept', init.headers))) {\n            init.headers['Accept'] = ApiResponse._jsonContentType;\n        }\n\n        // Serialize body\n        //TODO Check that body is a plain object\n        if (typeof init.body !== 'string' || !init.body) {\n\n            var contentTypeHeaderName = findHeaderName(ApiResponse._contentType, init.headers);\n\n            if (!contentTypeHeaderName) {\n                contentTypeHeaderName = ApiResponse._contentType;\n                init.headers[contentTypeHeaderName] = ApiResponse._jsonContentType;\n            }\n\n            var contentType = init.headers[contentTypeHeaderName];\n\n            // Assign a new encoded body\n            if (contentType.indexOf(ApiResponse._jsonContentType) > -1) {\n                init.body = JSON.stringify(init.body);\n            } else if (contentType.indexOf(ApiResponse._urlencodedContentType) > -1) {\n                init.body = queryStringify(init.body);\n            }\n\n        }\n\n        // Create a request with encoded body\n        var req = new Request(init.url, init);\n\n        // Keep the original body accessible directly (for mocks)\n        req.originalBody = init.body;\n\n        return req;\n\n    }\n\n}\n\n/**\n * @name IApiError\n * @property {string} stack\n * @property {string} originalMessage\n * @property {ApiResponse} apiResponse\n */\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Client.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport * as utils from '../core/Utils';\n\n/**\n * Creates a response\n * @param stringBody\n * @param init\n * @return {Response}\n */\nexport function createResponse(stringBody, init) {\n\n    init = init || {};\n\n    var response = new Response(stringBody, init);\n\n    //TODO Wait for https://github.com/bitinn/node-fetch/issues/38\n    if (utils.isNodeJS()) {\n\n        response._text = stringBody;\n        response._decode = function() {\n            return this._text;\n        };\n\n    }\n\n    return response;\n\n}\n\nexport function findHeaderName(name, headers) {\n    name = name.toLowerCase();\n    return Object.keys(headers).reduce(function(res, key) {\n        if (res) return res;\n        if (name == key.toLowerCase()) return key;\n        return res;\n    }, null);\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/Utils.js\n **/","import {fetch, Request, Response, Headers, Promise} from '../core/Externals';\nimport * as utils from './Utils';\n\nexport default class ApiResponse {\n\n    static _contentType = 'Content-Type';\n    static _jsonContentType = 'application/json';\n    static _multipartContentType = 'multipart/mixed';\n    static _urlencodedContentType = 'application/x-www-form-urlencoded';\n    static _headerSeparator = ':';\n    static _bodySeparator = '\\n\\n';\n    static _boundarySeparator = '--';\n\n    /**\n     * @param {Request} request\n     * @param {Response} response\n     * @param {string} responseText\n     */\n    constructor(request, response, responseText) {\n\n        /** @type {Request} */\n        this._request = request;\n\n        /** @type {Response} */\n        this._response = response;\n\n        this._text = responseText;\n        this._json = null;\n        this._multipart = [];\n\n    }\n\n    /**\n     * @return {Response}\n     */\n    response() {\n        return this._response;\n    }\n\n    /**\n     * @return {Request}\n     */\n    request() {\n        return this._request;\n    }\n\n    /**\n     * @return {boolean}\n     */\n    ok() {\n        return this._response && this._response.ok;\n    }\n\n    /**\n     * @return {string}\n     */\n    text() {\n        if (!this._isJson() && !this._isMultipart()) throw new Error('Response is not text');\n        return this._text;\n    }\n\n    /**\n     * @return {object}\n     */\n    json() {\n        if (!this._isJson()) throw new Error('Response is not JSON');\n        if (!this._json) {\n            this._json = this._text ? JSON.parse(this._text) : null;\n        }\n        return this._json;\n    }\n\n    /**\n     * @param [skipOKCheck]\n     * @return {string}\n     */\n    error(skipOKCheck) {\n\n        if (this.ok() && !skipOKCheck) return null;\n\n        var message = (this._response && this._response.status ? this._response.status + ' ' : '') +\n                      (this._response && this._response.statusText ? this._response.statusText : '');\n\n        try {\n\n            if (this.json().message) message = this.json().message;\n            if (this.json().error_description) message = this.json().error_description;\n            if (this.json().description) message = this.json().description;\n\n        } catch (e) {}\n\n        return message;\n\n    }\n\n    /**\n     * @return {ApiResponse[]}\n     */\n    multipart() {\n\n        if (!this._isMultipart()) throw new Error('Response is not multipart');\n\n        if (!this._multipart.length) {\n\n            // Step 1. Split multipart response\n\n            var text = this.text();\n\n            if (!text) throw new Error('No response body');\n\n            var boundary = this._getContentType().match(/boundary=([^;]+)/i)[1];\n\n            if (!boundary) throw new Error('Cannot find boundary');\n\n            var parts = text.toString().split(ApiResponse._boundarySeparator + boundary);\n\n            if (parts[0].trim() === '') parts.shift();\n            if (parts[parts.length - 1].trim() == ApiResponse._boundarySeparator) parts.pop();\n\n            if (parts.length < 1) throw new Error('No parts in body');\n\n            // Step 2. Parse status info\n\n            var statusInfo = ApiResponse.create(parts.shift(), this._response.status, this._response.statusText).json();\n\n            // Step 3. Parse all other parts\n\n            this._multipart = parts.map((part:string, i) => {\n\n                var status = statusInfo.response[i].status;\n\n                return ApiResponse.create(part, status);\n\n            });\n\n        }\n\n        return this._multipart;\n\n    }\n\n    _isContentType(contentType) {\n        return this._getContentType().indexOf(contentType) > -1;\n    }\n\n    _getContentType() {\n        return this._response.headers.get(ApiResponse._contentType) || '';\n    }\n\n    _isMultipart() {\n        return this._isContentType(ApiResponse._multipartContentType);\n    }\n\n    _isUrlEncoded() {\n        return this._isContentType(ApiResponse._urlencodedContentType);\n    }\n\n    _isJson() {\n        return this._isContentType(ApiResponse._jsonContentType);\n    }\n\n    /**\n     * Method is used to create ApiResponse object from string parts of multipart/mixed response\n     * @param {string} [text]\n     * @param {number} [status]\n     * @param {string} [statusText]\n     * @return {ApiResponse}\n     */\n    static create(text, status, statusText) {\n\n        text = text || '';\n        status = status || 200;\n        statusText = statusText || 'OK';\n\n        text = text.replace(/\\r/g, '');\n\n        var headers = new Headers(),\n            headersAndBody = text.split(ApiResponse._bodySeparator),\n            headersText = (headersAndBody.length > 1) ? headersAndBody.shift() : '';\n\n        text = headersAndBody.join(ApiResponse._bodySeparator);\n\n        (headersText || '')\n            .split('\\n')\n            .forEach((header:string) => {\n\n                var split = header.trim().split(ApiResponse._headerSeparator),\n                    key = split.shift().trim(),\n                    value = split.join(ApiResponse._headerSeparator).trim();\n\n                if (key) headers.append(key, value);\n\n            });\n\n        return new ApiResponse(null, utils.createResponse(text, {\n            headers: headers,\n            status: status,\n            statusText: statusText\n        }), text);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/http/ApiResponse.js\n **/","import Registry from './Registry';\nimport {default as HttpClient} from '../http/Client';\n\nexport default class Client extends HttpClient {\n\n    constructor() {\n        super();\n        this._registry = new Registry();\n    }\n\n    registry() {\n        return this._registry;\n    }\n\n    async _loadResponse(request) {\n\n        var mock = this._registry.find(request);\n\n        return await mock.getResponse(request);\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/ClientMock.js\n **/","import Mock from './Mock';\n\nexport default class Registry {\n\n    constructor() {\n        this._mocks = [];\n    }\n\n    add(mock) {\n        this._mocks.push(mock);\n        return this;\n    }\n\n    clear() {\n        this._mocks = [];\n        return this;\n    }\n\n    find(request) {\n\n        //console.log('Registry is looking for', request);\n\n        var mock = this._mocks.shift();\n\n        if (!mock) throw new Error('No mock in registry for request ' + request.method + ' ' + request.url);\n\n        if (!mock.test(request)) throw new Error('Wrong request ' + request.method + ' ' + request.url +\n                                                 ' for expected mock ' + mock.method() + ' ' + mock.path());\n\n        return mock;\n\n    }\n\n    apiCall(method:string, path:string, response:any, status, statusText) {\n\n        this.add(new Mock(method, path, response, status, statusText));\n\n        return this;\n\n    }\n\n    authentication() {\n\n        this.apiCall('POST', '/restapi/oauth/token', {\n            'access_token': 'ACCESS_TOKEN',\n            'token_type': 'bearer',\n            'expires_in': 3600,\n            'refresh_token': 'REFRESH_TOKEN',\n            'refresh_token_expires_in': 60480,\n            'scope': 'SMS RCM Foo Boo',\n            'expireTime': new Date().getTime() + 3600000\n        });\n\n        return this;\n\n    }\n\n    logout() {\n\n        this.apiCall('POST', '/restapi/oauth/revoke', {});\n\n        return this;\n\n    }\n\n    presenceLoad(id) {\n\n        this.apiCall('GET', '/restapi/v1.0/account/~/extension/' + id + '/presence', {\n            \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id + \"/presence\",\n            \"extension\": {\n                \"uri\": \"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/\" + id,\n                \"id\": id,\n                \"extensionNumber\": \"101\"\n            },\n            \"activeCalls\": [],\n            \"presenceStatus\": \"Available\",\n            \"telephonyStatus\": \"Ringing\",\n            \"userStatus\": \"Available\",\n            \"dndStatus\": \"TakeAllCalls\",\n            \"extensionId\": id\n        });\n\n        return this;\n\n    }\n\n    subscribeGeneric(expiresIn) {\n\n        expiresIn = expiresIn || 15 * 60 * 60;\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': [\n                '/restapi/v1.0/account/~/extension/~/presence'\n            ],\n            'expirationTime': new Date(date.getTime() + (expiresIn * 1000)).toISOString(),\n            'expiresIn': expiresIn,\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': false,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar'\n            },\n            'id': 'foo-bar-baz',\n            'creationTime': date.toISOString(),\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    subscribeOnPresence(id, detailed) {\n\n        id = id || '1';\n\n        var date = new Date();\n\n        this.apiCall('POST', '/restapi/v1.0/subscription', {\n            'eventFilters': ['/restapi/v1.0/account/~/extension/' + id + '/presence' + (detailed ? '?detailedTelephonyState=true' : '')],\n            'expirationTime': new Date(date.getTime() + (15 * 60 * 60 * 1000)).toISOString(),\n            'deliveryMode': {\n                'transportType': 'PubNub',\n                'encryption': true,\n                'address': '123_foo',\n                'subscriberKey': 'sub-c-foo',\n                'secretKey': 'sec-c-bar',\n                'encryptionAlgorithm': 'AES',\n                'encryptionKey': 'VQwb6EVNcQPBhE/JgFZ2zw=='\n            },\n            'creationTime': date.toISOString(),\n            'id': 'foo-bar-baz',\n            'status': 'Active',\n            'uri': 'https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz'\n        });\n\n        return this;\n\n    }\n\n    tokenRefresh(failure) {\n\n        if (!failure) {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'access_token': 'ACCESS_TOKEN_FROM_REFRESH',\n                'token_type': 'bearer',\n                'expires_in': 3600,\n                'refresh_token': 'REFRESH_TOKEN_FROM_REFRESH',\n                'refresh_token_expires_in': 60480,\n                'scope': 'SMS RCM Foo Boo'\n            });\n\n        } else {\n\n            this.apiCall('POST', '/restapi/oauth/token', {\n                'message': 'Wrong token',\n                'error_description': 'Wrong token',\n                'description': 'Wrong token'\n            }, 400);\n\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Registry.js\n **/","import ApiResponse from '../http/ApiResponse';\nimport {delay} from '../core/Utils';\nimport {createResponse} from '../http/Utils';\n\nexport default class Mock {\n\n    constructor(method, path, json, status, statusText, delay) {\n        this._method = method.toUpperCase();\n        this._path = path;\n        this._json = json || {};\n        this._delay = delay || 10;\n        this._status = status || 200;\n        this._statusText = statusText || 'OK';\n    }\n\n    path() {\n        return this._path;\n    }\n\n    method() {\n        return this._method;\n    }\n\n    test(request:Request) {\n\n        return request.url.indexOf(this._path) > -1 &&\n               request.method.toUpperCase() == this._method;\n\n    }\n\n    async getResponse(request) {\n\n        await delay(this._delay);\n\n        return this.createResponse(this._json);\n\n    }\n\n    createResponse(json, init) {\n\n        init = init || {};\n\n        init.status = init.status || this._status;\n        init.statusText = init.statusText || this._statusText;\n\n        var str = JSON.stringify(json),\n            res = createResponse(str, init);\n\n        res.headers.set(ApiResponse._contentType, ApiResponse._jsonContentType);\n\n        return res;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mocks/Mock.js\n **/","import Observable from '../core/Observable';\nimport Queue from '../core/Queue';\nimport Auth from './Auth';\nimport {Promise} from '../core/Externals';\nimport {queryStringify, parseQueryString, delay} from '../core/Utils';\n\nexport default class Platform extends Observable {\n\n    static _urlPrefix = '/restapi';\n    static _apiVersion = 'v1.0';\n    static _accessTokenTtl = null; // Platform server by default sets it to 60 * 60 = 1 hour\n    static _refreshTokenTtl = 10 * 60 * 60; // 10 hours\n    static _refreshTokenTtlRemember = 7 * 24 * 60 * 60; // 1 week\n    static _tokenEndpoint = '/restapi/oauth/token';\n    static _revokeEndpoint = '/restapi/oauth/revoke';\n    static _authorizeEndpoint = '/restapi/oauth/authorize';\n    static _refreshDelayMs = 100;\n    static _cacheId = 'platform';\n    static _clearCacheOnRefreshError = true;\n\n    events = {\n        beforeLogin: 'beforeLogin',\n        loginSuccess: 'loginSuccess',\n        loginError: 'loginError',\n        beforeRefresh: 'beforeRefresh',\n        refreshSuccess: 'refreshSuccess',\n        refreshError: 'refreshError',\n        beforeLogout: 'beforeLogout',\n        logoutSuccess: 'logoutSuccess',\n        logoutError: 'logoutError'\n    };\n\n    constructor(client, cache, server, appKey, appSecret) {\n\n        super();\n\n        this._server = server;\n        this._appKey = appKey;\n        this._appSecret = appSecret;\n\n        /** @type {Cache} */\n        this._cache = cache;\n\n        /** @type {Client} */\n        this._client = client;\n\n        this._queue = new Queue(this._cache, Platform._cacheId + '-refresh');\n\n        this._auth = new Auth(this._cache, Platform._cacheId);\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    auth() {\n        return this._auth;\n    }\n\n    /**\n     * @return {Client}\n     */\n    client() {\n        return this._client;\n    }\n\n    /**\n     * @param {string} path\n     * @param {object} [options]\n     * @param {boolean} [options.addServer]\n     * @param {string} [options.addMethod]\n     * @param {boolean} [options.addToken]\n     * @return {string}\n     */\n    createUrl(path, options) {\n\n        path = path || '';\n        options = options || {};\n\n        var builtUrl = '',\n            hasHttp = path.indexOf('http://') != -1 || path.indexOf('https://') != -1;\n\n        if (options.addServer && !hasHttp) builtUrl += this._server;\n\n        if (path.indexOf(Platform._urlPrefix) == -1 && !hasHttp) builtUrl += Platform._urlPrefix + '/' + Platform._apiVersion;\n\n        builtUrl += path;\n\n        if (options.addMethod || options.addToken) builtUrl += (path.indexOf('?') > -1 ? '&' : '?');\n\n        if (options.addMethod) builtUrl += '_method=' + options.addMethod;\n        if (options.addToken) builtUrl += (options.addMethod ? '&' : '') + 'access_token=' + this._auth.accessToken();\n\n        return builtUrl;\n\n    }\n\n    /**\n     * @param {string} options.redirectUri\n     * @param {string} options.state\n     * @param {string} options.brandId\n     * @param {string} options.display\n     * @param {string} options.prompt\n     * @return {string}\n     */\n    authUrl(options) {\n\n        options = options || {};\n\n        return this.createUrl(Platform._authorizeEndpoint + '?' + queryStringify({\n                'response_type': 'code',\n                'redirect_uri': options.redirectUri || '',\n                'client_id': this._appKey,\n                'state': options.state || '',\n                'brand_id': options.brandId || '',\n                'display': options.display || '',\n                'prompt': options.prompt || ''\n            }), {addServer: true})\n\n    }\n\n    /**\n     * @param {string} url\n     * @return {Object}\n     */\n    parseAuthRedirectUrl(url:string) {\n\n        var qs = parseQueryString(url.split('?').reverse()[0]),\n            error = qs.error_description || qs.error;\n\n        if (error) {\n            var e = new Error(error);\n            e.error = qs.error;\n            throw e;\n        }\n\n        return qs;\n\n    }\n\n    /**\n     * @return {Promise<boolean>}\n     */\n    async loggedIn() {\n\n        try {\n            await this._ensureAuthentication();\n            return true;\n        } catch (e) {\n            return false;\n        }\n\n    }\n\n    /**\n     * @param {string} options.username\n     * @param {string} options.password\n     * @param {string} options.extension\n     * @param {string} options.code\n     * @param {string} options.redirectUri\n     * @param {string} options.endpointId\n     * @returns {Promise<ApiResponse>}\n     */\n    async login(options) {\n\n        try {\n\n            options = options || {};\n\n            options.remember = options.remember || false;\n\n            this.emit(this.events.beforeLogin);\n\n            var body = {\n                \"access_token_ttl\": Platform._accessTokenTtl,\n                \"refresh_token_ttl\": options.remember ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n            };\n\n            if (!options.code) {\n\n                body.grant_type = 'password';\n                body.username = options.username;\n                body.password = options.password;\n                body.extension = options.extension || '';\n\n            } else if (options.code) {\n\n                body.grant_type = 'authorization_code';\n                body.code = options.code;\n                body.redirect_uri = options.redirectUri;\n                //body.client_id = this.getCredentials().key; // not needed\n\n            }\n\n            if (options.endpointId) body.endpoint_id = options.endpointId;\n\n            var apiResponse = await this._tokenRequest(Platform._tokenEndpoint, body),\n                json = apiResponse.json();\n\n            this._auth\n                .setData(json)\n                .setRemember(options.remember);\n\n            this.emit(this.events.loginSuccess, apiResponse);\n\n            return apiResponse;\n\n        } catch (e) {\n\n            this._cache.clean();\n\n            this.emit(this.events.loginError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async refresh() {\n\n        try {\n\n            this.emit(this.events.beforeRefresh);\n\n            if (this._queue.isPaused()) {\n\n                await this._queue.poll();\n\n                if (!this._isAccessTokenValid()) {\n                    throw new Error('Automatic authentification timeout');\n                }\n\n                this.emit(this.events.refreshSuccess, null);\n\n                return null;\n\n            }\n\n            this._queue.pause();\n\n            // Make sure all existing AJAX calls had a chance to reach the server\n            await delay(Platform._refreshDelayMs);\n\n            // Perform sanity checks\n            if (!this._auth.refreshToken()) throw new Error('Refresh token is missing');\n            if (!this._auth.refreshTokenValid()) throw new Error('Refresh token has expired');\n            if (!this._queue.isPaused()) throw new Error('Queue was resumed before refresh call');\n\n            /** @type {ApiResponse} */\n            var res = await this._tokenRequest(Platform._tokenEndpoint, {\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": this._auth.refreshToken(),\n                    \"access_token_ttl\": Platform._accessTokenTtl,\n                    \"refresh_token_ttl\": this._auth.remember() ? Platform._refreshTokenTtlRemember : Platform._refreshTokenTtl\n                }),\n                json = res.json();\n\n            if (!json.access_token) {\n                throw this._client.makeError(new Error('Malformed OAuth response'), res);\n            }\n\n            this._auth.setData(json);\n            this._queue.resume();\n\n            this.emit(this.events.refreshSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            e = this._client.makeError(e);\n\n            if (Platform._clearCacheOnRefreshError) {\n                this._cache.clean();\n            }\n\n            this.emit(this.events.refreshError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async logout() {\n\n        try {\n\n            this.emit(this.events.beforeLogout);\n\n            this._queue.pause();\n\n            var res = await this._tokenRequest(Platform._revokeEndpoint, {\n                token: this._auth.accessToken()\n            });\n\n            this._queue.resume();\n            this._cache.clean();\n\n            this.emit(this.events.logoutSuccess, res);\n\n            return res;\n\n        } catch (e) {\n\n            this._queue.resume();\n\n            this.emit(this.events.logoutError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<Request>}\n     */\n    async inflateRequest(request, options) {\n\n        options = options || {};\n\n        if (options.skipAuthCheck) return request;\n\n        await this._ensureAuthentication();\n\n        request.headers.set('Authorization', this._authHeader());\n        //request.url = this.createUrl(request.url, {addServer: true}); //FIXME Spec prevents this...\n\n        //TODO Add User-Agent here\n\n        return request;\n\n    }\n\n    /**\n     * @param {Request} request\n     * @param {object} [options]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async sendRequest(request, options) {\n\n        try {\n\n            request = await this.inflateRequest(request, options);\n\n            return (await this._client.sendRequest(request));\n\n        } catch (e) {\n\n            // Guard is for errors that come from polling\n            if (!e.apiResponse || !e.apiResponse.response() || (e.apiResponse.response().status != 401)) throw e;\n\n            this._auth.cancelAccessToken();\n\n            return (await this.sendRequest(request, options));\n\n        }\n\n    }\n\n    /**\n     * General purpose function to send anything to server\n     * @param {string} options.url\n     * @param {object} [options.body]\n     * @param {string} [options.method]\n     * @param {object} [options.query]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async send(options = {}) {\n\n        //FIXME https://github.com/bitinn/node-fetch/issues/43\n        options.url = this.createUrl(options.url, {addServer: true});\n\n        return await this.sendRequest(this._client.createRequest(options), options);\n\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async get(url, query, options) {\n        options = options || {};\n        options.method = 'GET';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} body\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async post(url, body, query, options) {\n        options = options || {};\n        options.method = 'POST';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {object} [body]\n     * @param {object} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async put(url, body, query, options) {\n        options = options || {};\n        options.method = 'PUT';\n        options.url = url;\n        options.query = query;\n        options.body = body;\n        return await this.send(options);\n    }\n\n    /**\n     * @param {string} url\n     * @param {string} [query]\n     * @param {object} [options]\n     * @param {object} [options.headers]\n     * @param {boolean} [options.skipAuthCheck]\n     * @return {Promise<ApiResponse>}\n     */\n    async 'delete'(url, query, options) {\n        options = options || {};\n        options.method = 'DELETE';\n        options.url = url;\n        options.query = query;\n        return await this.send(options);\n    }\n\n    async _tokenRequest(path, body) {\n\n        return await this.send({\n            url: path,\n            skipAuthCheck: true,\n            body: body,\n            method: 'POST',\n            headers: {\n                'Authorization': 'Basic ' + this._apiKey(),\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        });\n\n    }\n\n    async _ensureAuthentication() {\n\n        if (this._isAccessTokenValid()) return null;\n        return await this.refresh();\n\n    }\n\n    _isAccessTokenValid() {\n\n        return (this._auth.accessTokenValid() && !this._queue.isPaused());\n\n    }\n\n    _apiKey() {\n        var apiKey = this._appKey + ':' + this._appSecret;\n        return (typeof btoa == 'function') ? btoa(apiKey) : new Buffer(apiKey).toString('base64');\n    }\n\n    _authHeader() {\n        var token = this._auth.accessToken();\n        return this._auth.tokenType() + (token ? ' ' + token : '');\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Platform.js\n **/","export default class Auth {\n\n    static refreshHandicapMs:number = 60 * 1000; // 1 minute\n    static forcedTokenType = 'forced';\n\n    constructor(cache, cacheId:string) {\n\n        /** @type {Cache} */\n        this._cache = cache;\n        this._cacheId = cacheId;\n\n    }\n\n    accessToken() {\n        return this.data().access_token;\n    }\n\n    refreshToken() {\n        return this.data().refresh_token;\n    }\n\n    tokenType() {\n        return this.data().token_type;\n    }\n\n    /**\n     * @return {{token_type: string, access_token: string, expires_in: number, refresh_token: string, refresh_token_expires_in: number}}\n     */\n    data() {\n\n        return this._cache.getItem(this._cacheId) || {\n                token_type: '',\n                access_token: '',\n                expires_in: 0,\n                refresh_token: '',\n                refresh_token_expires_in: 0\n            };\n\n    }\n\n    /**\n     * @param {object} newData\n     * @return {Auth}\n     */\n    setData(newData) {\n\n        newData = newData || {};\n\n        var data = this.data();\n\n        Object.keys(newData).forEach((key) => {\n            data[key] = newData[key];\n        });\n\n        data.expire_time = Date.now() + (data.expires_in * 1000);\n        data.refresh_token_expire_time = Date.now() + (data.refresh_token_expires_in * 1000);\n\n        this._cache.setItem(this._cacheId, data);\n\n        return this;\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    accessTokenValid() {\n\n        var authData = this.data();\n        return (authData.token_type === Auth.forcedTokenType || (authData.expire_time - Auth.refreshHandicapMs > Date.now()));\n\n    }\n\n    /**\n     * Check if there is a valid (not expired) access token\n     * @return {boolean}\n     */\n    refreshTokenValid() {\n\n        return (this.data().refresh_token_expire_time > Date.now());\n\n    }\n\n    /**\n     * @return {Auth}\n     */\n    cancelAccessToken() {\n\n        return this.setData({\n            access_token: '',\n            expires_in: 0\n        });\n\n    }\n\n    /**\n     * This method sets a special authentication mode used in Service Web\n     * @return {Auth}\n     */\n    forceAuthentication() {\n\n        this.setData({\n            token_type: Auth.forcedTokenType,\n            access_token: '',\n            expires_in: 0,\n            refresh_token: '',\n            refresh_token_expires_in: 0\n        });\n\n        return this;\n\n    }\n\n    /**\n     * @param remember\n     * @return {Auth}\n     */\n    setRemember(remember) {\n\n        return this.setData({remember: remember});\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    remember() {\n\n        return !!this.data().remember;\n\n    }\n\n}\n\n//export interface IAuthData {\n//    remember?:boolean;\n//    token_type?:string;\n//    access_token?:string;\n//    expires_in?:number; // actually it's string\n//    expire_time?:number;\n//    refresh_token?:string;\n//    refresh_token_expires_in?:number; // actually it's string\n//    refresh_token_expire_time?:number;\n//    scope?:string;\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/Auth.js\n **/","import PubnubMock from './PubnubMock.js';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMockFactory {\n\n    constructor() {\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    init(options:PUBNUBInitOptions) {\n        return new PubnubMock(options);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubFactory.js\n **/","import Observable from '../core/Observable';\nimport {PUBNUB} from '../core/Externals';\n\nexport default class PubnubMock extends Observable {\n\n    constructor(options) {\n        super();\n        this.options = options;\n        this.crypto_obj = PUBNUB.crypto_obj;\n    }\n\n    ready() {}\n\n    subscribe(options:PUBNUBSubscribeOptions) {\n        this.on('message-' + options.channel, options.message);\n    }\n\n    unsubscribe(options:PUBNUBUnsubscribeOptions) {\n        this.off('message-' + options.channel);\n    }\n\n    receiveMessage(msg, channel) {\n        this.emit('message-' + channel, msg, 'env', channel);\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pubnub/PubnubMock.js\n **/","import Observable from '../core/Observable';\nimport Client from '../http/Client';\nimport {poll, stopPolling, delay} from '../core/Utils';\n\nexport default class Subscription extends Observable {\n\n    static _renewHandicapMs = 2 * 60 * 1000;\n    static _pollInterval = 10 * 1000;\n\n    events = {\n        notification: 'notification',\n        removeSuccess: 'removeSuccess',\n        removeError: 'removeError',\n        renewSuccess: 'renewSuccess',\n        renewError: 'renewError',\n        subscribeSuccess: 'subscribeSuccess',\n        subscribeError: 'subscribeError'\n    };\n\n    constructor(pubnubFactory, platform) {\n\n        super();\n\n        this._pubnubFactory = pubnubFactory;\n        this._platform = platform;\n        this._pubnub = null;\n        this._timeout = null;\n        this._subscription = {};\n\n    }\n\n    subscribed(){\n\n        return !!(this._subscription.id &&\n                  this._subscription.deliveryMode &&\n                  this._subscription.deliveryMode.subscriberKey &&\n                  this._subscription.deliveryMode.address);\n\n    }\n\n    /**\n     * @return {boolean}\n     */\n    alive() {\n\n        return this.subscribed() && Date.now() < this.expirationTime();\n\n    }\n\n    expirationTime() {\n        return new Date(this._subscription.expirationTime || 0).getTime() - Subscription._renewHandicapMs;\n    }\n\n    setSubscription(subscription) {\n\n        subscription = subscription || {};\n\n        this._clearTimeout();\n\n        this._subscription = subscription;\n\n        if (!this._pubnub) this._subscribeAtPubnub();\n\n        this._setTimeout();\n\n        return this;\n\n    }\n\n    subscription() {\n        return this._subscription;\n    }\n\n    /**\n     * Creates or updates subscription if there is an active one\n     * @returns {Promise<ApiResponse>}\n     */\n    async register() {\n\n        if (this.alive()) {\n            return await this.renew();\n        } else {\n            return await this.subscribe();\n        }\n\n    }\n\n    eventFilters() {\n        return this._subscription.eventFilters || [];\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    addEventFilters(events) {\n        this.setEventFilters(this.eventFilters().concat(events));\n        return this;\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {Subscription}\n     */\n    setEventFilters(events) {\n        this._subscription.eventFilters = events;\n        return this;\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async subscribe() {\n\n        try {\n\n            this._clearTimeout();\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.post('/restapi/v1.0/subscription', {\n                    eventFilters: this._getFullEventFilters(),\n                    deliveryMode: {\n                        transportType: 'PubNub'\n                    }\n                }),\n                json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.subscribeSuccess, response);\n\n            return response;\n\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.subscribeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async renew() {\n\n        try {\n\n            this._clearTimeout();\n\n            if (!this.alive()) throw new Error('Subscription is not alive');\n\n            if (!this.eventFilters().length) throw new Error('Events are undefined');\n\n            var response = await this._platform.put('/restapi/v1.0/subscription/' + this._subscription.id, {\n                eventFilters: this._getFullEventFilters()\n            });\n\n            var json = response.json();\n\n            this.setSubscription(json)\n                .emit(this.events.renewSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.reset()\n                .emit(this.events.renewError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    async remove() {\n\n        try {\n\n            if (!this.subscribed()) throw new Error('No subscription');\n\n            var response = await this._platform.delete('/restapi/v1.0/subscription/' + this._subscription.id);\n\n            this.reset()\n                .emit(this.events.removeSuccess, response);\n\n            return response;\n\n        } catch (e) {\n\n            e = this._platform.client().makeError(e);\n\n            this.emit(this.events.removeError, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    resubscribe() {\n\n        return this.reset().setEventFilters(this.eventFilters()).subscribe();\n\n    }\n\n    /**\n     * Remove subscription and disconnect from PUBNUB\n     * This method resets subscription at client side but backend is not notified\n     */\n    reset() {\n        this._clearTimeout();\n        if (this.subscribed() && this._pubnub) this._pubnub.unsubscribe({channel: this._subscription.deliveryMode.address});\n        this._subscription = {};\n        return this;\n    }\n\n    _getFullEventFilters() {\n\n        return this.eventFilters().map((event) => {\n            return this._platform.createUrl(event);\n        });\n\n    }\n\n    _setTimeout() {\n\n        this._clearTimeout();\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        poll((next)=> {\n\n            if (this.alive()) return next();\n\n            this.renew();\n\n        }, Subscription._pollInterval, this._timeout);\n\n        return this;\n\n    }\n\n    _clearTimeout() {\n\n        stopPolling(this._timeout);\n\n        return this;\n\n    }\n\n    _decrypt(message:any) {\n\n        if (!this.subscribed()) throw new Error('No subscription');\n\n        if (this._subscription.deliveryMode.encryptionKey) {\n\n            var PUBNUB = this._pubnubFactory;\n\n            message = PUBNUB.crypto_obj.decrypt(message, this._subscription.deliveryMode.encryptionKey, {\n                encryptKey: false,\n                keyEncoding: 'base64',\n                keyLength: 128,\n                mode: 'ecb'\n            });\n\n        }\n\n        return message;\n\n    }\n\n    _notify(message:any) {\n\n        this.emit(this.events.notification, this._decrypt(message));\n\n        return this;\n\n    }\n\n    _subscribeAtPubnub():Subscription {\n\n        if (!this.alive()) throw new Error('Subscription is not alive');\n\n        var PUBNUB = this._pubnubFactory;\n\n        this._pubnub = PUBNUB.init({\n            ssl: true,\n            subscribe_key: this._subscription.deliveryMode.subscriberKey\n        });\n\n        this._pubnub.ready();\n\n        this._pubnub.subscribe({\n            channel: this._subscription.deliveryMode.address,\n            message: this._notify.bind(this),\n            connect: () => {}\n        });\n\n        return this;\n\n    }\n\n}\n\n//export interface ISubscription {\n//    id?:string;\n//    uri?: string;\n//    eventFilters?:string[];\n//    expirationTime?:string; // 2014-03-12T19:54:35.613Z\n//    expiresIn?:number;\n//    deliveryMode?: {\n//        transportType?:string;\n//        encryption?:boolean;\n//        address?:string;\n//        subscriberKey?:string;\n//        encryptionKey?:string;\n//        secretKey?:string;\n//    };\n//    creationTime?:string; // 2014-03-12T19:54:35.613Z\n//    status?:string; // Active\n//}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/Subscription.js\n **/","import Subscription from './Subscription';\nimport Queue from '../core/Queue';\n\nexport default class CachedSubscription extends Subscription {\n\n    constructor(pubnubFactory, platform, cache, cacheKey) {\n\n        super(pubnubFactory, platform);\n\n        this._cache = cache;\n        this._cacheKey = cacheKey;\n        this._renewQueue = new Queue(this._cache, cacheKey + '-renew');\n        this._resubscribeQueue = new Queue(this._cache, cacheKey + '-resubscribe');\n\n        this.events = {\n            ...this.events,\n            queuedRenewSuccess: 'queuedRenewSuccess',\n            queuedRenewError: 'queuedRenewError',\n            queuedResubscribeSuccess: 'queuedResubscribeSuccess',\n            queuedResubscribeError: 'queuedResubscribeError'\n        };\n\n        this.on(this.events.renewError, () => {\n            this.resubscribe();\n        });\n\n        this.on([this.events.subscribeSuccess, this.events.renewSuccess], () => {\n            this._cache.setItem(this._cacheKey, this.subscription());\n        });\n\n        this.on(this.events.removeSuccess, () => {\n            this._cache.removeItem(this._cacheKey);\n        });\n\n    }\n\n    /**\n     * TODO Combine with Platform.refresh and move elsewhere\n     * @param actionCb\n     * @param queue\n     * @param successEvent\n     * @param errorEvent\n     * @param errorMessage\n     * @return {*}\n     * @private\n     */\n    async _queue(actionCb, queue, successEvent, errorEvent, errorMessage) {\n\n        try {\n\n            if (queue.isPaused()) {\n\n                await queue.poll();\n\n                if (!this.alive()) {\n                    throw new Error(errorMessage);\n                }\n\n                this.emit(successEvent, null);\n\n                return null;\n\n            }\n\n            queue.pause();\n\n            var res = await actionCb.call(this);\n\n            queue.resume();\n\n            this.emit(successEvent, res);\n\n            return res;\n\n        } catch (e) {\n\n            this.emit(errorEvent, e);\n\n            throw e;\n\n        }\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    renew() {\n\n        return this._queue(\n            super.renew,\n            this._renewQueue,\n            this.events.queuedRenewSuccess,\n            this.events.queuedRenewError,\n            'Subscription is not alive after renew timeout'\n        );\n\n    }\n\n    /**\n     * @returns {Promise<ApiResponse>}\n     */\n    resubscribe() {\n\n        return this._queue(\n            super.resubscribe,\n            this._resubscribeQueue,\n            this.events.queuedResubscribeSuccess,\n            this.events.queuedResubscribeError,\n            'Subscription is not alive after resubscribe timeout'\n        );\n\n    }\n\n    /**\n     * @param {string[]} events\n     * @return {CachedSubscription}\n     */\n    restore(events) {\n\n        var cachedSubscriptionData = this._cache.getItem(this._cacheKey);\n\n        if (cachedSubscriptionData) {\n            try {\n                this.setSubscription(cachedSubscriptionData);\n            } catch (e) {}\n        } else {\n            this.setEventFilters(events);\n        }\n\n        return this;\n\n    }\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/subscription/CachedSubscription.js\n **/","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var iteratorSymbol =\n    typeof Symbol === \"function\" && Symbol.iterator || \"@@iterator\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided, then outerFn.prototype instanceof Generator.\n    var generator = Object.create((outerFn || Generator).prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype;\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `value instanceof AwaitArgument` to determine if the yielded value is\n  // meant to be awaited. Some may consider the name of this method too\n  // cutesy, but they are curmudgeons.\n  runtime.awrap = function(arg) {\n    return new AwaitArgument(arg);\n  };\n\n  function AwaitArgument(arg) {\n    this.arg = arg;\n  }\n\n  function AsyncIterator(generator) {\n    // This invoke function is written in a style that assumes some\n    // calling function (or Promise) will handle exceptions.\n    function invoke(method, arg) {\n      var result = generator[method](arg);\n      var value = result.value;\n      return value instanceof AwaitArgument\n        ? Promise.resolve(value.arg).then(invokeNext, invokeThrow)\n        : Promise.resolve(value).then(function(unwrapped) {\n            // When a yielded Promise is resolved, its final value becomes\n            // the .value of the Promise<{value,done}> result for the\n            // current iteration. If the Promise is rejected, however, the\n            // result for this iteration will be rejected with the same\n            // reason. Note that rejections of yielded Promises are not\n            // thrown back into the generator function, as is the case\n            // when an awaited Promise is rejected. This difference in\n            // behavior between yield and await is important, because it\n            // allows the consumer to decide what to do with the yielded\n            // rejection (swallow it and continue, manually .throw it back\n            // into the generator, abandon iteration, whatever). With\n            // await, by contrast, there is no opportunity to examine the\n            // rejection reason outside the generator function, so the\n            // only option is to throw it from the await expression, and\n            // let the generator function handle the exception.\n            result.value = unwrapped;\n            return result;\n          });\n    }\n\n    if (typeof process === \"object\" && process.domain) {\n      invoke = process.domain.bind(invoke);\n    }\n\n    var invokeNext = invoke.bind(generator, \"next\");\n    var invokeThrow = invoke.bind(generator, \"throw\");\n    var invokeReturn = invoke.bind(generator, \"return\");\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return invoke(method, arg);\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : new Promise(function (resolve) {\n          resolve(callInvokeWithMethodAndArg());\n        });\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          if (method === \"return\" ||\n              (method === \"throw\" && delegate.iterator[method] === undefined)) {\n            // A return or throw (when the delegate iterator has no throw\n            // method) always terminates the yield* loop.\n            context.delegate = null;\n\n            // If the delegate iterator has a return method, give it a\n            // chance to clean up.\n            var returnMethod = delegate.iterator[\"return\"];\n            if (returnMethod) {\n              var record = tryCatch(returnMethod, delegate.iterator, arg);\n              if (record.type === \"throw\") {\n                // If the return method threw an exception, let that\n                // exception prevail over the original return or throw.\n                method = \"throw\";\n                arg = record.arg;\n                continue;\n              }\n            }\n\n            if (method === \"return\") {\n              // Continue with the outer return, now that the delegate\n              // iterator has been terminated.\n              continue;\n            }\n          }\n\n          var record = tryCatch(\n            delegate.iterator[method],\n            delegate.iterator,\n            arg\n          );\n\n          if (record.type === \"throw\") {\n            context.delegate = null;\n\n            // Like returning generator.throw(uncaught), but without the\n            // overhead of an extra function call.\n            method = \"throw\";\n            arg = record.arg;\n            continue;\n          }\n\n          // Delegate generator ran and handled its own exceptions so\n          // regardless of what the method was, we continue as if it is\n          // \"next\" with an undefined arg.\n          method = \"next\";\n          arg = undefined;\n\n          var info = record.arg;\n          if (info.done) {\n            context[delegate.resultName] = info.value;\n            context.next = delegate.nextLoc;\n          } else {\n            state = GenStateSuspendedYield;\n            return info;\n          }\n\n          context.delegate = null;\n        }\n\n        if (method === \"next\") {\n          if (state === GenStateSuspendedYield) {\n            context.sent = arg;\n          } else {\n            context.sent = undefined;\n          }\n\n        } else if (method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw arg;\n          }\n\n          if (context.dispatchException(arg)) {\n            // If the dispatched exception was caught by a catch block,\n            // then let that catch block handle the exception normally.\n            method = \"next\";\n            arg = undefined;\n          }\n\n        } else if (method === \"return\") {\n          context.abrupt(\"return\", arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          var info = {\n            value: record.arg,\n            done: context.done\n          };\n\n          if (record.arg === ContinueSentinel) {\n            if (context.delegate && method === \"next\") {\n              // Deliberately forget the last sent value so that we don't\n              // accidentally pass it on to the delegate.\n              arg = undefined;\n            }\n          } else {\n            return info;\n          }\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(arg) call above.\n          method = \"throw\";\n          arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      this.sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n        return !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.next = finallyEntry.finallyLoc;\n      } else {\n        this.complete(record);\n      }\n\n      return ContinueSentinel;\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = record.arg;\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/regenerator/runtime.js\n ** module id = 22\n ** module chunks = 0\n **/"],"sourceRoot":"/source/"}